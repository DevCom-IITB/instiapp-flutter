var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,k){a instanceof String&&(a=String(a));for(var d=a.length,c=0;c<d;c++){var b=a[c];if(e.call(k,b,c,a))return{i:c,v:b}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,k){a!=Array.prototype&&a!=Object.prototype&&(a[e]=k.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,e,k,d){if(e){k=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var c=a[d];c in k||(k[c]={});k=k[c]}a=a[a.length-1];d=k[a];e=e(d);e!=d&&null!=e&&$jscomp.defineProperty(k,a,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,k){return $jscomp.findInternal(this,a,k).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var e=0;return function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,e){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var k=0,d={next:function(){if(k<a.length){var c=k++;return{value:e(c,a[c]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Math.cosh",function(a){if(a)return a;var e=Math.exp;return function(a){a=Number(a);return(e(a)+e(-a))/2}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,k){return k})}},"es8","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,k,d){var c=this.length||0;0>k&&(k=Math.max(0,c+k));if(null==d||d>c)d=c;d=Number(d);0>d&&(d=Math.max(0,c+d));for(k=Number(k||0);k<d;k++)this[k]=a;return this}},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(a){return Math.pow(2,-52)},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,k){return a===k?0!==a||1/a===1/k:a!==a&&k!==k}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,k){var d=this;d instanceof String&&(d=String(d));var c=d.length;k=k||0;for(0>k&&(k=Math.max(k+c,0));k<c;k++){var b=d[k];if(b===a||Object.is(b,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,e,k){if(null==a)throw new TypeError("The 'this' value for String.prototype."+k+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+k+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,k){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,k||0)}},"es6","es3");
(function(){function a(e,k,d){function c(h,g){if(!k[h]){if(!e[h]){var f="function"==typeof require&&require;if(!g&&f)return f(h,!0);if(b)return b(h,!0);g=Error("Cannot find module '"+h+"'");throw g.code="MODULE_NOT_FOUND",g;}g=k[h]={exports:{}};e[h][0].call(g.exports,function(a){return c(e[h][1][a]||a)},g,g.exports,a,e,k,d)}return k[h].exports}for(var b="function"==typeof require&&require,h=0;h<d.length;h++)c(d[h]);return c}return a})()({1:[function(a,e,k){function d(a){a:{for(var f=0;f<n.length;f++)if(n[f].short_name.toLowerCase().replace(" ",
"-").replace(/^A-Za-z0-9\\-/,"")==a){a=n[f];break a}a=void 0}void 0!=a&&(b.moveToLocation(a),c(a))}function c(a){void 0==a?(document.getElementById("infobox").style.opacity=0,document.getElementById("locfab").classList.remove("translate"),setTimeout(function(){document.getElementById("infobox").style.display="none";document.getElementById("locname").innerText="";document.getElementById("locdesc").innerText=""},300)):(document.getElementById("infobox").style.display="block",document.getElementById("locfab").classList.add("translate"),
setTimeout(function(){document.getElementById("infobox").style.opacity=1},100),document.getElementById("locname").innerText=a.name,document.getElementById("locdesc").innerText=a.description)}var b=a("instimapweb");e=a("autocomplete.js");var h=a("fuse.js");a=a("hammerjs");var n=[],g,f={shouldSort:!0,threshold:.3,tokenize:!0,location:0,distance:7,maxPatternLength:10,minMatchCharLength:1,keys:["name","short_name"]};e("#search",{hint:!0},[{source:function(a,f){f(g.search(a).slice(0,10))},displayKey:"short_name",
templates:{suggestion:function(a){return a.short_name}}}]).on("autocomplete:selected",function(a,f,g,l){b.moveToLocation(f);c(f)});fetch("https://api.insti.app/api/locations").then(function(a){return a.json()}).then(function(a){n=a;g=new h(n,f);b.getMap({mapPath:"assets/map.webp",mapMinPath:"assets/map.webp",markersBase:"assets/map/",attributions:'<a href="http://mrane.com/" target="_blank">Prof. Mandar Rane</a>',map_id:"map",marker_id:"marker",user_marker_id:"user-marker"},n,function(a){c(a)},
function(){document.querySelector(".loading-fader").style.display="none";document.querySelectorAll(".hide-till-load").forEach(function(a){a.classList.remove("hide-till-load")});document.body.style.background="#666";var a=decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent("location").replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));null!=a&&void 0!=a&&d(a)})});e=document.querySelector("#infobox, #infobox *");var l=document.querySelector("#infobox");
e=new a.Manager(e);a=new a.Swipe;e.add(a);e.on("swipe",function(a){a=a.offsetDirection;8===a?l.classList.add("expanded"):16==a&&l.classList.remove("expanded")});document.getElementById("locfab").addEventListener("click",function(){b.getGPS()})},{"autocomplete.js":2,"fuse.js":20,hammerjs:21,instimapweb:28}],2:[function(a,e,k){e.exports=a("./src/standalone/")},{"./src/standalone/":17}],3:[function(a,e,k){a=a("../common/utils.js");k={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",
top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:"0"},defaultClasses:{root:"algolia-autocomplete",
prefix:"aa",noPrefix:!1,dropdownMenu:"dropdown-menu",input:"input",hint:"hint",suggestions:"suggestions",suggestion:"suggestion",cursor:"cursor",dataset:"dataset",empty:"empty"},appendTo:{wrapper:{position:"absolute",zIndex:"100",display:"none"},input:{},inputWithNoHint:{},dropdown:{display:"block"}}};a.isMsie()&&a.mixin(k.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});a.isMsie()&&7>=a.isMsie()&&a.mixin(k.input,{marginTop:"-1px"});e.exports=
k},{"../common/utils.js":13}],4:[function(a,e,k){function d(a){a=a||{};a.templates=a.templates||{};a.source||h.error("missing source");a.name&&!/^[_a-zA-Z0-9-]+$/.test(a.name)&&h.error("invalid dataset name: "+a.name);this.query=null;this._isEmpty=!0;this.highlight=!!a.highlight;this.name="undefined"===typeof a.name||null===a.name?h.getUniqueId():a.name;this.source=a.source;this.displayFn=c(a.display||a.displayKey);this.debounce=a.debounce;this.cache=!1!==a.cache;this.templates=b(a.templates,this.displayFn);
this.css=h.mixin({},f,a.appendTo?f.appendTo:{});this.cssClasses=a.cssClasses=h.mixin({},f.defaultClasses,a.cssClasses||{});this.cssClasses.prefix=a.cssClasses.formattedPrefix||h.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix);var l=h.className(this.cssClasses.prefix,this.cssClasses.dataset);this.$el=a.$menu&&0<a.$menu.find(l+"-"+this.name).length?n.element(a.$menu.find(l+"-"+this.name)[0]):n.element(g.dataset.replace("%CLASS%",this.name).replace("%PREFIX%",this.cssClasses.prefix).replace("%DATASET%",
this.cssClasses.dataset));this.$menu=a.$menu;this.clearCachedSuggestions()}function c(a){function f(f){return f[a]}a=a||"value";return h.isFunction(a)?a:f}function b(a,f){function b(a){return"<p>"+f(a)+"</p>"}return{empty:a.empty&&h.templatify(a.empty),header:a.header&&h.templatify(a.header),footer:a.footer&&h.templatify(a.footer),suggestion:a.suggestion||b}}var h=a("../common/utils.js"),n=a("../common/dom.js"),g=a("./html.js"),f=a("./css.js");a=a("./event_emitter.js");d.extractDatasetName=function(a){return n.element(a).data("aaDataset")};
d.extractValue=function(a){return n.element(a).data("aaValue")};d.extractDatum=function(a){a=n.element(a).data("aaDatum");"string"===typeof a&&(a=JSON.parse(a));return a};h.mixin(d.prototype,a,{_render:function(a,f){function b(){var f=[].slice.call(arguments,0);f=[{query:a,isEmpty:!0}].concat(f);return d.templates.empty.apply(this,f)}function p(){var a=[].slice.call(arguments,0),b=this;var p=g.suggestions.replace("%PREFIX%",this.cssClasses.prefix).replace("%SUGGESTIONS%",this.cssClasses.suggestions);
p=n.element(p).css(this.css.suggestions);var l=h.map(f,function(f){var p=g.suggestion.replace("%PREFIX%",b.cssClasses.prefix).replace("%SUGGESTION%",b.cssClasses.suggestion);p=n.element(p).attr({role:"option",id:["option",Math.floor(1E8*Math.random())].join("-")}).append(d.templates.suggestion.apply(this,[f].concat(a)));p.data("aaDataset",d.name);p.data("aaValue",d.displayFn(f)||void 0);p.data("aaDatum",JSON.stringify(f));p.children().each(function(){n.element(this).css(b.css.suggestionChild)});return p});
p.append.apply(p,l);return p}function l(){var f=[].slice.call(arguments,0);f=[{query:a,isEmpty:!q}].concat(f);return d.templates.header.apply(this,f)}function c(){var f=[].slice.call(arguments,0);f=[{query:a,isEmpty:!q}].concat(f);return d.templates.footer.apply(this,f)}if(this.$el){var d=this,e=[].slice.call(arguments,2);this.$el.empty();var q=f&&f.length;this._isEmpty=!q;if(!q&&this.templates.empty)this.$el.html(b.apply(this,e)).prepend(d.templates.header?l.apply(this,e):null).append(d.templates.footer?
c.apply(this,e):null);else if(q)this.$el.html(p.apply(this,e)).prepend(d.templates.header?l.apply(this,e):null).append(d.templates.footer?c.apply(this,e):null);else if(f&&!Array.isArray(f))throw new TypeError("suggestions must be an array");this.$menu&&this.$menu.addClass(this.cssClasses.prefix+(q?"with":"without")+"-"+this.name).removeClass(this.cssClasses.prefix+(q?"without":"with")+"-"+this.name);this.trigger("rendered",a)}},getRoot:function(){return this.$el},update:function(a){function f(f){if(!this.canceled&&
a===this.query){var b=[].slice.call(arguments,1);this.cacheSuggestions(a,f,b);this._render.apply(this,[a,f].concat(b))}}this.query=a;this.canceled=!1;if(this.shouldFetchFromCache(a))f.apply(this,[this.cachedSuggestions].concat(this.cachedRenderExtraArgs));else{var b=this,g=function(){b.canceled||b.source(a,f.bind(b))};this.debounce?(clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(function(){b.debounceTimeout=null;g()},this.debounce)):g()}},cacheSuggestions:function(a,f,b){this.cachedQuery=
a;this.cachedSuggestions=f;this.cachedRenderExtraArgs=b},shouldFetchFromCache:function(a){return this.cache&&this.cachedQuery===a&&this.cachedSuggestions&&this.cachedSuggestions.length},clearCachedSuggestions:function(){delete this.cachedQuery;delete this.cachedSuggestions;delete this.cachedRenderExtraArgs},cancel:function(){this.canceled=!0},clear:function(){this.cancel();this.$el.empty();this.trigger("rendered","")},isEmpty:function(){return this._isEmpty},destroy:function(){this.clearCachedSuggestions();
this.$el=null}});e.exports=d},{"../common/dom.js":11,"../common/utils.js":13,"./css.js":3,"./event_emitter.js":7,"./html.js":8}],5:[function(a,e,k){function d(a){var f=this;a=a||{};a.menu||c.error("menu is required");c.isArray(a.datasets)||c.isObject(a.datasets)||c.error("1 or more datasets required");a.datasets||c.error("datasets is required");this.isOpen=!1;this.isEmpty=!0;this.minLength=a.minLength||0;this.templates={};this.appendTo=a.appendTo||!1;this.css=c.mixin({},n,a.appendTo?n.appendTo:{});
this.cssClasses=a.cssClasses=c.mixin({},n.defaultClasses,a.cssClasses||{});this.cssClasses.prefix=a.cssClasses.formattedPrefix||c.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix);var g=c.bind(this._onSuggestionClick,this);var h=c.bind(this._onSuggestionMouseEnter,this);var m=c.bind(this._onSuggestionMouseLeave,this);var p=c.className(this.cssClasses.prefix,this.cssClasses.suggestion);this.$menu=b.element(a.menu).on("mouseenter.aa",p,h).on("mouseleave.aa",p,m).on("click.aa",p,g);this.$container=
a.appendTo?a.wrapper:this.$menu;a.templates&&a.templates.header&&(this.templates.header=c.templatify(a.templates.header),this.$menu.prepend(this.templates.header()));a.templates&&a.templates.empty&&(this.templates.empty=c.templatify(a.templates.empty),this.$empty=b.element('<div class="'+c.className(this.cssClasses.prefix,this.cssClasses.empty,!0)+'"></div>'),this.$menu.append(this.$empty),this.$empty.hide());this.datasets=c.map(a.datasets,function(b){return new d.Dataset(c.mixin({$menu:f.$menu,cssClasses:a.cssClasses},
b))});c.each(this.datasets,function(a){var b=a.getRoot();b&&0===b.parent().length&&f.$menu.append(b);a.onSync("rendered",f._onRendered,f)});a.templates&&a.templates.footer&&(this.templates.footer=c.templatify(a.templates.footer),this.$menu.append(this.templates.footer()));var e=this;b.element(window).resize(function(){e._redraw()})}var c=a("../common/utils.js"),b=a("../common/dom.js");k=a("./event_emitter.js");var h=a("./dataset.js"),n=a("./css.js");c.mixin(d.prototype,k,{_onSuggestionClick:function(a){this.trigger("suggestionClicked",
b.element(a.currentTarget))},_onSuggestionMouseEnter:function(a){var f=b.element(a.currentTarget);if(!f.hasClass(c.className(this.cssClasses.prefix,this.cssClasses.cursor,!0))){this._removeCursor();var g=this;setTimeout(function(){g._setCursor(f,!1)},0)}},_onSuggestionMouseLeave:function(a){a.relatedTarget&&0<b.element(a.relatedTarget).closest("."+c.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).length||(this._removeCursor(),this.trigger("cursorRemoved"))},_onRendered:function(a,f){function b(a){return a.templates&&
a.templates.empty}(this.isEmpty=c.every(this.datasets,function(a){return a.isEmpty()}))?(f.length>=this.minLength&&this.trigger("empty"),this.$empty?f.length<this.minLength?this._hide():(a=this.templates.empty({query:this.datasets[0]&&this.datasets[0].query}),this.$empty.html(a),this.$empty.show(),this._show()):c.any(this.datasets,b)?f.length<this.minLength?this._hide():this._show():this._hide()):this.isOpen&&(this.$empty&&(this.$empty.empty(),this.$empty.hide()),f.length>=this.minLength?this._show():
this._hide());this.trigger("datasetRendered")},_hide:function(){this.$container.hide()},_show:function(){this.$container.css("display","block");this._redraw();this.trigger("shown")},_redraw:function(){this.isOpen&&this.appendTo&&this.trigger("redrawn")},_getSuggestions:function(){return this.$menu.find(c.className(this.cssClasses.prefix,this.cssClasses.suggestion))},_getCursor:function(){return this.$menu.find(c.className(this.cssClasses.prefix,this.cssClasses.cursor)).first()},_setCursor:function(a,
f){a.first().addClass(c.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).attr("aria-selected","true");this.trigger("cursorMoved",f)},_removeCursor:function(){this._getCursor().removeClass(c.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).removeAttr("aria-selected")},_moveCursor:function(a){if(this.isOpen){var f=this._getCursor();var b=this._getSuggestions();this._removeCursor();a=b.index(f)+a;a=(a+1)%(b.length+1)-1;-1===a?this.trigger("cursorRemoved"):(-1>a&&(a=b.length-1),
this._setCursor(b=b.eq(a),!0),this._ensureVisible(b))}},_ensureVisible:function(a){var f=a.position().top;a=f+a.height()+parseInt(a.css("margin-top"),10)+parseInt(a.css("margin-bottom"),10);var b=this.$menu.scrollTop();var g=this.$menu.height()+parseInt(this.$menu.css("padding-top"),10)+parseInt(this.$menu.css("padding-bottom"),10);0>f?this.$menu.scrollTop(b+f):g<a&&this.$menu.scrollTop(b+(a-g))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},
open:function(){this.isOpen||(this.isOpen=!0,this.isEmpty||this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?this.css.ltr:this.css.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var f=null;a.length&&(f={raw:h.extractDatum(a),value:h.extractValue(a),datasetName:h.extractDatasetName(a)});return f},getCurrentCursor:function(){return this._getCursor().first()},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},
getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},cursorTopSuggestion:function(){this._setCursor(this._getSuggestions().first(),!1)},update:function(a){c.each(this.datasets,function(f){f.update(a)})},empty:function(){c.each(this.datasets,function(a){a.clear()});this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".aa");this.$menu=null;c.each(this.datasets,function(a){a.destroy()})}});d.Dataset=
h;e.exports=d},{"../common/dom.js":11,"../common/utils.js":13,"./css.js":3,"./dataset.js":4,"./event_emitter.js":7}],6:[function(a,e,k){function d(a){a&&a.el||c.error("EventBus initialized without el");this.$el=b.element(a.el)}var c=a("../common/utils.js"),b=a("../common/dom.js");c.mixin(d.prototype,{trigger:function(a,b,g,f){a=c.Event("autocomplete:"+a);this.$el.trigger(a,[b,g,f]);return a}});e.exports=d},{"../common/dom.js":11,"../common/utils.js":13}],7:[function(a,e,k){function d(a,f,c,d){if(!c)return this;
f=f.split(n);c=d?b(c,d):c;for(this._callbacks=this._callbacks||{};d=f.shift();)this._callbacks[d]=this._callbacks[d]||{sync:[],async:[]},this._callbacks[d][a].push(c);return this}function c(a,f,b){return function(){for(var g,c=0,p=a.length;!g&&c<p;c+=1)g=!1===a[c].apply(f,b);return!g}}function b(a,f){return a.bind?a.bind(f):function(){a.apply(f,[].slice.call(arguments,0))}}var h=a("immediate"),n=/\s+/;e.exports={onSync:function(a,f,b){return d.call(this,"sync",a,f,b)},onAsync:function(a,f,b){return d.call(this,
"async",a,f,b)},off:function(a){var f;if(!this._callbacks)return this;for(a=a.split(n);f=a.shift();)delete this._callbacks[f];return this},trigger:function(a){var f,b,g;if(!this._callbacks)return this;a=a.split(n);for(g=[].slice.call(arguments,1);(f=a.shift())&&(b=this._callbacks[f]);){var d=c(b.sync,this,[f].concat(g));var p=c(b.async,this,[f].concat(g));d()&&h(p)}return this}}},{immediate:22}],8:[function(a,e,k){e.exports={wrapper:'<span class="%ROOT%"></span>',dropdown:'<span class="%PREFIX%%DROPDOWN_MENU%"></span>',
dataset:'<div class="%PREFIX%%DATASET%-%CLASS%"></div>',suggestions:'<span class="%PREFIX%%SUGGESTIONS%"></span>',suggestion:'<div class="%PREFIX%%SUGGESTION%"></div>'}},{}],9:[function(a,e,k){function d(a){var f=this;a=a||{};a.input||n.error("input is missing");var b=n.bind(this._onBlur,this);var d=n.bind(this._onFocus,this);var p=n.bind(this._onKeydown,this);var e=n.bind(this._onInput,this);this.$hint=g.element(a.hint);this.$input=g.element(a.input).on("blur.aa",b).on("focus.aa",d).on("keydown.aa",
p);0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=n.noop);if(n.isMsie())this.$input.on("keydown.aa keypress.aa cut.aa paste.aa",function(a){h[a.which||a.keyCode]||n.defer(n.bind(f._onInput,f,a))});else this.$input.on("input.aa",e);this.query=this.$input.val();this.$overflowHelper=c(this.$input)}function c(a){return g.element('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:a.css("font-family"),fontSize:a.css("font-size"),
fontStyle:a.css("font-style"),fontVariant:a.css("font-variant"),fontWeight:a.css("font-weight"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),textIndent:a.css("text-indent"),textRendering:a.css("text-rendering"),textTransform:a.css("text-transform")}).insertAfter(a)}function b(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var h={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};var n=a("../common/utils.js"),g=a("../common/dom.js");a=a("./event_emitter.js");
d.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")};n.mixin(d.prototype,a,{_onBlur:function(){this.resetInputValue();this.$input.removeAttr("aria-activedescendant");this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=h[a.which||a.keyCode];this._managePreventDefault(b,a);b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,c){switch(a){case "tab":a=
this.getHint();var f=this.getInputValue();a=a&&a!==f&&!b(c);break;case "up":case "down":a=!b(c);break;default:a=!1}a&&c.preventDefault()},_shouldTrigger:function(a,c){switch(a){case "tab":a=!b(c);break;default:a=!0}return a},_checkInputValue:function(){var a=this.getInputValue();var b=this.query;var c=(b=d.normalizeQuery(a)===d.normalizeQuery(b))&&this.query?this.query.length!==a.length:!1;this.query=a;b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},
blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){"undefined"===typeof a&&(a=this.query);this.$input.val(a);b?this.clearHint():this._checkInputValue()},expand:function(){this.$input.attr("aria-expanded","true")},collapse:function(){this.$input.attr("aria-expanded","false")},setActiveDescendant:function(a){this.$input.attr("aria-activedescendant",a)},removeActiveDescendant:function(){this.$input.removeAttr("aria-activedescendant")},
resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a=this.getInputValue();var b=this.getHint();b=a!==b&&0===b.indexOf(a);""!==a&&b&&!this.hasOverflow()||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());
return this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a=this.$input.val().length;var b=this.$input[0].selectionStart;return n.isNumber(b)?b===a:document.selection?(b=document.selection.createRange(),b.moveStart("character",-a),a===b.text.length):!0},destroy:function(){this.$hint.off(".aa");this.$input.off(".aa");this.$hint=this.$input=this.$overflowHelper=null}});e.exports=d},{"../common/dom.js":11,"../common/utils.js":13,"./event_emitter.js":7}],10:[function(a,e,k){function d(a){a=
a||{};a.input||n.error("missing input");this.isActivated=!1;this.debug=!!a.debug;this.autoselect=!!a.autoselect;this.autoselectOnBlur=!!a.autoselectOnBlur;this.openOnFocus=!!a.openOnFocus;this.minLength=n.isNumber(a.minLength)?a.minLength:1;this.autoWidth=void 0===a.autoWidth?!0:!!a.autoWidth;this.clearOnSelected=!!a.clearOnSelected;this.tabAutocomplete=void 0===a.tabAutocomplete?!0:!!a.tabAutocomplete;a.hint=!!a.hint;if(a.hint&&a.appendTo)throw Error("[autocomplete.js] hint and appendTo options can't be used at the same time");
this.css=a.css=n.mixin({},m,a.appendTo?m.appendTo:{});this.cssClasses=a.cssClasses=n.mixin({},m.defaultClasses,a.cssClasses||{});this.cssClasses.prefix=a.cssClasses.formattedPrefix=n.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix);this.listboxId=a.listboxId=[this.cssClasses.root,"listbox",n.getUniqueId()].join("-");var b=c(a);this.$node=b.wrapper;var p=this.$input=b.input;var h=b.menu;b=b.hint;a.dropdownMenuContainer&&g.element(a.dropdownMenuContainer).css("position","relative").append(h.css("top",
"0"));p.on("blur.aa",function(a){var b=document.activeElement;n.isMsie()&&(h[0]===b||h[0].contains(b))&&(a.preventDefault(),a.stopImmediatePropagation(),n.defer(function(){p.focus()}))});h.on("mousedown.aa",function(a){a.preventDefault()});this.eventBus=a.eventBus||new f({el:p});this.dropdown=(new d.Dropdown({appendTo:a.appendTo,wrapper:this.$node,menu:h,datasets:a.datasets,templates:a.templates,cssClasses:a.cssClasses,minLength:this.minLength})).onSync("suggestionClicked",this._onSuggestionClicked,
this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onSync("shown",this._onShown,this).onSync("empty",this._onEmpty,this).onSync("redrawn",this._onRedrawn,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=(new d.Input({input:p,hint:b})).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,
this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);this._bindKeyboardShortcuts(a);this._setLanguageDirection()}function c(a){var f=g.element(a.input);var c=g.element(q.wrapper.replace("%ROOT%",
a.cssClasses.root)).css(a.css.wrapper);a.appendTo||"block"!==f.css("display")||"table"!==f.parent().css("display")||c.css("display","table-cell");var p=q.dropdown.replace("%PREFIX%",a.cssClasses.prefix).replace("%DROPDOWN_MENU%",a.cssClasses.dropdownMenu);p=g.element(p).css(a.css.dropdown).attr({role:"listbox",id:a.listboxId});a.templates&&a.templates.dropdownMenu&&p.html(n.templatify(a.templates.dropdownMenu)());var d=f.clone().css(a.css.hint).css(b(f));d.val("").addClass(n.className(a.cssClasses.prefix,
a.cssClasses.hint,!0)).removeAttr("id name placeholder required").prop("readonly",!0).attr({"aria-hidden":"true",autocomplete:"off",spellcheck:"false",tabindex:-1});d.removeData&&d.removeData();f.data("aaAttrs",{"aria-autocomplete":f.attr("aria-autocomplete"),"aria-expanded":f.attr("aria-expanded"),"aria-owns":f.attr("aria-owns"),autocomplete:f.attr("autocomplete"),dir:f.attr("dir"),role:f.attr("role"),spellcheck:f.attr("spellcheck"),style:f.attr("style"),type:f.attr("type")});f.addClass(n.className(a.cssClasses.prefix,
a.cssClasses.input,!0)).attr({autocomplete:"off",spellcheck:!1,role:"combobox","aria-autocomplete":a.datasets&&a.datasets[0]&&a.datasets[0].displayKey?"both":"list","aria-expanded":"false","aria-label":a.ariaLabel,"aria-owns":a.listboxId}).css(a.hint?a.css.input:a.css.inputWithNoHint);try{f.attr("dir")||f.attr("dir","auto")}catch(w){}c=a.appendTo?c.appendTo(g.element(a.appendTo).eq(0)).eq(0):f.wrap(c).parent();c.prepend(a.hint?d:null).append(p);return{wrapper:c,input:f,hint:d,menu:p}}function b(a){return{backgroundAttachment:a.css("background-attachment"),
backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function h(a,b){var f=a.find(n.className(b.prefix,b.input));n.each(f.data("aaAttrs"),function(a,b){void 0===a?f.removeAttr(b):f.attr(b,a)});f.detach().removeClass(n.className(b.prefix,b.input,!0)).insertAfter(a);
f.removeData&&f.removeData("aaAttrs");a.remove()}var n=a("../common/utils.js"),g=a("../common/dom.js"),f=a("./event_bus.js"),l=a("./input.js");k=a("./dropdown.js");var q=a("./html.js"),m=a("./css.js");n.mixin(d.prototype,{_bindKeyboardShortcuts:function(a){if(a.keyboardShortcuts){var b=this.$input,f=[];n.each(a.keyboardShortcuts,function(a){"string"===typeof a&&(a=a.toUpperCase().charCodeAt(0));f.push(a)});g.element(document).keydown(function(a){var c=a.target||a.srcElement,g=c.tagName;c.isContentEditable||
"INPUT"===g||"SELECT"===g||"TEXTAREA"===g||-1===f.indexOf(a.which||a.keyCode)||(b.focus(),a.stopPropagation(),a.preventDefault())})}},_onSuggestionClicked:function(a,b){var f;a={selectionMethod:"click"};(f=this.dropdown.getDatumForSuggestion(b))&&this._select(f,a)},_onCursorMoved:function(a,b){a=this.dropdown.getDatumForCursor();var f=this.dropdown.getCurrentCursor().attr("id");this.input.setActiveDescendant(f);a&&(b&&this.input.setInputValue(a.value,!0),this.eventBus.trigger("cursorchanged",a.raw,
a.datasetName))},_onCursorRemoved:function(){this.input.resetInputValue();this._updateHint();this.eventBus.trigger("cursorremoved")},_onDatasetRendered:function(){this._updateHint();this.eventBus.trigger("updated")},_onOpened:function(){this._updateHint();this.input.expand();this.eventBus.trigger("opened")},_onEmpty:function(){this.eventBus.trigger("empty")},_onRedrawn:function(){this.$node.css("top","0px");this.$node.css("left","0px");var a=this.$input[0].getBoundingClientRect();this.autoWidth&&
this.$node.css("width",a.width+"px");var b=this.$node[0].getBoundingClientRect();this.$node.css("top",a.bottom-b.top+"px");this.$node.css("left",a.left-b.left+"px");this.eventBus.trigger("redrawn")},_onShown:function(){this.eventBus.trigger("shown");this.autoselect&&this.dropdown.cursorTopSuggestion()},_onClosed:function(){this.input.clearHint();this.input.removeActiveDescendant();this.input.collapse();this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0;if(this.openOnFocus){var a=
this.input.getQuery();a.length>=this.minLength?this.dropdown.update(a):this.dropdown.empty();this.dropdown.open()}},_onBlurred:function(){var a=this.dropdown.getDatumForCursor();var b=this.dropdown.getDatumForTopSuggestion();var f={selectionMethod:"blur"};this.debug||(this.autoselectOnBlur&&a?this._select(a,f):this.autoselectOnBlur&&b?this._select(b,f):(this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()))},_onEnterKeyed:function(a,b){a=this.dropdown.getDatumForCursor();var f=this.dropdown.getDatumForTopSuggestion();
var c={selectionMethod:"enterKey"};a?(this._select(a,c),b.preventDefault()):this.autoselect&&f&&(this._select(f,c),b.preventDefault())},_onTabKeyed:function(a,b){if(this.tabAutocomplete){var f={selectionMethod:"tabKey"};(a=this.dropdown.getDatumForCursor())?(this._select(a,f),b.preventDefault()):this._autocomplete(!0)}else this.dropdown.close()},_onEscKeyed:function(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=
this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp();this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown();this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid();b.length>=this.minLength?this.dropdown.update(b):
this.dropdown.empty();this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function(){var a=this.input.getLanguageDirection();this.dir!==a&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a;if((a=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()){var b=this.input.getInputValue();var f=l.normalizeQuery(b);
f=n.escapeRegExChars(f);f=new RegExp("^(?:"+f+")(.+$)","i");(a=f.exec(a.value))?this.input.setHint(b+a[1]):this.input.clearHint()}else this.input.clearHint()},_autocomplete:function(a){var b=this.input.getHint();var f=this.input.getQuery();a=a||this.input.isCursorAtEnd();b&&f!==b&&a&&((b=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(b.value),this.eventBus.trigger("autocompleted",b.raw,b.datasetName))},_select:function(a,b){"undefined"!==typeof a.value&&this.input.setQuery(a.value);
this.clearOnSelected?this.setVal(""):this.input.setInputValue(a.value,!0);this._setLanguageDirection();!1===this.eventBus.trigger("selected",a.raw,a.datasetName,b).isDefaultPrevented()&&(this.dropdown.close(),n.defer(n.bind(this.dropdown.empty,this.dropdown)))},open:function(){if(!this.isActivated){var a=this.input.getInputValue();a.length>=this.minLength?this.dropdown.update(a):this.dropdown.empty()}this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){a=n.toStr(a);this.isActivated?
this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0));this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy();this.dropdown.destroy();h(this.$node,this.cssClasses);this.$node=null},getWrapper:function(){return this.dropdown.$container[0]}});d.Dropdown=k;d.Input=l;d.sources=a("../sources/index.js");e.exports=d},{"../common/dom.js":11,"../common/utils.js":13,"../sources/index.js":15,"./css.js":3,"./dropdown.js":5,
"./event_bus.js":6,"./html.js":8,"./input.js":9}],11:[function(a,e,k){e.exports={element:null}},{}],12:[function(a,e,k){e.exports=function(a){if(a=a.match(/Algolia for vanilla JavaScript (\d+\.)(\d+\.)(\d+)/))return[a[1],a[2],a[3]]}},{}],13:[function(a,e,k){function d(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var c=a("./dom.js");e.exports={isArray:null,isFunction:null,isObject:null,bind:null,each:null,map:null,mixin:null,isMsie:function(a){void 0===a&&(a=navigator.userAgent);
return/(msie|trident)/i.test(a)&&(a=a.match(/(msie |rv:)(\d+(.\d+)?)/i))?a[2]:!1},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isNumber:function(a){return"number"===typeof a},toStr:function(a){return void 0===a||null===a?"":a+""},cloneDeep:function(a){var b=this.mixin({},a),c=this;this.each(b,function(a,f){a&&(c.isArray(a)?b[f]=[].concat(a):c.isObject(a)&&(b[f]=c.cloneDeep(a)))});return b},error:function(a){throw Error(a);},every:function(a,c){var b=
!0;if(!a)return b;this.each(a,function(g,f){b&&(b=c.call(null,g,f,a)&&b)});return!!b},any:function(a,c){var b=!1;if(!a)return b;this.each(a,function(g,f){if(c.call(null,g,f,a))return b=!0,!1});return b},getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(a){if(this.isFunction(a))return a;var b=c.element(a);return"SCRIPT"===b.prop("tagName")?function(){return b.text()}:function(){return String(a)}},defer:function(a){setTimeout(a,0)},noop:function(){},formatPrefix:function(a,
c){return c?"":a+"-"},className:function(a,c,d){return(d?"":".")+a+c},escapeHighlightedString:function(a,c,e){c=c||"<em>";var b=document.createElement("div");b.appendChild(document.createTextNode(c));e=e||"</em>";var f=document.createElement("div");f.appendChild(document.createTextNode(e));var l=document.createElement("div");l.appendChild(document.createTextNode(a));return l.innerHTML.replace(RegExp(d(b.innerHTML),"g"),c).replace(RegExp(d(f.innerHTML),"g"),e)}}},{"./dom.js":11}],14:[function(a,e,
k){var d=a("../common/utils.js"),c=a("../../version.js"),b=a("../common/parseAlgoliaClientVersion.js");e.exports=function(a,e){var g=b(a.as._ua);g&&3<=g[0]&&20<g[1]&&(e=e||{},e.additionalUA="autocomplete.js "+c);return function(b,c){a.search(b,e,function(a,b){a?d.error(a.message):c(b.hits,b)})}}},{"../../version.js":18,"../common/parseAlgoliaClientVersion.js":12,"../common/utils.js":13}],15:[function(a,e,k){e.exports={hits:a("./hits.js"),popularIn:a("./popularIn.js")}},{"./hits.js":14,"./popularIn.js":16}],
16:[function(a,e,k){var d=a("../common/utils.js"),c=a("../../version.js"),b=a("../common/parseAlgoliaClientVersion.js");e.exports=function(a,e,g,f){var l=b(a.as._ua);l&&3<=l[0]&&20<l[1]&&(e=e||{},e.additionalUA="autocomplete.js "+c);if(!g.source)return d.error("Missing 'source' key");var h=d.isFunction(g.source)?g.source:function(a){return a[g.source]};if(!g.index)return d.error("Missing 'index' key");var m=g.index;f=f||{};return function(l,q){a.search(l,e,function(a,l){if(a)d.error(a.message);else if(0<
l.hits.length){var p=l.hits[0];a=d.mixin({hitsPerPage:0},g);delete a.source;delete a.index;var n=b(m.as._ua);n&&3<=n[0]&&20<n[1]&&(e.additionalUA="autocomplete.js "+c);m.search(h(p),a,function(a,b){if(a)d.error(a.message);else{var c=[];f.includeAll&&c.push(d.mixin({facet:{value:f.allTitle||"All departments",count:b.nbHits}},d.cloneDeep(p)));d.each(b.facets,function(a,b){d.each(a,function(a,f){c.push(d.mixin({facet:{facet:b,value:f,count:a}},d.cloneDeep(p)))})});for(a=1;a<l.hits.length;++a)c.push(l.hits[a]);
q(c,l)}})}else q([])})}}},{"../../version.js":18,"../common/parseAlgoliaClientVersion.js":12,"../common/utils.js":13}],17:[function(a,e,k){function d(a,f,g,d){g=b.isArray(g)?g:[].slice.call(arguments,2);var l=c(a).each(function(a,b){a=c(b);b=new n({el:a});b=d||new h({input:a,eventBus:b,dropdownMenuContainer:f.dropdownMenuContainer,hint:void 0===f.hint?!0:!!f.hint,minLength:f.minLength,autoselect:f.autoselect,autoselectOnBlur:f.autoselectOnBlur,tabAutocomplete:f.tabAutocomplete,openOnFocus:f.openOnFocus,
templates:f.templates,debug:f.debug,clearOnSelected:f.clearOnSelected,cssClasses:f.cssClasses,datasets:g,keyboardShortcuts:f.keyboardShortcuts,appendTo:f.appendTo,autoWidth:f.autoWidth});a.data("aaAutocomplete",b)});l.autocomplete={};b.each("open close getVal setVal destroy getWrapper".split(" "),function(a){l.autocomplete[a]=function(){var b=arguments,f;l.each(function(g,d){g=c(d).data("aaAutocomplete");f=g[a].apply(g,b)});return f}});return l}var c=a("../../zepto.js");a("../common/dom.js").element=
c;var b=a("../common/utils.js");b.isArray=c.isArray;b.isFunction=c.isFunction;b.isObject=c.isPlainObject;b.bind=c.proxy;b.each=function(a,b){c.each(a,function(a,f){return b(f,a)})};b.map=c.map;b.mixin=c.extend;b.Event=c.Event;var h=a("../autocomplete/typeahead.js"),n=a("../autocomplete/event_bus.js");d.sources=h.sources;d.escapeHighlightedString=b.escapeHighlightedString;var g="autocomplete"in window,f=window.autocomplete;d.noConflict=function(){g?window.autocomplete=f:delete window.autocomplete;
return d};e.exports=d},{"../../zepto.js":19,"../autocomplete/event_bus.js":6,"../autocomplete/typeahead.js":10,"../common/dom.js":11,"../common/utils.js":13}],18:[function(a,e,k){e.exports="0.35.0"},{}],19:[function(a,e,k){(function(a,c){e.exports=c(a)})(window,function(a){var c=function(){function b(a){return null==a?String(a):V[Y.call(a)]||"object"}function c(a){return"function"==b(a)}function d(a){return null!=a&&a==a.window}function g(a){return"object"==b(a)}function f(a){return g(a)&&!d(a)&&
Object.getPrototypeOf(a)==Object.prototype}function l(a){var b=!!a&&"length"in a&&a.length,f=E.type(a);return"function"!=f&&!d(a)&&("array"==f||0===b||"number"==typeof b&&0<b&&b-1 in a)}function e(a){return H.call(a,function(a){return null!=a})}function m(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function p(a){return a in R?R[a]:R[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function r(a,b){return"number"!=
typeof b||G[m(a)]?b:b+"px"}function t(a){return"children"in a?J.call(a.children):E.map(a.childNodes,function(a){if(1==a.nodeType)return a})}function u(a,b){var f,c=a?a.length:0;for(f=0;f<c;f++)this[f]=a[f];this.length=c;this.selector=b||""}function y(a,b,c){for(C in b)c&&(f(b[C])||W(b[C]))?(f(b[C])&&!f(a[C])&&(a[C]={}),W(b[C])&&!W(a[C])&&(a[C]=[]),y(a[C],b[C],c)):b[C]!==z&&(a[C]=b[C])}function w(a,b){return null==b?E(a):E(a).filter(b)}function v(a,b,f,g){return c(b)?b.call(a,f,g):b}function A(a,b){var f=
a.className||"",c=f&&f.baseVal!==z;if(b===z)return c?f.baseVal:f;c?f.baseVal=b:a.className=b}function B(a){try{return a?"true"==a||("false"==a?!1:"null"==a?null:+a+""==a?+a:/^[\[\{]/.test(a)?E.parseJSON(a):a):a}catch(ia){return a}}function x(a,b){b(a);for(var f=0,c=a.childNodes.length;f<c;f++)x(a.childNodes[f],b)}var z,C,S,k=[],M=k.concat,H=k.filter,J=k.slice,D=a.document,T={},R={},G={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},Q=/^\s*<(\w+|!)[^>]*>/,da=
/^<(\w+)\s*\/?>(?:<\/\1>|)$/,aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,F=/^(?:body|html)$/i,N=/([A-Z])/g,O="val css html text data width height offset".split(" "),K=D.createElement("table"),U=D.createElement("tr"),Z={tr:D.createElement("tbody"),tbody:K,thead:K,tfoot:K,td:U,th:U,"*":D.createElement("div")},ba=/complete|loaded|interactive/,X=/^[\w-]*$/,V={},Y=V.toString,L={},P=D.createElement("div"),ea={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",
maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},W=Array.isArray||function(a){return a instanceof Array};L.matches=function(a,b){if(!b||!a||1!==a.nodeType)return!1;var f=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(f)return f.call(a,b);var c=a.parentNode;(f=!c)&&(c=P).appendChild(a);b=~L.qsa(c,b).indexOf(a);
f&&P.removeChild(a);return b};var ca=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})};var fa=function(a){return H.call(a,function(b,f){return a.indexOf(b)==f})};L.fragment=function(a,b,c){var g;da.test(a)&&(g=E(D.createElement(RegExp.$1)));if(!g){a.replace&&(a=a.replace(aa,"<$1></$2>"));b===z&&(b=Q.test(a)&&RegExp.$1);b in Z||(b="*");var d=Z[b];d.innerHTML=""+a;g=E.each(J.call(d.childNodes),function(){d.removeChild(this)})}if(f(c)){var l=E(g);E.each(c,function(a,
b){if(-1<O.indexOf(a))l[a](b);else l.attr(a,b)})}return g};L.Z=function(a,b){return new u(a,b)};L.isZ=function(a){return a instanceof L.Z};L.init=function(a,b){if(a)if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&Q.test(a))b=L.fragment(a,RegExp.$1,b),a=null;else{if(b!==z)return E(b).find(a);b=L.qsa(D,a)}else{if(c(a))return E(D).ready(a);if(L.isZ(a))return a;if(W(a))b=e(a);else if(g(a))b=[a],a=null;else if(Q.test(a))b=L.fragment(a.trim(),RegExp.$1,b),a=null;else{if(b!==z)return E(b).find(a);b=L.qsa(D,
a)}}else return L.Z();return L.Z(b,a)};var E=function(a,b){return L.init(a,b)};E.extend=function(a){var b=J.call(arguments,1);if("boolean"==typeof a){var f=a;a=b.shift()}b.forEach(function(b){y(a,b,f)});return a};L.qsa=function(a,b){var f,c="#"==b[0],g=!c&&"."==b[0],d=c||g?b.slice(1):b,l=X.test(d);return a.getElementById&&l&&c?(f=a.getElementById(d))?[f]:[]:1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType?[]:J.call(l&&!c&&a.getElementsByClassName?g?a.getElementsByClassName(d):a.getElementsByTagName(b):
a.querySelectorAll(b))};E.contains=D.documentElement.contains?function(a,b){return a!==b&&a.contains(b)}:function(a,b){for(;b&&(b=b.parentNode);)if(b===a)return!0;return!1};E.type=b;E.isFunction=c;E.isWindow=d;E.isArray=W;E.isPlainObject=f;E.isEmptyObject=function(a){for(var b in a)return!1;return!0};E.isNumeric=function(a){var b=Number(a),f=typeof a;return null!=a&&"boolean"!=f&&("string"!=f||a.length)&&!isNaN(b)&&isFinite(b)||!1};E.inArray=function(a,b,f){return k.indexOf.call(b,a,f)};E.camelCase=
ca;E.trim=function(a){return null==a?"":String.prototype.trim.call(a)};E.uuid=0;E.support={};E.expr={};E.noop=function(){};E.map=function(a,b){var f=[],c;if(l(a))for(c=0;c<a.length;c++){var g=b(a[c],c);null!=g&&f.push(g)}else for(c in a)g=b(a[c],c),null!=g&&f.push(g);return 0<f.length?E.fn.concat.apply([],f):f};E.each=function(a,b){var f;if(l(a))for(f=0;f<a.length&&!1!==b.call(a[f],f,a[f]);f++);else for(f in a)if(!1===b.call(a[f],f,a[f]))break;return a};E.grep=function(a,b){return H.call(a,b)};a.JSON&&
(E.parseJSON=JSON.parse);E.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});E.fn={constructor:L.Z,length:0,forEach:k.forEach,reduce:k.reduce,push:k.push,sort:k.sort,splice:k.splice,indexOf:k.indexOf,concat:function(){var a,b=[];for(a=0;a<arguments.length;a++){var f=arguments[a];b[a]=L.isZ(f)?f.toArray():f}return M.apply(L.isZ(this)?this.toArray():this,b)},map:function(a){return E(E.map(this,function(b,f){return a.call(b,
f,b)}))},slice:function(){return E(J.apply(this,arguments))},ready:function(a){ba.test(D.readyState)&&D.body?a(E):D.addEventListener("DOMContentLoaded",function(){a(E)},!1);return this},get:function(a){return a===z?J.call(this):this[0<=a?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){k.every.call(this,function(b,f){return!1!==a.call(b,
f,b)});return this},filter:function(a){return c(a)?this.not(this.not(a)):E(H.call(this,function(b){return L.matches(b,a)}))},add:function(a,b){return E(fa(this.concat(E(a,b))))},is:function(a){return 0<this.length&&L.matches(this[0],a)},not:function(a){var b=[];if(c(a)&&a.call!==z)this.each(function(f){a.call(this,f)||b.push(this)});else{var f="string"==typeof a?this.filter(a):l(a)&&c(a.item)?J.call(a):E(a);this.forEach(function(a){0>f.indexOf(a)&&b.push(a)})}return E(b)},has:function(a){return this.filter(function(){return g(a)?
E.contains(this,a):E(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!g(a)?a:E(a)},last:function(){var a=this[this.length-1];return a&&!g(a)?a:E(a)},find:function(a){var b=this;return a?"object"==typeof a?E(a).filter(function(){var a=this;return k.some.call(b,function(b){return E.contains(b,a)})}):1==this.length?E(L.qsa(this[0],a)):this.map(function(){return L.qsa(this,a)}):E()},closest:function(a,b){var f=[],c="object"==
typeof a&&E(a);this.each(function(g,d){for(;d&&!(c?0<=c.indexOf(d):L.matches(d,a));)d=d!==b&&!(null!=d&&d.nodeType==d.DOCUMENT_NODE)&&d.parentNode;d&&0>f.indexOf(d)&&f.push(d)});return E(f)},parents:function(a){for(var b=[],f=this;0<f.length;)f=E.map(f,function(a){if((a=a.parentNode)&&(null==a||a.nodeType!=a.DOCUMENT_NODE)&&0>b.indexOf(a))return b.push(a),a});return w(b,a)},parent:function(a){return w(fa(this.pluck("parentNode")),a)},children:function(a){return w(this.map(function(){return t(this)}),
a)},contents:function(){return this.map(function(){return this.contentDocument||J.call(this.childNodes)})},siblings:function(a){return w(this.map(function(a,b){return H.call(t(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return E.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display="");if("none"==getComputedStyle(this,"").getPropertyValue("display")){var a=
this.style,b=this.nodeName;if(!T[b]){var f=D.createElement(b);D.body.appendChild(f);var c=getComputedStyle(f,"").getPropertyValue("display");f.parentNode.removeChild(f);"none"==c&&(c="block");T[b]=c}a.display=T[b]}})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var b=c(a);if(this[0]&&!b)var f=E(a).get(0),g=f.parentNode||1<this.length;return this.each(function(c){E(this).wrapAll(b?a.call(this,c):g?f.cloneNode(!0):f)})},wrapAll:function(a){if(this[0]){E(this[0]).before(a=
E(a));for(var b;(b=a.children()).length;)a=b.first();E(a).append(this)}return this},wrapInner:function(a){var b=c(a);return this.each(function(f){var c=E(this),g=c.contents();f=b?a.call(this,f):a;g.length?g.wrapAll(f):c.append(f)})},unwrap:function(){this.parent().each(function(){E(this).replaceWith(E(this).children())});return this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=
E(this);(a===z?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return E(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return E(this.pluck("nextElementSibling")).filter(a||"*")},html:function(a){return 0 in arguments?this.each(function(b){var f=this.innerHTML;E(this).empty().append(v(this,a,b,f))}):0 in this?this[0].innerHTML:null},text:function(a){return 0 in arguments?this.each(function(b){b=v(this,a,b,this.textContent);this.textContent=null==b?"":""+b}):
0 in this?this.pluck("textContent").join(""):null},attr:function(a,b){var f;return"string"!=typeof a||1 in arguments?this.each(function(f){if(1===this.nodeType)if(g(a))for(C in a){var c=C;f=a[C];null==f?this.removeAttribute(c):this.setAttribute(c,f)}else c=a,f=v(this,b,f,this.getAttribute(a)),null==f?this.removeAttribute(c):this.setAttribute(c,f)}):0 in this&&1==this[0].nodeType&&null!=(f=this[0].getAttribute(a))?f:z},removeAttr:function(a){return this.each(function(){1===this.nodeType&&a.split(" ").forEach(function(a){this.removeAttribute(a)},
this)})},prop:function(a,b){a=ea[a]||a;return 1 in arguments?this.each(function(f){this[a]=v(this,b,f,this[a])}):this[0]&&this[0][a]},removeProp:function(a){a=ea[a]||a;return this.each(function(){delete this[a]})},data:function(a,b){var f="data-"+a.replace(N,"-$1").toLowerCase();f=1 in arguments?this.attr(f,b):this.attr(f);return null!==f?B(f):z},val:function(a){return 0 in arguments?(null==a&&(a=""),this.each(function(b){this.value=v(this,a,b,this.value)})):this[0]&&(this[0].multiple?E(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):
this[0].value)},offset:function(b){if(b)return this.each(function(a){var f=E(this);a=v(this,b,a,f.offset());var c=f.offsetParent().offset();a={top:a.top-c.top,left:a.left-c.left};"static"==f.css("position")&&(a.position="relative");f.css(a)});if(!this.length)return null;if(D.documentElement!==this[0]&&!E.contains(D.documentElement,this[0]))return{top:0,left:0};var f=this[0].getBoundingClientRect();return{left:f.left+a.pageXOffset,top:f.top+a.pageYOffset,width:Math.round(f.width),height:Math.round(f.height)}},
css:function(a,f){if(2>arguments.length){var c=this[0];if("string"==typeof a)return c?c.style[ca(a)]||getComputedStyle(c,"").getPropertyValue(a):void 0;if(W(a)){if(!c)return;var g={},d=getComputedStyle(c,"");E.each(a,function(a,b){g[b]=c.style[ca(b)]||d.getPropertyValue(b)});return g}}var l="";if("string"==b(a))f||0===f?l=m(a)+":"+r(a,f):this.each(function(){this.style.removeProperty(m(a))});else for(C in a)a[C]||0===a[C]?l+=m(C)+":"+r(C,a[C])+";":this.each(function(){this.style.removeProperty(m(C))});
return this.each(function(){this.style.cssText+=";"+l})},index:function(a){return a?this.indexOf(E(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return a?k.some.call(this,function(a){return this.test(A(a))},p(a)):!1},addClass:function(a){return a?this.each(function(b){if("className"in this){S=[];var f=A(this);v(this,a,b,f).split(/\s+/g).forEach(function(a){E(this).hasClass(a)||S.push(a)},this);S.length&&A(this,f+(f?" ":"")+S.join(" "))}}):this},removeClass:function(a){return this.each(function(b){if("className"in
this){if(a===z)return A(this,"");S=A(this);v(this,a,b,S).split(/\s+/g).forEach(function(a){S=S.replace(p(a)," ")});A(this,S.trim())}})},toggleClass:function(a,b){return a?this.each(function(f){var c=E(this);v(this,a,f,A(this)).split(/\s+/g).forEach(function(a){(b===z?!c.hasClass(a):b)?c.addClass(a):c.removeClass(a)})}):this},scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===z?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,
a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===z?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),f=this.offset(),c=F.test(b[0].nodeName)?{top:0,left:0}:b.offset();f.top-=parseFloat(E(a).css("margin-top"))||0;f.left-=parseFloat(E(a).css("margin-left"))||0;c.top+=parseFloat(E(b[0]).css("border-top-width"))||0;c.left+=
parseFloat(E(b[0]).css("border-left-width"))||0;return{top:f.top-c.top,left:f.left-c.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||D.body;a&&!F.test(a.nodeName)&&"static"==E(a).css("position");)a=a.offsetParent;return a})}};E.fn.detach=E.fn.remove;["width","height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});E.fn[a]=function(f){var c,g=this[0];return f===z?d(g)?g["inner"+b]:null!=g&&g.nodeType==g.DOCUMENT_NODE?g.documentElement["scroll"+
b]:(c=this.offset())&&c[a]:this.each(function(b){g=E(this);g.css(a,v(this,f,b,g[a]()))})}});["after","prepend","before","append"].forEach(function(f,c){var g=c%2;E.fn[f]=function(){var f,d=E.map(arguments,function(a){var c=[];f=b(a);return"array"==f?(a.forEach(function(a){if(a.nodeType!==z)return c.push(a);if(E.zepto.isZ(a))return c=c.concat(a.get());c=c.concat(L.fragment(a))}),c):"object"==f||null==a?a:L.fragment(a)}),l,m=1<this.length;return 1>d.length?this:this.each(function(b,f){l=g?f:f.parentNode;
f=0==c?f.nextSibling:1==c?f.firstChild:2==c?f:null;var p=E.contains(D.documentElement,l);d.forEach(function(b){if(m)b=b.cloneNode(!0);else if(!l)return E(b).remove();l.insertBefore(b,f);p&&x(b,function(b){if(!(null==b.nodeName||"SCRIPT"!==b.nodeName.toUpperCase()||b.type&&"text/javascript"!==b.type||b.src)){var f=b.ownerDocument?b.ownerDocument.defaultView:a;f.eval.call(f,b.innerHTML)}})})})};E.fn[g?f+"To":"insert"+(c?"Before":"After")]=function(a){E(a)[f](this);return this}});L.Z.prototype=u.prototype=
E.fn;L.uniq=fa;L.deserializeValue=B;E.zepto=L;return E}();(function(b){function c(a){return a._zid||(a._zid=r++)}function d(a,b,f,d){b=g(b);if(b.ns)var l=new RegExp("(?:^| )"+b.ns.replace(" "," .* ?")+"(?: |$)");return(v[c(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||l.test(a.ns))&&(!f||c(a.fn)===c(f))&&(!d||a.sel==d)})}function g(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function f(a){return z[a]||B&&x[a]||a}function l(a,d,l,p,e,h,q){var n=c(a),r=v[n]||
(v[n]=[]);d.split(/\s/).forEach(function(c){if("ready"==c)return b(document).ready(l);var d=g(c);d.fn=l;d.sel=e;d.e in z&&(l=function(a){var f=a.relatedTarget;if(!f||f!==this&&!b.contains(this,f))return d.fn.apply(this,arguments)});var n=(d.del=h)||l;d.proxy=function(b){b=m(b);if(!b.isImmediatePropagationStopped()){try{var f=Object.getOwnPropertyDescriptor(b,"data");if(!f||f.writable)b.data=p}catch(Z){}f=n.apply(a,b._args==t?[b]:[b].concat(b._args));!1===f&&(b.preventDefault(),b.stopPropagation());
return f}};d.i=r.length;r.push(d);"addEventListener"in a&&a.addEventListener(f(d.e),d.proxy,d.del&&!B&&d.e in x||!!q)})}function e(a,b,g,l,p){var m=c(a);(b||"").split(/\s/).forEach(function(b){d(a,b,g,l).forEach(function(b){delete v[m][b.i];"removeEventListener"in a&&a.removeEventListener(f(b.e),b.proxy,b.del&&!B&&b.e in x||!!p)})})}function m(a,f){if(f||!a.isDefaultPrevented)if(f||(f=a),b.each(M,function(b,c){var g=f[b];a[b]=function(){this[c]=C;return g&&g.apply(f,arguments)};a[c]=k}),a.timeStamp||
(a.timeStamp=Date.now()),f.defaultPrevented!==t?f.defaultPrevented:"returnValue"in f?!1===f.returnValue:f.getPreventDefault&&f.getPreventDefault())a.isDefaultPrevented=C;return a}function p(a){var b,f={originalEvent:a};for(b in a)I.test(b)||a[b]===t||(f[b]=a[b]);return m(f,a)}var r=1,t,u=Array.prototype.slice,y=b.isFunction,w=function(a){return"string"==typeof a},v={},A={},B="onfocusin"in a,x={focus:"focusin",blur:"focusout"},z={mouseenter:"mouseover",mouseleave:"mouseout"};A.click=A.mousedown=A.mouseup=
A.mousemove="MouseEvents";b.event={add:l,remove:e};b.proxy=function(a,f){var g=2 in arguments&&u.call(arguments,2);if(y(a)){var d=function(){return a.apply(f,g?g.concat(u.call(arguments)):arguments)};d._zid=c(a);return d}if(w(f))return g?(g.unshift(a[f],a),b.proxy.apply(null,g)):b.proxy(a[f],a);throw new TypeError("expected function");};b.fn.bind=function(a,b,f){return this.on(a,b,f)};b.fn.unbind=function(a,b){return this.off(a,b)};b.fn.one=function(a,b,f,c){return this.on(a,b,f,c,1)};var C=function(){return!0},
k=function(){return!1},I=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,M={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};b.fn.delegate=function(a,b,f){return this.on(b,a,f)};b.fn.undelegate=function(a,b,f){return this.off(b,a,f)};b.fn.live=function(a,f){b(document.body).delegate(this.selector,a,f);return this};b.fn.die=function(a,f){b(document.body).undelegate(this.selector,a,f);return this};b.fn.on=function(a,
f,c,g,d){var m,h,q=this;if(a&&!w(a))return b.each(a,function(a,b){q.on(a,f,c,b,d)}),q;w(f)||y(g)||!1===g||(g=c,c=f,f=t);if(g===t||!1===c)g=c,c=t;!1===g&&(g=k);return q.each(function(q,n){d&&(m=function(a){e(n,a.type,g);return g.apply(this,arguments)});f&&(h=function(a){var c=b(a.target).closest(f,n).get(0);if(c&&c!==n){var d=b.extend(p(a),{currentTarget:c,liveFired:n});return(m||g).apply(c,[d].concat(u.call(arguments,1)))}});l(n,a,g,c,f,h||m)})};b.fn.off=function(a,f,c){var g=this;if(a&&!w(a))return b.each(a,
function(a,b){g.off(a,f,b)}),g;w(f)||y(c)||!1===c||(c=f,f=t);!1===c&&(c=k);return g.each(function(){e(this,a,c,f)})};b.fn.trigger=function(a,f){a=w(a)||b.isPlainObject(a)?b.Event(a):m(a);a._args=f;return this.each(function(){if(a.type in x&&"function"==typeof this[a.type])this[a.type]();else"dispatchEvent"in this?this.dispatchEvent(a):b(this).triggerHandler(a,f)})};b.fn.triggerHandler=function(a,f){var c,g;this.each(function(l,m){c=p(w(a)?b.Event(a):a);c._args=f;c.target=m;b.each(d(m,a.type||a),function(a,
b){g=b.proxy(c);if(c.isImmediatePropagationStopped())return!1})});return g};"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(a){b.fn[a]=function(b){return 0 in arguments?this.bind(a,b):this.trigger(a)}});b.Event=function(a,b){w(a)||(b=a,a=b.type);var f=document.createEvent(A[a]||"Events"),c=!0;if(b)for(var g in b)"bubbles"==g?c=!!b[g]:f[g]=
b[g];f.initEvent(a,c,!0);return m(f)}})(c);(function(a){var b=[],c;a.fn.remove=function(){return this.each(function(){this.parentNode&&("IMG"===this.tagName&&(b.push(this),this.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",c&&clearTimeout(c),c=setTimeout(function(){b=[]},6E4)),this.parentNode.removeChild(this))})}})(c);(function(a){function b(b,g){var l=b[m];l=l&&f[l];if(void 0===g)return l||c(b);if(l){if(g in l)return l[g];var p=e(g);if(p in l)return l[p]}return d.call(a(b),g)}
function c(b,c,d){var l=b[m]||(b[m]=++a.uuid);b=f[l]||(f[l]=g(b));void 0!==c&&(b[e(c)]=d);return b}function g(b){var f={};a.each(b.attributes||p,function(b,c){0==c.name.indexOf("data-")&&(f[e(c.name.replace("data-",""))]=a.zepto.deserializeValue(c.value))});return f}var f={},d=a.fn.data,e=a.camelCase,m=a.expando="Zepto"+ +new Date,p=[];a.fn.data=function(f,g){return void 0===g?a.isPlainObject(f)?this.each(function(b,g){a.each(f,function(a,b){c(g,a,b)})}):0 in this?b(this[0],f):void 0:this.each(function(){c(this,
f,g)})};a.data=function(b,f,c){return a(b).data(f,c)};a.hasData=function(b){return(b=(b=b[m])&&f[b])?!a.isEmptyObject(b):!1};a.fn.removeData=function(b){"string"==typeof b&&(b=b.split(/\s+/));return this.each(function(){var c=this[m],g=c&&f[c];g&&a.each(b||g,function(a){delete g[b?e(this):a]})})};["remove","empty"].forEach(function(b){var f=a.fn[b];a.fn[b]=function(){var a=this.find("*");"remove"===b&&(a=a.add(this));a.removeData();return f.call(this)}})})(c);return c})},{}],20:[function(a,e,k){(function(a,
c){"object"===typeof k&&"object"===typeof e?e.exports=c():"function"===typeof define&&define.amd?define("Fuse",[],c):"object"===typeof k?k.Fuse=c():a.Fuse=c()})(this,function(){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};a[d].call(e.exports,e,e.exports,c);e.l=!0;return e.exports}var b={};c.m=a;c.c=b;c.d=function(a,b,g){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:g})};c.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})};c.t=function(a,b){b&1&&(a=c(a));if(b&8||b&4&&"object"===typeof a&&a&&a.__esModule)return a;var g=Object.create(null);c.r(g);Object.defineProperty(g,"default",{enumerable:!0,value:a});if(b&2&&"string"!=typeof a)for(var f in a)c.d(g,f,function(b){return a[b]}.bind(null,f));return g};c.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};c.d(b,"a",b);return b};c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,
b)};c.p="";return c(c.s="./src/index.js")}({"./src/bitap/bitap_matched_indices.js":function(a,c){a.exports=function(){for(var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=[],g=-1,f,l=0,e=a.length;l<e;l+=1)(f=a[l])&&-1===g?g=l:f||-1===g||(f=l-1,f-g+1>=c&&d.push([g,f]),g=-1);a[l-1]&&l-g>=c&&d.push([g,l-1]);return d}},"./src/bitap/bitap_pattern_alphabet.js":function(a,c){a.exports=function(a){for(var b={},c=a.length,g=0;g<c;g+=
1)b[a.charAt(g)]=0;for(g=0;g<c;g+=1)b[a.charAt(g)]|=1<<c-g-1;return b}},"./src/bitap/bitap_regex_search.js":function(a,c){var b=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;a.exports=function(a,c){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g;g=new RegExp(c.replace(b,"\\$&").replace(g,"|"));g=a.match(g);var f=!!g,d=[];if(f)for(var e=0,m=g.length;e<m;e+=1){var p=g[e];d.push([a.indexOf(p),p.length-1])}return{score:f?.5:1,isMatch:f,matchedIndices:d}}},"./src/bitap/bitap_score.js":function(a,
c){a.exports=function(a,c){var b=c.errors,g=c.currentLocation,f=c.expectedLocation;c=c.distance;c=void 0===c?100:c;a=(void 0===b?0:b)/a.length;g=Math.abs((void 0===f?0:f)-(void 0===g?0:g));return c?a+g/c:g?1:a}},"./src/bitap/bitap_search.js":function(a,c,b){var d=b("./src/bitap/bitap_score.js"),e=b("./src/bitap/bitap_matched_indices.js");a.exports=function(a,b,c,h){var f=h.location,g=h.distance;g=void 0===g?100:g;var l=h.threshold,q=h.findAllMatches;q=void 0===q?!1:q;h=h.minMatchCharLength;h=void 0===
h?1:h;f=void 0===f?0:f;var n=a.length;l=void 0===l?.6:l;for(var y=a.indexOf(b,f),w=b.length,v=[],A=0;A<n;A+=1)v[A]=0;-1!==y&&(y=d(b,{errors:0,currentLocation:y,expectedLocation:f,distance:g}),l=Math.min(y,l),y=a.lastIndexOf(b,f+w),-1!==y&&(y=d(b,{errors:0,currentLocation:y,expectedLocation:f,distance:g}),l=Math.min(y,l)));y=-1;A=[];for(var B=1,x=w+n,z=1<<w-1,C=0;C<w;C+=1){for(var k=0,I=x;k<I;)d(b,{errors:C,currentLocation:f+I,expectedLocation:f,distance:g})<=l?k=I:x=I,I=Math.floor((x-k)/2+k);x=I;
k=Math.max(1,f-I+1);var M=q?n:Math.min(f+I,n)+w;I=Array(M+2);for(I[M+1]=(1<<C)-1;M>=k;--M){var H=M-1,J=c[a.charAt(H)];J&&(v[H]=1);I[M]=(I[M+1]<<1|1)&J;0!==C&&(I[M]=I[M]|(A[M+1]|A[M])<<1|1|A[M+1]);if(I[M]&z&&(B=d(b,{errors:C,currentLocation:H,expectedLocation:f,distance:g}),B<=l)){l=B;y=H;if(y<=f)break;k=Math.max(1,2*f-y)}}if(d(b,{errors:C+1,currentLocation:f,expectedLocation:f,distance:g})>l)break;A=I}return{isMatch:0<=y,score:0===B?.001:B,matchedIndices:e(v,h)}}},"./src/bitap/index.js":function(a,
c,b){function d(a,b){for(var f=0;f<b.length;f++){var c=b[f];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}function e(a,b,f){b&&d(a.prototype,b);f&&d(a,f);return a}var g=b("./src/bitap/bitap_regex_search.js"),f=b("./src/bitap/bitap_search.js"),l=b("./src/bitap/bitap_pattern_alphabet.js");c=function(){function a(b,f){var c=f.location;c=void 0===c?0:c;var g=f.distance;g=void 0===g?100:g;var d=f.threshold;d=void 0===d?.6:d;var e=f.maxPatternLength;
e=void 0===e?32:e;var m=f.isCaseSensitive;m=void 0===m?!1:m;var p=f.tokenSeparator;p=void 0===p?/ +/g:p;var h=f.findAllMatches;h=void 0===h?!1:h;f=f.minMatchCharLength;f=void 0===f?1:f;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.options={location:c,distance:g,threshold:d,maxPatternLength:e,isCaseSensitive:m,tokenSeparator:p,findAllMatches:h,minMatchCharLength:f};this.pattern=this.options.isCaseSensitive?b:b.toLowerCase();this.pattern.length<=e&&(this.patternAlphabet=
l(this.pattern))}e(a,[{key:"search",value:function(a){this.options.isCaseSensitive||(a=a.toLowerCase());if(this.pattern===a)return{isMatch:!0,score:0,matchedIndices:[[0,a.length-1]]};var b=this.options,c=b.tokenSeparator;if(this.pattern.length>b.maxPatternLength)return g(a,this.pattern,c);b=this.options;return f(a,this.pattern,this.patternAlphabet,{location:b.location,distance:b.distance,threshold:b.threshold,findAllMatches:b.findAllMatches,minMatchCharLength:b.minMatchCharLength})}}]);return a}();
a.exports=c},"./src/helpers/deep_value.js":function(a,c,b){var d=b("./src/helpers/is_array.js"),e=function m(a,b,c){if(b){var f=b.indexOf("."),l=b,e=null;-1!==f&&(l=b.slice(0,f),e=b.slice(f+1));a=a[l];if(null!==a&&void 0!==a)if(e||"string"!==typeof a&&"number"!==typeof a)if(d(a))for(b=0,f=a.length;b<f;b+=1)m(a[b],e,c);else e&&m(a,e,c);else c.push(a.toString())}else c.push(a);return c};a.exports=function(a,b){return e(a,b,[])}},"./src/helpers/is_array.js":function(a,c){a.exports=function(a){return Array.isArray?
Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)}},"./src/index.js":function(a,c,b){function d(a){d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return d(a)}function e(a,b){for(var f=0;f<b.length;f++){var c=b[f];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}
function g(a,b,f){b&&e(a.prototype,b);f&&e(a,f);return a}var f=b("./src/bitap/index.js"),l=b("./src/helpers/deep_value.js"),q=b("./src/helpers/is_array.js");c=function(){function a(b,f){var c=f.location;c=void 0===c?0:c;var g=f.distance;g=void 0===g?100:g;var d=f.threshold;d=void 0===d?.6:d;var e=f.maxPatternLength;e=void 0===e?32:e;var m=f.caseSensitive;m=void 0===m?!1:m;var p=f.tokenSeparator;p=void 0===p?/ +/g:p;var h=f.findAllMatches;h=void 0===h?!1:h;var q=f.minMatchCharLength;q=void 0===q?1:
q;var n=f.id;n=void 0===n?null:n;var r=f.keys;r=void 0===r?[]:r;var k=f.shouldSort;k=void 0===k?!0:k;var I=f.getFn;I=void 0===I?l:I;var M=f.sortFn;M=void 0===M?function(a,b){return a.score-b.score}:M;var H=f.tokenize;H=void 0===H?!1:H;var J=f.matchAllTokens;J=void 0===J?!1:J;var D=f.includeMatches;D=void 0===D?!1:D;var T=f.includeScore;T=void 0===T?!1:T;f=f.verbose;f=void 0===f?!1:f;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.options={location:c,distance:g,
threshold:d,maxPatternLength:e,isCaseSensitive:m,tokenSeparator:p,findAllMatches:h,minMatchCharLength:q,id:n,keys:r,includeMatches:D,includeScore:T,shouldSort:k,getFn:I,sortFn:M,verbose:f,tokenize:H,matchAllTokens:J};this.setCollection(b)}g(a,[{key:"setCollection",value:function(a){return this.list=a}},{key:"search",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\nSearch pattern: "'.concat(a,'"'));var f=this._prepareSearchers(a);f=this._search(f.tokenSearchers,
f.fullSearcher);var c=f.results;this._computeScore(f.weights,c);this.options.shouldSort&&this._sort(c);b.limit&&"number"===typeof b.limit&&(c=c.slice(0,b.limit));return this._format(c)}},{key:"_prepareSearchers",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",b=[];if(this.options.tokenize)for(var c=a.split(this.options.tokenSeparator),g=0,d=c.length;g<d;g+=1)b.push(new f(c[g],this.options));a=new f(a,this.options);return{tokenSearchers:b,fullSearcher:a}}},{key:"_search",
value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],b=1<arguments.length?arguments[1]:void 0,f=this.list,c={},g=[];if("string"===typeof f[0]){for(var d=0,l=f.length;d<l;d+=1)this._analyze({key:"",value:f[d],record:d,index:d},{resultMap:c,results:g,tokenSearchers:a,fullSearcher:b});return{weights:null,results:g}}d={};l=0;for(var e=f.length;l<e;l+=1)for(var m=f[l],h=0,q=this.options.keys.length;h<q;h+=1){var n=this.options.keys[h];if("string"!==typeof n){d[n.name]={weight:1-
n.weight||1};if(0>=n.weight||1<n.weight)throw Error("Key weight has to be > 0 and <= 1");n=n.name}else d[n]={weight:1};this._analyze({key:n,value:this.options.getFn(m,n),record:m,index:l},{resultMap:c,results:g,tokenSearchers:a,fullSearcher:b})}return{weights:d,results:g}}},{key:"_analyze",value:function(a,b){var f=a.key,c=a.arrayIndex,g=void 0===c?-1:c;c=a.value;var d=a.record;a=a.index;var l=b.tokenSearchers;l=void 0===l?[]:l;var e=b.fullSearcher,m=void 0===e?[]:e;e=b.resultMap;e=void 0===e?{}:
e;b=b.results;b=void 0===b?[]:b;if(void 0!==c&&null!==c){var h=!1,p=-1,n=0;if("string"===typeof c){this._log("\nKey: ".concat(""===f?"-":f));m=m.search(c);this._log('Full text: "'.concat(c,'", score: ').concat(m.score));if(this.options.tokenize){p=c.split(this.options.tokenSeparator);for(var r=[],k=0;k<l.length;k+=1){var M=l[k];this._log('\nPattern: "'.concat(M.pattern,'"'));for(var H=!1,J=0;J<p.length;J+=1){var D=p[J],T=M.search(D),R={};T.isMatch?(R[D]=T.score,H=h=!0,r.push(T.score)):(R[D]=1,this.options.matchAllTokens||
r.push(1));this._log('Token: "'.concat(D,'", score: ').concat(R[D]))}H&&(n+=1)}p=r[0];k=r.length;for(M=1;M<k;M+=1)p+=r[M];p/=k;this._log("Token score average:",p)}r=m.score;-1<p&&(r=(r+p)/2);this._log("Score average:",r);l=this.options.tokenize&&this.options.matchAllTokens?n>=l.length:!0;this._log("\nCheck Matches: ".concat(l));(h||m.isMatch)&&l&&((l=e[a])?l.output.push({key:f,arrayIndex:g,value:c,score:r,matchedIndices:m.matchedIndices}):(e[a]={item:d,output:[{key:f,arrayIndex:g,value:c,score:r,
matchedIndices:m.matchedIndices}]},b.push(e[a])))}else if(q(c))for(g=0,h=c.length;g<h;g+=1)this._analyze({key:f,arrayIndex:g,value:c[g],record:d,index:a},{resultMap:e,results:b,tokenSearchers:l,fullSearcher:m})}}},{key:"_computeScore",value:function(a,b){this._log("\n\nComputing score:\n");for(var f=0,c=b.length;f<c;f+=1){for(var g=b[f].output,d=g.length,l=1,e=1,m=0;m<d;m+=1){var h=a?a[g[m].key].weight:1,p=(1===h?g[m].score:g[m].score||.001)*h;1!==h?e=Math.min(e,p):(g[m].nScore=p,l*=p)}b[f].score=
1===e?l:e;this._log(b[f])}}},{key:"_sort",value:function(a){this._log("\n\nSorting....");a.sort(this.options.sortFn)}},{key:"_format",value:function(a){var b=[];if(this.options.verbose){var f=[];this._log("\n\nOutput:\n\n",JSON.stringify(a,function(a,b){if("object"===d(b)&&null!==b){if(-1!==f.indexOf(b))return;f.push(b)}return b}));f=null}var c=[];this.options.includeMatches&&c.push(function(a,b){a=a.output;b.matches=[];for(var f=0,c=a.length;f<c;f+=1){var g=a[f];if(0!==g.matchedIndices.length){var d=
{indices:g.matchedIndices,value:g.value};g.key&&(d.key=g.key);g.hasOwnProperty("arrayIndex")&&-1<g.arrayIndex&&(d.arrayIndex=g.arrayIndex);b.matches.push(d)}}});this.options.includeScore&&c.push(function(a,b){b.score=a.score});for(var g=0,l=a.length;g<l;g+=1){var e=a[g];this.options.id&&(e.item=this.options.getFn(e.item,this.options.id)[0]);if(c.length){for(var m={item:e.item},h=0,p=c.length;h<p;h+=1)c[h](e,m);b.push(m)}else b.push(e.item)}return b}},{key:"_log",value:function(){if(this.options.verbose){var a;
(a=console).log.apply(a,arguments)}}}]);return a}();a.exports=c}})})},{}],21:[function(a,e,k){(function(a,c,b,h){function d(a,b,f){return setTimeout(m(a,f),b)}function g(a,b,c){return Array.isArray(a)?(f(a,c[b],c),!0):!1}function f(a,b,f){var c;if(a)if(a.forEach)a.forEach(b,f);else if(a.length!==h)for(c=0;c<a.length;)b.call(f,a[c],c,a),c++;else for(c in a)a.hasOwnProperty(c)&&b.call(f,a[c],c,a)}function l(b,f,c){var g="DEPRECATED METHOD: "+f+"\n"+c+" AT \n";return function(){var f=Error("get-stack-trace");
f=f&&f.stack?f.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace";var c=a.console&&(a.console.warn||a.console.log);c&&c.call(a.console,g,f);return b.apply(this,arguments)}}function q(a,b,f){b=b.prototype;var c=a.prototype=Object.create(b);c.constructor=a;c._super=b;f&&la(c,f)}function m(a,b){return function(){return a.apply(b,arguments)}}function p(a,b){return"function"==typeof a?a.apply(b?b[0]||h:h,b):a}function r(a,
b,c){f(y(b),function(b){a.addEventListener(b,c,!1)})}function t(a,b,c){f(y(b),function(b){a.removeEventListener(b,c,!1)})}function u(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function y(a){return a.trim().split(/\s+/g)}function w(a,b,f){if(a.indexOf&&!f)return a.indexOf(b);for(var c=0;c<a.length;){if(f&&a[c][f]==b||!f&&a[c]===b)return c;c++}return-1}function v(a){return Array.prototype.slice.call(a,0)}function k(a,b,f){for(var c=[],g=[],d=0;d<a.length;){var l=b?a[d][b]:a[d];0>w(g,l)&&
c.push(a[d]);g[d]=l;d++}f&&(c=b?c.sort(function(a,f){return a[b]>f[b]}):c.sort());return c}function B(a,b){for(var f,c=b[0].toUpperCase()+b.slice(1),g=0;g<ia.length;){f=(f=ia[g])?f+c:b;if(f in a)return f;g++}return h}function x(b){b=b.ownerDocument||b;return b.defaultView||b.parentWindow||a}function z(a,b){var f=this;this.manager=a;this.callback=b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){p(a.options.enable,[a])&&f.handler(b)};this.init()}function C(a){var b=
a.options.inputClass;return new (b?b:Aa?R:Ba?Q:ra?aa:T)(a,S)}function S(a,b,f){var c=f.pointers.length,g=f.changedPointers.length;var d=b&1&&0===c-g;f.isFirst=!!d;f.isFinal=!!(b&12&&0===c-g);d&&(a.session={});f.eventType=b;b=a.session;c=f.pointers;g=c.length;b.firstInput||(b.firstInput=I(f));1<g&&!b.firstMultiple?b.firstMultiple=I(f):1===g&&(b.firstMultiple=!1);d=b.firstInput;var l=(g=b.firstMultiple)?g.center:d.center;var e=f.center=M(c);f.timeStamp=pa();f.deltaTime=f.timeStamp-d.timeStamp;f.angle=
D(l,e);f.distance=J(l,e);d=f.center;l=b.offsetDelta||{};e=b.prevDelta||{};var m=b.prevInput||{};if(1===f.eventType||4===m.eventType)e=b.prevDelta={x:m.deltaX||0,y:m.deltaY||0},l=b.offsetDelta={x:d.x,y:d.y};f.deltaX=e.x+(d.x-l.x);f.deltaY=e.y+(d.y-l.y);f.offsetDirection=H(f.deltaX,f.deltaY);l=f.deltaTime;d=f.deltaX/l||0;l=f.deltaY/l||0;f.overallVelocityX=d;f.overallVelocityY=l;f.overallVelocity=ja(d)>ja(l)?d:l;g?(d=g.pointers,d=J(c[0],c[1],na)/J(d[0],d[1],na)):d=1;f.scale=d;g?(g=g.pointers,c=D(c[1],
c[0],na)+D(g[1],g[0],na)):c=0;f.rotation=c;f.maxPointers=b.prevInput?f.pointers.length>b.prevInput.maxPointers?f.pointers.length:b.prevInput.maxPointers:f.pointers.length;l=b.lastInterval||f;c=f.timeStamp-l.timeStamp;8!=f.eventType&&(25<c||l.velocity===h)?(d=f.deltaX-l.deltaX,l=f.deltaY-l.deltaY,e=d/c||0,m=l/c||0,c=e,g=m,e=ja(e)>ja(m)?e:m,d=H(d,l),b.lastInterval=f):(e=l.velocity,c=l.velocityX,g=l.velocityY,d=l.direction);f.velocity=e;f.velocityX=c;f.velocityY=g;f.direction=d;b=a.element;u(f.srcEvent.target,
b)&&(b=f.srcEvent.target);f.target=b;a.emit("hammer.input",f);a.recognize(f);a.session.prevInput=f}function I(a){for(var b=[],f=0;f<a.pointers.length;)b[f]={clientX:ka(a.pointers[f].clientX),clientY:ka(a.pointers[f].clientY)},f++;return{timeStamp:pa(),pointers:b,center:M(b),deltaX:a.deltaX,deltaY:a.deltaY}}function M(a){var b=a.length;if(1===b)return{x:ka(a[0].clientX),y:ka(a[0].clientY)};for(var f=0,c=0,g=0;g<b;)f+=a[g].clientX,c+=a[g].clientY,g++;return{x:ka(f/b),y:ka(c/b)}}function H(a,b){return a===
b?1:ja(a)>=ja(b)?0>a?2:4:0>b?8:16}function J(a,b,f){f||(f=sa);var c=b[f[0]]-a[f[0]];a=b[f[1]]-a[f[1]];return Math.sqrt(c*c+a*a)}function D(a,b,f){f||(f=sa);return 180*Math.atan2(b[f[1]]-a[f[1]],b[f[0]]-a[f[0]])/Math.PI}function T(){this.evEl=Ca;this.evWin=Da;this.pressed=!1;z.apply(this,arguments)}function R(){this.evEl=ta;this.evWin=ua;z.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function G(){this.evTarget="touchstart";this.evWin="touchstart touchmove touchend touchcancel";
this.started=!1;z.apply(this,arguments)}function Q(){this.evTarget=Ea;this.targetIds={};z.apply(this,arguments)}function da(a,b){var f=v(a.touches),c=this.targetIds;if(b&3&&1===f.length)return c[f[0].identifier]=!0,[f,f];a=v(a.changedTouches);var g=[],d=this.target;var l=f.filter(function(a){return u(a.target,d)});if(1===b)for(f=0;f<l.length;)c[l[f].identifier]=!0,f++;for(f=0;f<a.length;)c[a[f].identifier]&&g.push(a[f]),b&12&&delete c[a[f].identifier],f++;if(g.length)return[k(l.concat(g),"identifier",
!0),g]}function aa(){z.apply(this,arguments);var a=m(this.handler,this);this.touch=new Q(this.manager,a);this.mouse=new T(this.manager,a);this.primaryTouch=null;this.lastTouches=[]}function F(a){a=a.changedPointers[0];if(a.identifier===this.primaryTouch){var b={x:a.clientX,y:a.clientY};this.lastTouches.push(b);var f=this.lastTouches;setTimeout(function(){var a=f.indexOf(b);-1<a&&f.splice(a,1)},2500)}}function N(a,b){this.manager=a;this.set(b)}function O(a){if(-1<a.indexOf("none"))return"none";var b=
-1<a.indexOf("pan-x"),f=-1<a.indexOf("pan-y");return b&&f?"none":b||f?b?"pan-x":"pan-y":-1<a.indexOf("manipulation")?"manipulation":"auto"}function K(a){this.options=la({},this.defaults,a||{});this.id=ya++;this.manager=null;a=this.options.enable;this.options.enable=a===h?!0:a;this.state=1;this.simultaneous={};this.requireFail=[]}function U(a){return a&16?"cancel":a&8?"end":a&4?"move":a&2?"start":""}function Z(a){return 16==a?"down":8==a?"up":2==a?"left":4==a?"right":""}function ba(a,b){return(b=b.manager)?
b.get(a):a}function X(){K.apply(this,arguments)}function V(){X.apply(this,arguments);this.pY=this.pX=null}function Y(){X.apply(this,arguments)}function L(){K.apply(this,arguments);this._input=this._timer=null}function P(){X.apply(this,arguments)}function ea(){X.apply(this,arguments)}function W(){K.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=0}function ca(a,b){b=b||{};var f=b.recognizers;b.recognizers=f===h?ca.defaults.preset:f;return new fa(a,b)}function fa(a,
b){this.options=la({},ca.defaults,b||{});this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=a;this.input=C(this);this.touchAction=new N(this,this.options.touchAction);E(this,!0);f(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}function E(a,b){var c=a.element;if(c.style){var g;f(a.options.cssProps,function(f,d){g=B(c.style,d);b?
(a.oldCssProps[g]=c.style[g],c.style[g]=f):c.style[g]=a.oldCssProps[g]||""});b||(a.oldCssProps={})}}function ha(a,b){var f=c.createEvent("Event");f.initEvent(a,!0,!0);f.gesture=b;b.target.dispatchEvent(f)}var ia=" webkit Moz MS ms o".split(" "),ma=c.createElement("div"),ka=Math.round,ja=Math.abs,pa=Date.now;var la="function"!==typeof Object.assign?function(a){if(a===h||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),f=1;f<arguments.length;f++){var c=
arguments[f];if(c!==h&&null!==c)for(var g in c)c.hasOwnProperty(g)&&(b[g]=c[g])}return b}:Object.assign;var qa=l(function(a,b,f){for(var c=Object.keys(b),g=0;g<c.length;){if(!f||f&&a[c[g]]===h)a[c[g]]=b[c[g]];g++}return a},"extend","Use `assign`."),xa=l(function(a,b){return qa(a,b,!0)},"merge","Use `assign`."),ya=1,za=/mobile|tablet|ip(ad|hone|od)|android/i,ra="ontouchstart"in a,Aa=B(a,"PointerEvent")!==h,Ba=ra&&za.test(navigator.userAgent),sa=["x","y"],na=["clientX","clientY"];z.prototype={handler:function(){},
init:function(){this.evEl&&r(this.element,this.evEl,this.domHandler);this.evTarget&&r(this.target,this.evTarget,this.domHandler);this.evWin&&r(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&t(this.element,this.evEl,this.domHandler);this.evTarget&&t(this.target,this.evTarget,this.domHandler);this.evWin&&t(x(this.element),this.evWin,this.domHandler)}};var Fa={mousedown:1,mousemove:2,mouseup:4},Ca="mousedown",Da="mousemove mouseup";q(T,z,{handler:function(a){var b=Fa[a.type];
b&1&&0===a.button&&(this.pressed=!0);b&2&&1!==a.which&&(b=4);this.pressed&&(b&4&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var Ga={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Ha={2:"touch",3:"pen",4:"mouse",5:"kinect"},ta="pointerdown",ua="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(ta="MSPointerDown",ua="MSPointerMove MSPointerUp MSPointerCancel");q(R,z,{handler:function(a){var b=
this.store,f=!1,c=a.type.toLowerCase().replace("ms","");c=Ga[c];var g=Ha[a.pointerType]||a.pointerType,d="touch"==g,l=w(b,a.pointerId,"pointerId");c&1&&(0===a.button||d)?0>l&&(b.push(a),l=b.length-1):c&12&&(f=!0);0>l||(b[l]=a,this.callback(this.manager,c,{pointers:b,changedPointers:[a],pointerType:g,srcEvent:a}),f&&b.splice(l,1))}});var Ia={touchstart:1,touchmove:2,touchend:4,touchcancel:8};q(G,z,{handler:function(a){var b=Ia[a.type];1===b&&(this.started=!0);if(this.started){var f=v(a.touches);var c=
v(a.changedTouches);b&12&&(f=k(f.concat(c),"identifier",!0));f=[f,c];b&12&&0===f[0].length-f[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:f[0],changedPointers:f[1],pointerType:"touch",srcEvent:a})}}});var Ja={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Ea="touchstart touchmove touchend touchcancel";q(Q,z,{handler:function(a){var b=Ja[a.type],f=da.call(this,a,b);f&&this.callback(this.manager,b,{pointers:f[0],changedPointers:f[1],pointerType:"touch",srcEvent:a})}});q(aa,
z,{handler:function(a,b,f){var c="mouse"==f.pointerType;if(!(c&&f.sourceCapabilities&&f.sourceCapabilities.firesTouchEvents)){if("touch"==f.pointerType)b&1?(this.primaryTouch=f.changedPointers[0].identifier,F.call(this,f)):b&12&&F.call(this,f);else{if(c)a:{c=f.srcEvent.clientX;for(var g=f.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var l=this.lastTouches[d],e=Math.abs(g-l.y);if(25>=Math.abs(c-l.x)&&25>=e){c=!0;break a}}c=!1}if(c)return}this.callback(a,b,f)}},destroy:function(){this.touch.destroy();
this.mouse.destroy()}});var va=B(ma.style,"touchAction"),wa=va!==h,oa=function(){if(!wa)return!1;var b={},f=a.CSS&&a.CSS.supports;"auto;manipulation;pan-y;pan-x;pan-x pan-y;none".split(";").forEach(function(c){b[c]=f?a.CSS.supports("touch-action",c):!0});return b}();N.prototype={set:function(a){"compute"==a&&(a=this.compute());wa&&this.manager.element.style&&oa[a]&&(this.manager.element.style[va]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},
compute:function(){var a=[];f(this.manager.recognizers,function(b){p(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))});return O(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,f=a.offsetDirection;if(this.manager.session.prevented)b.preventDefault();else{var c=this.actions,g=-1<c.indexOf("none")&&!oa.none,d=-1<c.indexOf("pan-y")&&!oa["pan-y"];c=-1<c.indexOf("pan-x")&&!oa["pan-x"];if(g){var l=2>a.distance,e=250>a.deltaTime;if(1===a.pointers.length&&l&&e)return}if(!c||!d)if(g||d&&
f&6||c&&f&24)return this.preventSrc(b)}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};K.prototype={defaults:{},set:function(a){la(this.options,a);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(a){if(g(a,"recognizeWith",this))return this;var b=this.simultaneous;a=ba(a,this);b[a.id]||(b[a.id]=a,a.recognizeWith(this));return this},dropRecognizeWith:function(a){if(g(a,"dropRecognizeWith",this))return this;a=ba(a,this);delete this.simultaneous[a.id];
return this},requireFailure:function(a){if(g(a,"requireFailure",this))return this;var b=this.requireFail;a=ba(a,this);-1===w(b,a)&&(b.push(a),a.requireFailure(this));return this},dropRequireFailure:function(a){if(g(a,"dropRequireFailure",this))return this;a=ba(a,this);a=w(this.requireFail,a);-1<a&&this.requireFail.splice(a,1);return this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){f.manager.emit(b,
a)}var f=this,c=this.state;8>c&&b(f.options.event+U(c));b(f.options.event);a.additionalEvent&&b(a.additionalEvent);8<=c&&b(f.options.event+U(c))},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=32},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&33))return!1;a++}return!0},recognize:function(a){a=la({},a);p(this.options.enable,[this,a])?(this.state&56&&(this.state=1),this.state=this.process(a),this.state&30&&this.tryEmit(a)):(this.reset(),
this.state=32)},process:function(a){},getTouchAction:function(){},reset:function(){}};q(X,K,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,f=a.eventType,c=b&6;a=this.attrTest(a);return c&&(f&8||!a)?b|16:c||a?f&4?b|8:b&2?b|4:2:32}});q(V,X,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var a=this.options.direction,b=[];a&6&&b.push("pan-y");a&24&&b.push("pan-x");
return b},directionTest:function(a){var b=this.options,f=!0,c=a.distance,g=a.direction,d=a.deltaX,l=a.deltaY;g&b.direction||(b.direction&6?(g=0===d?1:0>d?2:4,f=d!=this.pX,c=Math.abs(a.deltaX)):(g=0===l?1:0>l?8:16,f=l!=this.pY,c=Math.abs(a.deltaY)));a.direction=g;return f&&c>b.threshold&&g&b.direction},attrTest:function(a){return X.prototype.attrTest.call(this,a)&&(this.state&2||!(this.state&2)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;this.pY=a.deltaY;var b=Z(a.direction);b&&(a.additionalEvent=
this.options.event+b);this._super.emit.call(this,a)}});q(Y,X,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&2)},emit:function(a){1!==a.scale&&(a.additionalEvent=this.options.event+(1>a.scale?"in":"out"));this._super.emit.call(this,a)}});q(L,K,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},
process:function(a){var b=this.options,f=a.pointers.length===b.pointers,c=a.distance<b.threshold,g=a.deltaTime>b.time;this._input=a;if(!c||!f||a.eventType&12&&!g)this.reset();else if(a.eventType&1)this.reset(),this._timer=d(function(){this.state=8;this.tryEmit()},b.time,this);else if(a.eventType&4)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){8===this.state&&(a&&a.eventType&4?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=pa(),this.manager.emit(this.options.event,
this._input)))}});q(P,X,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&2)}});q(ea,X,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return V.prototype.getTouchAction.call(this)},attrTest:function(a){var b=this.options.direction;if(b&30)var f=a.overallVelocity;else b&6?f=a.overallVelocityX:
b&24&&(f=a.overallVelocityY);return this._super.attrTest.call(this,a)&&b&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&ja(f)>this.options.velocity&&a.eventType&4},emit:function(a){var b=Z(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a);this.manager.emit(this.options.event,a)}});q(W,K,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(a){var b=
this.options,f=a.pointers.length===b.pointers,c=a.distance<b.threshold,g=a.deltaTime<b.time;this.reset();if(a.eventType&1&&0===this.count)return this.failTimeout();if(c&&g&&f){if(4!=a.eventType)return this.failTimeout();f=this.pTime?a.timeStamp-this.pTime<b.interval:!0;c=!this.pCenter||J(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp;this.pCenter=a.center;this.count=c&&f?this.count+1:1;this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=
8;this.tryEmit()},b.interval,this),2):8}return 32},failTimeout:function(){this._timer=d(function(){this.state=32},this.options.interval,this);return 32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});ca.VERSION="2.0.7";ca.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[P,{enable:!1}],[Y,{enable:!1},["rotate"]],[ea,{direction:6}],[V,{direction:6},
["swipe"]],[W],[W,{event:"doubletap",taps:2},["tap"]],[L]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};fa.prototype={set:function(a){la(this.options,a);a.touchAction&&this.touchAction.update();a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init());return this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);
var f=this.recognizers,c=b.curRecognizer;if(!c||c&&c.state&8)c=b.curRecognizer=null;for(var g=0;g<f.length;){var d=f[g];2===b.stopped||c&&d!=c&&!d.canRecognizeWith(c)?d.reset():d.recognize(a);!c&&d.state&14&&(c=b.curRecognizer=d);g++}}},get:function(a){if(a instanceof K)return a;for(var b=this.recognizers,f=0;f<b.length;f++)if(b[f].options.event==a)return b[f];return null},add:function(a){if(g(a,"add",this))return this;var b=this.get(a.options.event);b&&this.remove(b);this.recognizers.push(a);a.manager=
this;this.touchAction.update();return a},remove:function(a){if(g(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers;a=w(b,a);-1!==a&&(b.splice(a,1),this.touchAction.update())}return this},on:function(a,b){if(a!==h&&b!==h){var c=this.handlers;f(y(a),function(a){c[a]=c[a]||[];c[a].push(b)});return this}},off:function(a,b){if(a!==h){var c=this.handlers;f(y(a),function(a){b?c[a]&&c[a].splice(w(c[a],b),1):delete c[a]});return this}},emit:function(a,b){this.options.domEvents&&ha(a,b);
var f=this.handlers[a]&&this.handlers[a].slice();if(f&&f.length)for(b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()},a=0;a<f.length;)f[a](b),a++},destroy:function(){this.element&&E(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};la(ca,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,
DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:fa,Input:z,TouchAction:N,TouchInput:Q,MouseInput:T,PointerEventInput:R,TouchMouseInput:aa,SingleTouchInput:G,Recognizer:K,AttrRecognizer:X,Tap:W,Pan:V,Swipe:ea,Pinch:Y,Rotate:P,Press:L,on:r,off:t,each:f,merge:xa,extend:qa,assign:la,inherit:q,bindFn:m,prefixed:B});("undefined"!==typeof a?a:"undefined"!==typeof self?self:{}).Hammer=ca;"function"===typeof define&&define.amd?define(function(){return ca}):
"undefined"!=typeof e&&e.exports?e.exports=ca:a[b]=ca})(window,document,"Hammer")},{}],22:[function(a,e,k){function d(){h&&n&&(h=!1,n.length?f=n.concat(f):g=-1,f.length&&c())}function c(){if(!h){l=!1;h=!0;for(var a=f.length,b=setTimeout(d);a;){n=f;for(f=[];n&&++g<a;)n[g].run();g=-1;a=f.length}n=null;g=-1;h=!1;clearTimeout(b)}}function b(a,b){this.fun=a;this.array=b}a=[a("./nextTick"),a("./mutation.js"),a("./messageChannel"),a("./stateChange"),a("./timeout")];var h,n,g=-1,f=[],l=!1;k=-1;for(var q=
a.length;++k<q;)if(a[k]&&a[k].test&&a[k].test()){var m=a[k].install(c);break}b.prototype.run=function(){var a=this.fun,b=this.array;switch(b.length){case 0:return a();case 1:return a(b[0]);case 2:return a(b[0],b[1]);case 3:return a(b[0],b[1],b[2]);default:return a.apply(null,b)}};e.exports=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var g=1;g<arguments.length;g++)c[g-1]=arguments[g];f.push(new b(a,c));l||h||(l=!0,m())}},{"./messageChannel":23,"./mutation.js":24,"./nextTick":25,
"./stateChange":26,"./timeout":27}],23:[function(a,e,k){(function(a){k.test=function(){return a.setImmediate?!1:"undefined"!==typeof a.MessageChannel};k.install=function(c){var b=new a.MessageChannel;b.port1.onmessage=c;return function(){b.port2.postMessage(0)}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],24:[function(a,e,k){(function(a){var c=a.MutationObserver||a.WebKitMutationObserver;k.test=function(){return c};k.install=
function(b){var d=0;b=new c(b);var e=a.document.createTextNode("");b.observe(e,{characterData:!0});return function(){e.data=d=++d%2}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],25:[function(a,e,k){(function(a){k.test=function(){return"undefined"!==typeof a&&!a.browser};k.install=function(c){return function(){a.nextTick(c)}}}).call(this,a("_process"))},{_process:256}],26:[function(a,e,k){(function(a){k.test=function(){return"document"in
a&&"onreadystatechange"in a.document.createElement("script")};k.install=function(c){return function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c();b.onreadystatechange=null;b.parentNode.removeChild(b);b=null};a.document.documentElement.appendChild(b);return c}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],27:[function(a,e,k){k.test=function(){return!0};k.install=function(a){return function(){setTimeout(a,
0)}}},{}],28:[function(a,e,k){function d(a){c(a.pixel_x,a.pixel_y,!0)}function c(a,b,f,c){void 0===f&&(f=!0);void 0===c&&(c=M.marker_id);a=[Number(a),3575-Number(b)];b=H.getOverlayById(c);null!==b?b.setPosition(a):(b=document.getElementById(c),c=new p.default({id:c,position:a,positioning:"bottom-center",element:b,stopEvent:!1,offset:[0,0]}),H.addOverlay(c));f&&(J.animate({center:a}),J.animate({zoom:4.5}))}function b(){var a=new t.default({url:M.mapPath,attributions:Q,projection:G,imageExtent:R}),
b=new Image;b.src=M.mapPath;b.onload=function(){T.setSource(a)}}function h(){return navigator.geolocation?!0:!1}function n(a){null!=F&&c(F.pixel_x,F.pixel_y,a,M.user_marker_id)}function g(a){var b=1E3*(a.coords.latitude-19.133691);a=1E3*(a.coords.longitude-72.916984);var f=O,c=Math.round(4189+f[0]+f[1]*b+f[2]*a+f[3]*b*b+f[4]*b*b*a+f[5]*b*b*a*a+f[6]*a*a+f[7]*b*a*a+f[8]*b*a);f=K;return{pixel_x:c,pixel_y:Math.round(1655+f[0]+f[1]*b+f[2]*a+f[3]*b*b+f[4]*b*b*a+f[5]*b*b*a*a+f[6]*a*a+f[7]*b*a*a+f[8]*b*a)}}
e=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(k,"__esModule",{value:!0});var f=e(a("ol/map")),l=e(a("ol/layer/image")),q=e(a("ol/view")),m=e(a("ol/extent")),p=e(a("ol/overlay")),r=e(a("ol/layer/vector")),t=e(a("ol/source/imagestatic")),u=e(a("ol/source/vector")),y=e(a("ol/proj/projection")),w=e(a("ol/feature")),v=e(a("ol/geom/point")),A=e(a("ol/geom/polygon")),B=e(a("ol/style/style")),x=e(a("ol/style/icon")),z=e(a("ol/style/text")),C=e(a("ol/style/stroke")),
S=e(a("ol/style/fill")),I=e(a("ol/interaction")),M,H,J,D,T,R,G,Q,da=!1,aa,F,N=!1,O=[-7.769917472065843,159.26978694839946,244.46989575495544,-6.003894110679995,-.28864271213341297,.010398324019718075,4.215508849724247,-.6078830146963545,-7.0400449629241395],K=[14.199431377059842,-158.80601990819815,68.9630034040724,5.796703402034644,1.1348242200568706,.11891051684489184,-.2930832938484276,.1448231125788526,-5.282895700923075];k.getMap=function(a,g,e,h){M=a;for(var p=[],n=0;n<g.length;n++){var k=g[n],
F=[k.pixel_x,3575-k.pixel_y];null===k.parent&&(k=new w.default({geometry:new v.default(F),loc:k}),p.push(k))}g=new u.default({features:p});D=new r.default({source:g,style:function(a){var b=H.getView().getZoom(),f=a.get("loc");if(3!==f.group_id||N)return a=f.name,"0"!==f.short_name&&(a=f.short_name),f=1===f.group_id||4===f.group_id||12===f.group_id?"blue":3===f.group_id?"green":2===f.group_id?"yellow":"gray",a=new z.default({offsetY:20,padding:[20,20,20,20],font:3*b+"px Roboto",text:a,fill:new S.default({color:"#ffffff"}),
stroke:new C.default({color:"#444",width:3})}),f=new x.default({src:M.markersBase+"marker_dot_"+f+".png",scale:.2}),[new B.default({image:3<=b?f:void 0,text:4<=b?a:void 0})]}});R=[0,0,5430,3575];G=new y.default({code:"instiMAP",units:"pixels",extent:R});a=new t.default({url:a.mapMinPath,attributions:Q,projection:G,imageExtent:R,imageLoadFunction:function(a,f){a=a.getImage();a.src=f;a.onload=function(){b();h()}}});T=new l.default({source:a});a=I.default.defaults({altShiftDragRotate:!1,pinchRotate:!1});
J=new q.default({projection:G,center:m.default.getCenter(R),zoom:3.4,minZoom:2,maxZoom:5.5,extent:[300,300,5E3,3E3]});H=new f.default({interactions:a,layers:[T,D],target:M.map_id,view:J,controls:[]});H.on("click",function(a){var b=a.pixel;a=[b[0]+30,b[1]-30];b=H.getCoordinateFromPixel([b[0]-30,b[1]+30]);a=H.getCoordinateFromPixel(a).concat(b);a=new w.default(new A.default([[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]],[a[0],a[1]]]]));(a=D.getSource().forEachFeatureIntersectingExtent(a.getGeometry().getExtent(),
function(a){return a}))?(a=a.get("loc"),d(a),e(a)):(c(-50,-50,!1),e())});H.on("pointermove",function(a){a=H.getEventPixel(a.originalEvent);a=H.hasFeatureAtPixel(a);var b=document.getElementById(M.map_id);null!=b&&(b.style.cursor=a?"pointer":"move")});H.on("pointerdrag",function(){da=!1});return H};k.moveToLocation=d;k.moveMarker=c;k.setResidencesVisible=function(a){N=a;D.getSource().changed()};k.hasGeolocation=h;k.getGPS=function(a){h()?(da=!0,null!=aa?n(!0):aa=navigator.geolocation.watchPosition(function(a){var b=
da||null==F;a=g(a);0<a.pixel_x&&0<a.pixel_y&&5430>a.pixel_x&&5375>a.pixel_y&&(F=a,n(b))},function(){},{enableHighAccuracy:!0})):a&&a()};k.getMapXY=g;k.isFollowingUser=function(){return da};k.getGeolocationLast=function(){return F};k.cleanup=function(){null!=aa&&void 0!=aa&&navigator.geolocation.clearWatch(aa)}},{"ol/extent":54,"ol/feature":57,"ol/geom/point":81,"ol/geom/polygon":82,"ol/interaction":90,"ol/layer/image":107,"ol/layer/vector":110,"ol/map":115,"ol/overlay":128,"ol/proj/projection":145,
"ol/source/imagestatic":210,"ol/source/vector":213,"ol/style/fill":225,"ol/style/icon":226,"ol/style/stroke":233,"ol/style/style":234,"ol/style/text":235,"ol/view":245}],29:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={binarySearch:function(a,b,e){for(var c,g=e||d.numberSafeCompareFunction,f=0,l=a.length,h=!1;f<l;)e=f+(l-f>>1),c=+g(a[e],b),0>c?f=e+1:(l=e,h=!c);return h?f:~f},numberSafeCompareFunction:function(a,b){return a>b?1:a<b?-1:0},includes:function(a,b){return 0<=
a.indexOf(b)},linearFindNearest:function(a,b,d){var c=a.length;if(a[0]<=b)return 0;if(!(b<=a[c-1]))if(0<d)for(d=1;d<c;++d){if(a[d]<b)return d-1}else if(0>d)for(d=1;d<c;++d){if(a[d]<=b)return d}else for(d=1;d<c;++d){if(a[d]==b)return d;if(a[d]<b)return a[d-1]-b<b-a[d]?d-1:d}return c-1},reverseSubArray:function(a,b,d){for(;b<d;){var c=a[b];a[b]=a[d];a[d]=c;++b;--d}},extend:function(a,b){var c=Array.isArray(b)?b:[b],d=c.length;for(b=0;b<d;b++)a[a.length]=c[b]},remove:function(a,b){b=a.indexOf(b);var c=
-1<b;c&&a.splice(b,1);return c},find:function(a,b){for(var c=a.length>>>0,d,g=0;g<c;g++)if(d=a[g],b(d,g,a))return d;return null},equals:function(a,b){var c=a.length;if(c!==b.length)return!1;for(var d=0;d<c;d++)if(a[d]!==b[d])return!1;return!0},stableSort:function(a,b){var c=a.length,d=Array(a.length),g;for(g=0;g<c;g++)d[g]={index:g,value:a[g]};d.sort(function(a,c){return b(a.value,c.value)||a.index-c.index});for(g=0;g<a.length;g++)a[g]=d[g].value},findIndex:function(a,b){var c;return a.every(function(d,
g){c=g;return!b(d,g,a)})?-1:c},isSorted:function(a,b,e){var c=b||d.numberSafeCompareFunction;return a.every(function(b,f){if(0===f)return!0;b=c(a[f-1],b);return!(0<b||e&&0===b)})}};k.default=d},{}],30:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./index.js"))&&a.__esModule?a:{default:a};a=function(a){this.message="Assertion failed. See https://openlayers.org/en/"+(d.default.VERSION?d.default.VERSION.split("-")[0]:"latest")+"/doc/errors/#"+a+" for details.";this.code=
a;this.name="AssertionError"};d.default.inherits(a,Error);k.default=a},{"./index.js":89}],31:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./assertionerror.js"))&&a.__esModule?a:{default:a};k.default={assert:function(a,b){if(!a)throw new d.default(b);}}},{"./assertionerror.js":30}],32:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./tilerange.js");var c=d(e);e=a("./math.js");var b=d(e);a=a("./tilegrid.js");
var h=d(a);a=function(a){this.html_=a.html;this.tileRanges_=a.tileRanges?a.tileRanges:null};a.prototype.getHTML=function(){return this.html_};a.prototype.intersectsAnyTileRange=function(a,g,f){if(!this.tileRanges_)return!0;var d,e;for(e in a)if(e in this.tileRanges_){var m=a[e];var p=0;for(d=this.tileRanges_[e].length;p<d;++p){var n=this.tileRanges_[e][p];if(n.intersects(m))return!0;var t=g.getTileRangeForExtentAndZ(h.default.extentFromProjection(f),parseInt(e,10)),u=t.getWidth();if(m.minX<t.minX||
m.maxX>t.maxX)if(n.intersects(new c.default(b.default.modulo(m.minX,u),b.default.modulo(m.maxX,u),m.minY,m.maxY))||m.getWidth()>u&&n.intersects(t))return!0}}return!1};k.default=a},{"./math.js":123,"./tilegrid.js":238,"./tilerange.js":241}],33:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./math.js"))&&a.__esModule?a:{default:a};k.default={createExtent:function(a){return function(b){if(b)return[d.default.clamp(b[0],a[0],a[2]),d.default.clamp(b[1],a[1],a[3])]}},none:function(a){return a}}},
{"./math.js":123}],34:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./assertionerror.js"),b=d(c);c=a("./collectioneventtype.js");var h=d(c);c=a("./object.js");var n=d(c);a=a("./events/event.js");var g=d(a),f=function(a,b){n.default.call(this);this.unique_=!!(b||{}).unique;this.array_=a?a:[];if(this.unique_)for(a=0,b=this.array_.length;a<b;++a)this.assertUnique_(this.array_[a],a);this.updateLength_()};
e.default.inherits(f,n.default);f.prototype.clear=function(){for(;0<this.getLength();)this.pop()};f.prototype.extend=function(a){var b;var f=0;for(b=a.length;f<b;++f)this.push(a[f]);return this};f.prototype.forEach=function(a,b){a=b?a.bind(b):a;b=this.array_;for(var f=0,c=b.length;f<c;++f)a(b[f],f,b)};f.prototype.getArray=function(){return this.array_};f.prototype.item=function(a){return this.array_[a]};f.prototype.getLength=function(){return this.get(f.Property_.LENGTH)};f.prototype.insertAt=function(a,
b){this.unique_&&this.assertUnique_(b);this.array_.splice(a,0,b);this.updateLength_();this.dispatchEvent(new f.Event(h.default.ADD,b))};f.prototype.pop=function(){return this.removeAt(this.getLength()-1)};f.prototype.push=function(a){this.unique_&&this.assertUnique_(a);var b=this.getLength();this.insertAt(b,a);return this.getLength()};f.prototype.remove=function(a){var b=this.array_,f;var c=0;for(f=b.length;c<f;++c)if(b[c]===a)return this.removeAt(c)};f.prototype.removeAt=function(a){var b=this.array_[a];
this.array_.splice(a,1);this.updateLength_();this.dispatchEvent(new f.Event(h.default.REMOVE,b));return b};f.prototype.setAt=function(a,b){var c=this.getLength();if(a<c)this.unique_&&this.assertUnique_(b,a),c=this.array_[a],this.array_[a]=b,this.dispatchEvent(new f.Event(h.default.REMOVE,c)),this.dispatchEvent(new f.Event(h.default.ADD,b));else{for(;c<a;++c)this.insertAt(c,void 0);this.insertAt(a,b)}};f.prototype.updateLength_=function(){this.set(f.Property_.LENGTH,this.array_.length)};f.prototype.assertUnique_=
function(a,f){for(var c=0,g=this.array_.length;c<g;++c)if(this.array_[c]===a&&c!==f)throw new b.default(58);};f.Property_={LENGTH:"length"};f.Event=function(a,b){g.default.call(this,a);this.element=b};e.default.inherits(f.Event,g.default);k.default=f},{"./assertionerror.js":30,"./collectioneventtype.js":35,"./events/event.js":50,"./index.js":89,"./object.js":125}],35:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={ADD:"add",REMOVE:"remove"}},{}],36:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});var d=(e=a("./asserts.js"))&&e.__esModule?e:{default:e},c=(a=a("./math.js"))&&a.__esModule?a:{default:a},b={HEX_COLOR_RE_:/^#(?:[0-9a-f]{3,4}){1,2}$/i,NAMED_COLOR_RE_:/^([a-z]*)$/i,asArray:function(a){return Array.isArray(a)?a:b.fromString(a)},asString:function(a){return"string"===typeof a?a:b.toString(a)},fromNamed:function(a){var b=document.createElement("div");b.style.color=a;document.body.appendChild(b);a=getComputedStyle(b).color;document.body.removeChild(b);return a}};
b.fromString=function(){var a={},c=0;return function(g){if(a.hasOwnProperty(g))var f=a[g];else{if(1024<=c){f=0;for(var d in a)0===(f++&3)&&(delete a[d],--c)}f=b.fromStringInternal_(g);a[g]=f;++c}return f}}();b.fromStringInternal_=function(a){b.NAMED_COLOR_RE_.exec(a)&&(a=b.fromNamed(a));if(b.HEX_COLOR_RE_.exec(a)){var c=a.length-1;var g=4>=c?1:2;var f=4===c||8===c;c=parseInt(a.substr(1+0*g,g),16);var e=parseInt(a.substr(1+1*g,g),16);var h=parseInt(a.substr(1+2*g,g),16);a=f?parseInt(a.substr(1+3*g,
g),16):255;1==g&&(c=(c<<4)+c,e=(e<<4)+e,h=(h<<4)+h,f&&(a=(a<<4)+a));g=[c,e,h,a/255]}else 0==a.indexOf("rgba(")?(a=a.slice(5,-1).split(",").map(Number),g=b.normalize(a)):0==a.indexOf("rgb(")?(a=a.slice(4,-1).split(",").map(Number),a.push(1),g=b.normalize(a)):d.default.assert(!1,14);return g};b.normalize=function(a,b){b=b||[];b[0]=c.default.clamp(a[0]+.5|0,0,255);b[1]=c.default.clamp(a[1]+.5|0,0,255);b[2]=c.default.clamp(a[2]+.5|0,0,255);b[3]=c.default.clamp(a[3],0,1);return b};b.toString=function(a){var b=
a[0];b!=(b|0)&&(b=b+.5|0);var c=a[1];c!=(c|0)&&(c=c+.5|0);var f=a[2];f!=(f|0)&&(f=f+.5|0);return"rgba("+b+","+c+","+f+","+(void 0===a[3]?1:a[3])+")"};k.default=b},{"./asserts.js":31,"./math.js":123}],37:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./color.js"))&&a.__esModule?a:{default:a},c={asColorLike:function(a){return c.isColorLike(a)?a:d.default.asString(a)},isColorLike:function(a){return"string"===typeof a||a instanceof CanvasPattern||a instanceof CanvasGradient}};
k.default=c},{"./color.js":36}],38:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./collection.js");var c=d(e);e=a("./control/attribution.js");var b=d(e);e=a("./control/rotate.js");var h=d(e);a=a("./control/zoom.js");var n=d(a);k.default={defaults:function(a){a=a?a:{};var f=new c.default;(void 0!==a.zoom?a.zoom:1)&&f.push(new n.default(a.zoomOptions));(void 0!==a.rotate?a.rotate:1)&&f.push(new h.default(a.rotateOptions));(void 0!==
a.attribution?a.attribution:1)&&f.push(new b.default(a.attributionOptions));return f}}},{"./collection.js":34,"./control/attribution.js":39,"./control/rotate.js":41,"./control/zoom.js":42}],39:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../array.js"),b=d(c);c=a("../control/control.js");var h=d(c);c=a("../css.js");var n=d(c);c=a("../dom.js");var g=d(c);c=a("../events.js");var f=d(c);c=a("../events/eventtype.js");
var l=d(c);c=a("../layer/layer.js");var q=d(c);a=a("../obj.js");var m=d(a),p=function(a){a=a?a:{};this.ulElement_=document.createElement("UL");this.logoLi_=document.createElement("LI");this.ulElement_.appendChild(this.logoLi_);this.logoLi_.style.display="none";this.collapsed_=void 0!==a.collapsed?a.collapsed:!0;this.collapsible_=void 0!==a.collapsible?a.collapsible:!0;this.collapsible_||(this.collapsed_=!1);var b=void 0!==a.className?a.className:"ol-attribution",c=void 0!==a.tipLabel?a.tipLabel:"Attributions",
g=void 0!==a.collapseLabel?a.collapseLabel:"\u00bb";"string"===typeof g?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=g):this.collapseLabel_=g;g=void 0!==a.label?a.label:"i";"string"===typeof g?(this.label_=document.createElement("span"),this.label_.textContent=g):this.label_=g;var d=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;g=document.createElement("button");g.setAttribute("type","button");g.title=c;g.appendChild(d);f.default.listen(g,
l.default.CLICK,this.handleClick_,this);b=b+" "+n.default.CLASS_UNSELECTABLE+" "+n.default.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible");c=document.createElement("div");c.className=b;c.appendChild(this.ulElement_);c.appendChild(g);h.default.call(this,{element:c,render:a.render?a.render:p.render,target:a.target});this.renderedAttributions_=[];this.renderedVisible_=!0;this.logoElements_={}};e.default.inherits(p,h.default);p.prototype.getSourceAttributions_=
function(a){for(var b={},f=[],c=a.layerStatesArray,g=a.viewState.resolution,d=0,e=c.length;d<e;++d){var l=c[d];if(q.default.visibleAtResolution(l,g)&&(l=l.layer.getSource())&&(l=l.getAttributions2())&&(l=l(a)))if(Array.isArray(l))for(var m=0,p=l.length;m<p;++m)l[m]in b||(f.push(l[m]),b[l[m]]=!0);else l in b||(f.push(l),b[l]=!0)}return f};p.render=function(a){this.updateElement_(a.frameState)};p.prototype.updateElement_=function(a){if(a){var f=this.getSourceAttributions_(a);if(!b.default.equals(f,
this.renderedAttributions_)){for(;this.ulElement_.lastChild!==this.logoLi_;)this.ulElement_.removeChild(this.ulElement_.lastChild);for(var c=0,g=f.length;c<g;++c){var d=document.createElement("LI");d.innerHTML=f[c];this.ulElement_.appendChild(d)}0===f.length&&0<this.renderedAttributions_.length?this.element.classList.add("ol-logo-only"):0===this.renderedAttributions_.length&&0<f.length&&this.element.classList.remove("ol-logo-only");c=0<f.length||!m.default.isEmpty(a.logos);this.renderedVisible_!=
c&&(this.element.style.display=c?"":"none",this.renderedVisible_=c);this.renderedAttributions_=f;this.insertLogos_(a)}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)};p.prototype.insertLogos_=function(a){a=a.logos;var b=this.logoElements_;for(d in b)d in a||(g.default.removeNode(b[d]),delete b[d]);var f;for(f in a){var c=a[f];c instanceof HTMLElement&&(this.logoLi_.appendChild(c),b[f]=c);if(!(f in b)){var d=new Image;d.src=f;if(""===c)var e=d;else e=document.createElement("a"),
e.href=c,e.appendChild(d);this.logoLi_.appendChild(e);b[f]=e}}this.logoLi_.style.display=m.default.isEmpty(a)?"none":""};p.prototype.handleClick_=function(a){a.preventDefault();this.handleToggle_()};p.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed");this.collapsed_?g.default.replaceNode(this.collapseLabel_,this.label_):g.default.replaceNode(this.label_,this.collapseLabel_);this.collapsed_=!this.collapsed_};p.prototype.getCollapsible=function(){return this.collapsible_};
p.prototype.setCollapsible=function(a){this.collapsible_!==a&&(this.collapsible_=a,this.element.classList.toggle("ol-uncollapsible"),!a&&this.collapsed_&&this.handleToggle_())};p.prototype.setCollapsed=function(a){this.collapsible_&&this.collapsed_!==a&&this.handleToggle_()};p.prototype.getCollapsed=function(){return this.collapsed_};k.default=p},{"../array.js":29,"../control/control.js":40,"../css.js":44,"../dom.js":46,"../events.js":48,"../events/eventtype.js":52,"../index.js":89,"../layer/layer.js":108,
"../obj.js":124}],40:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../mapeventtype.js");var b=d(e);e=a("../object.js");var h=d(e);e=a("../dom.js");var n=d(e);a=a("../events.js");var g=d(a);a=function(a){h.default.call(this);this.element=a.element?a.element:null;this.map_=this.target_=null;this.listenerKeys=[];this.render=a.render?a.render:c.default.nullFunction;a.target&&this.setTarget(a.target)};
c.default.inherits(a,h.default);a.prototype.disposeInternal=function(){n.default.removeNode(this.element);h.default.prototype.disposeInternal.call(this)};a.prototype.getMap=function(){return this.map_};a.prototype.setMap=function(a){this.map_&&n.default.removeNode(this.element);for(var f=0,d=this.listenerKeys.length;f<d;++f)g.default.unlistenByKey(this.listenerKeys[f]);this.listenerKeys.length=0;if(this.map_=a)(this.target_?this.target_:a.getOverlayContainerStopEvent()).appendChild(this.element),
this.render!==c.default.nullFunction&&this.listenerKeys.push(g.default.listen(a,b.default.POSTRENDER,this.render,this)),a.render()};a.prototype.setTarget=function(a){this.target_="string"===typeof a?document.getElementById(a):a};k.default=a},{"../dom.js":46,"../events.js":48,"../index.js":89,"../mapeventtype.js":121,"../object.js":125}],41:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../events.js");var c=d(e);e=a("../events/eventtype.js");
var b=d(e);e=a("../index.js");e=d(e);var h=a("../control/control.js"),n=d(h);h=a("../css.js");var g=d(h);a=a("../easing.js");var f=d(a),l=function(a){a=a?a:{};var f=void 0!==a.className?a.className:"ol-rotate",d=void 0!==a.label?a.label:"\u21e7";this.label_=null;"string"===typeof d?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=d):(this.label_=d,this.label_.classList.add("ol-compass"));var e=a.tipLabel?a.tipLabel:"Reset rotation";d=document.createElement("button");
d.className=f+"-reset";d.setAttribute("type","button");d.title=e;d.appendChild(this.label_);c.default.listen(d,b.default.CLICK,l.prototype.handleClick_,this);e=f+" "+g.default.CLASS_UNSELECTABLE+" "+g.default.CLASS_CONTROL;f=document.createElement("div");f.className=e;f.appendChild(d);d=a.render?a.render:l.render;this.callResetNorth_=a.resetNorth?a.resetNorth:void 0;n.default.call(this,{element:f,render:d,target:a.target});this.duration_=void 0!==a.duration?a.duration:250;this.autoHide_=void 0!==
a.autoHide?a.autoHide:!0;this.rotation_=void 0;this.autoHide_&&this.element.classList.add(g.default.CLASS_HIDDEN)};e.default.inherits(l,n.default);l.prototype.handleClick_=function(a){a.preventDefault();void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()};l.prototype.resetNorth_=function(){var a=this.getMap().getView();a&&void 0!==a.getRotation()&&(0<this.duration_?a.animate({rotation:0,duration:this.duration_,easing:f.default.easeOut}):a.setRotation(0))};l.render=function(a){if(a=
a.frameState){a=a.viewState.rotation;if(a!=this.rotation_){var b="rotate("+a+"rad)";if(this.autoHide_){var f=this.element.classList.contains(g.default.CLASS_HIDDEN);f||0!==a?f&&0!==a&&this.element.classList.remove(g.default.CLASS_HIDDEN):this.element.classList.add(g.default.CLASS_HIDDEN)}this.label_.style.msTransform=b;this.label_.style.webkitTransform=b;this.label_.style.transform=b}this.rotation_=a}};k.default=l},{"../control/control.js":40,"../css.js":44,"../easing.js":47,"../events.js":48,"../events/eventtype.js":52,
"../index.js":89}],42:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../events.js"),b=d(c);c=a("../events/eventtype.js");var h=d(c);c=a("../control/control.js");var n=d(c);c=a("../css.js");var g=d(c);a=a("../easing.js");var f=d(a),l=function(a){a=a?a:{};var f=void 0!==a.className?a.className:"ol-zoom",c=void 0!==a.delta?a.delta:1,d=void 0!==a.zoomInLabel?a.zoomInLabel:"+",e=void 0!==a.zoomOutLabel?
a.zoomOutLabel:"\u2212",q=void 0!==a.zoomInTipLabel?a.zoomInTipLabel:"Zoom in",y=void 0!==a.zoomOutTipLabel?a.zoomOutTipLabel:"Zoom out",w=document.createElement("button");w.className=f+"-in";w.setAttribute("type","button");w.title=q;w.appendChild("string"===typeof d?document.createTextNode(d):d);b.default.listen(w,h.default.CLICK,l.prototype.handleClick_.bind(this,c));d=document.createElement("button");d.className=f+"-out";d.setAttribute("type","button");d.title=y;d.appendChild("string"===typeof e?
document.createTextNode(e):e);b.default.listen(d,h.default.CLICK,l.prototype.handleClick_.bind(this,-c));f=f+" "+g.default.CLASS_UNSELECTABLE+" "+g.default.CLASS_CONTROL;c=document.createElement("div");c.className=f;c.appendChild(w);c.appendChild(d);n.default.call(this,{element:c,target:a.target});this.duration_=void 0!==a.duration?a.duration:250};e.default.inherits(l,n.default);l.prototype.handleClick_=function(a,b){b.preventDefault();this.zoomByDelta_(a)};l.prototype.zoomByDelta_=function(a){var b=
this.getMap().getView();if(b){var c=b.getResolution();c&&(a=b.constrainResolution(c,a),0<this.duration_?(b.getAnimating()&&b.cancelAnimations(),b.animate({resolution:a,duration:this.duration_,easing:f.default.easeOut})):b.setResolution(a))}};k.default=l},{"../control/control.js":40,"../css.js":44,"../easing.js":47,"../events.js":48,"../events/eventtype.js":52,"../index.js":89}],43:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("./math.js"))&&e.__esModule?e:{default:e},
c=(a=a("./string.js"))&&a.__esModule?a:{default:a},b={add:function(a,b){a[0]+=b[0];a[1]+=b[1];return a},closestOnCircle:function(a,b){var c=b.getRadius(),f=b.getCenter();b=f[0];f=f[1];var d=a[0]-b;a=a[1]-f;0===d&&0===a&&(d=1);var e=Math.sqrt(d*d+a*a);return[b+c*d/e,f+c*a/e]},closestOnSegment:function(a,b){var c=a[0];a=a[1];var f=b[0],d=b[1];b=f[0];f=f[1];var e=d[0];d=d[1];var m=e-b,p=d-f;c=0===m&&0===p?0:(m*(c-b)+p*(a-f))/(m*m+p*p||0);0>=c?(a=b,c=f):1<=c?(a=e,c=d):(a=b+c*m,c=f+c*p);return[a,c]},createStringXY:function(a){return function(c){return b.toStringXY(c,
a)}},degreesToStringHDMS:function(a,b,g){b=d.default.modulo(b+180,360)-180;var f=Math.abs(3600*b);g=g||0;var e=Math.pow(10,g),h=Math.floor(f/3600),m=Math.floor((f-3600*h)/60);f=Math.ceil((f-3600*h-60*m)*e)/e;60<=f&&(f=0,m+=1);60<=m&&(m=0,h+=1);return h+"\u00b0 "+c.default.padNumber(m,2)+"\u2032 "+c.default.padNumber(f,2,g)+"\u2033"+(0==b?"":" "+a.charAt(0>b?1:0))},format:function(a,b,c){return a?b.replace("{x}",a[0].toFixed(c)).replace("{y}",a[1].toFixed(c)):""},equals:function(a,b){for(var c=!0,
f=a.length-1;0<=f;--f)if(a[f]!=b[f]){c=!1;break}return c},rotate:function(a,b){var c=Math.cos(b);b=Math.sin(b);var f=a[1]*c+a[0]*b;a[0]=a[0]*c-a[1]*b;a[1]=f;return a},scale:function(a,b){a[0]*=b;a[1]*=b;return a},sub:function(a,b){a[0]-=b[0];a[1]-=b[1];return a},squaredDistance:function(a,b){var c=a[0]-b[0];a=a[1]-b[1];return c*c+a*a},distance:function(a,c){return Math.sqrt(b.squaredDistance(a,c))},squaredDistanceToSegment:function(a,c){return b.squaredDistance(a,b.closestOnSegment(a,c))},toStringHDMS:function(a,
c){return a?b.degreesToStringHDMS("NS",a[1],c)+" "+b.degreesToStringHDMS("EW",a[0],c):""},toStringXY:function(a,c){return b.format(a,"{x}, {y}",c)}};k.default=b},{"./math.js":123,"./string.js":216}],44:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a={CLASS_HIDDEN:"ol-hidden",CLASS_SELECTABLE:"ol-selectable",CLASS_UNSELECTABLE:"ol-unselectable",CLASS_UNSUPPORTED:"ol-unsupported",CLASS_CONTROL:"ol-control"};a.getFontFamilies=function(){var a,c={};return function(b){a||(a=document.createElement("div").style);
if(!(b in c)){a.font=b;var d=a.fontFamily;a.font="";if(!d)return null;c[b]=d.split(/,\s?/)}return c[b]}}();k.default=a},{}],45:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=(a=a("./index.js"))&&a.__esModule?a:{default:a};e=function(){};e.prototype.disposed_=!1;e.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())};e.prototype.disposeInternal=a.default.nullFunction;k.default=e},{"./index.js":89}],46:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});k.default={createCanvasContext2D:function(a,c){var b=document.createElement("CANVAS");a&&(b.width=a);c&&(b.height=c);return b.getContext("2d")},outerWidth:function(a){var c=a.offsetWidth;a=getComputedStyle(a);return c+=parseInt(a.marginLeft,10)+parseInt(a.marginRight,10)},outerHeight:function(a){var c=a.offsetHeight;a=getComputedStyle(a);return c+=parseInt(a.marginTop,10)+parseInt(a.marginBottom,10)},replaceNode:function(a,c){var b=c.parentNode;b&&b.replaceChild(a,c)},removeNode:function(a){return a&&
a.parentNode?a.parentNode.removeChild(a):null},removeChildren:function(a){for(;a.lastChild;)a.removeChild(a.lastChild)}}},{}],47:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={easeIn:function(a){return Math.pow(a,3)},easeOut:function(a){return 1-d.easeIn(1-a)},inAndOut:function(a){return 3*a*a-2*a*a*a},linear:function(a){return a},upAndDown:function(a){return.5>a?d.inAndOut(2*a):1-d.inAndOut(2*(a-.5))}};k.default=d},{}],48:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});var d=(a=a("./obj.js"))&&a.__esModule?a:{default:a},c={bindListener_:function(a){var b=function(b){var g=a.listener,f=a.bindTo||a.target;a.callOnce&&c.unlistenByKey(a);return g.call(f,b)};return a.boundListener=b},findListener_:function(a,c,d,g){for(var b,e=0,h=a.length;e<h;++e)if(b=a[e],b.listener===c&&b.bindTo===d)return g&&(b.deleteIndex=e),b},getListeners:function(a,c){return(a=a.ol_lm)?a[c]:void 0},getListenerMap_:function(a){var b=a.ol_lm;b||(b=a.ol_lm={});return b},removeListeners_:function(a,
e){var b=c.getListeners(a,e);if(b){for(var g=0,f=b.length;g<f;++g)a.removeEventListener(e,b[g].boundListener),d.default.clear(b[g]);b.length=0;if(b=a.ol_lm)delete b[e],0===Object.keys(b).length&&delete a.ol_lm}},listen:function(a,d,e,g,f){var b=c.getListenerMap_(a),h=b[d];h||(h=b[d]=[]);(b=c.findListener_(h,e,g,!1))?f||(b.callOnce=!1):(b={bindTo:g,callOnce:!!f,listener:e,target:a,type:d},a.addEventListener(d,c.bindListener_(b)),h.push(b));return b},listenOnce:function(a,d,e,g){return c.listen(a,d,
e,g,!0)},unlisten:function(a,d,e,g){(a=c.getListeners(a,d))&&(e=c.findListener_(a,e,g,!0))&&c.unlistenByKey(e)},unlistenByKey:function(a){if(a&&a.target){a.target.removeEventListener(a.type,a.boundListener);var b=c.getListeners(a.target,a.type);if(b){var e="deleteIndex"in a?a.deleteIndex:b.indexOf(a);-1!==e&&b.splice(e,1);0===b.length&&c.removeListeners_(a.target,a.type)}d.default.clear(a)}},unlistenAll:function(a){var b=c.getListenerMap_(a),d;for(d in b)c.removeListeners_(a,d)}};k.default=c},{"./obj.js":124}],
49:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../mapbrowsereventtype.js");var c=d(e);e=a("../asserts.js");var b=d(e);e=a("../functions.js");e=d(e);a=a("../has.js");var h=d(a);a={altKeyOnly:function(a){a=a.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey},altShiftKeysOnly:function(a){a=a.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey}};a.always=e.default.TRUE;a.click=function(a){return a.type==
c.default.CLICK};a.mouseActionButton=function(a){a=a.originalEvent;return 0==a.button&&!(h.default.WEBKIT&&h.default.MAC&&a.ctrlKey)};a.never=e.default.FALSE;a.pointerMove=function(a){return"pointermove"==a.type};a.singleClick=function(a){return a.type==c.default.SINGLECLICK};a.doubleClick=function(a){return a.type==c.default.DBLCLICK};a.noModifierKeys=function(a){a=a.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey};a.platformModifierKeyOnly=function(a){a=a.originalEvent;return!a.altKey&&
(h.default.MAC?a.metaKey:a.ctrlKey)&&!a.shiftKey};a.shiftKeyOnly=function(a){a=a.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey};a.targetNotEditable=function(a){a=a.originalEvent.target.tagName;return"INPUT"!==a&&"SELECT"!==a&&"TEXTAREA"!==a};a.mouseOnly=function(a){b.default.assert(a.pointerEvent,56);return"mouse"==a.pointerEvent.pointerType};a.primaryAction=function(a){a=a.pointerEvent;return a.isPrimary&&0===a.button};k.default=a},{"../asserts.js":31,"../functions.js":60,"../has.js":84,
"../mapbrowsereventtype.js":118}],50:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(a){this.propagationStopped;this.type=a;this.target=null};a.prototype.preventDefault=a.prototype.stopPropagation=function(){this.propagationStopped=!0};a.stopPropagation=function(a){a.stopPropagation()};a.preventDefault=function(a){a.preventDefault()};k.default=a},{}],51:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});
e=a("../index.js");var c=d(e);e=a("../disposable.js");var b=d(e);e=a("../events.js");var h=d(e);a=a("../events/event.js");var n=d(a);a=function(){b.default.call(this);this.pendingRemovals_={};this.dispatching_={};this.listeners_={}};c.default.inherits(a,b.default);a.prototype.addEventListener=function(a,b){var f=this.listeners_[a];f||(f=this.listeners_[a]=[]);-1===f.indexOf(b)&&f.push(b)};a.prototype.dispatchEvent=function(a){var b="string"===typeof a?new n.default(a):a;a=b.type;b.target=this;var d=
this.listeners_[a];if(d){a in this.dispatching_||(this.dispatching_[a]=0,this.pendingRemovals_[a]=0);++this.dispatching_[a];for(var g=0,e=d.length;g<e;++g)if(!1===d[g].call(this,b)||b.propagationStopped){var p=!1;break}--this.dispatching_[a];if(0===this.dispatching_[a]){b=this.pendingRemovals_[a];for(delete this.pendingRemovals_[a];b--;)this.removeEventListener(a,c.default.nullFunction);delete this.dispatching_[a]}return p}};a.prototype.disposeInternal=function(){h.default.unlistenAll(this)};a.prototype.getListeners=
function(a){return this.listeners_[a]};a.prototype.hasListener=function(a){return a?a in this.listeners_:0<Object.keys(this.listeners_).length};a.prototype.removeEventListener=function(a,b){var f=this.listeners_[a];f&&(b=f.indexOf(b),a in this.pendingRemovals_?(f[b]=c.default.nullFunction,++this.pendingRemovals_[a]):(f.splice(b,1),0===f.length&&delete this.listeners_[a]))};k.default=a},{"../disposable.js":45,"../events.js":48,"../events/event.js":50,"../index.js":89}],52:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});k.default={CHANGE:"change",CLEAR:"clear",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"}},{}],53:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});k.default={LEFT:37,UP:38,RIGHT:39,DOWN:40}},{}],54:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./asserts.js");var c=d(e);e=a("./extent/corner.js");var b=d(e);a=a("./extent/relationship.js");var h=d(a),n={boundingExtent:function(a){for(var b=n.createEmpty(),c=0,d=a.length;c<d;++c)n.extendCoordinate(b,a[c]);return b},boundingExtentXYs_:function(a,b,c){var f=Math.min.apply(null,a),d=Math.min.apply(null,b);a=Math.max.apply(null,
a);b=Math.max.apply(null,b);return n.createOrUpdate(f,d,a,b,c)},buffer:function(a,b,c){return c?(c[0]=a[0]-b,c[1]=a[1]-b,c[2]=a[2]+b,c[3]=a[3]+b,c):[a[0]-b,a[1]-b,a[2]+b,a[3]+b]},clone:function(a,b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a.slice()},closestSquaredDistanceXY:function(a,b,c){b=b<a[0]?a[0]-b:a[2]<b?b-a[2]:0;a=c<a[1]?a[1]-c:a[3]<c?c-a[3]:0;return b*b+a*a},containsCoordinate:function(a,b){return n.containsXY(a,b[0],b[1])},containsExtent:function(a,b){return a[0]<=b[0]&&b[2]<=
a[2]&&a[1]<=b[1]&&b[3]<=a[3]},containsXY:function(a,b,c){return a[0]<=b&&b<=a[2]&&a[1]<=c&&c<=a[3]},coordinateRelationship:function(a,b){var f=a[1],c=a[2],d=a[3],g=b[0];b=b[1];var e=h.default.UNKNOWN;g<a[0]?e|=h.default.LEFT:g>c&&(e|=h.default.RIGHT);b<f?e|=h.default.BELOW:b>d&&(e|=h.default.ABOVE);e===h.default.UNKNOWN&&(e=h.default.INTERSECTING);return e},createEmpty:function(){return[Infinity,Infinity,-Infinity,-Infinity]},createOrUpdate:function(a,b,c,d,e){return e?(e[0]=a,e[1]=b,e[2]=c,e[3]=
d,e):[a,b,c,d]},createOrUpdateEmpty:function(a){return n.createOrUpdate(Infinity,Infinity,-Infinity,-Infinity,a)},createOrUpdateFromCoordinate:function(a,b){var f=a[0];a=a[1];return n.createOrUpdate(f,a,f,a,b)},createOrUpdateFromCoordinates:function(a,b){b=n.createOrUpdateEmpty(b);return n.extendCoordinates(b,a)},createOrUpdateFromFlatCoordinates:function(a,b,c,d,e){e=n.createOrUpdateEmpty(e);return n.extendFlatCoordinates(e,a,b,c,d)},createOrUpdateFromRings:function(a,b){b=n.createOrUpdateEmpty(b);
return n.extendRings(b,a)},equals:function(a,b){return a[0]==b[0]&&a[2]==b[2]&&a[1]==b[1]&&a[3]==b[3]},extend:function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[2]>a[2]&&(a[2]=b[2]);b[1]<a[1]&&(a[1]=b[1]);b[3]>a[3]&&(a[3]=b[3]);return a},extendCoordinate:function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])},extendCoordinates:function(a,b){var f;var c=0;for(f=b.length;c<f;++c)n.extendCoordinate(a,b[c]);return a},extendFlatCoordinates:function(a,b,c,d,e){for(;c<
d;c+=e)n.extendXY(a,b[c],b[c+1]);return a},extendRings:function(a,b){var f;var c=0;for(f=b.length;c<f;++c)n.extendCoordinates(a,b[c]);return a},extendXY:function(a,b,c){a[0]=Math.min(a[0],b);a[1]=Math.min(a[1],c);a[2]=Math.max(a[2],b);a[3]=Math.max(a[3],c)},forEachCorner:function(a,b,c){var f;return(f=b.call(c,n.getBottomLeft(a)))||(f=b.call(c,n.getBottomRight(a)))||(f=b.call(c,n.getTopRight(a)))?f:(f=b.call(c,n.getTopLeft(a)))?f:!1},getArea:function(a){var b=0;n.isEmpty(a)||(b=n.getWidth(a)*n.getHeight(a));
return b},getBottomLeft:function(a){return[a[0],a[1]]},getBottomRight:function(a){return[a[2],a[1]]},getCenter:function(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]},getCorner:function(a,f){var d;f===b.default.BOTTOM_LEFT?d=n.getBottomLeft(a):f===b.default.BOTTOM_RIGHT?d=n.getBottomRight(a):f===b.default.TOP_LEFT?d=n.getTopLeft(a):f===b.default.TOP_RIGHT?d=n.getTopRight(a):c.default.assert(!1,13);return d},getEnlargedArea:function(a,b){return(Math.max(a[2],b[2])-Math.min(a[0],b[0]))*(Math.max(a[3],b[3])-
Math.min(a[1],b[1]))},getForViewAndSize:function(a,b,c,d,e){var f=b*d[0]/2;d=b*d[1]/2;b=Math.cos(c);var g=Math.sin(c);c=f*b;f*=g;b*=d;var l=d*g,m=a[0],h=a[1];a=m-c+l;d=m-c-l;g=m+c-l;c=m+c+l;l=h-f-b;m=h-f+b;var q=h+f+b;f=h+f-b;return n.createOrUpdate(Math.min(a,d,g,c),Math.min(l,m,q,f),Math.max(a,d,g,c),Math.max(l,m,q,f),e)},getHeight:function(a){return a[3]-a[1]},getIntersectionArea:function(a,b){a=n.getIntersection(a,b);return n.getArea(a)},getIntersection:function(a,b,c){c=c?c:n.createEmpty();n.intersects(a,
b)&&(c[0]=a[0]>b[0]?a[0]:b[0],c[1]=a[1]>b[1]?a[1]:b[1],c[2]=a[2]<b[2]?a[2]:b[2],c[3]=a[3]<b[3]?a[3]:b[3]);return c},getMargin:function(a){return n.getWidth(a)+n.getHeight(a)},getSize:function(a){return[a[2]-a[0],a[3]-a[1]]},getTopLeft:function(a){return[a[0],a[3]]},getTopRight:function(a){return[a[2],a[3]]},getWidth:function(a){return a[2]-a[0]},intersects:function(a,b){return a[0]<=b[2]&&a[2]>=b[0]&&a[1]<=b[3]&&a[3]>=b[1]},isEmpty:function(a){return a[2]<a[0]||a[3]<a[1]},returnOrUpdate:function(a,
b){return b?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b):a},scaleFromCenter:function(a,b){var f=(a[2]-a[0])/2*(b-1);b=(a[3]-a[1])/2*(b-1);a[0]-=f;a[2]+=f;a[1]-=b;a[3]+=b},intersectsSegment:function(a,b,c){var f=!1,d=n.coordinateRelationship(a,b),e=n.coordinateRelationship(a,c);if(d===h.default.INTERSECTING||e===h.default.INTERSECTING)f=!0;else{var g=a[0],l=a[1],u=a[2];a=a[3];var y=c[0];c=c[1];b=(c-b[1])/(y-b[0]);e&h.default.ABOVE&&!(d&h.default.ABOVE)&&(f=y-(c-a)/b,f=f>=g&&f<=u);f||!(e&h.default.RIGHT)||
d&h.default.RIGHT||(f=c-(y-u)*b,f=f>=l&&f<=a);f||!(e&h.default.BELOW)||d&h.default.BELOW||(f=y-(c-l)/b,f=f>=g&&f<=u);f||!(e&h.default.LEFT)||d&h.default.LEFT||(f=c-(y-g)*b,f=f>=l&&f<=a)}return f},applyTransform:function(a,b,c){a=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];b(a,a,2);return n.boundingExtentXYs_([a[0],a[2],a[4],a[6]],[a[1],a[3],a[5],a[7]],c)}};k.default=n},{"./asserts.js":31,"./extent/corner.js":55,"./extent/relationship.js":56}],55:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});k.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},{}],56:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},{}],57:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./asserts.js");var c=d(e);e=a("./events.js");var b=d(e);e=a("./events/eventtype.js");var h=d(e);e=a("./index.js");
e=d(e);var n=a("./object.js"),g=d(n);n=a("./geom/geometry.js");var f=d(n);a=a("./style/style.js");var l=d(a),q=function(a){g.default.call(this);this.id_=void 0;this.geometryName_="geometry";this.style_=null;this.styleFunction_=void 0;this.geometryChangeKey_=null;b.default.listen(this,g.default.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);void 0!==a&&(a instanceof f.default||!a?this.setGeometry(a):this.setProperties(a))};e.default.inherits(q,g.default);q.prototype.clone=
function(){var a=new q(this.getProperties());a.setGeometryName(this.getGeometryName());var b=this.getGeometry();b&&a.setGeometry(b.clone());(b=this.getStyle())&&a.setStyle(b);return a};q.prototype.getGeometry=function(){return this.get(this.geometryName_)};q.prototype.getId=function(){return this.id_};q.prototype.getGeometryName=function(){return this.geometryName_};q.prototype.getStyle=function(){return this.style_};q.prototype.getStyleFunction=function(){return this.styleFunction_};q.prototype.handleGeometryChange_=
function(){this.changed()};q.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(b.default.unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);var a=this.getGeometry();a&&(this.geometryChangeKey_=b.default.listen(a,h.default.CHANGE,this.handleGeometryChange_,this));this.changed()};q.prototype.setGeometry=function(a){this.set(this.geometryName_,a)};q.prototype.setStyle=function(a){this.styleFunction_=(this.style_=a)?q.createStyleFunction(a):void 0;this.changed()};
q.prototype.setId=function(a){this.id_=a;this.changed()};q.prototype.setGeometryName=function(a){b.default.unlisten(this,g.default.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.geometryName_=a;b.default.listen(this,g.default.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this);this.handleGeometryChanged_()};q.createStyleFunction=function(a){if("function"===typeof a)var b=2==a.length?function(b){return a(this,b)}:a;else{if(Array.isArray(a))var f=
a;else c.default.assert(a instanceof l.default,41),f=[a];b=function(){return f}}return b};k.default=q},{"./asserts.js":31,"./events.js":48,"./events/eventtype.js":52,"./geom/geometry.js":77,"./index.js":89,"./object.js":125,"./style/style.js":234}],58:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./format/formattype.js");var b=d(e);a=a("./xml.js");var h=d(a),n={loadFeaturesXhr:function(a,f,c,d){return function(e,
g,l){var m=new XMLHttpRequest;m.open("GET","function"===typeof a?a(e,g,l):a,!0);f.getType()==b.default.ARRAY_BUFFER&&(m.responseType="arraybuffer");m.onload=function(a){if(!m.status||200<=m.status&&300>m.status){a=f.getType();if(a==b.default.JSON||a==b.default.TEXT)var e=m.responseText;else a==b.default.XML?(e=m.responseXML)||(e=h.default.parse(m.responseText)):a==b.default.ARRAY_BUFFER&&(e=m.response);e?c.call(this,f.readFeatures(e,{featureProjection:l}),f.readProjection(e),f.getLastExtent()):d.call(this)}else d.call(this)}.bind(this);
m.onerror=function(){d.call(this)}.bind(this);m.send()}},xhr:function(a,b){return n.loadFeaturesXhr(a,b,function(a,b){this.addFeatures(a)},c.default.nullFunction)}};k.default=n},{"./format/formattype.js":59,"./index.js":89,"./xml.js":255}],59:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"}},{}],60:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={TRUE:function(){return!0},FALSE:function(){return!1}}},
{}],61:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={linearRing:function(a,b,d,e){for(var c=0,f=a[d-e],l=a[d-e+1];b<d;b+=e){var h=a[b],m=a[b+1];c+=l*h-f*m;f=h;l=m}return c/2},linearRings:function(a,b,e,n){var c=0,f;var l=0;for(f=e.length;l<f;++l){var h=e[l];c+=d.linearRing(a,b,h,n);b=h}return c},linearRingss:function(a,b,e,n){var c=0,f;var l=0;for(f=e.length;l<f;++l){var h=e[l];c+=d.linearRings(a,b,h,n);b=h[h.length-1]}return c}};k.default=d},{}],62:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});var d=(a=a("../../math.js"))&&a.__esModule?a:{default:a},c={point:function(a,c,e,g,f,l,q){var b=a[c],p=a[c+1],h=a[e]-b,t=a[e+1]-p;if(0!==h||0!==t)if(l=((f-b)*h+(l-p)*t)/(h*h+t*t),1<l)c=e;else if(0<l){for(f=0;f<g;++f)q[f]=d.default.lerp(a[c+f],a[e+f],l);q.length=g;return}for(f=0;f<g;++f)q[f]=a[c+f];q.length=g},getMaxSquaredDelta:function(a,c,e,g,f){var b=a[c],h=a[c+1];for(c+=g;c<e;c+=g){var m=a[c],p=a[c+1];b=d.default.squaredDistance(b,h,m,p);b>f&&(f=b);b=m;h=p}return f},getsMaxSquaredDelta:function(a,
d,e,g,f){var b;var h=0;for(b=e.length;h<b;++h){var m=e[h];f=c.getMaxSquaredDelta(a,d,m,g,f);d=m}return f},getssMaxSquaredDelta:function(a,d,e,g,f){var b;var h=0;for(b=e.length;h<b;++h){var m=e[h];f=c.getsMaxSquaredDelta(a,d,m,g,f);d=m[m.length-1]}return f},getClosestPoint:function(a,e,n,g,f,l,q,m,p,r,t){if(e==n)return r;if(0===f){var b=d.default.squaredDistance(q,m,a[e],a[e+1]);if(b<r){for(t=0;t<g;++t)p[t]=a[e+t];p.length=g;return b}return r}for(var h=t?t:[NaN,NaN],w=e+g;w<n;)if(c.point(a,w-g,w,g,
q,m,h),b=d.default.squaredDistance(q,m,h[0],h[1]),b<r){r=b;for(t=0;t<g;++t)p[t]=h[t];p.length=g;w+=g}else w+=g*Math.max((Math.sqrt(b)-Math.sqrt(r))/f|0,1);if(l&&(c.point(a,n-g,e,g,q,m,h),b=d.default.squaredDistance(q,m,h[0],h[1]),b<r)){r=b;for(t=0;t<g;++t)p[t]=h[t];p.length=g}return r},getsClosestPoint:function(a,d,e,g,f,l,q,m,p,r,t){t=t?t:[NaN,NaN];var b;var h=0;for(b=e.length;h<b;++h){var n=e[h];r=c.getClosestPoint(a,d,n,g,f,l,q,m,p,r,t);d=n}return r},getssClosestPoint:function(a,d,e,g,f,l,q,m,
p,r,t){t=t?t:[NaN,NaN];var b;var h=0;for(b=e.length;h<b;++h){var n=e[h];r=c.getsClosestPoint(a,d,n,g,f,l,q,m,p,r,t);d=n[n.length-1]}return r}};k.default=c},{"../../math.js":123}],63:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../extent.js"))&&a.__esModule?a:{default:a},c={linearRingContainsExtent:function(a,e,n,g,f){return!d.default.forEachCorner(f,function(b){return!c.linearRingContainsXY(a,e,n,g,b[0],b[1])})},linearRingContainsXY:function(a,c,d,e,f,l){for(var b=
0,g=a[d-e],p=a[d-e+1];c<d;c+=e){var h=a[c],t=a[c+1];p<=l?t>l&&0<(h-g)*(l-p)-(f-g)*(t-p)&&b++:t<=l&&0>(h-g)*(l-p)-(f-g)*(t-p)&&b--;g=h;p=t}return 0!==b},linearRingsContainsXY:function(a,d,e,g,f,l){if(0===e.length||!c.linearRingContainsXY(a,d,e[0],g,f,l))return!1;var b;d=1;for(b=e.length;d<b;++d)if(c.linearRingContainsXY(a,e[d-1],e[d],g,f,l))return!1;return!0},linearRingssContainsXY:function(a,d,e,g,f,l){if(0===e.length)return!1;var b;var m=0;for(b=e.length;m<b;++m){var p=e[m];if(c.linearRingsContainsXY(a,
d,p,g,f,l))return!0;d=p[p.length-1]}return!1}};k.default=c},{"../../extent.js":54}],64:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={coordinate:function(a,b,d,e){var c;e=0;for(c=d.length;e<c;++e)a[b++]=d[e];return b},coordinates:function(a,b,d,e){var c;var f=0;for(c=d.length;f<c;++f){var l=d[f],h;for(h=0;h<e;++h)a[b++]=l[h]}return b},coordinatess:function(a,b,e,n,g){g=g?g:[];var c=0,l;var h=0;for(l=e.length;h<l;++h)b=d.coordinates(a,b,e[h],n),g[c++]=b;g.length=c;return g},
coordinatesss:function(a,b,e,n,g){g=g?g:[];var c=0,l;var h=0;for(l=e.length;h<l;++h)b=d.coordinatess(a,b,e[h],n,g[c]),g[c++]=b,b=b[b.length-1];g.length=c;return g}};k.default=d},{}],65:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={coordinates:function(a,b,d,e,g){g=void 0!==g?g:[];for(var c=0;b<d;b+=e)g[c++]=a.slice(b,b+e);g.length=c;return g},coordinatess:function(a,b,e,n,g){g=void 0!==g?g:[];var c=0,l;var h=0;for(l=e.length;h<l;++h){var m=e[h];g[c++]=d.coordinates(a,b,
m,n,g[c]);b=m}g.length=c;return g},coordinatesss:function(a,b,e,n,g){g=void 0!==g?g:[];var c=0,l;var h=0;for(l=e.length;h<l;++h){var m=e[h];g[c++]=d.coordinatess(a,b,m,n,g[c]);b=m[m.length-1]}g.length=c;return g}};k.default=d},{}],66:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("../../array.js"))&&e.__esModule?e:{default:e},c=(a=a("../flat/contains.js"))&&a.__esModule?a:{default:a},b={linearRings:function(a,b,e,f,l,q,m){for(var g,h,t,u,n,k=l[q+1],v=[],A=0,B=e.length;A<
B;++A){var x=e[A];t=a[x-f];n=a[x-f+1];for(g=b;g<x;g+=f){u=a[g];h=a[g+1];if(k<=n&&h<=k||n<=k&&k<=h)t=(k-n)/(h-n)*(u-t)+t,v.push(t);t=u;n=h}}A=NaN;B=-Infinity;v.sort(d.default.numberSafeCompareFunction);t=v[0];g=1;for(h=v.length;g<h;++g)u=v[g],x=Math.abs(u-t),x>B&&(t=(t+u)/2,c.default.linearRingsContainsXY(a,b,e,f,t,k)&&(A=t,B=x)),t=u;isNaN(A)&&(A=l[q]);return m?(m.push(A,k,B),m):[A,k,B]},linearRingss:function(a,c,d,f,e){var g=[],l;var p=0;for(l=d.length;p<l;++p){var h=d[p];g=b.linearRings(a,c,h,f,
e,2*p,g);c=h[h.length-1]}return g}};k.default=b},{"../../array.js":29,"../flat/contains.js":63}],67:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../extent.js");var c=d(e);e=a("../flat/contains.js");var b=d(e);a=a("../flat/segments.js");var h=d(a),n={lineString:function(a,b,d,e,m){var f=c.default.extendFlatCoordinates(c.default.createEmpty(),a,b,d,e);return c.default.intersects(m,f)?c.default.containsExtent(m,f)||f[0]>=
m[0]&&f[2]<=m[2]||f[1]>=m[1]&&f[3]<=m[3]?!0:h.default.forEach(a,b,d,e,function(a,b){return c.default.intersectsSegment(m,a,b)}):!1},lineStrings:function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){if(n.lineString(a,b,c[g],d,e))return!0;b=c[g]}return!1},linearRing:function(a,c,d,e,m){return n.lineString(a,c,d,e,m)||b.default.linearRingContainsXY(a,c,d,e,m[0],m[1])||b.default.linearRingContainsXY(a,c,d,e,m[0],m[3])||b.default.linearRingContainsXY(a,c,d,e,m[2],m[1])||b.default.linearRingContainsXY(a,
c,d,e,m[2],m[3])?!0:!1},linearRings:function(a,c,d,e,m){if(!n.linearRing(a,c,d[0],e,m))return!1;if(1===d.length)return!0;var f;c=1;for(f=d.length;c<f;++c)if(b.default.linearRingContainsExtent(a,d[c-1],d[c],e,m))return!1;return!0},linearRingss:function(a,b,c,d,e){var f;var g=0;for(f=c.length;g<f;++g){var l=c[g];if(n.linearRings(a,b,l,d,e))return!0;b=l[l.length-1]}return!1}};k.default=n},{"../../extent.js":54,"../flat/contains.js":63,"../flat/segments.js":71}],68:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});var d={lineString:function(a,b,d,e){var c=a[b],f=a[b+1],l=0;for(b+=e;b<d;b+=e){var h=a[b],m=a[b+1];l+=Math.sqrt((h-c)*(h-c)+(m-f)*(m-f));c=h;f=m}return l},linearRing:function(a,b,e,n){var c=d.lineString(a,b,e,n),f=a[e-n]-a[b];a=a[e-n+1]-a[b+1];return c+=Math.sqrt(f*f+a*a)}};k.default=d},{}],69:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../flat/reverse.js"))&&a.__esModule?a:{default:a},c={linearRingIsClockwise:function(a,c,d,e){for(var b=
0,g=a[d-e],h=a[d-e+1];c<d;c+=e){var m=a[c],p=a[c+1];b+=(m-g)*(p+h);g=m;h=p}return 0<b},linearRingsAreOriented:function(a,d,e,g,f){f=void 0!==f?f:!1;var b;var h=0;for(b=e.length;h<b;++h){var m=e[h];d=c.linearRingIsClockwise(a,d,m,g);if(0===h){if(f&&d||!f&&!d)return!1}else if(f&&!d||!f&&d)return!1;d=m}return!0},linearRingssAreOriented:function(a,d,e,g,f){var b;var h=0;for(b=e.length;h<b;++h)if(!c.linearRingsAreOriented(a,d,e[h],g,f))return!1;return!0},orientLinearRings:function(a,e,n,g,f){f=void 0!==
f?f:!1;var b;var h=0;for(b=n.length;h<b;++h){var m=n[h],p=c.linearRingIsClockwise(a,e,m,g);(0===h?f&&p||!f&&!p:f&&!p||!f&&p)&&d.default.coordinates(a,e,m,g);e=m}return e},orientLinearRingss:function(a,d,e,g,f){var b;var h=0;for(b=e.length;h<b;++h)d=c.orientLinearRings(a,d,e[h],g,f);return d}};k.default=c},{"../flat/reverse.js":70}],70:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={coordinates:function(a,c,b,e){for(;c<b-e;){var d;for(d=0;d<e;++d){var g=a[c+d];a[c+d]=a[b-
e+d];a[b-e+d]=g}c+=e;b-=e}}}},{}],71:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={forEach:function(a,c,b,e,n,g){for(var f=[a[c],a[c+1]],d=[],h;c+e<b;c+=e){d[0]=a[c+e];d[1]=a[c+e+1];if(h=n.call(g,f,d))return h;f[0]=d[0];f[1]=d[1]}return!1}}},{}],72:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../math.js"))&&a.__esModule?a:{default:a},c={lineString:function(a,d,e,g,f,l,q){q=void 0!==q?q:[];l||(e=c.radialDistance(a,d,e,g,f,q,0),a=q,
d=0,g=2);q.length=c.douglasPeucker(a,d,e,g,f,q,0);return q},douglasPeucker:function(a,c,e,g,f,l,q){var b=(e-c)/g;if(3>b){for(;c<e;c+=g)l[q++]=a[c],l[q++]=a[c+1];return q}var p=Array(b);p[0]=1;p[b-1]=1;e=[c,e-g];for(var h=0,t;0<e.length;){var u=e.pop(),n=e.pop(),k=0,v=a[n],A=a[n+1],B=a[u],x=a[u+1];for(t=n+g;t<u;t+=g){var z=d.default.squaredSegmentDistance(a[t],a[t+1],v,A,B,x);z>k&&(h=t,k=z)}k>f&&(p[(h-c)/g]=1,n+g<h&&e.push(n,h),h+g<u&&e.push(h,u))}for(t=0;t<b;++t)p[t]&&(l[q++]=a[c+t*g],l[q++]=a[c+
t*g+1]);return q},douglasPeuckers:function(a,d,e,g,f,l,q,m){var b;var h=0;for(b=e.length;h<b;++h){var t=e[h];q=c.douglasPeucker(a,d,t,g,f,l,q);m.push(q);d=t}return q},douglasPeuckerss:function(a,d,e,g,f,l,q,m){var b;var h=0;for(b=e.length;h<b;++h){var t=e[h],u=[];q=c.douglasPeuckers(a,d,t,g,f,l,q,u);m.push(u);d=t[t.length-1]}return q},radialDistance:function(a,c,e,g,f,l,q){if(e<=c+g){for(;c<e;c+=g)l[q++]=a[c],l[q++]=a[c+1];return q}var b=a[c],p=a[c+1];l[q++]=b;l[q++]=p;var h=b,t=p;for(c+=g;c<e;c+=
g)h=a[c],t=a[c+1],d.default.squaredDistance(b,p,h,t)>f&&(l[q++]=h,l[q++]=t,b=h,p=t);if(h!=b||t!=p)l[q++]=h,l[q++]=t;return q},snap:function(a,c){return c*Math.round(a/c)},quantize:function(a,d,e,g,f,l,q){if(d==e)return q;var b=c.snap(a[d],f),p=c.snap(a[d+1],f);d+=g;l[q++]=b;l[q++]=p;do{var h=c.snap(a[d],f);var t=c.snap(a[d+1],f);d+=g;if(d==e)return l[q++]=h,l[q++]=t,q}while(h==b&&t==p);for(;d<e;){var u=c.snap(a[d],f);var n=c.snap(a[d+1],f);d+=g;if(u!=h||n!=t){var k=h-b,v=t-p,A=u-b,B=n-p;k*B==v*A&&
(0>k&&A<k||k==A||0<k&&A>k)&&(0>v&&B<v||v==B||0<v&&B>v)||(l[q++]=h,l[q++]=t,b=h,p=t);h=u;t=n}}l[q++]=h;l[q++]=t;return q},quantizes:function(a,d,e,g,f,l,q,m){var b;var h=0;for(b=e.length;h<b;++h){var t=e[h];q=c.quantize(a,d,t,g,f,l,q);m.push(q);d=t}return q},quantizess:function(a,d,e,g,f,l,q,m){var b;var h=0;for(b=e.length;h<b;++h){var t=e[h],u=[];q=c.quantizes(a,d,t,g,f,l,q,u);m.push(u);d=t[t.length-1]}return q}};k.default=c},{"../../math.js":123}],73:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});k.default={lineString:function(a,c,b,e,n){for(var d=b,f=b,l=0,h=0,m=b,p,r,t,u,y,k;b<e;b+=n){var v=c[b],A=c[b+1];void 0!==t&&(t=v-t,u=A-u,r=Math.sqrt(t*t+u*u),void 0!==y&&(h+=p,p=Math.acos((y*t+k*u)/(p*r)),p>a&&(h>l&&(l=h,d=m,f=b),h=0,m=b-n)),p=r,y=t,k=u);t=v;u=A}return h+r>l?[m,b]:[d,f]}}},{}],74:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../math.js"))&&a.__esModule?a:{default:a};k.default={lineString:function(a,b,e,n,g,f,l,q){var c=[],p=a[b]>a[e-
n],h=g.length,t=a[b],u=a[b+1];b+=n;for(var y=a[b],k=a[b+1],v=0,A=Math.sqrt(Math.pow(y-t,2)+Math.pow(k-u,2)),B="",x=0,z,C,S,I=0;I<h;++I){C=p?h-I-1:I;C=g.charAt(C);B=p?C+B:B+C;var M=f(B)-x;x+=M;for(var H=l+M/2;b<e-n&&v+A<H;)t=y,u=k,b+=n,y=a[b],k=a[b+1],v+=A,A=Math.sqrt(Math.pow(y-t,2)+Math.pow(k-u,2));var J=H-v;H=Math.atan2(k-u,y-t);p&&(H+=0<H?-Math.PI:Math.PI);if(void 0!==S){var D=H-S;D+=D>Math.PI?-2*Math.PI:D<-Math.PI?2*Math.PI:0;if(Math.abs(D)>q)return null}D=J/A;J=d.default.lerp(t,y,D);D=d.default.lerp(u,
k,D);S==H?(p&&(z[0]=J,z[1]=D,z[2]=M/2),z[4]=B):(B=C,x=M,z=[J,D,M/2,H,B],p?c.unshift(z):c.push(z),S=H);l+=M}return c}}},{"../../math.js":123}],75:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../flat/area.js"))&&a.__esModule?a:{default:a};k.default={lineStringIsClosed:function(a,b,e,n){var c=e-n;return a[b]===a[c]&&a[b+1]===a[c+1]&&3<(e-b)/n?!!d.default.linearRing(a,b,e,n):!1}}},{"../flat/area.js":61}],76:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});
k.default={transform2D:function(a,c,b,e,n,g){for(var f=g?g:[],d=0;c<b;c+=e){var h=a[c],m=a[c+1];f[d++]=n[0]*h+n[2]*m+n[4];f[d++]=n[1]*h+n[3]*m+n[5]}g&&f.length!=d&&(f.length=d);return f},rotate:function(a,c,b,e,n,g,f){var d=f?f:[],h=Math.cos(n);n=Math.sin(n);var m=g[0];g=g[1];for(var p=0;c<b;c+=e){var r=a[c]-m,t=a[c+1]-g;d[p++]=m+r*h-t*n;d[p++]=g+r*n+t*h;for(r=c+2;r<c+e;++r)d[p++]=a[r]}f&&d.length!=p&&(d.length=p);return d},scale:function(a,c,b,e,n,g,f,l){var d=l?l:[],m=f[0];f=f[1];for(var p=0;c<
b;c+=e){var h=a[c]-m,t=a[c+1]-f;d[p++]=m+n*h;d[p++]=f+g*t;for(h=c+2;h<c+e;++h)d[p++]=a[h]}l&&d.length!=p&&(d.length=p);return d},translate:function(a,c,b,e,n,g,f){for(var d=f?f:[],h=0,m;c<b;c+=e)for(d[h++]=a[c]+n,d[h++]=a[c+1]+g,m=c+2;m<c+e;++m)d[h++]=a[m];f&&d.length!=h&&(d.length=h);return d}}},{}],77:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../object.js"),b=d(c);c=a("../extent.js");var h=
d(c);c=a("../functions.js");c=d(c);var n=a("../geom/flat/transform.js"),g=d(n);n=a("../proj.js");var f=d(n);n=a("../proj/units.js");var l=d(n);a=a("../transform.js");var q=d(a);a=function(){b.default.call(this);this.extent_=h.default.createEmpty();this.extentRevision_=-1;this.simplifiedGeometryCache={};this.simplifiedGeometryRevision=this.simplifiedGeometryMaxMinSquaredTolerance=0;this.tmpTransform_=q.default.create()};e.default.inherits(a,b.default);a.prototype.clone=function(){};a.prototype.closestPointXY=
function(a,b,c,f){};a.prototype.getClosestPoint=function(a,b){b=b?b:[NaN,NaN];this.closestPointXY(a[0],a[1],b,Infinity);return b};a.prototype.intersectsCoordinate=function(a){return this.containsXY(a[0],a[1])};a.prototype.computeExtent=function(a){};a.prototype.containsXY=c.default.FALSE;a.prototype.getExtent=function(a){this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision());return h.default.returnOrUpdate(this.extent_,a)};
a.prototype.rotate=function(a,b){};a.prototype.scale=function(a,b,c){};a.prototype.simplify=function(a){return this.getSimplifiedGeometry(a*a)};a.prototype.getSimplifiedGeometry=function(a){};a.prototype.getType=function(){};a.prototype.applyTransform=function(a){};a.prototype.intersectsExtent=function(a){};a.prototype.translate=function(a,b){};a.prototype.transform=function(a,b){var c=this.tmpTransform_;a=f.default.get(a);var d=a.getUnits()==l.default.TILE_PIXELS?function(d,e,l){var m=a.getExtent(),
p=a.getWorldExtent();m=h.default.getHeight(p)/h.default.getHeight(m);q.default.compose(c,p[0],p[3],m,-m,0,0,0);g.default.transform2D(d,0,d.length,l,c,e);return f.default.getTransform(a,b)(d,e,l)}:f.default.getTransform(a,b);this.applyTransform(d);return this};k.default=a},{"../extent.js":54,"../functions.js":60,"../geom/flat/transform.js":76,"../index.js":89,"../object.js":125,"../proj.js":141,"../proj/units.js":148,"../transform.js":243}],78:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});k.default={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"}},{}],79:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"}},{}],80:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});
e=a("../index.js");e=d(e);var c=a("../extent.js"),b=d(c);c=a("../geom/geometrylayout.js");var h=d(c);c=a("../geom/geometrytype.js");var n=d(c);c=a("../geom/simplegeometry.js");var g=d(c);c=a("../geom/flat/area.js");var f=d(c);c=a("../geom/flat/closest.js");var l=d(c);c=a("../geom/flat/deflate.js");var q=d(c);c=a("../geom/flat/inflate.js");var m=d(c);a=a("../geom/flat/simplify.js");var p=d(a),r=function(a,b){g.default.call(this);this.maxDeltaRevision_=this.maxDelta_=-1;this.setCoordinates(a,b)};e.default.inherits(r,
g.default);r.prototype.clone=function(){var a=new r(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};r.prototype.closestPointXY=function(a,c,f,d){if(d<b.default.closestSquaredDistanceXY(this.getExtent(),a,c))return d;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(l.default.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return l.default.getClosestPoint(this.flatCoordinates,
0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,a,c,f,d)};r.prototype.getArea=function(){return f.default.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};r.prototype.getCoordinates=function(){return m.default.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)};r.prototype.getSimplifiedGeometryInternal=function(a){var b=[];b.length=p.default.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a,b,0);a=new r(null);
a.setFlatCoordinates(h.default.XY,b);return a};r.prototype.getType=function(){return n.default.LINEAR_RING};r.prototype.intersectsExtent=function(a){};r.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=q.default.coordinates(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(h.default.XY,null)};r.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};
k.default=r},{"../extent.js":54,"../geom/flat/area.js":61,"../geom/flat/closest.js":62,"../geom/flat/deflate.js":64,"../geom/flat/inflate.js":65,"../geom/flat/simplify.js":72,"../geom/geometrylayout.js":78,"../geom/geometrytype.js":79,"../geom/simplegeometry.js":83,"../index.js":89}],81:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../extent.js"),b=d(c);c=a("../geom/geometrylayout.js");var h=
d(c);c=a("../geom/geometrytype.js");var n=d(c);c=a("../geom/simplegeometry.js");var g=d(c);c=a("../geom/flat/deflate.js");var f=d(c);a=a("../math.js");var l=d(a),q=function(a,b){g.default.call(this);this.setCoordinates(a,b)};e.default.inherits(q,g.default);q.prototype.clone=function(){var a=new q(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice());return a};q.prototype.closestPointXY=function(a,b,c,f){var d=this.flatCoordinates;a=l.default.squaredDistance(a,b,d[0],d[1]);if(a<f){f=
this.stride;for(b=0;b<f;++b)c[b]=d[b];c.length=f;return a}return f};q.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]};q.prototype.computeExtent=function(a){return b.default.createOrUpdateFromCoordinate(this.flatCoordinates,a)};q.prototype.getType=function(){return n.default.POINT};q.prototype.intersectsExtent=function(a){return b.default.containsXY(a,this.flatCoordinates[0],this.flatCoordinates[1])};q.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,
a,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=f.default.coordinate(this.flatCoordinates,0,a,this.stride),this.changed()):this.setFlatCoordinates(h.default.XY,null)};q.prototype.setFlatCoordinates=function(a,b){this.setFlatCoordinatesInternal(a,b);this.changed()};k.default=q},{"../extent.js":54,"../geom/flat/deflate.js":64,"../geom/geometrylayout.js":78,"../geom/geometrytype.js":79,"../geom/simplegeometry.js":83,"../index.js":89,"../math.js":123}],82:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../array.js"),b=d(c);c=a("../extent.js");var h=d(c);c=a("../geom/geometrylayout.js");var n=d(c);c=a("../geom/geometrytype.js");var g=d(c);c=a("../geom/linearring.js");var f=d(c);c=a("../geom/point.js");var l=d(c);c=a("../geom/simplegeometry.js");var q=d(c);c=a("../geom/flat/area.js");var m=d(c);c=a("../geom/flat/closest.js");var p=d(c);c=a("../geom/flat/contains.js");
var r=d(c);c=a("../geom/flat/deflate.js");var t=d(c);c=a("../geom/flat/inflate.js");var u=d(c);c=a("../geom/flat/interiorpoint.js");var y=d(c);c=a("../geom/flat/intersectsextent.js");var w=d(c);c=a("../geom/flat/orient.js");var v=d(c);c=a("../geom/flat/simplify.js");var A=d(c);a=a("../math.js");var B=d(a),x=function(a,b){q.default.call(this);this.ends_=[];this.flatInteriorPointRevision_=-1;this.flatInteriorPoint_=null;this.orientedRevision_=this.maxDeltaRevision_=this.maxDelta_=-1;this.orientedFlatCoordinates_=
null;this.setCoordinates(a,b)};e.default.inherits(x,q.default);x.prototype.appendLinearRing=function(a){this.flatCoordinates?b.default.extend(this.flatCoordinates,a.getFlatCoordinates()):this.flatCoordinates=a.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length);this.changed()};x.prototype.clone=function(){var a=new x(null);a.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice());return a};x.prototype.closestPointXY=function(a,b,c,f){if(f<h.default.closestSquaredDistanceXY(this.getExtent(),
a,b))return f;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(p.default.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision());return p.default.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,a,b,c,f)};x.prototype.containsXY=function(a,b){return r.default.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,a,b)};x.prototype.getArea=function(){return m.default.linearRings(this.getOrientedFlatCoordinates(),
0,this.ends_,this.stride)};x.prototype.getCoordinates=function(a){if(void 0!==a){var b=this.getOrientedFlatCoordinates().slice();v.default.orientLinearRings(b,0,this.ends_,this.stride,a)}else b=this.flatCoordinates;return u.default.coordinatess(b,0,this.ends_,this.stride)};x.prototype.getEnds=function(){return this.ends_};x.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var a=h.default.getCenter(this.getExtent());this.flatInteriorPoint_=y.default.linearRings(this.getOrientedFlatCoordinates(),
0,this.ends_,this.stride,a,0);this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_};x.prototype.getInteriorPoint=function(){return new l.default(this.getFlatInteriorPoint(),n.default.XYM)};x.prototype.getLinearRingCount=function(){return this.ends_.length};x.prototype.getLinearRing=function(a){if(0>a||this.ends_.length<=a)return null;var b=new f.default(null);b.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===a?0:this.ends_[a-1],this.ends_[a]));return b};
x.prototype.getLinearRings=function(){var a=this.layout,b=this.flatCoordinates,c=this.ends_,d=[],e=0,g;var l=0;for(g=c.length;l<g;++l){var m=c[l],p=new f.default(null);p.setFlatCoordinates(a,b.slice(e,m));d.push(p);e=m}return d};x.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var a=this.flatCoordinates;v.default.linearRingsAreOriented(a,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=a:(this.orientedFlatCoordinates_=a.slice(),this.orientedFlatCoordinates_.length=
v.default.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride));this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_};x.prototype.getSimplifiedGeometryInternal=function(a){var b=[],c=[];b.length=A.default.quantizes(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(a),b,0,c);a=new x(null);a.setFlatCoordinates(n.default.XY,b,c);return a};x.prototype.getType=function(){return g.default.POLYGON};x.prototype.intersectsExtent=function(a){return w.default.linearRings(this.getOrientedFlatCoordinates(),
0,this.ends_,this.stride,a)};x.prototype.setCoordinates=function(a,b){a?(this.setLayout(b,a,2),this.flatCoordinates||(this.flatCoordinates=[]),a=t.default.coordinatess(this.flatCoordinates,0,a,this.stride,this.ends_),this.flatCoordinates.length=0===a.length?0:a[a.length-1],this.changed()):this.setFlatCoordinates(n.default.XY,null,this.ends_)};x.prototype.setFlatCoordinates=function(a,b,c){this.setFlatCoordinatesInternal(a,b);this.ends_=c;this.changed()};x.circular=function(a,c,f,d){var e=d?d:32;d=
[];var g;for(g=0;g<e;++g)b.default.extend(d,a.offset(c,f,2*Math.PI*g/e));d.push(d[0],d[1]);a=new x(null);a.setFlatCoordinates(n.default.XY,d,[d.length]);return a};x.fromExtent=function(a){var b=a[0],c=a[1],f=a[2];a=a[3];b=[b,c,b,a,f,a,f,c,b,c];c=new x(null);c.setFlatCoordinates(n.default.XY,b,[b.length]);return c};x.fromCircle=function(a,b,c){var f=b?b:32,d=a.getStride();b=a.getLayout();var e=new x(null,b);f=d*(f+1);d=Array(f);for(var g=0;g<f;g++)d[g]=0;e.setFlatCoordinates(b,d,[d.length]);x.makeRegular(e,
a.getCenter(),a.getRadius(),c);return e};x.makeRegular=function(a,b,c,f){var d=a.getFlatCoordinates(),e=a.getLayout(),g=a.getStride(),l=a.getEnds(),m=d.length/g-1;f=f?f:0;for(var p,h,t=0;t<=m;++t)h=t*g,p=f+2*B.default.modulo(t,m)*Math.PI/m,d[h]=b[0]+c*Math.cos(p),d[h+1]=b[1]+c*Math.sin(p);a.setFlatCoordinates(e,d,l)};k.default=x},{"../array.js":29,"../extent.js":54,"../geom/flat/area.js":61,"../geom/flat/closest.js":62,"../geom/flat/contains.js":63,"../geom/flat/deflate.js":64,"../geom/flat/inflate.js":65,
"../geom/flat/interiorpoint.js":66,"../geom/flat/intersectsextent.js":67,"../geom/flat/orient.js":69,"../geom/flat/simplify.js":72,"../geom/geometrylayout.js":78,"../geom/geometrytype.js":79,"../geom/linearring.js":80,"../geom/point.js":81,"../geom/simplegeometry.js":83,"../index.js":89,"../math.js":123}],83:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../functions.js");c=d(c);var b=a("../extent.js"),
h=d(b);b=a("../geom/geometry.js");var n=d(b);b=a("../geom/geometrylayout.js");var g=d(b);b=a("../geom/flat/transform.js");var f=d(b);a=a("../obj.js");var l=d(a),q=function(){n.default.call(this);this.layout=g.default.XY;this.stride=2;this.flatCoordinates=null};e.default.inherits(q,n.default);q.getLayoutForStride_=function(a){if(2==a)var b=g.default.XY;else 3==a?b=g.default.XYZ:4==a&&(b=g.default.XYZM);return b};q.getStrideForLayout=function(a){var b;a==g.default.XY?b=2:a==g.default.XYZ||a==g.default.XYM?
b=3:a==g.default.XYZM&&(b=4);return b};q.prototype.containsXY=c.default.FALSE;q.prototype.computeExtent=function(a){return h.default.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,a)};q.prototype.getCoordinates=function(){};q.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)};q.prototype.getFlatCoordinates=function(){return this.flatCoordinates};q.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-
this.stride)};q.prototype.getLayout=function(){return this.layout};q.prototype.getSimplifiedGeometry=function(a){this.simplifiedGeometryRevision!=this.getRevision()&&(l.default.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision());if(0>a||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&a<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var b=a.toString();if(this.simplifiedGeometryCache.hasOwnProperty(b))return this.simplifiedGeometryCache[b];
var c=this.getSimplifiedGeometryInternal(a);if(c.getFlatCoordinates().length<this.flatCoordinates.length)return this.simplifiedGeometryCache[b]=c;this.simplifiedGeometryMaxMinSquaredTolerance=a;return this};q.prototype.getSimplifiedGeometryInternal=function(a){return this};q.prototype.getStride=function(){return this.stride};q.prototype.setFlatCoordinatesInternal=function(a,b){this.stride=q.getStrideForLayout(a);this.layout=a;this.flatCoordinates=b};q.prototype.setCoordinates=function(a,b){};q.prototype.setLayout=
function(a,b,c){if(a)b=q.getStrideForLayout(a);else{for(a=0;a<c;++a){if(0===b.length){this.layout=g.default.XY;this.stride=2;return}b=b[0]}b=b.length;a=q.getLayoutForStride_(b)}this.layout=a;this.stride=b};q.prototype.applyTransform=function(a){this.flatCoordinates&&(a(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())};q.prototype.rotate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();f.default.rotate(c,0,c.length,d,a,b,c);this.changed()}};q.prototype.scale=
function(a,b,c){void 0===b&&(b=a);c||(c=h.default.getCenter(this.getExtent()));var d=this.getFlatCoordinates();if(d){var e=this.getStride();f.default.scale(d,0,d.length,e,a,b,c,d);this.changed()}};q.prototype.translate=function(a,b){var c=this.getFlatCoordinates();if(c){var d=this.getStride();f.default.translate(c,0,c.length,d,a,b,c);this.changed()}};q.transform2D=function(a,b,c){var d=a.getFlatCoordinates();return d?(a=a.getStride(),f.default.transform2D(d,0,d.length,a,b,c)):null};k.default=q},{"../extent.js":54,
"../functions.js":60,"../geom/flat/transform.js":76,"../geom/geometry.js":77,"../geom/geometrylayout.js":78,"../index.js":89,"../obj.js":124}],84:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("./index.js"))&&e.__esModule?e:{default:e},c=(a=a("./webgl.js"))&&a.__esModule?a:{default:a},b={};a="undefined"!==typeof navigator?navigator.userAgent.toLowerCase():"";b.FIREFOX=-1!==a.indexOf("firefox");b.SAFARI=-1!==a.indexOf("safari")&&-1==a.indexOf("chrom");b.WEBKIT=-1!==a.indexOf("webkit")&&
-1==a.indexOf("edge");b.MAC=-1!==a.indexOf("macintosh");b.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1;b.CANVAS_LINE_DASH=!1;b.CANVAS=d.default.ENABLE_CANVAS&&function(){if(!("HTMLCanvasElement"in window))return!1;try{var a=document.createElement("CANVAS").getContext("2d");return a?(void 0!==a.setLineDash&&(b.CANVAS_LINE_DASH=!0),!0):!1}catch(n){return!1}}();b.DEVICE_ORIENTATION="DeviceOrientationEvent"in window;b.GEOLOCATION="geolocation"in navigator;b.TOUCH=d.default.ASSUME_TOUCH||"ontouchstart"in
window;b.POINTER="PointerEvent"in window;b.MSPOINTER=!!navigator.msPointerEnabled;b.WEBGL;(function(){if(d.default.ENABLE_WEBGL){var a=!1,e=[];if("WebGLRenderingContext"in window)try{var g=document.createElement("CANVAS"),f=c.default.getContext(g,{failIfMajorPerformanceCaveat:!0});if(f){a=!0;var l=f.getParameter(f.MAX_TEXTURE_SIZE);e=f.getSupportedExtensions()}}catch(q){}b.WEBGL=a;d.default.WEBGL_EXTENSIONS=e;d.default.WEBGL_MAX_TEXTURE_SIZE=l}})();k.default=b},{"./index.js":89,"./webgl.js":248}],
85:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./imagebase.js"),b=d(c);c=a("./imagestate.js");var h=d(c);c=a("./events.js");var n=d(c);c=a("./events/eventtype.js");var g=d(c);a=a("./extent.js");var f=d(a);a=function(a,c,f,d,e,g){b.default.call(this,a,c,f,h.default.IDLE);this.src_=d;this.image_=new Image;null!==e&&(this.image_.crossOrigin=e);this.imageListenerKeys_=null;this.state=h.default.IDLE;
this.imageLoadFunction_=g};e.default.inherits(a,b.default);a.prototype.getImage=function(){return this.image_};a.prototype.handleImageError_=function(){this.state=h.default.ERROR;this.unlistenImage_();this.changed()};a.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=f.default.getHeight(this.extent)/this.image_.height);this.state=h.default.LOADED;this.unlistenImage_();this.changed()};a.prototype.load=function(){if(this.state==h.default.IDLE||this.state==h.default.ERROR)this.state=
h.default.LOADING,this.changed(),this.imageListenerKeys_=[n.default.listenOnce(this.image_,g.default.ERROR,this.handleImageError_,this),n.default.listenOnce(this.image_,g.default.LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_)};a.prototype.setImage=function(a){this.image_=a};a.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(n.default.unlistenByKey);this.imageListenerKeys_=null};k.default=a},{"./events.js":48,"./events/eventtype.js":52,"./extent.js":54,
"./imagebase.js":86,"./imagestate.js":88,"./index.js":89}],86:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./events/eventtarget.js"),b=d(c);a=a("./events/eventtype.js");var h=d(a);a=function(a,c,f,d){b.default.call(this);this.extent=a;this.pixelRatio_=f;this.resolution=c;this.state=d};e.default.inherits(a,b.default);a.prototype.changed=function(){this.dispatchEvent(h.default.CHANGE)};a.prototype.getExtent=
function(){return this.extent};a.prototype.getImage=function(){};a.prototype.getPixelRatio=function(){return this.pixelRatio_};a.prototype.getResolution=function(){return this.resolution};a.prototype.getState=function(){return this.state};a.prototype.load=function(){};k.default=a},{"./events/eventtarget.js":51,"./events/eventtype.js":52,"./index.js":89}],87:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);
var c=a("./imagebase.js"),b=d(c);a=a("./imagestate.js");var h=d(a);a=function(a,c,f,d,e){this.loader_=void 0!==e?e:null;b.default.call(this,a,c,f,void 0!==e?h.default.IDLE:h.default.LOADED);this.canvas_=d;this.error_=null};e.default.inherits(a,b.default);a.prototype.getError=function(){return this.error_};a.prototype.handleLoad_=function(a){a?(this.error_=a,this.state=h.default.ERROR):this.state=h.default.LOADED;this.changed()};a.prototype.load=function(){this.state==h.default.IDLE&&(this.state=h.default.LOADING,
this.changed(),this.loader_(this.handleLoad_.bind(this)))};a.prototype.getImage=function(){return this.canvas_};k.default=a},{"./imagebase.js":86,"./imagestate.js":88,"./index.js":89}],88:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3}},{}],89:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={ASSUME_TOUCH:!1,DEFAULT_MAX_ZOOM:42,DEFAULT_MIN_ZOOM:0,DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD:.5,DEFAULT_TILE_SIZE:256,
DEFAULT_WMS_VERSION:"1.3.0",ENABLE_CANVAS:!0,ENABLE_PROJ4JS:!0,ENABLE_RASTER_REPROJECTION:!0,ENABLE_WEBGL:!0,DEBUG_WEBGL:!0,INITIAL_ATLAS_SIZE:256,MAX_ATLAS_SIZE:-1,MOUSEWHEELZOOM_MAXDELTA:1,OVERVIEWMAP_MAX_RATIO:.75,OVERVIEWMAP_MIN_RATIO:.1,RASTER_REPROJECTION_MAX_SOURCE_TILES:100,RASTER_REPROJECTION_MAX_SUBDIVISION:10,RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH:.25,SIMPLIFY_TOLERANCE:.5,WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK:1024,VERSION:"v4.6.4"};d.WEBGL_MAX_TEXTURE_SIZE;d.WEBGL_EXTENSIONS;d.inherits=
function(a,b){a.prototype=Object.create(b.prototype);a.prototype.constructor=a};d.nullFunction=function(){};d.getUid=function(a){return a.ol_uid||(a.ol_uid=++d.uidCounter_)};d.uidCounter_=0;k.default=d},{}],90:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./collection.js");var c=d(e);e=a("./kinetic.js");var b=d(e);e=a("./interaction/doubleclickzoom.js");var h=d(e);e=a("./interaction/dragpan.js");var n=d(e);e=a("./interaction/dragrotate.js");
var g=d(e);e=a("./interaction/dragzoom.js");var f=d(e);e=a("./interaction/keyboardpan.js");var l=d(e);e=a("./interaction/keyboardzoom.js");var q=d(e);e=a("./interaction/mousewheelzoom.js");var m=d(e);e=a("./interaction/pinchrotate.js");var p=d(e);a=a("./interaction/pinchzoom.js");var r=d(a);k.default={defaults:function(a){a=a?a:{};var d=new c.default,e=new b.default(-.005,.05,100);(void 0!==a.altShiftDragRotate?a.altShiftDragRotate:1)&&d.push(new g.default);(void 0!==a.doubleClickZoom?a.doubleClickZoom:
1)&&d.push(new h.default({delta:a.zoomDelta,duration:a.zoomDuration}));(void 0!==a.dragPan?a.dragPan:1)&&d.push(new n.default({kinetic:e}));(void 0!==a.pinchRotate?a.pinchRotate:1)&&d.push(new p.default);(void 0!==a.pinchZoom?a.pinchZoom:1)&&d.push(new r.default({constrainResolution:a.constrainResolution,duration:a.zoomDuration}));if(void 0!==a.keyboard?a.keyboard:1)d.push(new l.default),d.push(new q.default({delta:a.zoomDelta,duration:a.zoomDuration}));(void 0!==a.mouseWheelZoom?a.mouseWheelZoom:
1)&&d.push(new m.default({constrainResolution:a.constrainResolution,duration:a.zoomDuration}));(void 0!==a.shiftDragZoom?a.shiftDragZoom:1)&&d.push(new f.default({duration:a.zoomDuration}));return d}}},{"./collection.js":34,"./interaction/doubleclickzoom.js":91,"./interaction/dragpan.js":93,"./interaction/dragrotate.js":94,"./interaction/dragzoom.js":95,"./interaction/keyboardpan.js":97,"./interaction/keyboardzoom.js":98,"./interaction/mousewheelzoom.js":99,"./interaction/pinchrotate.js":100,"./interaction/pinchzoom.js":101,
"./kinetic.js":104}],91:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../mapbrowsereventtype.js"),b=d(c);a=a("../interaction/interaction.js");var h=d(a),n=function(a){a=a?a:{};this.delta_=a.delta?a.delta:1;h.default.call(this,{handleEvent:n.handleEvent});this.duration_=void 0!==a.duration?a.duration:250};e.default.inherits(n,h.default);n.handleEvent=function(a){var c=!1,d=a.originalEvent;if(a.type==
b.default.DBLCLICK){c=a.coordinate;d=d.shiftKey?-this.delta_:this.delta_;var e=a.map.getView();h.default.zoomByDelta(e,d,c,this.duration_);a.preventDefault();c=!0}return!c};k.default=n},{"../index.js":89,"../interaction/interaction.js":96,"../mapbrowsereventtype.js":118}],92:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../events/event.js");var c=d(e);e=a("../index.js");e=d(e);var b=a("../events/condition.js"),h=d(b);b=a("../interaction/pointer.js");
var n=d(b);a=a("../render/box.js");var g=d(a),f=function(a){n.default.call(this,{handleDownEvent:f.handleDownEvent_,handleDragEvent:f.handleDragEvent_,handleUpEvent:f.handleUpEvent_});a=a?a:{};this.box_=new g.default(a.className||"ol-dragbox");this.minArea_=void 0!==a.minArea?a.minArea:64;this.startPixel_=null;this.condition_=a.condition?a.condition:h.default.always;this.boxEndCondition_=a.boxEndCondition?a.boxEndCondition:f.defaultBoxEndCondition};e.default.inherits(f,n.default);f.defaultBoxEndCondition=
function(a,b,c){a=c[0]-b[0];b=c[1]-b[1];return a*a+b*b>=this.minArea_};f.handleDragEvent_=function(a){h.default.mouseOnly(a)&&(this.box_.setPixels(this.startPixel_,a.pixel),this.dispatchEvent(new f.Event(f.EventType_.BOXDRAG,a.coordinate,a)))};f.prototype.getGeometry=function(){return this.box_.getGeometry()};f.prototype.onBoxEnd=e.default.nullFunction;f.handleUpEvent_=function(a){if(!h.default.mouseOnly(a))return!0;this.box_.setMap(null);this.boxEndCondition_(a,this.startPixel_,a.pixel)&&(this.onBoxEnd(a),
this.dispatchEvent(new f.Event(f.EventType_.BOXEND,a.coordinate,a)));return!1};f.handleDownEvent_=function(a){return h.default.mouseOnly(a)&&h.default.mouseActionButton(a)&&this.condition_(a)?(this.startPixel_=a.pixel,this.box_.setMap(a.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new f.Event(f.EventType_.BOXSTART,a.coordinate,a)),!0):!1};f.EventType_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"};f.Event=function(a,b,f){c.default.call(this,a);this.coordinate=
b;this.mapBrowserEvent=f};e.default.inherits(f.Event,c.default);k.default=f},{"../events/condition.js":49,"../events/event.js":50,"../index.js":89,"../interaction/pointer.js":102,"../render/box.js":149}],93:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../viewhint.js"),b=d(c);c=a("../coordinate.js");var h=d(c);c=a("../easing.js");var n=d(c);c=a("../events/condition.js");var g=d(c);c=a("../functions.js");
c=d(c);a=a("../interaction/pointer.js");var f=d(a),l=function(a){f.default.call(this,{handleDownEvent:l.handleDownEvent_,handleDragEvent:l.handleDragEvent_,handleUpEvent:l.handleUpEvent_});a=a?a:{};this.kinetic_=a.kinetic;this.lastCentroid=null;this.lastPointersCount_;this.condition_=a.condition?a.condition:g.default.noModifierKeys;this.noKinetic_=!1};e.default.inherits(l,f.default);l.handleDragEvent_=function(a){var b=this.targetPointers,c=f.default.centroid(b);if(b.length==this.lastPointersCount_){if(this.kinetic_&&
this.kinetic_.update(c[0],c[1]),this.lastCentroid){var d=this.lastCentroid[0]-c[0],e=c[1]-this.lastCentroid[1];a=a.map.getView();var g=a.getState();d=[d,e];h.default.scale(d,g.resolution);h.default.rotate(d,g.rotation);h.default.add(d,g.center);d=a.constrainCenter(d);a.setCenter(d)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=c;this.lastPointersCount_=b.length};l.handleUpEvent_=function(a){var c=a.map;a=c.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&
this.kinetic_.end()){var f=this.kinetic_.getDistance(),d=this.kinetic_.getAngle(),e=a.getCenter();e=c.getPixelFromCoordinate(e);c=c.getCoordinateFromPixel([e[0]-f*Math.cos(d),e[1]-f*Math.sin(d)]);a.animate({center:a.constrainCenter(c),duration:500,easing:n.default.easeOut})}a.setHint(b.default.INTERACTING,-1);return!1}this.kinetic_&&this.kinetic_.begin();this.lastCentroid=null;return!0};l.handleDownEvent_=function(a){if(0<this.targetPointers.length&&this.condition_(a)){var c=a.map.getView();this.lastCentroid=
null;this.handlingDownUpSequence||c.setHint(b.default.INTERACTING,1);c.getAnimating()&&c.setCenter(a.frameState.viewState.center);this.kinetic_&&this.kinetic_.begin();this.noKinetic_=1<this.targetPointers.length;return!0}return!1};l.prototype.shouldStopEvent=c.default.FALSE;k.default=l},{"../coordinate.js":43,"../easing.js":47,"../events/condition.js":49,"../functions.js":60,"../index.js":89,"../interaction/pointer.js":102,"../viewhint.js":246}],94:[function(a,e,k){function d(a){return a&&a.__esModule?
a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../rotationconstraint.js"),b=d(c);c=a("../viewhint.js");var h=d(c);c=a("../events/condition.js");var n=d(c);c=a("../functions.js");c=d(c);var g=a("../interaction/interaction.js"),f=d(g);a=a("../interaction/pointer.js");var l=d(a),q=function(a){a=a?a:{};l.default.call(this,{handleDownEvent:q.handleDownEvent_,handleDragEvent:q.handleDragEvent_,handleUpEvent:q.handleUpEvent_});this.condition_=a.condition?
a.condition:n.default.altShiftKeysOnly;this.lastAngle_=void 0;this.duration_=void 0!==a.duration?a.duration:250};e.default.inherits(q,l.default);q.handleDragEvent_=function(a){if(n.default.mouseOnly(a)){var c=a.map,d=c.getView();if(d.getConstraints().rotation!==b.default.disable){c=c.getSize();a=a.pixel;a=Math.atan2(c[1]/2-a[1],a[0]-c[0]/2);if(void 0!==this.lastAngle_){c=a-this.lastAngle_;var e=d.getRotation();f.default.rotateWithoutConstraints(d,e-c)}this.lastAngle_=a}}};q.handleUpEvent_=function(a){if(!n.default.mouseOnly(a))return!0;
a=a.map.getView();a.setHint(h.default.INTERACTING,-1);var b=a.getRotation();f.default.rotate(a,b,void 0,this.duration_);return!1};q.handleDownEvent_=function(a){return n.default.mouseOnly(a)&&n.default.mouseActionButton(a)&&this.condition_(a)?(a.map.getView().setHint(h.default.INTERACTING,1),this.lastAngle_=void 0,!0):!1};q.prototype.shouldStopEvent=c.default.FALSE;k.default=q},{"../events/condition.js":49,"../functions.js":60,"../index.js":89,"../interaction/interaction.js":96,"../interaction/pointer.js":102,
"../rotationconstraint.js":207,"../viewhint.js":246}],95:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../easing.js"),b=d(c);c=a("../events/condition.js");var h=d(c);c=a("../extent.js");var n=d(c);a=a("../interaction/dragbox.js");var g=d(a);a=function(a){a=a?a:{};var b=a.condition?a.condition:h.default.shiftKeyOnly;this.duration_=void 0!==a.duration?a.duration:200;this.out_=void 0!==a.out?a.out:
!1;g.default.call(this,{condition:b,className:a.className||"ol-dragzoom"})};e.default.inherits(a,g.default);a.prototype.onBoxEnd=function(){var a=this.getMap(),c=a.getView(),d=a.getSize(),e=this.getGeometry().getExtent();if(this.out_){var g=c.calculateExtent(d);e=n.default.createOrUpdateFromCoordinates([a.getPixelFromCoordinate(n.default.getBottomLeft(e)),a.getPixelFromCoordinate(n.default.getTopRight(e))]);e=c.getResolutionForExtent(e,d);n.default.scaleFromCenter(g,1/e);e=g}d=c.constrainResolution(c.getResolutionForExtent(e,
d));g=n.default.getCenter(e);g=c.constrainCenter(g);c.animate({resolution:d,center:g,duration:this.duration_,easing:b.default.easeOut})};k.default=a},{"../easing.js":47,"../events/condition.js":49,"../extent.js":54,"../index.js":89,"../interaction/dragbox.js":92}],96:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../object.js"),b=d(c);c=a("../easing.js");var h=d(c);c=a("../interaction/property.js");
var n=d(c);a=a("../math.js");var g=d(a),f=function(a){b.default.call(this);this.map_=null;this.setActive(!0);this.handleEvent=a.handleEvent};e.default.inherits(f,b.default);f.prototype.getActive=function(){return this.get(n.default.ACTIVE)};f.prototype.getMap=function(){return this.map_};f.prototype.setActive=function(a){this.set(n.default.ACTIVE,a)};f.prototype.setMap=function(a){this.map_=a};f.pan=function(a,b,c){var f=a.getCenter();f&&(b=a.constrainCenter([f[0]+b[0],f[1]+b[1]]),c?a.animate({duration:c,
easing:h.default.linear,center:b}):a.setCenter(b))};f.rotate=function(a,b,c,d){b=a.constrainRotation(b,0);f.rotateWithoutConstraints(a,b,c,d)};f.rotateWithoutConstraints=function(a,b,c,f){if(void 0!==b){var d=a.getRotation(),e=a.getCenter();void 0!==d&&e&&0<f?a.animate({rotation:b,anchor:c,duration:f,easing:h.default.easeOut}):a.rotate(b,c)}};f.zoom=function(a,b,c,d,e){b=a.constrainResolution(b,0,e);f.zoomWithoutConstraints(a,b,c,d)};f.zoomByDelta=function(a,b,c,d){var e=a.getResolution();b=a.constrainResolution(e,
b,0);if(void 0!==b){var l=a.getResolutions();b=g.default.clamp(b,a.getMinResolution()||l[l.length-1],a.getMaxResolution()||l[0])}c&&void 0!==b&&b!==e&&(l=a.getCenter(),c=a.calculateCenterZoom(b,c),c=a.constrainCenter(c),c=[(b*l[0]-e*c[0])/(b-e),(b*l[1]-e*c[1])/(b-e)]);f.zoomWithoutConstraints(a,b,c,d)};f.zoomWithoutConstraints=function(a,b,c,f){if(b){var d=a.getResolution(),e=a.getCenter();void 0!==d&&e&&b!==d&&f?a.animate({resolution:b,anchor:c,duration:f,easing:h.default.easeOut}):(c&&(c=a.calculateCenterZoom(b,
c),a.setCenter(c)),a.setResolution(b))}};k.default=f},{"../easing.js":47,"../index.js":89,"../interaction/property.js":103,"../math.js":123,"../object.js":125}],97:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../coordinate.js"),b=d(c);c=a("../events/eventtype.js");var h=d(c);c=a("../events/keycode.js");var n=d(c);c=a("../events/condition.js");var g=d(c);a=a("../interaction/interaction.js");var f=
d(a),l=function(a){f.default.call(this,{handleEvent:l.handleEvent});a=a||{};this.defaultCondition_=function(a){return g.default.noModifierKeys(a)&&g.default.targetNotEditable(a)};this.condition_=void 0!==a.condition?a.condition:this.defaultCondition_;this.duration_=void 0!==a.duration?a.duration:100;this.pixelDelta_=void 0!==a.pixelDelta?a.pixelDelta:128};e.default.inherits(l,f.default);l.handleEvent=function(a){var c=!1;if(a.type==h.default.KEYDOWN){var d=a.originalEvent.keyCode;if(this.condition_(a)&&
(d==n.default.DOWN||d==n.default.LEFT||d==n.default.RIGHT||d==n.default.UP)){c=a.map.getView();var e=c.getResolution()*this.pixelDelta_,g=0,l=0;d==n.default.DOWN?l=-e:d==n.default.LEFT?g=-e:d==n.default.RIGHT?g=e:l=e;d=[g,l];b.default.rotate(d,c.getRotation());f.default.pan(c,d,this.duration_);a.preventDefault();c=!0}}return!c};k.default=l},{"../coordinate.js":43,"../events/condition.js":49,"../events/eventtype.js":52,"../events/keycode.js":53,"../index.js":89,"../interaction/interaction.js":96}],
98:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../events/eventtype.js"),b=d(c);c=a("../events/condition.js");var h=d(c);a=a("../interaction/interaction.js");var n=d(a),g=function(a){n.default.call(this,{handleEvent:g.handleEvent});a=a?a:{};this.condition_=a.condition?a.condition:h.default.targetNotEditable;this.delta_=a.delta?a.delta:1;this.duration_=void 0!==a.duration?a.duration:100};e.default.inherits(g,
n.default);g.handleEvent=function(a){var c=!1;if(a.type==b.default.KEYDOWN||a.type==b.default.KEYPRESS){var f=a.originalEvent.charCode;!this.condition_(a)||43!=f&&45!=f||(c=43==f?this.delta_:-this.delta_,f=a.map.getView(),n.default.zoomByDelta(f,c,void 0,this.duration_),a.preventDefault(),c=!0)}return!c};k.default=g},{"../events/condition.js":49,"../events/eventtype.js":52,"../index.js":89,"../interaction/interaction.js":96}],99:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}
Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../viewhint.js");var b=d(e);e=a("../easing.js");var h=d(e);e=a("../events/eventtype.js");var n=d(e);e=a("../has.js");var g=d(e);e=a("../interaction/interaction.js");var f=d(e);a=a("../math.js");var l=d(a),q=function(a){f.default.call(this,{handleEvent:q.handleEvent});a=a||{};this.delta_=0;this.duration_=void 0!==a.duration?a.duration:250;this.timeout_=void 0!==a.timeout?a.timeout:80;this.useAnchor_=void 0!==a.useAnchor?
a.useAnchor:!0;this.constrainResolution_=a.constrainResolution||!1;this.lastAnchor_=null;this.mode_=this.timeoutId_=this.startTime_=void 0;this.trackpadEventGap_=400;this.trackpadTimeoutId_=void 0;this.trackpadDeltaPerZoom_=300;this.trackpadZoomBuffer_=1.5};c.default.inherits(q,f.default);q.handleEvent=function(a){var c=a.type;if(c!==n.default.WHEEL&&c!==n.default.MOUSEWHEEL)return!0;a.preventDefault();c=a.map;var f=a.originalEvent;this.useAnchor_&&(this.lastAnchor_=a.coordinate);if(a.type==n.default.WHEEL){var d=
f.deltaY;g.default.FIREFOX&&f.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(d/=g.default.DEVICE_PIXEL_RATIO);f.deltaMode===WheelEvent.DOM_DELTA_LINE&&(d*=40)}else a.type==n.default.MOUSEWHEEL&&(d=-f.wheelDeltaY,g.default.SAFARI&&(d/=3));if(0===d)return!1;a=Date.now();void 0===this.startTime_&&(this.startTime_=a);if(!this.mode_||a-this.startTime_>this.trackpadEventGap_)this.mode_=4>Math.abs(d)?q.Mode_.TRACKPAD:q.Mode_.WHEEL;if(this.mode_===q.Mode_.TRACKPAD){c=c.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):
c.setHint(b.default.INTERACTING,1);this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);f=c.getResolution()*Math.pow(2,d/this.trackpadDeltaPerZoom_);var e=c.getMinResolution(),l=c.getMaxResolution(),m=0;f<e?(f=Math.max(f,e/this.trackpadZoomBuffer_),m=1):f>l&&(f=Math.min(f,l*this.trackpadZoomBuffer_),m=-1);if(this.lastAnchor_){var k=c.calculateCenterZoom(f,this.lastAnchor_);c.setCenter(c.constrainCenter(k))}c.setResolution(f);0===m&&this.constrainResolution_&&
c.animate({resolution:c.constrainResolution(f,0<d?-1:1),easing:h.default.easeOut,anchor:this.lastAnchor_,duration:this.duration_});0<m?c.animate({resolution:e,easing:h.default.easeOut,anchor:this.lastAnchor_,duration:500}):0>m&&c.animate({resolution:l,easing:h.default.easeOut,anchor:this.lastAnchor_,duration:500});this.startTime_=a;return!1}this.delta_+=d;d=Math.max(this.timeout_-(a-this.startTime_),0);clearTimeout(this.timeoutId_);this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,c),d);
return!1};q.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0;this.getMap().getView().setHint(b.default.INTERACTING,-1)};q.prototype.handleWheelZoom_=function(a){a=a.getView();a.getAnimating()&&a.cancelAnimations();var b=c.default.MOUSEWHEELZOOM_MAXDELTA;b=l.default.clamp(this.delta_,-b,b);f.default.zoomByDelta(a,-b,this.lastAnchor_,this.duration_);this.mode_=void 0;this.delta_=0;this.lastAnchor_=null;this.timeoutId_=this.startTime_=void 0};q.prototype.setMouseAnchor=function(a){this.useAnchor_=
a;a||(this.lastAnchor_=null)};q.Mode_={TRACKPAD:"trackpad",WHEEL:"wheel"};k.default=q},{"../easing.js":47,"../events/eventtype.js":52,"../has.js":84,"../index.js":89,"../interaction/interaction.js":96,"../math.js":123,"../viewhint.js":246}],100:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../viewhint.js"),b=d(c);c=a("../functions.js");c=d(c);var h=a("../interaction/interaction.js"),n=d(h);h=
a("../interaction/pointer.js");var g=d(h);a=a("../rotationconstraint.js");var f=d(a),l=function(a){g.default.call(this,{handleDownEvent:l.handleDownEvent_,handleDragEvent:l.handleDragEvent_,handleUpEvent:l.handleUpEvent_});a=a||{};this.anchor_=null;this.lastAngle_=void 0;this.rotating_=!1;this.rotationDelta_=0;this.threshold_=void 0!==a.threshold?a.threshold:.3;this.duration_=void 0!==a.duration?a.duration:250};e.default.inherits(l,g.default);l.handleDragEvent_=function(a){var b=0,c=this.targetPointers[0],
d=this.targetPointers[1];c=Math.atan2(d.clientY-c.clientY,d.clientX-c.clientX);void 0!==this.lastAngle_&&(b=c-this.lastAngle_,this.rotationDelta_+=b,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0));this.lastAngle_=c;a=a.map;c=a.getView();if(c.getConstraints().rotation!==f.default.disable){d=a.getViewport().getBoundingClientRect();var e=g.default.centroid(this.targetPointers);e[0]-=d.left;e[1]-=d.top;this.anchor_=a.getCoordinateFromPixel(e);this.rotating_&&(d=c.getRotation(),
a.render(),n.default.rotateWithoutConstraints(c,d+b,this.anchor_))}};l.handleUpEvent_=function(a){if(2>this.targetPointers.length){a=a.map.getView();a.setHint(b.default.INTERACTING,-1);if(this.rotating_){var c=a.getRotation();n.default.rotate(a,c,this.anchor_,this.duration_)}return!1}return!0};l.handleDownEvent_=function(a){return 2<=this.targetPointers.length?(a=a.map,this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||a.getView().setHint(b.default.INTERACTING,
1),!0):!1};l.prototype.shouldStopEvent=c.default.FALSE;k.default=l},{"../functions.js":60,"../index.js":89,"../interaction/interaction.js":96,"../interaction/pointer.js":102,"../rotationconstraint.js":207,"../viewhint.js":246}],101:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../viewhint.js"),b=d(c);c=a("../functions.js");c=d(c);var h=a("../interaction/interaction.js"),n=d(h);a=a("../interaction/pointer.js");
var g=d(a),f=function(a){g.default.call(this,{handleDownEvent:f.handleDownEvent_,handleDragEvent:f.handleDragEvent_,handleUpEvent:f.handleUpEvent_});a=a?a:{};this.constrainResolution_=a.constrainResolution||!1;this.anchor_=null;this.duration_=void 0!==a.duration?a.duration:400;this.lastDistance_=void 0;this.lastScaleDelta_=1};e.default.inherits(f,g.default);f.handleDragEvent_=function(a){var b=1,c=this.targetPointers[0],f=this.targetPointers[1],d=c.clientX-f.clientX;c=c.clientY-f.clientY;d=Math.sqrt(d*
d+c*c);void 0!==this.lastDistance_&&(b=this.lastDistance_/d);this.lastDistance_=d;a=a.map;d=a.getView();f=d.getResolution();var e=d.getMaxResolution(),l=d.getMinResolution();c=f*b;c>e?(b=e/f,c=e):c<l&&(b=l/f,c=l);1!=b&&(this.lastScaleDelta_=b);b=a.getViewport().getBoundingClientRect();f=g.default.centroid(this.targetPointers);f[0]-=b.left;f[1]-=b.top;this.anchor_=a.getCoordinateFromPixel(f);a.render();n.default.zoomWithoutConstraints(d,c,this.anchor_)};f.handleUpEvent_=function(a){if(2>this.targetPointers.length){a=
a.map.getView();a.setHint(b.default.INTERACTING,-1);var c=a.getResolution();(this.constrainResolution_||c<a.getMinResolution()||c>a.getMaxResolution())&&n.default.zoom(a,c,this.anchor_,this.duration_,this.lastScaleDelta_-1);return!1}return!0};f.handleDownEvent_=function(a){return 2<=this.targetPointers.length?(a=a.map,this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||a.getView().setHint(b.default.INTERACTING,1),!0):!1};f.prototype.shouldStopEvent=c.default.FALSE;
k.default=f},{"../functions.js":60,"../index.js":89,"../interaction/interaction.js":96,"../interaction/pointer.js":102,"../viewhint.js":246}],102:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../functions.js");c=d(c);var b=a("../mapbrowsereventtype.js"),h=d(b);b=a("../mapbrowserpointerevent.js");var n=d(b);b=a("../interaction/interaction.js");var g=d(b);a=a("../obj.js");var f=d(a),l=function(a){a=
a?a:{};g.default.call(this,{handleEvent:a.handleEvent?a.handleEvent:l.handleEvent});this.handleDownEvent_=a.handleDownEvent?a.handleDownEvent:l.handleDownEvent;this.handleDragEvent_=a.handleDragEvent?a.handleDragEvent:l.handleDragEvent;this.handleMoveEvent_=a.handleMoveEvent?a.handleMoveEvent:l.handleMoveEvent;this.handleUpEvent_=a.handleUpEvent?a.handleUpEvent:l.handleUpEvent;this.handlingDownUpSequence=!1;this.trackedPointers_={};this.targetPointers=[]};e.default.inherits(l,g.default);l.centroid=
function(a){for(var b=a.length,c=0,f=0,d=0;d<b;d++)c+=a[d].clientX,f+=a[d].clientY;return[c/b,f/b]};l.prototype.isPointerDraggingEvent_=function(a){a=a.type;return a===h.default.POINTERDOWN||a===h.default.POINTERDRAG||a===h.default.POINTERUP};l.prototype.updateTrackedPointers_=function(a){if(this.isPointerDraggingEvent_(a)){var b=a.pointerEvent,c=b.pointerId.toString();a.type==h.default.POINTERUP?delete this.trackedPointers_[c]:a.type==h.default.POINTERDOWN?this.trackedPointers_[c]=b:c in this.trackedPointers_&&
(this.trackedPointers_[c]=b);this.targetPointers=f.default.getValues(this.trackedPointers_)}};l.handleDragEvent=e.default.nullFunction;l.handleUpEvent=c.default.FALSE;l.handleDownEvent=c.default.FALSE;l.handleMoveEvent=e.default.nullFunction;l.handleEvent=function(a){if(!(a instanceof n.default))return!0;var b=!1;this.updateTrackedPointers_(a);this.handlingDownUpSequence?a.type==h.default.POINTERDRAG?this.handleDragEvent_(a):a.type==h.default.POINTERUP&&(this.handlingDownUpSequence=this.handleUpEvent_(a)&&
0<this.targetPointers.length):a.type==h.default.POINTERDOWN?(this.handlingDownUpSequence=a=this.handleDownEvent_(a),b=this.shouldStopEvent(a)):a.type==h.default.POINTERMOVE&&this.handleMoveEvent_(a);return!b};l.prototype.shouldStopEvent=function(a){return a};k.default=l},{"../functions.js":60,"../index.js":89,"../interaction/interaction.js":96,"../mapbrowsereventtype.js":118,"../mapbrowserpointerevent.js":119,"../obj.js":124}],103:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});
k.default={ACTIVE:"active"}},{}],104:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(a,c,b){this.decay_=a;this.minVelocity_=c;this.delay_=b;this.points_=[];this.initialVelocity_=this.angle_=0};a.prototype.begin=function(){this.initialVelocity_=this.angle_=this.points_.length=0};a.prototype.update=function(a,c){this.points_.push(a,c,Date.now())};a.prototype.end=function(){if(6>this.points_.length)return!1;var a=Date.now()-this.delay_,c=this.points_.length-3;if(this.points_[c+
2]<a)return!1;for(var b=c-3;0<b&&this.points_[b+2]>a;)b-=3;a=this.points_[c+2]-this.points_[b+2];if(a<1E3/60)return!1;var e=this.points_[c]-this.points_[b];c=this.points_[c+1]-this.points_[b+1];this.angle_=Math.atan2(c,e);this.initialVelocity_=Math.sqrt(e*e+c*c)/a;return this.initialVelocity_>this.minVelocity_};a.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_};a.prototype.getAngle=function(){return this.angle_};k.default=a},{}],105:[function(a,e,k){function d(a){return a&&
a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../object.js"),b=d(c);c=a("../layer/property.js");var h=d(c);c=a("../math.js");var n=d(c);a=a("../obj.js");var g=d(a);a=function(a){b.default.call(this);var c=g.default.assign({},a);c[h.default.OPACITY]=void 0!==a.opacity?a.opacity:1;c[h.default.VISIBLE]=void 0!==a.visible?a.visible:!0;c[h.default.Z_INDEX]=void 0!==a.zIndex?a.zIndex:0;c[h.default.MAX_RESOLUTION]=void 0!==a.maxResolution?
a.maxResolution:Infinity;c[h.default.MIN_RESOLUTION]=void 0!==a.minResolution?a.minResolution:0;this.setProperties(c);this.state_={layer:this,managed:!0};this.type};e.default.inherits(a,b.default);a.prototype.getType=function(){return this.type};a.prototype.getLayerState=function(){this.state_.opacity=n.default.clamp(this.getOpacity(),0,1);this.state_.sourceState=this.getSourceState();this.state_.visible=this.getVisible();this.state_.extent=this.getExtent();this.state_.zIndex=this.getZIndex();this.state_.maxResolution=
this.getMaxResolution();this.state_.minResolution=Math.max(this.getMinResolution(),0);return this.state_};a.prototype.getLayersArray=function(a){};a.prototype.getLayerStatesArray=function(a){};a.prototype.getExtent=function(){return this.get(h.default.EXTENT)};a.prototype.getMaxResolution=function(){return this.get(h.default.MAX_RESOLUTION)};a.prototype.getMinResolution=function(){return this.get(h.default.MIN_RESOLUTION)};a.prototype.getOpacity=function(){return this.get(h.default.OPACITY)};a.prototype.getSourceState=
function(){};a.prototype.getVisible=function(){return this.get(h.default.VISIBLE)};a.prototype.getZIndex=function(){return this.get(h.default.Z_INDEX)};a.prototype.setExtent=function(a){this.set(h.default.EXTENT,a)};a.prototype.setMaxResolution=function(a){this.set(h.default.MAX_RESOLUTION,a)};a.prototype.setMinResolution=function(a){this.set(h.default.MIN_RESOLUTION,a)};a.prototype.setOpacity=function(a){this.set(h.default.OPACITY,a)};a.prototype.setVisible=function(a){this.set(h.default.VISIBLE,
a)};a.prototype.setZIndex=function(a){this.set(h.default.Z_INDEX,a)};k.default=a},{"../index.js":89,"../layer/property.js":109,"../math.js":123,"../obj.js":124,"../object.js":125}],106:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../collection.js");var b=d(e);e=a("../collectioneventtype.js");var h=d(e);e=a("../object.js");var n=d(e);e=a("../objecteventtype.js");var g=d(e);e=a("../asserts.js");
var f=d(e);e=a("../events.js");var l=d(e);e=a("../events/eventtype.js");var q=d(e);e=a("../extent.js");var m=d(e);e=a("../layer/base.js");var p=d(e);e=a("../obj.js");var r=d(e);a=a("../source/state.js");var t=d(a),u=function(a){var c=a||{};a=r.default.assign({},c);delete a.layers;c=c.layers;p.default.call(this,a);this.layersListenerKeys_=[];this.listenerKeys_={};l.default.listen(this,n.default.getChangeEventType(u.Property_.LAYERS),this.handleLayersChanged_,this);c?Array.isArray(c)?c=new b.default(c.slice(),
{unique:!0}):f.default.assert(c instanceof b.default,43):c=new b.default(void 0,{unique:!0});this.setLayers(c)};c.default.inherits(u,p.default);u.prototype.handleLayerChange_=function(){this.changed()};u.prototype.handleLayersChanged_=function(a){this.layersListenerKeys_.forEach(l.default.unlistenByKey);this.layersListenerKeys_.length=0;a=this.getLayers();this.layersListenerKeys_.push(l.default.listen(a,h.default.ADD,this.handleLayersAdd_,this),l.default.listen(a,h.default.REMOVE,this.handleLayersRemove_,
this));for(var b in this.listenerKeys_)this.listenerKeys_[b].forEach(l.default.unlistenByKey);r.default.clear(this.listenerKeys_);b=a.getArray();var f;a=0;for(f=b.length;a<f;a++){var d=b[a];this.listenerKeys_[c.default.getUid(d).toString()]=[l.default.listen(d,g.default.PROPERTYCHANGE,this.handleLayerChange_,this),l.default.listen(d,q.default.CHANGE,this.handleLayerChange_,this)]}this.changed()};u.prototype.handleLayersAdd_=function(a){a=a.element;var b=c.default.getUid(a).toString();this.listenerKeys_[b]=
[l.default.listen(a,g.default.PROPERTYCHANGE,this.handleLayerChange_,this),l.default.listen(a,q.default.CHANGE,this.handleLayerChange_,this)];this.changed()};u.prototype.handleLayersRemove_=function(a){a=c.default.getUid(a.element).toString();this.listenerKeys_[a].forEach(l.default.unlistenByKey);delete this.listenerKeys_[a];this.changed()};u.prototype.getLayers=function(){return this.get(u.Property_.LAYERS)};u.prototype.setLayers=function(a){this.set(u.Property_.LAYERS,a)};u.prototype.getLayersArray=
function(a){var b=void 0!==a?a:[];this.getLayers().forEach(function(a){a.getLayersArray(b)});return b};u.prototype.getLayerStatesArray=function(a){var b=void 0!==a?a:[],c=b.length;this.getLayers().forEach(function(a){a.getLayerStatesArray(b)});a=this.getLayerState();var f;for(f=b.length;c<f;c++){var d=b[c];d.opacity*=a.opacity;d.visible=d.visible&&a.visible;d.maxResolution=Math.min(d.maxResolution,a.maxResolution);d.minResolution=Math.max(d.minResolution,a.minResolution);void 0!==a.extent&&(d.extent=
void 0!==d.extent?m.default.getIntersection(d.extent,a.extent):a.extent)}return b};u.prototype.getSourceState=function(){return t.default.READY};u.Property_={LAYERS:"layers"};k.default=u},{"../asserts.js":31,"../collection.js":34,"../collectioneventtype.js":35,"../events.js":48,"../events/eventtype.js":52,"../extent.js":54,"../index.js":89,"../layer/base.js":105,"../obj.js":124,"../object.js":125,"../objecteventtype.js":126,"../source/state.js":212}],107:[function(a,e,k){function d(a){return a&&a.__esModule?
a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../layertype.js"),b=d(c);a=a("../layer/layer.js");var h=d(a);a=function(a){h.default.call(this,a?a:{});this.type=b.default.IMAGE};e.default.inherits(a,h.default);a.prototype.getSource;k.default=a},{"../index.js":89,"../layer/layer.js":108,"../layertype.js":113}],108:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../events.js");
var c=d(e);e=a("../events/eventtype.js");var b=d(e);e=a("../index.js");var h=d(e);e=a("../object.js");var n=d(e);e=a("../layer/base.js");var g=d(e);e=a("../layer/property.js");var f=d(e);e=a("../obj.js");var l=d(e);e=a("../render/eventtype.js");var q=d(e);a=a("../source/state.js");var m=d(a);a=function(a){var b=l.default.assign({},a);delete b.source;g.default.call(this,b);this.sourceChangeKey_=this.mapRenderKey_=this.mapPrecomposeKey_=null;a.map&&this.setMap(a.map);c.default.listen(this,n.default.getChangeEventType(f.default.SOURCE),
this.handleSourcePropertyChange_,this);this.setSource(a.source?a.source:null)};h.default.inherits(a,g.default);a.visibleAtResolution=function(a,b){return a.visible&&b>=a.minResolution&&b<a.maxResolution};a.prototype.getLayersArray=function(a){a=a?a:[];a.push(this);return a};a.prototype.getLayerStatesArray=function(a){a=a?a:[];a.push(this.getLayerState());return a};a.prototype.getSource=function(){return this.get(f.default.SOURCE)||null};a.prototype.getSourceState=function(){var a=this.getSource();
return a?a.getState():m.default.UNDEFINED};a.prototype.handleSourceChange_=function(){this.changed()};a.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(c.default.unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var a=this.getSource();a&&(this.sourceChangeKey_=c.default.listen(a,b.default.CHANGE,this.handleSourceChange_,this));this.changed()};a.prototype.setMap=function(a){this.mapPrecomposeKey_&&(c.default.unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=
null);a||this.changed();this.mapRenderKey_&&(c.default.unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null);a&&(this.mapPrecomposeKey_=c.default.listen(a,q.default.PRECOMPOSE,function(a){var b=this.getLayerState();b.managed=!1;b.zIndex=Infinity;a.frameState.layerStatesArray.push(b);a.frameState.layerStates[h.default.getUid(this)]=b},this),this.mapRenderKey_=c.default.listen(this,b.default.CHANGE,a.render,a),this.changed())};a.prototype.setSource=function(a){this.set(f.default.SOURCE,a)};k.default=
a},{"../events.js":48,"../events/eventtype.js":52,"../index.js":89,"../layer/base.js":105,"../layer/property.js":109,"../obj.js":124,"../object.js":125,"../render/eventtype.js":160,"../source/state.js":212}],109:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"}},{}],110:[function(a,e,k){function d(a){return a&&a.__esModule?a:
{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../layertype.js"),b=d(c);c=a("../layer/layer.js");var h=d(c);c=a("../layer/vectorrendertype.js");var n=d(c);c=a("../obj.js");var g=d(c);a=a("../style/style.js");var f=d(a),l=function(a){a=a?a:{};var c=g.default.assign({},a);delete c.style;delete c.renderBuffer;delete c.updateWhileAnimating;delete c.updateWhileInteracting;h.default.call(this,c);this.declutter_=void 0!==a.declutter?a.declutter:!1;this.renderBuffer_=
void 0!==a.renderBuffer?a.renderBuffer:100;this.style_=null;this.styleFunction_=void 0;this.setStyle(a.style);this.updateWhileAnimating_=void 0!==a.updateWhileAnimating?a.updateWhileAnimating:!1;this.updateWhileInteracting_=void 0!==a.updateWhileInteracting?a.updateWhileInteracting:!1;this.renderMode_=a.renderMode||n.default.VECTOR;this.type=b.default.VECTOR};e.default.inherits(l,h.default);l.prototype.getDeclutter=function(){return this.declutter_};l.prototype.setDeclutter=function(a){this.declutter_=
a};l.prototype.getRenderBuffer=function(){return this.renderBuffer_};l.prototype.getRenderOrder=function(){return this.get(l.Property_.RENDER_ORDER)};l.prototype.getSource;l.prototype.getStyle=function(){return this.style_};l.prototype.getStyleFunction=function(){return this.styleFunction_};l.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_};l.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_};l.prototype.setRenderOrder=function(a){this.set(l.Property_.RENDER_ORDER,
a)};l.prototype.setStyle=function(a){this.style_=void 0!==a?a:f.default.defaultFunction;this.styleFunction_=null===a?void 0:f.default.createFunction(this.style_);this.changed()};l.prototype.getRenderMode=function(){return this.renderMode_};l.Property_={RENDER_ORDER:"renderOrder"};k.default=l},{"../index.js":89,"../layer/layer.js":108,"../layer/vectorrendertype.js":111,"../layertype.js":113,"../obj.js":124,"../style/style.js":234}],111:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});
k.default={IMAGE:"image",VECTOR:"vector"}},{}],112:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"}},{}],113:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"}},{}],114:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={all:function(a,c){return[[-Infinity,-Infinity,Infinity,Infinity]]},bbox:function(a,c){return[a]},
tile:function(a){return function(c,b){b=a.getZForResolution(b);c=a.getTileRangeForExtentAndZ(c,b);var d=[];b=[b,0,0];for(b[1]=c.minX;b[1]<=c.maxX;++b[1])for(b[2]=c.minY;b[2]<=c.maxY;++b[2])d.push(a.getTileCoordExtent(b));return d}}}},{}],115:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./pluggablemap.js"),b=d(c);c=a("./plugintype.js");c=d(c);var h=a("./control.js"),n=d(h);h=a("./interaction.js");
var g=d(h);h=a("./obj.js");var f=d(h);h=a("./plugins.js");h=d(h);var l=a("./renderer/canvas/imagelayer.js");l=d(l);var q=a("./renderer/canvas/map.js");q=d(q);var m=a("./renderer/canvas/tilelayer.js");m=d(m);var p=a("./renderer/canvas/vectorlayer.js");p=d(p);var r=a("./renderer/canvas/vectortilelayer.js");r=d(r);var t=a("./renderer/webgl/imagelayer.js");t=d(t);var u=a("./renderer/webgl/map.js");u=d(u);var y=a("./renderer/webgl/tilelayer.js");y=d(y);a=a("./renderer/webgl/vectorlayer.js");a=d(a);e.default.ENABLE_CANVAS&&
(h.default.register(c.default.MAP_RENDERER,q.default),h.default.registerMultiple(c.default.LAYER_RENDERER,[l.default,m.default,p.default,r.default]));e.default.ENABLE_WEBGL&&(h.default.register(c.default.MAP_RENDERER,u.default),h.default.registerMultiple(c.default.LAYER_RENDERER,[t.default,y.default,a.default]));a=function(a){a=f.default.assign({},a);a.controls||(a.controls=n.default.defaults());a.interactions||(a.interactions=g.default.defaults());b.default.call(this,a)};e.default.inherits(a,b.default);
k.default=a},{"./control.js":38,"./index.js":89,"./interaction.js":90,"./obj.js":124,"./pluggablemap.js":130,"./plugins.js":131,"./plugintype.js":132,"./renderer/canvas/imagelayer.js":183,"./renderer/canvas/map.js":186,"./renderer/canvas/tilelayer.js":187,"./renderer/canvas/vectorlayer.js":188,"./renderer/canvas/vectortilelayer.js":189,"./renderer/webgl/imagelayer.js":196,"./renderer/webgl/map.js":198,"./renderer/webgl/tilelayer.js":199,"./renderer/webgl/vectorlayer.js":202}],116:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});e=(e=a("./index.js"))&&e.__esModule?e:{default:e};var d=(a=a("./mapevent.js"))&&a.__esModule?a:{default:a};a=function(a,b,e,n,g){d.default.call(this,a,b,g);this.originalEvent=e;this.pixel=b.getEventPixel(e);this.coordinate=b.getCoordinateFromPixel(this.pixel);this.dragging=void 0!==n?n:!1};e.default.inherits(a,d.default);a.prototype.preventDefault=function(){d.default.prototype.preventDefault.call(this);this.originalEvent.preventDefault()};a.prototype.stopPropagation=function(){d.default.prototype.stopPropagation.call(this);
this.originalEvent.stopPropagation()};k.default=a},{"./index.js":89,"./mapevent.js":120}],117:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./has.js"),b=d(c);c=a("./mapbrowsereventtype.js");var h=d(c);c=a("./mapbrowserpointerevent.js");var n=d(c);c=a("./events.js");var g=d(c);c=a("./events/eventtarget.js");var f=d(c);c=a("./pointer/eventtype.js");var l=d(c);a=a("./pointer/pointereventhandler.js");
var q=d(a);a=function(a,c){f.default.call(this);this.map_=a;this.clickTimeoutId_=0;this.dragging_=!1;this.dragListenerKeys_=[];this.moveTolerance_=c?c*b.default.DEVICE_PIXEL_RATIO:b.default.DEVICE_PIXEL_RATIO;this.down_=null;a=this.map_.getViewport();this.activePointers_=0;this.trackedTouches_={};this.pointerEventHandler_=new q.default(a);this.documentPointerEventHandler_=null;this.pointerdownListenerKey_=g.default.listen(this.pointerEventHandler_,l.default.POINTERDOWN,this.handlePointerDown_,this);
this.relayedListenerKey_=g.default.listen(this.pointerEventHandler_,l.default.POINTERMOVE,this.relayEvent_,this)};e.default.inherits(a,f.default);a.prototype.emulateClick_=function(a){var b=new n.default(h.default.CLICK,this.map_,a);this.dispatchEvent(b);0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,b=new n.default(h.default.DBLCLICK,this.map_,a),this.dispatchEvent(b)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var b=new n.default(h.default.SINGLECLICK,
this.map_,a);this.dispatchEvent(b)}.bind(this),250)};a.prototype.updateActivePointers_=function(a){a.type==h.default.POINTERUP||a.type==h.default.POINTERCANCEL?delete this.trackedTouches_[a.pointerId]:a.type==h.default.POINTERDOWN&&(this.trackedTouches_[a.pointerId]=!0);this.activePointers_=Object.keys(this.trackedTouches_).length};a.prototype.handlePointerUp_=function(a){this.updateActivePointers_(a);var b=new n.default(h.default.POINTERUP,this.map_,a);this.dispatchEvent(b);b.propagationStopped||
this.dragging_||!this.isMouseActionButton_(a)||this.emulateClick_(this.down_);0===this.activePointers_&&(this.dragListenerKeys_.forEach(g.default.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)};a.prototype.isMouseActionButton_=function(a){return 0===a.button};a.prototype.handlePointerDown_=function(a){this.updateActivePointers_(a);var b=new n.default(h.default.POINTERDOWN,this.map_,
a);this.dispatchEvent(b);this.down_=a;0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new q.default(document),this.dragListenerKeys_.push(g.default.listen(this.documentPointerEventHandler_,h.default.POINTERMOVE,this.handlePointerMove_,this),g.default.listen(this.documentPointerEventHandler_,h.default.POINTERUP,this.handlePointerUp_,this),g.default.listen(this.pointerEventHandler_,h.default.POINTERCANCEL,this.handlePointerUp_,this)))};a.prototype.handlePointerMove_=function(a){if(this.isMoving_(a)){this.dragging_=
!0;var b=new n.default(h.default.POINTERDRAG,this.map_,a,this.dragging_);this.dispatchEvent(b)}a.preventDefault()};a.prototype.relayEvent_=function(a){var b=!(!this.down_||!this.isMoving_(a));this.dispatchEvent(new n.default(a.type,this.map_,a,b))};a.prototype.isMoving_=function(a){return Math.abs(a.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(a.clientY-this.down_.clientY)>this.moveTolerance_};a.prototype.disposeInternal=function(){this.relayedListenerKey_&&(g.default.unlistenByKey(this.relayedListenerKey_),
this.relayedListenerKey_=null);this.pointerdownListenerKey_&&(g.default.unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null);this.dragListenerKeys_.forEach(g.default.unlistenByKey);this.dragListenerKeys_.length=0;this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null);this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null);f.default.prototype.disposeInternal.call(this)};
k.default=a},{"./events.js":48,"./events/eventtarget.js":51,"./has.js":84,"./index.js":89,"./mapbrowsereventtype.js":118,"./mapbrowserpointerevent.js":119,"./pointer/eventtype.js":134,"./pointer/pointereventhandler.js":139}],118:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=(a=a("./events/eventtype.js"))&&a.__esModule?a:{default:a};k.default={SINGLECLICK:"singleclick",CLICK:a.default.CLICK,DBLCLICK:a.default.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",
POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},{"./events/eventtype.js":52}],119:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("./index.js"))&&e.__esModule?e:{default:e};var d=(a=a("./mapbrowserevent.js"))&&a.__esModule?a:{default:a};a=function(a,b,e,n,g){d.default.call(this,a,b,e.originalEvent,n,g);this.pointerEvent=e};e.default.inherits(a,d.default);k.default=
a},{"./index.js":89,"./mapbrowserevent.js":116}],120:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("./index.js"))&&e.__esModule?e:{default:e};var d=(a=a("./events/event.js"))&&a.__esModule?a:{default:a};a=function(a,b,e){d.default.call(this,a);this.map=b;this.frameState=void 0!==e?e:null};e.default.inherits(a,d.default);k.default=a},{"./events/event.js":50,"./index.js":89}],121:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={POSTRENDER:"postrender",
MOVESTART:"movestart",MOVEEND:"moveend"}},{}],122:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"}},{}],123:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./asserts.js"))&&a.__esModule?a:{default:a},c={clamp:function(a,c,d){return Math.min(Math.max(a,c),d)}};c.cosh=function(){return"cosh"in Math?Math.cosh:function(a){a=Math.exp(a);return(a+1/a)/2}}();c.roundUpToPowerOfTwo=function(a){d.default.assert(0<
a,29);return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))};c.squaredSegmentDistance=function(a,d,e,g,f,l){var b=f-e,h=l-g;if(0!==b||0!==h){var p=((a-e)*b+(d-g)*h)/(b*b+h*h);1<p?(e=f,g=l):0<p&&(e+=b*p,g+=h*p)}return c.squaredDistance(a,d,e,g)};c.squaredDistance=function(a,c,d,e){a=d-a;c=e-c;return a*a+c*c};c.solveLinearSystem=function(a){for(var b=a.length,c=0;c<b;c++){for(var d=c,f=Math.abs(a[c][c]),e=c+1;e<b;e++){var k=Math.abs(a[e][c]);k>f&&(f=k,d=e)}if(0===f)return null;f=a[d];a[d]=a[c];a[c]=f;
for(d=c+1;d<b;d++)for(f=-a[d][c]/a[c][c],e=c;e<b+1;e++)a[d][e]=c==e?0:a[d][e]+f*a[c][e]}c=Array(b);for(d=b-1;0<=d;d--)for(c[d]=a[d][b]/a[d][d],f=d-1;0<=f;f--)a[f][b]-=a[f][d]*c[d];return c};c.toDegrees=function(a){return 180*a/Math.PI};c.toRadians=function(a){return a*Math.PI/180};c.modulo=function(a,c){a%=c;return 0>a*c?a+c:a};c.lerp=function(a,c,d){return a+d*(c-a)};k.default=c},{"./asserts.js":31}],124:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a={};a.assign="function"===
typeof Object.assign?Object.assign:function(a,c){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),d=1,e=arguments.length;d<e;++d){var g=arguments[d];if(void 0!==g&&null!==g)for(var f in g)g.hasOwnProperty(f)&&(b[f]=g[f])}return b};a.clear=function(a){for(var c in a)delete a[c]};a.getValues=function(a){var c=[],b;for(b in a)c.push(a[b]);return c};a.isEmpty=function(a){for(var c in a)return!1;return!c};k.default=a},{}],125:[function(a,e,k){function d(a){return a&&
a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./objecteventtype.js");var b=d(e);e=a("./observable.js");var h=d(e);e=a("./events/event.js");var n=d(e);a=a("./obj.js");var g=d(a),f=function(a){h.default.call(this);c.default.getUid(this);this.values_={};void 0!==a&&this.setProperties(a)};c.default.inherits(f,h.default);f.changeEventTypeCache_={};f.getChangeEventType=function(a){return f.changeEventTypeCache_.hasOwnProperty(a)?f.changeEventTypeCache_[a]:
f.changeEventTypeCache_[a]="change:"+a};f.prototype.get=function(a){var b;this.values_.hasOwnProperty(a)&&(b=this.values_[a]);return b};f.prototype.getKeys=function(){return Object.keys(this.values_)};f.prototype.getProperties=function(){return g.default.assign({},this.values_)};f.prototype.notify=function(a,c){var d=f.getChangeEventType(a);this.dispatchEvent(new f.Event(d,a,c));d=b.default.PROPERTYCHANGE;this.dispatchEvent(new f.Event(d,a,c))};f.prototype.set=function(a,b,c){c?this.values_[a]=b:
(c=this.values_[a],this.values_[a]=b,c!==b&&this.notify(a,c))};f.prototype.setProperties=function(a,b){for(var c in a)this.set(c,a[c],b)};f.prototype.unset=function(a,b){if(a in this.values_){var c=this.values_[a];delete this.values_[a];b||this.notify(a,c)}};f.Event=function(a,b,c){n.default.call(this,a);this.key=b;this.oldValue=c};c.default.inherits(f.Event,n.default);k.default=f},{"./events/event.js":50,"./index.js":89,"./obj.js":124,"./objecteventtype.js":126,"./observable.js":127}],126:[function(a,
e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={PROPERTYCHANGE:"propertychange"}},{}],127:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./events.js"),b=d(c);c=a("./events/eventtarget.js");var h=d(c);a=a("./events/eventtype.js");var n=d(a);a=function(){h.default.call(this);this.revision_=0};e.default.inherits(a,h.default);a.unByKey=function(a){if(Array.isArray(a))for(var c=0,d=
a.length;c<d;++c)b.default.unlistenByKey(a[c]);else b.default.unlistenByKey(a)};a.prototype.changed=function(){++this.revision_;this.dispatchEvent(n.default.CHANGE)};a.prototype.dispatchEvent;a.prototype.getRevision=function(){return this.revision_};a.prototype.on=function(a,c,d){if(Array.isArray(a)){for(var f=a.length,e=Array(f),g=0;g<f;++g)e[g]=b.default.listen(this,a[g],c,d);return e}return b.default.listen(this,a,c,d)};a.prototype.once=function(a,c,d){if(Array.isArray(a)){for(var f=a.length,e=
Array(f),g=0;g<f;++g)e[g]=b.default.listenOnce(this,a[g],c,d);return e}return b.default.listenOnce(this,a,c,d)};a.prototype.un=function(a,c,d){if(Array.isArray(a))for(var f=0,e=a.length;f<e;++f)b.default.unlisten(this,a[f],c,d);else b.default.unlisten(this,a,c,d)};k.default=a},{"./events.js":48,"./events/eventtarget.js":51,"./events/eventtype.js":52,"./index.js":89}],128:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");
e=d(e);var c=a("./mapeventtype.js"),b=d(c);c=a("./object.js");var h=d(c);c=a("./overlaypositioning.js");var n=d(c);c=a("./css.js");var g=d(c);c=a("./dom.js");var f=d(c);c=a("./events.js");var l=d(c);a=a("./extent.js");var q=d(a),m=function(a){h.default.call(this);this.options=a;this.id=a.id;this.insertFirst=void 0!==a.insertFirst?a.insertFirst:!0;this.stopEvent=void 0!==a.stopEvent?a.stopEvent:!0;this.element=document.createElement("DIV");this.element.className=void 0!==a.className?a.className:"ol-overlay-container "+
g.default.CLASS_SELECTABLE;this.element.style.position="absolute";this.autoPan=void 0!==a.autoPan?a.autoPan:!1;this.autoPanAnimation=a.autoPanAnimation||{};this.autoPanMargin=void 0!==a.autoPanMargin?a.autoPanMargin:20;this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0};this.mapPostrenderListenerKey=null;l.default.listen(this,h.default.getChangeEventType(m.Property.ELEMENT),this.handleElementChanged,this);l.default.listen(this,h.default.getChangeEventType(m.Property.MAP),this.handleMapChanged,
this);l.default.listen(this,h.default.getChangeEventType(m.Property.OFFSET),this.handleOffsetChanged,this);l.default.listen(this,h.default.getChangeEventType(m.Property.POSITION),this.handlePositionChanged,this);l.default.listen(this,h.default.getChangeEventType(m.Property.POSITIONING),this.handlePositioningChanged,this);void 0!==a.element&&this.setElement(a.element);this.setOffset(void 0!==a.offset?a.offset:[0,0]);this.setPositioning(void 0!==a.positioning?a.positioning:n.default.TOP_LEFT);void 0!==
a.position&&this.setPosition(a.position)};e.default.inherits(m,h.default);m.prototype.getElement=function(){return this.get(m.Property.ELEMENT)};m.prototype.getId=function(){return this.id};m.prototype.getMap=function(){return this.get(m.Property.MAP)};m.prototype.getOffset=function(){return this.get(m.Property.OFFSET)};m.prototype.getPosition=function(){return this.get(m.Property.POSITION)};m.prototype.getPositioning=function(){return this.get(m.Property.POSITIONING)};m.prototype.handleElementChanged=
function(){f.default.removeChildren(this.element);var a=this.getElement();a&&this.element.appendChild(a)};m.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(f.default.removeNode(this.element),l.default.unlistenByKey(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var a=this.getMap();a&&(this.mapPostrenderListenerKey=l.default.listen(a,b.default.POSTRENDER,this.render,this),this.updatePixelPosition(),a=this.stopEvent?a.getOverlayContainerStopEvent():a.getOverlayContainer(),
this.insertFirst?a.insertBefore(this.element,a.childNodes[0]||null):a.appendChild(this.element))};m.prototype.render=function(){this.updatePixelPosition()};m.prototype.handleOffsetChanged=function(){this.updatePixelPosition()};m.prototype.handlePositionChanged=function(){this.updatePixelPosition();this.get(m.Property.POSITION)&&this.autoPan&&this.panIntoView()};m.prototype.handlePositioningChanged=function(){this.updatePixelPosition()};m.prototype.setElement=function(a){this.set(m.Property.ELEMENT,
a)};m.prototype.setMap=function(a){this.set(m.Property.MAP,a)};m.prototype.setOffset=function(a){this.set(m.Property.OFFSET,a)};m.prototype.setPosition=function(a){this.set(m.Property.POSITION,a)};m.prototype.panIntoView=function(){var a=this.getMap();if(a&&a.getTargetElement()){var b=this.getRect(a.getTargetElement(),a.getSize()),c=this.getElement(),d=this.getRect(c,[f.default.outerWidth(c),f.default.outerHeight(c)]);c=this.autoPanMargin;if(!q.default.containsExtent(b,d)){var e=d[0]-b[0],g=b[2]-
d[2],l=d[1]-b[1];d=b[3]-d[3];b=[0,0];0>e?b[0]=e-c:0>g&&(b[0]=Math.abs(g)+c);0>l?b[1]=l-c:0>d&&(b[1]=Math.abs(d)+c);if(0!==b[0]||0!==b[1])c=a.getView().getCenter(),c=a.getPixelFromCoordinate(c),c=[c[0]+b[0],c[1]+b[1]],a.getView().animate({center:a.getCoordinateFromPixel(c),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}};m.prototype.getRect=function(a,b){var c=a.getBoundingClientRect();a=c.left+window.pageXOffset;c=c.top+window.pageYOffset;return[a,c,a+b[0],c+b[1]]};
m.prototype.setPositioning=function(a){this.set(m.Property.POSITIONING,a)};m.prototype.setVisible=function(a){this.rendered.visible!==a&&(this.element.style.display=a?"":"none",this.rendered.visible=a)};m.prototype.updatePixelPosition=function(){var a=this.getMap(),b=this.getPosition();a&&a.isRendered()&&b?(b=a.getPixelFromCoordinate(b),a=a.getSize(),this.updateRenderedPosition(b,a)):this.setVisible(!1)};m.prototype.updateRenderedPosition=function(a,b){var c=this.element.style,f=this.getOffset(),
d=this.getPositioning();this.setVisible(!0);var e=f[0];f=f[1];if(d==n.default.BOTTOM_RIGHT||d==n.default.CENTER_RIGHT||d==n.default.TOP_RIGHT)""!==this.rendered.left_&&(this.rendered.left_=c.left=""),e=Math.round(b[0]-a[0]-e)+"px",this.rendered.right_!=e&&(this.rendered.right_=c.right=e);else{""!==this.rendered.right_&&(this.rendered.right_=c.right="");if(d==n.default.BOTTOM_CENTER||d==n.default.CENTER_CENTER||d==n.default.TOP_CENTER)e-=this.element.offsetWidth/2;e=Math.round(a[0]+e)+"px";this.rendered.left_!=
e&&(this.rendered.left_=c.left=e)}if(d==n.default.BOTTOM_LEFT||d==n.default.BOTTOM_CENTER||d==n.default.BOTTOM_RIGHT)""!==this.rendered.top_&&(this.rendered.top_=c.top=""),a=Math.round(b[1]-a[1]-f)+"px",this.rendered.bottom_!=a&&(this.rendered.bottom_=c.bottom=a);else{""!==this.rendered.bottom_&&(this.rendered.bottom_=c.bottom="");if(d==n.default.CENTER_LEFT||d==n.default.CENTER_CENTER||d==n.default.CENTER_RIGHT)f-=this.element.offsetHeight/2;a=Math.round(a[1]+f)+"px";this.rendered.top_!=a&&(this.rendered.top_=
c.top=a)}};m.prototype.getOptions=function(){return this.options};m.Property={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};k.default=m},{"./css.js":44,"./dom.js":46,"./events.js":48,"./extent.js":54,"./index.js":89,"./mapeventtype.js":121,"./object.js":125,"./overlaypositioning.js":129}],129:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",
CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"}},{}],130:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./collection.js");var b=d(e);e=a("./collectioneventtype.js");var h=d(e);e=a("./mapbrowserevent.js");var n=d(e);e=a("./mapbrowsereventhandler.js");var g=d(e);e=a("./mapbrowsereventtype.js");var f=d(e);e=a("./mapevent.js");
var l=d(e);e=a("./mapeventtype.js");var q=d(e);e=a("./mapproperty.js");var m=d(e);e=a("./object.js");var p=d(e);e=a("./objecteventtype.js");var r=d(e);e=a("./tilequeue.js");var t=d(e);e=a("./view.js");var u=d(e);e=a("./viewhint.js");var y=d(e);e=a("./asserts.js");var w=d(e);e=a("./dom.js");var v=d(e);e=a("./events.js");var A=d(e);e=a("./events/event.js");var B=d(e);e=a("./events/eventtype.js");var x=d(e);e=a("./extent.js");var z=d(e);e=a("./functions.js");var C=d(e);e=a("./has.js");var S=d(e);e=a("./layer/group.js");
var I=d(e);e=a("./obj.js");var M=d(e);e=a("./plugins.js");var H=d(e);e=a("./renderer/type.js");e=d(e);var J=a("./size.js"),D=d(J);J=a("./structs/priorityqueue.js");var T=d(J);a=a("./transform.js");var R=d(a),G=function(a){p.default.call(this);var c=G.createOptionsInternal(a);this.loadTilesWhileAnimating_=void 0!==a.loadTilesWhileAnimating?a.loadTilesWhileAnimating:!1;this.loadTilesWhileInteracting_=void 0!==a.loadTilesWhileInteracting?a.loadTilesWhileInteracting:!1;this.pixelRatio_=void 0!==a.pixelRatio?
a.pixelRatio:S.default.DEVICE_PIXEL_RATIO;this.logos_=c.logos;this.animationDelayKey_;this.animationDelay_=function(){this.animationDelayKey_=void 0;this.renderFrame_.call(this,Date.now())}.bind(this);this.coordinateToPixelTransform_=R.default.create();this.pixelToCoordinateTransform_=R.default.create();this.frameIndex_=0;this.layerGroupPropertyListenerKeys_=this.viewChangeListenerKey_=this.viewPropertyListenerKey_=this.previousExtent_=this.frameState_=null;this.viewport_=document.createElement("DIV");
this.viewport_.className="ol-viewport"+(S.default.TOUCH?" ol-touch":"");this.viewport_.style.position="relative";this.viewport_.style.overflow="hidden";this.viewport_.style.width="100%";this.viewport_.style.height="100%";this.viewport_.style.msTouchAction="none";this.viewport_.style.touchAction="none";this.overlayContainer_=document.createElement("DIV");this.overlayContainer_.className="ol-overlaycontainer";this.viewport_.appendChild(this.overlayContainer_);this.overlayContainerStopEvent_=document.createElement("DIV");
this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var d=[x.default.CLICK,x.default.DBLCLICK,x.default.MOUSEDOWN,x.default.TOUCHSTART,x.default.MSPOINTERDOWN,f.default.POINTERDOWN,x.default.MOUSEWHEEL,x.default.WHEEL],e=0,l=d.length;e<l;++e)A.default.listen(this.overlayContainerStopEvent_,d[e],B.default.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_);this.mapBrowserEventHandler_=new g.default(this,a.moveTolerance);for(var u in f.default)A.default.listen(this.mapBrowserEventHandler_,
f.default[u],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=c.keyboardEventTarget;this.keyHandlerKeys_=null;A.default.listen(this.viewport_,x.default.WHEEL,this.handleBrowserEvent,this);A.default.listen(this.viewport_,x.default.MOUSEWHEEL,this.handleBrowserEvent,this);this.controls=c.controls||new b.default;this.interactions=c.interactions||new b.default;this.overlays_=c.overlays;this.overlayIdIndex_={};this.renderer_=c.mapRendererPlugin.create(this.viewport_,this);this.handleResize_;
this.focus_=null;this.postRenderFunctions_=[];this.tileQueue_=new t.default(this.getTilePriority.bind(this),this.handleTileChange_.bind(this));this.skippedFeatureUids_={};A.default.listen(this,p.default.getChangeEventType(m.default.LAYERGROUP),this.handleLayerGroupChanged_,this);A.default.listen(this,p.default.getChangeEventType(m.default.VIEW),this.handleViewChanged_,this);A.default.listen(this,p.default.getChangeEventType(m.default.SIZE),this.handleSizeChanged_,this);A.default.listen(this,p.default.getChangeEventType(m.default.TARGET),
this.handleTargetChanged_,this);this.setProperties(c.values);this.controls.forEach(function(a){a.setMap(this)},this);A.default.listen(this.controls,h.default.ADD,function(a){a.element.setMap(this)},this);A.default.listen(this.controls,h.default.REMOVE,function(a){a.element.setMap(null)},this);this.interactions.forEach(function(a){a.setMap(this)},this);A.default.listen(this.interactions,h.default.ADD,function(a){a.element.setMap(this)},this);A.default.listen(this.interactions,h.default.REMOVE,function(a){a.element.setMap(null)},
this);this.overlays_.forEach(this.addOverlayInternal_,this);A.default.listen(this.overlays_,h.default.ADD,function(a){this.addOverlayInternal_(a.element)},this);A.default.listen(this.overlays_,h.default.REMOVE,function(a){var b=a.element.getId();void 0!==b&&delete this.overlayIdIndex_[b.toString()];a.element.setMap(null)},this)};c.default.inherits(G,p.default);G.prototype.addControl=function(a){this.getControls().push(a)};G.prototype.addInteraction=function(a){this.getInteractions().push(a)};G.prototype.addLayer=
function(a){this.getLayerGroup().getLayers().push(a)};G.prototype.addOverlay=function(a){this.getOverlays().push(a)};G.prototype.addOverlayInternal_=function(a){var b=a.getId();void 0!==b&&(this.overlayIdIndex_[b.toString()]=a);a.setMap(this)};G.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose();A.default.unlisten(this.viewport_,x.default.WHEEL,this.handleBrowserEvent,this);A.default.unlisten(this.viewport_,x.default.MOUSEWHEEL,this.handleBrowserEvent,this);void 0!==this.handleResize_&&
(window.removeEventListener(x.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.setTarget(null);p.default.prototype.disposeInternal.call(this)};G.prototype.forEachFeatureAtPixel=function(a,b,c){if(this.frameState_)return a=this.getCoordinateFromPixel(a),c=void 0!==c?c:{},this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,void 0!==c.hitTolerance?c.hitTolerance*this.frameState_.pixelRatio:
0,b,null,void 0!==c.layerFilter?c.layerFilter:C.default.TRUE,null)};G.prototype.getFeaturesAtPixel=function(a,b){var c=null;this.forEachFeatureAtPixel(a,function(a){c||(c=[]);c.push(a)},b);return c};G.prototype.forEachLayerAtPixel=function(a,b,c,f,d){if(this.frameState_)return this.renderer_.forEachLayerAtPixel(a,this.frameState_,b,void 0!==c?c:null,void 0!==f?f:C.default.TRUE,void 0!==d?d:null)};G.prototype.hasFeatureAtPixel=function(a,b){if(!this.frameState_)return!1;a=this.getCoordinateFromPixel(a);
b=void 0!==b?b:{};return this.renderer_.hasFeatureAtCoordinate(a,this.frameState_,void 0!==b.hitTolerance?b.hitTolerance*this.frameState_.pixelRatio:0,void 0!==b.layerFilter?b.layerFilter:C.default.TRUE,null)};G.prototype.getEventCoordinate=function(a){return this.getCoordinateFromPixel(this.getEventPixel(a))};G.prototype.getEventPixel=function(a){var b=this.viewport_.getBoundingClientRect();a=a.changedTouches?a.changedTouches[0]:a;return[a.clientX-b.left,a.clientY-b.top]};G.prototype.getTarget=function(){return this.get(m.default.TARGET)};
G.prototype.getTargetElement=function(){var a=this.getTarget();return void 0!==a?"string"===typeof a?document.getElementById(a):a:null};G.prototype.getCoordinateFromPixel=function(a){var b=this.frameState_;return b?R.default.apply(b.pixelToCoordinateTransform,a.slice()):null};G.prototype.getControls=function(){return this.controls};G.prototype.getOverlays=function(){return this.overlays_};G.prototype.getOverlayById=function(a){a=this.overlayIdIndex_[a.toString()];return void 0!==a?a:null};G.prototype.getInteractions=
function(){return this.interactions};G.prototype.getLayerGroup=function(){return this.get(m.default.LAYERGROUP)};G.prototype.getLayers=function(){return this.getLayerGroup().getLayers()};G.prototype.getPixelFromCoordinate=function(a){var b=this.frameState_;return b?R.default.apply(b.coordinateToPixelTransform,a.slice(0,2)):null};G.prototype.getRenderer=function(){return this.renderer_};G.prototype.getSize=function(){return this.get(m.default.SIZE)};G.prototype.getView=function(){return this.get(m.default.VIEW)};
G.prototype.getViewport=function(){return this.viewport_};G.prototype.getOverlayContainer=function(){return this.overlayContainer_};G.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_};G.prototype.getTilePriority=function(a,b,c,f){var d=this.frameState_;if(!(d&&b in d.wantedTiles&&d.wantedTiles[b][a.getKey()]))return T.default.DROP;a=c[0]-d.focus[0];c=c[1]-d.focus[1];return 65536*Math.log(f)+Math.sqrt(a*a+c*c)/f};G.prototype.handleBrowserEvent=function(a,b){a=
new n.default(b||a.type,this,a);this.handleMapBrowserEvent(a)};G.prototype.handleMapBrowserEvent=function(a){if(this.frameState_){this.focus_=a.coordinate;a.frameState=this.frameState_;var b=this.getInteractions().getArray(),c;if(!1!==this.dispatchEvent(a))for(c=b.length-1;0<=c;c--){var f=b[c];if(f.getActive()&&!f.handleEvent(a))break}}};G.prototype.handlePostRender=function(){var a=this.frameState_,b=this.tileQueue_;if(!b.isEmpty()){var c=16,f=c;if(a){var d=a.viewHints;d[y.default.ANIMATING]&&(c=
this.loadTilesWhileAnimating_?8:0,f=2);d[y.default.INTERACTING]&&(c=this.loadTilesWhileInteracting_?8:0,f=2)}b.getTilesLoading()<c&&(b.reprioritize(),b.loadMoreTiles(c,f))}b=this.postRenderFunctions_;c=0;for(f=b.length;c<f;++c)b[c](this,a);b.length=0};G.prototype.handleSizeChanged_=function(){this.render()};G.prototype.handleTargetChanged_=function(){var a;this.getTarget()&&(a=this.getTargetElement());if(this.keyHandlerKeys_){for(var b=0,c=this.keyHandlerKeys_.length;b<c;++b)A.default.unlistenByKey(this.keyHandlerKeys_[b]);
this.keyHandlerKeys_=null}a?(a.appendChild(this.viewport_),a=this.keyboardEventTarget_?this.keyboardEventTarget_:a,this.keyHandlerKeys_=[A.default.listen(a,x.default.KEYDOWN,this.handleBrowserEvent,this),A.default.listen(a,x.default.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(x.default.RESIZE,this.handleResize_,!1))):(this.renderer_.removeLayerRenderers(),v.default.removeNode(this.viewport_),void 0!==this.handleResize_&&
(window.removeEventListener(x.default.RESIZE,this.handleResize_,!1),this.handleResize_=void 0));this.updateSize()};G.prototype.handleTileChange_=function(){this.render()};G.prototype.handleViewPropertyChanged_=function(){this.render()};G.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(A.default.unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null);this.viewChangeListenerKey_&&(A.default.unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=
null);var a=this.getView();a&&(this.viewport_.setAttribute("data-view",c.default.getUid(a)),this.viewPropertyListenerKey_=A.default.listen(a,r.default.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=A.default.listen(a,x.default.CHANGE,this.handleViewPropertyChanged_,this));this.render()};G.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(A.default.unlistenByKey),this.layerGroupPropertyListenerKeys_=
null);var a=this.getLayerGroup();a&&(this.layerGroupPropertyListenerKeys_=[A.default.listen(a,r.default.PROPERTYCHANGE,this.render,this),A.default.listen(a,x.default.CHANGE,this.render,this)]);this.render()};G.prototype.isRendered=function(){return!!this.frameState_};G.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_);this.animationDelay_()};G.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))};
G.prototype.removeControl=function(a){return this.getControls().remove(a)};G.prototype.removeInteraction=function(a){return this.getInteractions().remove(a)};G.prototype.removeLayer=function(a){return this.getLayerGroup().getLayers().remove(a)};G.prototype.removeOverlay=function(a){return this.getOverlays().remove(a)};G.prototype.renderFrame_=function(a){var b,f=this.getSize(),d=this.getView(),e=z.default.createEmpty(),g=this.frameState_,h=null;if(void 0!==f&&D.default.hasArea(f)&&d&&d.isDef()){h=
d.getHints(this.frameState_?this.frameState_.viewHints:void 0);var t=this.getLayerGroup().getLayerStatesArray(),u={};var m=0;for(b=t.length;m<b;++m)u[c.default.getUid(t[m].layer)]=t[m];m=d.getState();d=m.center;b=m.resolution/this.pixelRatio_;d[0]=Math.round(d[0]/b)*b;d[1]=Math.round(d[1]/b)*b;h={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:e,focus:this.focus_?this.focus_:d,index:this.frameIndex_++,layerStates:u,layerStatesArray:t,logos:M.default.assign({},this.logos_),
pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:f,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:a,usedTiles:{},viewState:m,viewHints:h,wantedTiles:{}}}h&&(h.extent=z.default.getForViewAndSize(m.center,m.resolution,m.rotation,h.size,e));this.frameState_=h;this.renderer_.renderFrame(h);h&&(h.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,h.postRenderFunctions),!g||this.previousExtent_&&
(z.default.isEmpty(this.previousExtent_)||z.default.equals(h.extent,this.previousExtent_))||(this.dispatchEvent(new l.default(q.default.MOVESTART,this,g)),this.previousExtent_=z.default.createOrUpdateEmpty(this.previousExtent_)),!this.previousExtent_||h.viewHints[y.default.ANIMATING]||h.viewHints[y.default.INTERACTING]||z.default.equals(h.extent,this.previousExtent_)||(this.dispatchEvent(new l.default(q.default.MOVEEND,this,h)),z.default.clone(h.extent,this.previousExtent_)));this.dispatchEvent(new l.default(q.default.POSTRENDER,
this,h));setTimeout(this.handlePostRender.bind(this),0)};G.prototype.setLayerGroup=function(a){this.set(m.default.LAYERGROUP,a)};G.prototype.setSize=function(a){this.set(m.default.SIZE,a)};G.prototype.setTarget=function(a){this.set(m.default.TARGET,a)};G.prototype.setView=function(a){this.set(m.default.VIEW,a)};G.prototype.skipFeature=function(a){a=c.default.getUid(a).toString();this.skippedFeatureUids_[a]=!0;this.render()};G.prototype.updateSize=function(){var a=this.getTargetElement();if(a){var b=
getComputedStyle(a);this.setSize([a.offsetWidth-parseFloat(b.borderLeftWidth)-parseFloat(b.paddingLeft)-parseFloat(b.paddingRight)-parseFloat(b.borderRightWidth),a.offsetHeight-parseFloat(b.borderTopWidth)-parseFloat(b.paddingTop)-parseFloat(b.paddingBottom)-parseFloat(b.borderBottomWidth)])}else this.setSize(void 0)};G.prototype.unskipFeature=function(a){a=c.default.getUid(a).toString();delete this.skippedFeatureUids_[a];this.render()};G.DEFAULT_RENDERER_TYPES=[e.default.CANVAS,e.default.WEBGL];
G.LOGO_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC";
G.createOptionsInternal=function(a){var f=null;void 0!==a.keyboardEventTarget&&(f="string"===typeof a.keyboardEventTarget?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var d={},e={};if(void 0===a.logo||"boolean"===typeof a.logo&&a.logo)e[G.LOGO_URL]="https://openlayers.org/";else{var g=a.logo;"string"===typeof g?e[g]="":g instanceof HTMLElement?e[c.default.getUid(g).toString()]=g:g&&(w.default.assert("string"==typeof g.href,44),w.default.assert("string"==typeof g.src,45),e[g.src]=
g.href)}g=a.layers instanceof I.default?a.layers:new I.default({layers:a.layers});d[m.default.LAYERGROUP]=g;d[m.default.TARGET]=a.target;d[m.default.VIEW]=void 0!==a.view?a.view:new u.default;var h;void 0!==a.renderer?(Array.isArray(a.renderer)?h=a.renderer:"string"===typeof a.renderer?h=[a.renderer]:w.default.assert(!1,46),0<=h.indexOf("dom")&&(h=h.concat(G.DEFAULT_RENDERER_TYPES))):h=G.DEFAULT_RENDERER_TYPES;g=H.default.getMapRendererPlugins();var l=0,t=h.length;a:for(;l<t;++l)for(var p=h[l],n=
0,y=g.length;n<y;++n){var z=g[n];if(z.handles(p)){var r=z;break a}}if(!r)throw Error("Unable to create a map renderer for types: "+h.join(", "));if(void 0!==a.controls)if(Array.isArray(a.controls))var k=new b.default(a.controls.slice());else w.default.assert(a.controls instanceof b.default,47),k=a.controls;if(void 0!==a.interactions)if(Array.isArray(a.interactions))var C=new b.default(a.interactions.slice());else w.default.assert(a.interactions instanceof b.default,48),C=a.interactions;void 0!==a.overlays?
Array.isArray(a.overlays)?a=new b.default(a.overlays.slice()):(w.default.assert(a.overlays instanceof b.default,49),a=a.overlays):a=new b.default;return{controls:k,interactions:C,keyboardEventTarget:f,logos:e,overlays:a,mapRendererPlugin:r,values:d}};k.default=G},{"./asserts.js":31,"./collection.js":34,"./collectioneventtype.js":35,"./dom.js":46,"./events.js":48,"./events/event.js":50,"./events/eventtype.js":52,"./extent.js":54,"./functions.js":60,"./has.js":84,"./index.js":89,"./layer/group.js":106,
"./mapbrowserevent.js":116,"./mapbrowsereventhandler.js":117,"./mapbrowsereventtype.js":118,"./mapevent.js":120,"./mapeventtype.js":121,"./mapproperty.js":122,"./obj.js":124,"./object.js":125,"./objecteventtype.js":126,"./plugins.js":131,"./renderer/type.js":192,"./size.js":208,"./structs/priorityqueue.js":219,"./tilequeue.js":240,"./transform.js":243,"./view.js":245,"./viewhint.js":246}],131:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./plugintype.js"))&&a.__esModule?
a:{default:a},c={mapRendererPlugins_:[],getMapRendererPlugins:function(){return c.mapRendererPlugins_},layerRendererPlugins_:[],getLayerRendererPlugins:function(){return c.layerRendererPlugins_},register:function(a,e){switch(a){case d.default.MAP_RENDERER:a=c.mapRendererPlugins_;a.push(e);break;case d.default.LAYER_RENDERER:a=c.layerRendererPlugins_;a.push(e);break;default:throw Error("Unsupported plugin type: "+a);}},registerMultiple:function(a,d){for(var b=0,e=d.length;b<e;++b)c.register(a,d[b])}};
k.default=c},{"./plugintype.js":132}],132:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={MAP_RENDERER:"MAP_RENDERER",LAYER_RENDERER:"LAYER_RENDERER"}},{}],133:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(a,c){this.dispatcher=a;this.mapping_=c};a.prototype.getEvents=function(){return Object.keys(this.mapping_)};a.prototype.getHandlerForEvent=function(a){return this.mapping_[a]};k.default=a},{}],134:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});k.default={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},{}],135:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../pointer/eventsource.js"))&&a.__esModule?a:{default:a},c=function(a){d.default.call(this,a,{mousedown:this.mousedown,
mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout});this.pointerMap=a.pointerMap;this.lastTouches=[]};e.default.inherits(c,d.default);c.POINTER_ID=1;c.POINTER_TYPE="mouse";c.DEDUP_DIST=25;c.prototype.isEventSimulatedFromTouch_=function(a){var b=this.lastTouches,d=a.clientX;a=a.clientY;for(var e=0,f=b.length,l;e<f&&(l=b[e]);e++){var k=Math.abs(a-l[1]);if(Math.abs(d-l[0])<=c.DEDUP_DIST&&k<=c.DEDUP_DIST)return!0}return!1};c.prepareEvent=function(a,d){d=d.cloneEvent(a,
a);var b=d.preventDefault;d.preventDefault=function(){a.preventDefault();b()};d.pointerId=c.POINTER_ID;d.isPrimary=!0;d.pointerType=c.POINTER_TYPE;return d};c.prototype.mousedown=function(a){if(!this.isEventSimulatedFromTouch_(a)){c.POINTER_ID.toString()in this.pointerMap&&this.cancel(a);var b=c.prepareEvent(a,this.dispatcher);this.pointerMap[c.POINTER_ID.toString()]=a;this.dispatcher.down(b,a)}};c.prototype.mousemove=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=c.prepareEvent(a,this.dispatcher);
this.dispatcher.move(b,a)}};c.prototype.mouseup=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=this.pointerMap[c.POINTER_ID.toString()];b&&b.button===a.button&&(b=c.prepareEvent(a,this.dispatcher),this.dispatcher.up(b,a),this.cleanupMouse())}};c.prototype.mouseover=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=c.prepareEvent(a,this.dispatcher);this.dispatcher.enterOver(b,a)}};c.prototype.mouseout=function(a){if(!this.isEventSimulatedFromTouch_(a)){var b=c.prepareEvent(a,this.dispatcher);
this.dispatcher.leaveOut(b,a)}};c.prototype.cancel=function(a){var b=c.prepareEvent(a,this.dispatcher);this.dispatcher.cancel(b,a);this.cleanupMouse()};c.prototype.cleanupMouse=function(){delete this.pointerMap[c.POINTER_ID.toString()]};k.default=c},{"../index.js":89,"../pointer/eventsource.js":133}],136:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../pointer/eventsource.js"))&&a.__esModule?a:{default:a};a=function(a){d.default.call(this,
a,{MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture});this.pointerMap=a.pointerMap;this.POINTER_TYPES=["","unavailable","touch","pen","mouse"]};e.default.inherits(a,d.default);a.prototype.prepareEvent_=function(a){var b=a;"number"===typeof a.pointerType&&(b=this.dispatcher.cloneEvent(a,
a),b.pointerType=this.POINTER_TYPES[a.pointerType]);return b};a.prototype.cleanup=function(a){delete this.pointerMap[a.toString()]};a.prototype.msPointerDown=function(a){this.pointerMap[a.pointerId.toString()]=a;var b=this.prepareEvent_(a);this.dispatcher.down(b,a)};a.prototype.msPointerMove=function(a){var b=this.prepareEvent_(a);this.dispatcher.move(b,a)};a.prototype.msPointerUp=function(a){var b=this.prepareEvent_(a);this.dispatcher.up(b,a);this.cleanup(a.pointerId)};a.prototype.msPointerOut=function(a){var b=
this.prepareEvent_(a);this.dispatcher.leaveOut(b,a)};a.prototype.msPointerOver=function(a){var b=this.prepareEvent_(a);this.dispatcher.enterOver(b,a)};a.prototype.msPointerCancel=function(a){var b=this.prepareEvent_(a);this.dispatcher.cancel(b,a);this.cleanup(a.pointerId)};a.prototype.msLostPointerCapture=function(a){a=this.dispatcher.makeEvent("lostpointercapture",a,a);this.dispatcher.dispatchEvent(a)};a.prototype.msGotPointerCapture=function(a){a=this.dispatcher.makeEvent("gotpointercapture",a,
a);this.dispatcher.dispatchEvent(a)};k.default=a},{"../index.js":89,"../pointer/eventsource.js":133}],137:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../pointer/eventsource.js"))&&a.__esModule?a:{default:a};a=function(a){d.default.call(this,a,{pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,
gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture})};e.default.inherits(a,d.default);a.prototype.pointerDown=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.pointerMove=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.pointerUp=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.pointerOut=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.pointerOver=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.pointerCancel=
function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.lostPointerCapture=function(a){this.dispatcher.fireNativeEvent(a)};a.prototype.gotPointerCapture=function(a){this.dispatcher.fireNativeEvent(a)};k.default=a},{"../index.js":89,"../pointer/eventsource.js":133}],138:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../events/event.js"))&&a.__esModule?a:{default:a},c=function(a,c,e){d.default.call(this,a);this.originalEvent=
c;a=e?e:{};this.buttons=this.getButtons_(a);this.pressure=this.getPressure_(a,this.buttons);this.bubbles="bubbles"in a?a.bubbles:!1;this.cancelable="cancelable"in a?a.cancelable:!1;this.view="view"in a?a.view:null;this.detail="detail"in a?a.detail:null;this.screenX="screenX"in a?a.screenX:0;this.screenY="screenY"in a?a.screenY:0;this.clientX="clientX"in a?a.clientX:0;this.clientY="clientY"in a?a.clientY:0;this.ctrlKey="ctrlKey"in a?a.ctrlKey:!1;this.altKey="altKey"in a?a.altKey:!1;this.shiftKey="shiftKey"in
a?a.shiftKey:!1;this.metaKey="metaKey"in a?a.metaKey:!1;this.button="button"in a?a.button:0;this.relatedTarget="relatedTarget"in a?a.relatedTarget:null;this.pointerId="pointerId"in a?a.pointerId:0;this.width="width"in a?a.width:0;this.height="height"in a?a.height:0;this.tiltX="tiltX"in a?a.tiltX:0;this.tiltY="tiltY"in a?a.tiltY:0;this.pointerType="pointerType"in a?a.pointerType:"";this.hwTimestamp="hwTimestamp"in a?a.hwTimestamp:0;this.isPrimary="isPrimary"in a?a.isPrimary:!1;c.preventDefault&&(this.preventDefault=
function(){c.preventDefault()})};e.default.inherits(c,d.default);c.prototype.getButtons_=function(a){if(a.buttons||c.HAS_BUTTONS)a=a.buttons;else switch(a.which){case 1:a=1;break;case 2:a=4;break;case 3:a=2;break;default:a=0}return a};c.prototype.getPressure_=function(a,c){return a.pressure?a.pressure:c?.5:0};c.HAS_BUTTONS=!1;(function(){try{var a=new MouseEvent("click",{buttons:1});c.HAS_BUTTONS=1===a.buttons}catch(h){}})();k.default=c},{"../events/event.js":50,"../index.js":89}],139:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../events.js"),b=d(c);c=a("../events/eventtarget.js");var h=d(c);c=a("../has.js");var n=d(c);c=a("../pointer/eventtype.js");var g=d(c);c=a("../pointer/mousesource.js");var f=d(c);c=a("../pointer/mssource.js");var l=d(c);c=a("../pointer/nativesource.js");var q=d(c);c=a("../pointer/pointerevent.js");var m=d(c);a=a("../pointer/touchsource.js");var p=d(a),r=function(a){h.default.call(this);
this.element_=a;this.pointerMap={};this.eventMap_={};this.eventSourceList_=[];this.registerSources()};e.default.inherits(r,h.default);r.prototype.registerSources=function(){if(n.default.POINTER)this.registerSource("native",new q.default(this));else if(n.default.MSPOINTER)this.registerSource("ms",new l.default(this));else{var a=new f.default(this);this.registerSource("mouse",a);n.default.TOUCH&&this.registerSource("touch",new p.default(this,a))}this.register_()};r.prototype.registerSource=function(a,
b){if(a=b.getEvents())a.forEach(function(a){var c=b.getHandlerForEvent(a);c&&(this.eventMap_[a]=c.bind(b))},this),this.eventSourceList_.push(b)};r.prototype.register_=function(){for(var a=this.eventSourceList_.length,b,c=0;c<a;c++)b=this.eventSourceList_[c],this.addEvents_(b.getEvents())};r.prototype.unregister_=function(){for(var a=this.eventSourceList_.length,b,c=0;c<a;c++)b=this.eventSourceList_[c],this.removeEvents_(b.getEvents())};r.prototype.eventHandler_=function(a){var b=this.eventMap_[a.type];
b&&b(a)};r.prototype.addEvents_=function(a){a.forEach(function(a){b.default.listen(this.element_,a,this.eventHandler_,this)},this)};r.prototype.removeEvents_=function(a){a.forEach(function(a){b.default.unlisten(this.element_,a,this.eventHandler_,this)},this)};r.prototype.cloneEvent=function(a,b){for(var c={},f,d=0,e=r.CLONE_PROPS.length;d<e;d++)f=r.CLONE_PROPS[d][0],c[f]=a[f]||b[f]||r.CLONE_PROPS[d][1];return c};r.prototype.down=function(a,b){this.fireEvent(g.default.POINTERDOWN,a,b)};r.prototype.move=
function(a,b){this.fireEvent(g.default.POINTERMOVE,a,b)};r.prototype.up=function(a,b){this.fireEvent(g.default.POINTERUP,a,b)};r.prototype.enter=function(a,b){a.bubbles=!1;this.fireEvent(g.default.POINTERENTER,a,b)};r.prototype.leave=function(a,b){a.bubbles=!1;this.fireEvent(g.default.POINTERLEAVE,a,b)};r.prototype.over=function(a,b){a.bubbles=!0;this.fireEvent(g.default.POINTEROVER,a,b)};r.prototype.out=function(a,b){a.bubbles=!0;this.fireEvent(g.default.POINTEROUT,a,b)};r.prototype.cancel=function(a,
b){this.fireEvent(g.default.POINTERCANCEL,a,b)};r.prototype.leaveOut=function(a,b){this.out(a,b);this.contains_(a.target,a.relatedTarget)||this.leave(a,b)};r.prototype.enterOver=function(a,b){this.over(a,b);this.contains_(a.target,a.relatedTarget)||this.enter(a,b)};r.prototype.contains_=function(a,b){return a&&b?a.contains(b):!1};r.prototype.makeEvent=function(a,b,c){return new m.default(a,c,b)};r.prototype.fireEvent=function(a,b,c){a=this.makeEvent(a,b,c);this.dispatchEvent(a)};r.prototype.fireNativeEvent=
function(a){a=this.makeEvent(a.type,a,a);this.dispatchEvent(a)};r.prototype.wrapMouseEvent=function(a,b){return this.makeEvent(a,f.default.prepareEvent(b,this),b)};r.prototype.disposeInternal=function(){this.unregister_();h.default.prototype.disposeInternal.call(this)};r.CLONE_PROPS=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",
0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];k.default=r},{"../events.js":48,"../events/eventtarget.js":51,"../has.js":84,"../index.js":89,"../pointer/eventtype.js":134,"../pointer/mousesource.js":135,"../pointer/mssource.js":136,"../pointer/nativesource.js":137,"../pointer/pointerevent.js":138,"../pointer/touchsource.js":140}],140:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../array.js"),b=d(c);c=a("../pointer/eventsource.js");var h=d(c);a=a("../pointer/mousesource.js");var n=d(a),g=function(a,b){h.default.call(this,a,{touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel});this.pointerMap=a.pointerMap;this.mouseSource=b;this.firstTouchId_=void 0;this.clickCount_=0;this.resetId_=
void 0};e.default.inherits(g,h.default);g.DEDUP_TIMEOUT=2500;g.CLICK_COUNT_TIMEOUT=200;g.POINTER_TYPE="touch";g.prototype.isPrimaryTouch_=function(a){return this.firstTouchId_===a.identifier};g.prototype.setPrimaryTouch_=function(a){var b=Object.keys(this.pointerMap).length;if(0===b||1===b&&n.default.POINTER_ID.toString()in this.pointerMap)this.firstTouchId_=a.identifier,this.cancelResetClickCount_()};g.prototype.removePrimaryPointer_=function(a){a.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())};
g.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),g.CLICK_COUNT_TIMEOUT)};g.prototype.resetClickCountHandler_=function(){this.clickCount_=0;this.resetId_=void 0};g.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)};g.prototype.touchToPointer_=function(a,b){a=this.dispatcher.cloneEvent(a,b);a.pointerId=b.identifier+2;a.bubbles=!0;a.cancelable=!0;a.detail=this.clickCount_;a.button=0;a.buttons=1;a.width=
b.webkitRadiusX||b.radiusX||0;a.height=b.webkitRadiusY||b.radiusY||0;a.pressure=b.webkitForce||b.force||.5;a.isPrimary=this.isPrimaryTouch_(b);a.pointerType=g.POINTER_TYPE;a.clientX=b.clientX;a.clientY=b.clientY;a.screenX=b.screenX;a.screenY=b.screenY;return a};g.prototype.processTouches_=function(a,b){function c(){a.preventDefault()}var d=Array.prototype.slice.call(a.changedTouches),f=d.length,e;for(e=0;e<f;++e){var g=this.touchToPointer_(a,d[e]);g.preventDefault=c;b.call(this,a,g)}};g.prototype.findTouch_=
function(a,b){for(var c=a.length,d,f=0;f<c;f++)if(d=a[f],d.identifier===b)return!0;return!1};g.prototype.vacuumTouches_=function(a){var b=a.touches,c=Object.keys(this.pointerMap),d=c.length;if(d>=b.length){var f=[],e;for(e=0;e<d;++e){var g=c[e];var h=this.pointerMap[g];g==n.default.POINTER_ID||this.findTouch_(b,g-2)||f.push(h.out)}for(e=0;e<f.length;++e)this.cancelOut_(a,f[e])}};g.prototype.touchstart=function(a){this.vacuumTouches_(a);this.setPrimaryTouch_(a.changedTouches[0]);this.dedupSynthMouse_(a);
this.clickCount_++;this.processTouches_(a,this.overDown_)};g.prototype.overDown_=function(a,b){this.pointerMap[b.pointerId]={target:b.target,out:b,outTarget:b.target};this.dispatcher.over(b,a);this.dispatcher.enter(b,a);this.dispatcher.down(b,a)};g.prototype.touchmove=function(a){a.preventDefault();this.processTouches_(a,this.moveOverOut_)};g.prototype.moveOverOut_=function(a,b){var c=this.pointerMap[b.pointerId];if(c){var d=c.out,f=c.outTarget;this.dispatcher.move(b,a);d&&f!==b.target&&(d.relatedTarget=
b.target,b.relatedTarget=f,d.target=f,b.target?(this.dispatcher.leaveOut(d,a),this.dispatcher.enterOver(b,a)):(b.target=f,b.relatedTarget=null,this.cancelOut_(a,b)));c.out=b;c.outTarget=b.target}};g.prototype.touchend=function(a){this.dedupSynthMouse_(a);this.processTouches_(a,this.upOut_)};g.prototype.upOut_=function(a,b){this.dispatcher.up(b,a);this.dispatcher.out(b,a);this.dispatcher.leave(b,a);this.cleanUpPointer_(b)};g.prototype.touchcancel=function(a){this.processTouches_(a,this.cancelOut_)};
g.prototype.cancelOut_=function(a,b){this.dispatcher.cancel(b,a);this.dispatcher.out(b,a);this.dispatcher.leave(b,a);this.cleanUpPointer_(b)};g.prototype.cleanUpPointer_=function(a){delete this.pointerMap[a.pointerId];this.removePrimaryPointer_(a)};g.prototype.dedupSynthMouse_=function(a){var c=this.mouseSource.lastTouches;a=a.changedTouches[0];if(this.isPrimaryTouch_(a)){var d=[a.clientX,a.clientY];c.push(d);setTimeout(function(){b.default.remove(c,d)},g.DEDUP_TIMEOUT)}};k.default=g},{"../array.js":29,
"../index.js":89,"../pointer/eventsource.js":133,"../pointer/mousesource.js":135}],141:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./sphere.js");e=d(e);var b=a("./extent.js"),h=d(b);b=a("./math.js");var n=d(b);b=a("./proj/epsg3857.js");var g=d(b);b=a("./proj/epsg4326.js");var f=d(b);b=a("./proj/projection.js");var l=d(b);b=a("./proj/units.js");var q=d(b);b=a("./proj/proj4.js");var m=d(b);b=a("./proj/projections.js");
var p=d(b);a=a("./proj/transforms.js");var r=d(a),t={};t.METERS_PER_UNIT=q.default.METERS_PER_UNIT;t.SPHERE_=new e.default(e.default.DEFAULT_RADIUS);c.default.ENABLE_PROJ4JS&&(t.setProj4=function(a){m.default.set(a)});t.getPointResolution=function(a,b,c,d){a=t.get(a);var f=a.getPointResolutionFunc();f?b=f(b,c):a.getUnits()==q.default.DEGREES&&!d||d==q.default.DEGREES||(f=t.getTransformFromProjections(a,t.get("EPSG:4326")),b=[c[0]-b/2,c[1],c[0]+b/2,c[1],c[0],c[1]-b/2,c[0],c[1]+b/2],b=f(b,b,2),c=t.SPHERE_.haversineDistance(b.slice(0,
2),b.slice(2,4)),b=t.SPHERE_.haversineDistance(b.slice(4,6),b.slice(6,8)),b=(c+b)/2,a=d?q.default.METERS_PER_UNIT[d]:a.getMetersPerUnit(),void 0!==a&&(b/=a));return b};t.addEquivalentProjections=function(a){t.addProjections(a);a.forEach(function(b){a.forEach(function(a){b!==a&&r.default.add(b,a,t.cloneTransform)})})};t.addEquivalentTransforms=function(a,b,c,d){a.forEach(function(a){b.forEach(function(b){r.default.add(a,b,c);r.default.add(b,a,d)})})};t.addProjection=function(a){p.default.add(a.getCode(),
a);r.default.add(a,a,t.cloneTransform)};t.addProjections=function(a){a.forEach(t.addProjection)};t.clearAllProjections=function(){p.default.clear();r.default.clear()};t.createProjection=function(a,b){return a?"string"===typeof a?t.get(a):a:t.get(b)};t.addCoordinateTransforms=function(a,b,c,d){a=t.get(a);b=t.get(b);r.default.add(a,b,t.createTransformFromCoordinateTransform(c));r.default.add(b,a,t.createTransformFromCoordinateTransform(d))};t.createTransformFromCoordinateTransform=function(a){return function(b,
c,d){var f=b.length;d=void 0!==d?d:2;c=void 0!==c?c:Array(f);var e;for(e=0;e<f;e+=d){var g=a([b[e],b[e+1]]);c[e]=g[0];c[e+1]=g[1];for(g=d-1;2<=g;--g)c[e+g]=b[e+g]}return c}};t.fromLonLat=function(a,b){return t.transform(a,"EPSG:4326",void 0!==b?b:"EPSG:3857")};t.toLonLat=function(a,b){a=t.transform(a,void 0!==b?b:"EPSG:3857","EPSG:4326");b=a[0];if(-180>b||180<b)a[0]=n.default.modulo(b+180,360)-180;return a};t.get=function(a){var b=null;if(a instanceof l.default)b=a;else if("string"===typeof a&&(b=
p.default.get(a),c.default.ENABLE_PROJ4JS&&!b)){var d=m.default.get();"function"==typeof d&&void 0!==d.defs(a)&&(b=new l.default({code:a}),t.addProjection(b))}return b};t.equivalent=function(a,b){if(a===b)return!0;var c=a.getUnits()===b.getUnits();return a.getCode()===b.getCode()?c:t.getTransformFromProjections(a,b)===t.cloneTransform&&c};t.getTransform=function(a,b){a=t.get(a);b=t.get(b);return t.getTransformFromProjections(a,b)};t.getTransformFromProjections=function(a,b){var d=a.getCode(),f=b.getCode(),
e=r.default.get(d,f);if(c.default.ENABLE_PROJ4JS&&!e){var g=m.default.get();if("function"==typeof g){var h=g.defs(d),l=g.defs(f);void 0!==h&&void 0!==l&&(h===l?t.addEquivalentProjections([b,a]):(e=g(f,d),t.addCoordinateTransforms(b,a,e.forward,e.inverse)),e=r.default.get(d,f))}}e||(e=t.identityTransform);return e};t.identityTransform=function(a,b,c){if(void 0!==b&&a!==b){c=0;for(var d=a.length;c<d;++c)b[c]=a[c];a=b}return a};t.cloneTransform=function(a,b,c){if(void 0!==b){c=0;for(var d=a.length;c<
d;++c)b[c]=a[c];a=b}else a=a.slice();return a};t.transform=function(a,b,c){return t.getTransform(b,c)(a,void 0,a.length)};t.transformExtent=function(a,b,c){b=t.getTransform(b,c);return h.default.applyTransform(a,b)};t.transformWithProjections=function(a,b,c){return t.getTransformFromProjections(b,c)(a)};t.addCommon=function(){t.addEquivalentProjections(g.default.PROJECTIONS);t.addEquivalentProjections(f.default.PROJECTIONS);t.addEquivalentTransforms(f.default.PROJECTIONS,g.default.PROJECTIONS,g.default.fromEPSG4326,
g.default.toEPSG4326)};t.addCommon();k.default=t},{"./extent.js":54,"./index.js":89,"./math.js":123,"./proj/epsg3857.js":142,"./proj/epsg4326.js":143,"./proj/proj4.js":144,"./proj/projection.js":145,"./proj/projections.js":146,"./proj/transforms.js":147,"./proj/units.js":148,"./sphere.js":215}],142:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../math.js"),b=d(c);c=a("../proj/projection.js");
var h=d(c);a=a("../proj/units.js");var n=d(a),g={Projection_:function(a){h.default.call(this,{code:a,units:n.default.METERS,extent:g.EXTENT,global:!0,worldExtent:g.WORLD_EXTENT,getPointResolution:function(a,c){return a/b.default.cosh(c[1]/g.RADIUS)}})}};e.default.inherits(g.Projection_,h.default);g.RADIUS=6378137;g.HALF_SIZE=Math.PI*g.RADIUS;g.EXTENT=[-g.HALF_SIZE,-g.HALF_SIZE,g.HALF_SIZE,g.HALF_SIZE];g.WORLD_EXTENT=[-180,-85,180,85];g.PROJECTIONS=[new g.Projection_("EPSG:3857"),new g.Projection_("EPSG:102100"),
new g.Projection_("EPSG:102113"),new g.Projection_("EPSG:900913"),new g.Projection_("urn:ogc:def:crs:EPSG:6.18:3:3857"),new g.Projection_("urn:ogc:def:crs:EPSG::3857"),new g.Projection_("http://www.opengis.net/gml/srs/epsg.xml#3857")];g.fromEPSG4326=function(a,b,c){var d=a.length;c=1<c?c:2;void 0===b&&(b=2<c?a.slice():Array(d));for(var f=g.HALF_SIZE,e=0;e<d;e+=c){b[e]=f*a[e]/180;var h=g.RADIUS*Math.log(Math.tan(Math.PI*(a[e+1]+90)/360));h>f?h=f:h<-f&&(h=-f);b[e+1]=h}return b};g.toEPSG4326=function(a,
b,c){var d=a.length;c=1<c?c:2;void 0===b&&(b=2<c?a.slice():Array(d));for(var f=0;f<d;f+=c)b[f]=180*a[f]/g.HALF_SIZE,b[f+1]=360*Math.atan(Math.exp(a[f+1]/g.RADIUS))/Math.PI-90;return b};k.default=g},{"../index.js":89,"../math.js":123,"../proj/projection.js":145,"../proj/units.js":148}],143:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../proj/projection.js"),b=d(c);a=a("../proj/units.js");var h=
d(a),n={Projection_:function(a,c){b.default.call(this,{code:a,units:h.default.DEGREES,extent:n.EXTENT,axisOrientation:c,global:!0,metersPerUnit:n.METERS_PER_UNIT,worldExtent:n.EXTENT})}};e.default.inherits(n.Projection_,b.default);n.RADIUS=6378137;n.EXTENT=[-180,-90,180,90];n.METERS_PER_UNIT=Math.PI*n.RADIUS/180;n.PROJECTIONS=[new n.Projection_("CRS:84"),new n.Projection_("EPSG:4326","neu"),new n.Projection_("urn:ogc:def:crs:EPSG::4326","neu"),new n.Projection_("urn:ogc:def:crs:EPSG:6.6:4326","neu"),
new n.Projection_("urn:ogc:def:crs:OGC:1.3:CRS84"),new n.Projection_("urn:ogc:def:crs:OGC:2:84"),new n.Projection_("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new n.Projection_("urn:x-ogc:def:crs:EPSG:4326","neu")];k.default=n},{"../index.js":89,"../proj/projection.js":145,"../proj/units.js":148}],144:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={cache_:null,set:function(a){d.cache_=a},get:function(){return d.cache_||window.proj4}};k.default=d},{}],145:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../proj/units.js");var b=d(e);a=a("../proj/proj4.js");var h=d(a);a=function(a){this.code_=a.code;this.units_=a.units;this.extent_=void 0!==a.extent?a.extent:null;this.worldExtent_=void 0!==a.worldExtent?a.worldExtent:null;this.axisOrientation_=void 0!==a.axisOrientation?a.axisOrientation:"enu";this.global_=void 0!==a.global?a.global:!1;this.canWrapX_=!(!this.global_||
!this.extent_);this.getPointResolutionFunc_=a.getPointResolution;this.defaultTileGrid_=null;this.metersPerUnit_=a.metersPerUnit;var b=a.code;if(c.default.ENABLE_PROJ4JS){var d=h.default.get();"function"==typeof d&&(b=d.defs(b),void 0!==b&&(void 0!==b.axis&&void 0===a.axisOrientation&&(this.axisOrientation_=b.axis),void 0===a.metersPerUnit&&(this.metersPerUnit_=b.to_meter),void 0===a.units&&(this.units_=b.units)))}};a.prototype.canWrapX=function(){return this.canWrapX_};a.prototype.getCode=function(){return this.code_};
a.prototype.getExtent=function(){return this.extent_};a.prototype.getUnits=function(){return this.units_};a.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||b.default.METERS_PER_UNIT[this.units_]};a.prototype.getWorldExtent=function(){return this.worldExtent_};a.prototype.getAxisOrientation=function(){return this.axisOrientation_};a.prototype.isGlobal=function(){return this.global_};a.prototype.setGlobal=function(a){this.global_=a;this.canWrapX_=!(!a||!this.extent_)};a.prototype.getDefaultTileGrid=
function(){return this.defaultTileGrid_};a.prototype.setDefaultTileGrid=function(a){this.defaultTileGrid_=a};a.prototype.setExtent=function(a){this.extent_=a;this.canWrapX_=!(!this.global_||!a)};a.prototype.setWorldExtent=function(a){this.worldExtent_=a};a.prototype.setGetPointResolution=function(a){this.getPointResolutionFunc_=a};a.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};k.default=a},{"../index.js":89,"../proj/proj4.js":144,"../proj/units.js":148}],146:[function(a,
e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={cache_:{},clear:function(){d.cache_={}},get:function(a){return d.cache_[a]||null},add:function(a,b){d.cache_[a]=b}};k.default=d},{}],147:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../obj.js"))&&a.__esModule?a:{default:a},c={cache_:{},clear:function(){c.cache_={}},add:function(a,d,e){a=a.getCode();d=d.getCode();var b=c.cache_;a in b||(b[a]={});b[a][d]=e},remove:function(a,e){a=a.getCode();e=e.getCode();
var b=c.cache_,g=b[a][e];delete b[a][e];d.default.isEmpty(b[a])&&delete b[a];return g},get:function(a,d){var b,e=c.cache_;a in e&&d in e[a]&&(b=e[a][d]);return b}};k.default=c},{"../obj.js":124}],148:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft",METERS_PER_UNIT:{}};a.METERS_PER_UNIT[a.DEGREES]=12741994*Math.PI/360;a.METERS_PER_UNIT[a.FEET]=.3048;a.METERS_PER_UNIT[a.METERS]=1;a.METERS_PER_UNIT[a.USFEET]=
1200/3937;k.default=a},{}],149:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../disposable.js");c=d(c);a=a("../geom/polygon.js");var b=d(a);a=function(a){this.geometry_=null;this.element_=document.createElement("div");this.element_.style.position="absolute";this.element_.className="ol-box "+a;this.endPixel_=this.startPixel_=this.map_=null};e.default.inherits(a,c.default);a.prototype.disposeInternal=
function(){this.setMap(null)};a.prototype.render_=function(){var a=this.startPixel_,b=this.endPixel_,c=this.element_.style;c.left=Math.min(a[0],b[0])+"px";c.top=Math.min(a[1],b[1])+"px";c.width=Math.abs(b[0]-a[0])+"px";c.height=Math.abs(b[1]-a[1])+"px"};a.prototype.setMap=function(a){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var b=this.element_.style;b.left=b.top=b.width=b.height="inherit"}(this.map_=a)&&this.map_.getOverlayContainer().appendChild(this.element_)};a.prototype.setPixels=
function(a,b){this.startPixel_=a;this.endPixel_=b;this.createOrUpdateGeometry();this.render_()};a.prototype.createOrUpdateGeometry=function(){var a=this.startPixel_,c=this.endPixel_;a=[a,[a[0],c[1]],c,[c[0],a[1]]].map(this.map_.getCoordinateFromPixel,this.map_);a[4]=a[0].slice();this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new b.default([a])};a.prototype.getGeometry=function(){return this.geometry_};k.default=a},{"../disposable.js":45,"../geom/polygon.js":82,"../index.js":89}],
150:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../css.js");var c=d(e);e=a("../dom.js");var b=d(e);e=a("../obj.js");var h=d(e);e=a("../structs/lrucache.js");e=d(e);a=a("../transform.js");a=d(a);var n={defaultFont:"10px sans-serif",defaultFillStyle:[0,0,0,1],defaultLineCap:"round",defaultLineDash:[],defaultLineDashOffset:0,defaultLineJoin:"round",defaultMiterLimit:10,defaultStrokeStyle:[0,0,0,1],defaultTextAlign:"center",
defaultTextBaseline:"middle",defaultPadding:[0,0,0,0],defaultLineWidth:1};n.labelCache=new e.default;n.checkedFonts_={};n.measureContext_=null;n.textHeights_={};n.checkFont=function(){function a(a){var b=n.getMeasureContext();b.font="32px monospace";p=b.measureText("wmytzilWMYTZIL@#/&?$%10").width;var c=!0;"monospace"!=a&&(b.font="32px "+a+",monospace",c=b.measureText("wmytzilWMYTZIL@#/&?$%10").width!=p);return c}function b(){var b=!0,c;for(c in d)60>d[c]&&(a(c)?(d[c]=60,h.default.clear(n.textHeights_),
n.measureContext_=null,e.clear()):(++d[c],b=!1));b&&(window.clearInterval(m),m=void 0)}var d=n.checkedFonts_,e=n.labelCache,m,p;return function(f){if(f=c.default.getFontFamilies(f))for(var e=0,g=f.length;e<g;++e){var h=f[e];h in d||(d[h]=60,a(h)||(d[h]=0,void 0===m&&(m=window.setInterval(b,32))))}}}();n.getMeasureContext=function(){var a=n.measureContext_;a||(a=n.measureContext_=b.default.createCanvasContext2D(1,1));return a};n.measureTextHeight=function(){var a,b=n.textHeights_;return function(c){var d=
b[c];void 0==d&&(a||(a=document.createElement("span"),a.textContent="M",a.style.margin=a.style.padding="0 !important",a.style.position="absolute !important",a.style.left="-99999px !important"),a.style.font=c,document.body.appendChild(a),d=b[c]=a.offsetHeight,document.body.removeChild(a));return d}}();n.measureTextWidth=function(a,b){var c=n.getMeasureContext();a!=c.font&&(c.font=a);return c.measureText(b).width};n.rotateAtOffset=function(a,b,c,d){0!==b&&(a.translate(c,d),a.rotate(b),a.translate(-c,
-d))};n.resetTransform_=a.default.create();n.drawImage=function(a,b,c,d,e,h,k,t,u,y,w){if(1!=c){var f=a.globalAlpha;a.globalAlpha=f*c}b&&a.setTransform.apply(a,b);a.drawImage(d,e,h,k,t,u,y,k*w,t*w);f&&(a.globalAlpha=f);b&&a.setTransform.apply(a,n.resetTransform_)};k.default=n},{"../css.js":44,"../dom.js":46,"../obj.js":124,"../structs/lrucache.js":218,"../transform.js":243}],151:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=
a("../../index.js");e=d(e);var c=a("../canvas/instruction.js"),b=d(c);a=a("../canvas/replay.js");var h=d(a);a=function(a,b,c,d,e,m){h.default.call(this,a,b,c,d,e,m);this.image_=this.hitDetectionImage_=this.declutterGroup_=null;this.width_=this.snapToPixel_=this.scale_=this.rotation_=this.rotateWithView_=this.originY_=this.originX_=this.opacity_=this.height_=this.anchorY_=this.anchorX_=void 0};e.default.inherits(a,h.default);a.prototype.drawCoordinates_=function(a,b,c,d){return this.appendFlatCoordinates(a,
b,c,d,!1,!1)};a.prototype.drawPoint=function(a,c){if(this.image_){this.beginGeometry(a,c);var d=a.getFlatCoordinates(),e=a.getStride(),g=this.coordinates.length;d=this.drawCoordinates_(d,0,d.length,e);this.instructions.push([b.default.DRAW_IMAGE,g,d,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([b.default.DRAW_IMAGE,
g,d,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(a,c)}};a.prototype.drawMultiPoint=function(a,c){if(this.image_){this.beginGeometry(a,c);var d=a.getFlatCoordinates(),e=a.getStride(),g=this.coordinates.length;d=this.drawCoordinates_(d,0,d.length,e);this.instructions.push([b.default.DRAW_IMAGE,g,d,this.image_,this.anchorX_,
this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]);this.hitDetectionInstructions.push([b.default.DRAW_IMAGE,g,d,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]);this.endGeometry(a,c)}};a.prototype.finish=function(){this.reverseHitDetectionInstructions();
this.anchorY_=this.anchorX_=void 0;this.image_=this.hitDetectionImage_=null;this.width_=this.snapToPixel_=this.rotation_=this.rotateWithView_=this.originY_=this.originX_=this.opacity_=this.scale_=this.height_=void 0};a.prototype.setImageStyle=function(a,b){var c=a.getAnchor(),d=a.getSize(),e=a.getHitDetectionImage(1),g=a.getImage(1),h=a.getOrigin();this.anchorX_=c[0];this.anchorY_=c[1];this.declutterGroup_=b;this.hitDetectionImage_=e;this.image_=g;this.height_=d[1];this.opacity_=a.getOpacity();this.originX_=
h[0];this.originY_=h[1];this.rotateWithView_=a.getRotateWithView();this.rotation_=a.getRotation();this.scale_=a.getScale();this.snapToPixel_=a.getSnapToPixel();this.width_=d[0]};k.default=a},{"../../index.js":89,"../canvas/instruction.js":153,"../canvas/replay.js":156}],152:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../array.js"),b=d(c);c=a("../../colorlike.js");var h=d(c);c=a("../../extent.js");
var n=d(c);c=a("../../geom/geometrytype.js");var g=d(c);c=a("../../geom/simplegeometry.js");var f=d(c);c=a("../../geom/flat/transform.js");var l=d(c);c=a("../../has.js");var q=d(c);c=a("../vectorcontext.js");var m=d(c);c=a("../canvas.js");var p=d(c);a=a("../../transform.js");var r=d(a);a=function(a,b,c,d,f){m.default.call(this);this.context_=a;this.pixelRatio_=b;this.extent_=c;this.transform_=d;this.viewRotation_=f;this.image_=this.strokeState_=this.fillState_=this.contextTextState_=this.contextStrokeState_=
this.contextFillState_=null;this.imageOriginY_=this.imageOriginX_=this.imageOpacity_=this.imageHeight_=this.imageAnchorY_=this.imageAnchorX_=0;this.imageRotateWithView_=!1;this.imageScale_=this.imageRotation_=0;this.imageSnapToPixel_=!1;this.imageWidth_=0;this.text_="";this.textOffsetY_=this.textOffsetX_=0;this.textRotateWithView_=!1;this.textScale_=this.textRotation_=0;this.textState_=this.textStrokeState_=this.textFillState_=null;this.pixelCoordinates_=[];this.tmpLocalTransform_=r.default.create()};
e.default.inherits(a,m.default);a.prototype.drawImages_=function(a,b,c,d){if(this.image_){a=l.default.transform2D(a,b,c,2,this.transform_,this.pixelCoordinates_);b=this.context_;c=this.tmpLocalTransform_;d=b.globalAlpha;1!=this.imageOpacity_&&(b.globalAlpha=d*this.imageOpacity_);var f=this.imageRotation_;this.imageRotateWithView_&&(f+=this.viewRotation_);var e;var g=0;for(e=a.length;g<e;g+=2){var h=a[g]-this.imageAnchorX_,m=a[g+1]-this.imageAnchorY_;this.imageSnapToPixel_&&(h=Math.round(h),m=Math.round(m));
if(0!==f||1!=this.imageScale_){var p=h+this.imageAnchorX_,t=m+this.imageAnchorY_;r.default.compose(c,p,t,this.imageScale_,this.imageScale_,f,-p,-t);b.setTransform.apply(b,c)}b.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,m,this.imageWidth_,this.imageHeight_)}0===f&&1==this.imageScale_||b.setTransform(1,0,0,1,0,0);1!=this.imageOpacity_&&(b.globalAlpha=d)}};a.prototype.drawText_=function(a,b,c,d){if(this.textState_&&""!==this.text_){this.textFillState_&&
this.setContextFillState_(this.textFillState_);this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_);this.setContextTextState_(this.textState_);a=l.default.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_);var f=this.context_,e=this.textRotation_;for(this.textRotateWithView_&&(e+=this.viewRotation_);b<c;b+=d){var g=a[b]+this.textOffsetX_,h=a[b+1]+this.textOffsetY_;if(0!==e||1!=this.textScale_){var m=r.default.compose(this.tmpLocalTransform_,g,h,this.textScale_,this.textScale_,
e,-g,-h);f.setTransform.apply(f,m)}this.textStrokeState_&&f.strokeText(this.text_,g,h);this.textFillState_&&f.fillText(this.text_,g,h)}0===e&&1==this.textScale_||f.setTransform(1,0,0,1,0,0)}};a.prototype.moveToLineTo_=function(a,b,c,d,f){var e=this.context_;a=l.default.transform2D(a,b,c,d,this.transform_,this.pixelCoordinates_);e.moveTo(a[0],a[1]);b=a.length;f&&(b-=2);for(d=2;d<b;d+=2)e.lineTo(a[d],a[d+1]);f&&e.closePath();return c};a.prototype.drawRings_=function(a,b,c,d){var f;var e=0;for(f=c.length;e<
f;++e)b=this.moveToLineTo_(a,b,c[e],d,!0);return b};a.prototype.drawCircle=function(a){if(n.default.intersects(this.extent_,a.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=f.default.transform2D(a,this.transform_,this.pixelCoordinates_),c=b[2]-b[0],d=b[3]-b[1];c=Math.sqrt(c*c+d*d);d=this.context_;d.beginPath();d.arc(b[0],b[1],c,0,2*Math.PI);this.fillState_&&d.fill();
this.strokeState_&&d.stroke()}""!==this.text_&&this.drawText_(a.getCenter(),0,2,2)}};a.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke());this.setImageStyle(a.getImage());this.setTextStyle(a.getText())};a.prototype.drawGeometry=function(a){switch(a.getType()){case g.default.POINT:this.drawPoint(a);break;case g.default.LINE_STRING:this.drawLineString(a);break;case g.default.POLYGON:this.drawPolygon(a);break;case g.default.MULTI_POINT:this.drawMultiPoint(a);break;case g.default.MULTI_LINE_STRING:this.drawMultiLineString(a);
break;case g.default.MULTI_POLYGON:this.drawMultiPolygon(a);break;case g.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a);break;case g.default.CIRCLE:this.drawCircle(a)}};a.prototype.drawFeature=function(a,b){(a=b.getGeometryFunction()(a))&&n.default.intersects(this.extent_,a.getExtent())&&(this.setStyle(b),this.drawGeometry(a))};a.prototype.drawGeometryCollection=function(a){a=a.getGeometriesArray();var b;var c=0;for(b=a.length;c<b;++c)this.drawGeometry(a[c])};a.prototype.drawPoint=function(a){var b=
a.getFlatCoordinates();a=a.getStride();this.image_&&this.drawImages_(b,0,b.length,a);""!==this.text_&&this.drawText_(b,0,b.length,a)};a.prototype.drawMultiPoint=function(a){var b=a.getFlatCoordinates();a=a.getStride();this.image_&&this.drawImages_(b,0,b.length,a);""!==this.text_&&this.drawText_(b,0,b.length,a)};a.prototype.drawLineString=function(a){if(n.default.intersects(this.extent_,a.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getFlatCoordinates();
b.beginPath();this.moveToLineTo_(c,0,c.length,a.getStride(),!1);b.stroke()}""!==this.text_&&(a=a.getFlatMidpoint(),this.drawText_(a,0,2,2))}};a.prototype.drawMultiLineString=function(a){var b=a.getExtent();if(n.default.intersects(this.extent_,b)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);b=this.context_;var c=a.getFlatCoordinates(),d=0,f=a.getEnds(),e=a.getStride();b.beginPath();var g;var h=0;for(g=f.length;h<g;++h)d=this.moveToLineTo_(c,d,f[h],e,!1);b.stroke()}""!==this.text_&&
(a=a.getFlatMidpoints(),this.drawText_(a,0,a.length,2))}};a.prototype.drawPolygon=function(a){if(n.default.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_;b.beginPath();this.drawRings_(a.getOrientedFlatCoordinates(),0,a.getEnds(),a.getStride());this.fillState_&&b.fill();this.strokeState_&&b.stroke()}""!==this.text_&&(a=a.getFlatInteriorPoint(),
this.drawText_(a,0,2,2))}};a.prototype.drawMultiPolygon=function(a){if(n.default.intersects(this.extent_,a.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_);this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var b=this.context_,c=a.getOrientedFlatCoordinates(),d=0,f=a.getEndss(),e=a.getStride(),g;b.beginPath();var h=0;for(g=f.length;h<g;++h)d=this.drawRings_(c,d,f[h],e);this.fillState_&&b.fill();this.strokeState_&&b.stroke()}""!==
this.text_&&(a=a.getFlatInteriorPoints(),this.drawText_(a,0,a.length,2))}};a.prototype.setContextFillState_=function(a){var b=this.context_,c=this.contextFillState_;c?c.fillStyle!=a.fillStyle&&(c.fillStyle=b.fillStyle=a.fillStyle):(b.fillStyle=a.fillStyle,this.contextFillState_={fillStyle:a.fillStyle})};a.prototype.setContextStrokeState_=function(a){var c=this.context_,d=this.contextStrokeState_;d?(d.lineCap!=a.lineCap&&(d.lineCap=c.lineCap=a.lineCap),q.default.CANVAS_LINE_DASH&&(b.default.equals(d.lineDash,
a.lineDash)||c.setLineDash(d.lineDash=a.lineDash),d.lineDashOffset!=a.lineDashOffset&&(d.lineDashOffset=c.lineDashOffset=a.lineDashOffset)),d.lineJoin!=a.lineJoin&&(d.lineJoin=c.lineJoin=a.lineJoin),d.lineWidth!=a.lineWidth&&(d.lineWidth=c.lineWidth=a.lineWidth),d.miterLimit!=a.miterLimit&&(d.miterLimit=c.miterLimit=a.miterLimit),d.strokeStyle!=a.strokeStyle&&(d.strokeStyle=c.strokeStyle=a.strokeStyle)):(c.lineCap=a.lineCap,q.default.CANVAS_LINE_DASH&&(c.setLineDash(a.lineDash),c.lineDashOffset=a.lineDashOffset),
c.lineJoin=a.lineJoin,c.lineWidth=a.lineWidth,c.miterLimit=a.miterLimit,c.strokeStyle=a.strokeStyle,this.contextStrokeState_={lineCap:a.lineCap,lineDash:a.lineDash,lineDashOffset:a.lineDashOffset,lineJoin:a.lineJoin,lineWidth:a.lineWidth,miterLimit:a.miterLimit,strokeStyle:a.strokeStyle})};a.prototype.setContextTextState_=function(a){var b=this.context_,c=this.contextTextState_,d=a.textAlign?a.textAlign:p.default.defaultTextAlign;c?(c.font!=a.font&&(c.font=b.font=a.font),c.textAlign!=d&&(c.textAlign=
d),c.textBaseline!=a.textBaseline&&(c.textBaseline=b.textBaseline=a.textBaseline)):(b.font=a.font,b.textAlign=d,b.textBaseline=a.textBaseline,this.contextTextState_={font:a.font,textAlign:d,textBaseline:a.textBaseline})};a.prototype.setFillStrokeStyle=function(a,b){a?(a=a.getColor(),this.fillState_={fillStyle:h.default.asColorLike(a?a:p.default.defaultFillStyle)}):this.fillState_=null;if(b){a=b.getColor();var c=b.getLineCap(),d=b.getLineDash(),f=b.getLineDashOffset(),e=b.getLineJoin(),g=b.getWidth();
b=b.getMiterLimit();this.strokeState_={lineCap:void 0!==c?c:p.default.defaultLineCap,lineDash:d?d:p.default.defaultLineDash,lineDashOffset:f?f:p.default.defaultLineDashOffset,lineJoin:void 0!==e?e:p.default.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==g?g:p.default.defaultLineWidth),miterLimit:void 0!==b?b:p.default.defaultMiterLimit,strokeStyle:h.default.asColorLike(a?a:p.default.defaultStrokeStyle)}}else this.strokeState_=null};a.prototype.setImageStyle=function(a){if(a){var b=a.getAnchor(),
c=a.getImage(1),d=a.getOrigin(),f=a.getSize();this.imageAnchorX_=b[0];this.imageAnchorY_=b[1];this.imageHeight_=f[1];this.image_=c;this.imageOpacity_=a.getOpacity();this.imageOriginX_=d[0];this.imageOriginY_=d[1];this.imageRotateWithView_=a.getRotateWithView();this.imageRotation_=a.getRotation();this.imageScale_=a.getScale()*this.pixelRatio_;this.imageSnapToPixel_=a.getSnapToPixel();this.imageWidth_=f[0]}else this.image_=null};a.prototype.setTextStyle=function(a){if(a){var b=a.getFill();b?(b=b.getColor(),
this.textFillState_={fillStyle:h.default.asColorLike(b?b:p.default.defaultFillStyle)}):this.textFillState_=null;var c=a.getStroke();if(c){b=c.getColor();var d=c.getLineCap(),f=c.getLineDash(),e=c.getLineDashOffset(),g=c.getLineJoin(),l=c.getWidth();c=c.getMiterLimit();this.textStrokeState_={lineCap:void 0!==d?d:p.default.defaultLineCap,lineDash:f?f:p.default.defaultLineDash,lineDashOffset:e?e:p.default.defaultLineDashOffset,lineJoin:void 0!==g?g:p.default.defaultLineJoin,lineWidth:void 0!==l?l:p.default.defaultLineWidth,
miterLimit:void 0!==c?c:p.default.defaultMiterLimit,strokeStyle:h.default.asColorLike(b?b:p.default.defaultStrokeStyle)}}else this.textStrokeState_=null;b=a.getFont();d=a.getOffsetX();f=a.getOffsetY();e=a.getRotateWithView();g=a.getRotation();l=a.getScale();c=a.getText();var m=a.getTextAlign();a=a.getTextBaseline();this.textState_={font:void 0!==b?b:p.default.defaultFont,textAlign:void 0!==m?m:p.default.defaultTextAlign,textBaseline:void 0!==a?a:p.default.defaultTextBaseline};this.text_=void 0!==
c?c:"";this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0;this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0;this.textRotateWithView_=void 0!==e?e:!1;this.textRotation_=void 0!==g?g:0;this.textScale_=this.pixelRatio_*(void 0!==l?l:1)}else this.text_=""};k.default=a},{"../../array.js":29,"../../colorlike.js":37,"../../extent.js":54,"../../geom/flat/transform.js":76,"../../geom/geometrytype.js":79,"../../geom/simplegeometry.js":83,"../../has.js":84,"../../index.js":89,"../../transform.js":243,"../canvas.js":150,
"../vectorcontext.js":164}],153:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12}},{}],154:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../canvas/instruction.js"),b=d(c);a=a("../canvas/replay.js");
var h=d(a);a=function(a,b,c,d,e,m){h.default.call(this,a,b,c,d,e,m)};e.default.inherits(a,h.default);a.prototype.drawFlatCoordinates_=function(a,c,d,e){var f=this.coordinates.length;a=this.appendFlatCoordinates(a,c,d,e,!1,!1);f=[b.default.MOVE_TO_LINE_TO,f,a];this.instructions.push(f);this.hitDetectionInstructions.push(f);return d};a.prototype.drawLineString=function(a,c){var d=this.state,e=d.lineWidth;void 0!==d.strokeStyle&&void 0!==e&&(this.updateStrokeStyle(d,this.applyStroke),this.beginGeometry(a,
c),this.hitDetectionInstructions.push([b.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset],[b.default.BEGIN_PATH]),d=a.getFlatCoordinates(),e=a.getStride(),this.drawFlatCoordinates_(d,0,d.length,e),this.hitDetectionInstructions.push([b.default.STROKE]),this.endGeometry(a,c))};a.prototype.drawMultiLineString=function(a,c){var d=this.state,e=d.lineWidth;if(void 0!==d.strokeStyle&&void 0!==e){this.updateStrokeStyle(d,this.applyStroke);this.beginGeometry(a,
c);this.hitDetectionInstructions.push([b.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset],[b.default.BEGIN_PATH]);d=a.getEnds();e=a.getFlatCoordinates();var g=a.getStride(),h=0,p;var n=0;for(p=d.length;n<p;++n)h=this.drawFlatCoordinates_(e,h,d[n],g);this.hitDetectionInstructions.push([b.default.STROKE]);this.endGeometry(a,c)}};a.prototype.finish=function(){var a=this.state;void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&
this.instructions.push([b.default.STROKE]);this.reverseHitDetectionInstructions();this.state=null};a.prototype.applyStroke=function(a){void 0!=a.lastStroke&&a.lastStroke!=this.coordinates.length&&(this.instructions.push([b.default.STROKE]),a.lastStroke=this.coordinates.length);a.lastStroke=0;h.default.prototype.applyStroke.call(this,a);this.instructions.push([b.default.BEGIN_PATH])};k.default=a},{"../../index.js":89,"../canvas/instruction.js":153,"../canvas/replay.js":156}],155:[function(a,e,k){function d(a){return a&&
a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../color.js"),b=d(c);c=a("../../geom/flat/simplify.js");var h=d(c);c=a("../canvas.js");var n=d(c);c=a("../canvas/instruction.js");var g=d(c);a=a("../canvas/replay.js");var f=d(a);a=function(a,b,c,d,e,g){f.default.call(this,a,b,c,d,e,g)};e.default.inherits(a,f.default);a.prototype.drawFlatCoordinatess_=function(a,b,c,d){var e=this.state,f=void 0!==e.fillStyle;e=void 0!=e.strokeStyle;
var h=c.length,l=[g.default.BEGIN_PATH];this.instructions.push(l);this.hitDetectionInstructions.push(l);for(l=0;l<h;++l){var m=c[l],p=this.coordinates.length;b=this.appendFlatCoordinates(a,b,m,d,!0,!e);b=[g.default.MOVE_TO_LINE_TO,p,b];this.instructions.push(b);this.hitDetectionInstructions.push(b);e&&(b=[g.default.CLOSE_PATH],this.instructions.push(b),this.hitDetectionInstructions.push(b));b=m}a=[g.default.FILL];this.hitDetectionInstructions.push(a);f&&this.instructions.push(a);e&&(f=[g.default.STROKE],
this.instructions.push(f),this.hitDetectionInstructions.push(f));return b};a.prototype.drawCircle=function(a,c){var d=this.state,e=d.strokeStyle;if(void 0!==d.fillStyle||void 0!==e){this.setFillStrokeStyles_(a);this.beginGeometry(a,c);this.hitDetectionInstructions.push([g.default.SET_FILL_STYLE,b.default.asString(n.default.defaultFillStyle)]);void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([g.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,
d.lineDashOffset]);var f=a.getFlatCoordinates(),h=a.getStride();e=this.coordinates.length;this.appendFlatCoordinates(f,0,f.length,h,!1,!1);f=[g.default.BEGIN_PATH];e=[g.default.CIRCLE,e];this.instructions.push(f,e);this.hitDetectionInstructions.push(f,e);e=[g.default.FILL];this.hitDetectionInstructions.push(e);void 0!==d.fillStyle&&this.instructions.push(e);void 0!==d.strokeStyle&&(d=[g.default.STROKE],this.instructions.push(d),this.hitDetectionInstructions.push(d));this.endGeometry(a,c)}};a.prototype.drawPolygon=
function(a,c){var d=this.state;this.setFillStrokeStyles_(a);this.beginGeometry(a,c);this.hitDetectionInstructions.push([g.default.SET_FILL_STYLE,b.default.asString(n.default.defaultFillStyle)]);void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([g.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset]);d=a.getEnds();var e=a.getOrientedFlatCoordinates(),f=a.getStride();this.drawFlatCoordinatess_(e,0,d,f);this.endGeometry(a,c)};a.prototype.drawMultiPolygon=
function(a,c){var d=this.state,e=d.strokeStyle;if(void 0!==d.fillStyle||void 0!==e){this.setFillStrokeStyles_(a);this.beginGeometry(a,c);this.hitDetectionInstructions.push([g.default.SET_FILL_STYLE,b.default.asString(n.default.defaultFillStyle)]);void 0!==d.strokeStyle&&this.hitDetectionInstructions.push([g.default.SET_STROKE_STYLE,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash,d.lineDashOffset]);d=a.getEndss();e=a.getOrientedFlatCoordinates();var f=a.getStride(),h=0,l;var k=
0;for(l=d.length;k<l;++k)h=this.drawFlatCoordinatess_(e,h,d[k],f);this.endGeometry(a,c)}};a.prototype.finish=function(){this.reverseHitDetectionInstructions();this.state=null;var a=this.tolerance;if(0!==a){var b=this.coordinates,c;var d=0;for(c=b.length;d<c;++d)b[d]=h.default.snap(b[d],a)}};a.prototype.setFillStrokeStyles_=function(a){var b=this.state;void 0!==b.fillStyle&&this.updateFillStyle(b,this.applyFill,a);void 0!==b.strokeStyle&&this.updateStrokeStyle(b,this.applyStroke)};k.default=a},{"../../color.js":36,
"../../geom/flat/simplify.js":72,"../../index.js":89,"../canvas.js":150,"../canvas/instruction.js":153,"../canvas/replay.js":156}],156:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../array.js");var b=d(e);e=a("../../colorlike.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../../extent/relationship.js");var g=d(e);e=a("../../geom/geometrytype.js");var f=d(e);e=a("../../geom/flat/inflate.js");
var l=d(e);e=a("../../geom/flat/length.js");var q=d(e);e=a("../../geom/flat/textpath.js");var m=d(e);e=a("../../geom/flat/transform.js");var p=d(e);e=a("../../has.js");var r=d(e);e=a("../../obj.js");var t=d(e);e=a("../vectorcontext.js");var u=d(e);e=a("../canvas.js");var y=d(e);e=a("../canvas/instruction.js");var w=d(e);e=a("../replay.js");var v=d(e);a=a("../../transform.js");var A=d(a);a=function(a,b,c,d,e,f){u.default.call(this);this.declutterTree=f;this.tmpExtent_=n.default.createEmpty();this.tolerance=
a;this.maxExtent=b;this.overlaps=e;this.pixelRatio=d;this.maxLineWidth=0;this.resolution=c;this.fillOrigin_;this.bufferedMaxExtent_=this.beginGeometryInstruction2_=this.beginGeometryInstruction1_=null;this.instructions=[];this.coordinates=[];this.coordinateCache_={};this.renderedTransform_=A.default.create();this.hitDetectionInstructions=[];this.pixelCoordinates_=null;this.state={};this.viewRotation_=0;this.tmpLocalTransform_=A.default.create();this.resetTransform_=A.default.create()};c.default.inherits(a,
u.default);a.prototype.replayTextBackground_=function(a,b,c,d,e,f,g){a.beginPath();a.moveTo.apply(a,b);a.lineTo.apply(a,c);a.lineTo.apply(a,d);a.lineTo.apply(a,e);a.lineTo.apply(a,b);f&&(this.fillOrigin_=f[2],this.fill_(a));g&&(this.setStrokeStyle_(a,g),a.stroke())};a.prototype.replayImage_=function(a,b,c,d,e,f,g,h,l,m,p,k,r,u,t,v,q,w){var C=q||w,z=this.tmpLocalTransform_;e*=r;f*=r;b-=e;c-=f;u&&(b=Math.round(b),c=Math.round(c));u=t+m>d.width?d.width-m:t;h=h+p>d.height?d.height-p:h;t=this.tmpExtent_;
var x=v[3]+u*r+v[1],B=v[0]+h*r+v[2],S=b-v[3],I=c-v[0];if(C||0!==k){var M=[S,I];var H=[S+x,I];var D=[S+x,I+B];var J=[S,I+B]}v=null;0!==k?(e=b+e,f=c+f,v=A.default.compose(z,e,f,1,1,k,-e,-f),n.default.createOrUpdateEmpty(t),n.default.extendCoordinate(t,A.default.apply(z,M)),n.default.extendCoordinate(t,A.default.apply(z,H)),n.default.extendCoordinate(t,A.default.apply(z,D)),n.default.extendCoordinate(t,A.default.apply(z,J))):n.default.createOrUpdate(S,I,S+x,I+B,t);k=a.canvas;k=t[0]<=k.width&&0<=t[2]&&
t[1]<=k.height&&0<=t[3];if(g){if(k||1!=g[4])n.default.extend(g,t),(a=k?[a,v?v.slice(0):null,l,d,m,p,u,h,b,c,r]:null)&&C&&a.push(q,w,M,H,D,J),g.push(a)}else k&&(C&&this.replayTextBackground_(a,M,H,D,J,q,w),y.default.drawImage(a,v,l,d,m,p,u,h,b,c,r))};a.prototype.applyPixelRatio=function(a){var b=this.pixelRatio;return 1==b?a:a.map(function(a){return a*b})};a.prototype.appendFlatCoordinates=function(a,b,c,d,e,f){var h=this.coordinates.length,l=this.getBufferedMaxExtent();f&&(b+=d);f=[a[b],a[b+1]];var m=
[NaN,NaN],p=!0,k;for(k=b+d;k<c;k+=d){m[0]=a[k];m[1]=a[k+1];var z=n.default.coordinateRelationship(l,m);z!==C?(p&&(this.coordinates[h++]=f[0],this.coordinates[h++]=f[1]),this.coordinates[h++]=m[0],this.coordinates[h++]=m[1],p=!1):z===g.default.INTERSECTING?(this.coordinates[h++]=m[0],this.coordinates[h++]=m[1],p=!1):p=!0;f[0]=m[0];f[1]=m[1];var C=z}if(e&&p||k===b+d)this.coordinates[h++]=f[0],this.coordinates[h++]=f[1];return h};a.prototype.drawCustomCoordinates_=function(a,b,c,d,e){for(var f=0,g=c.length;f<
g;++f){var h=c[f];b=this.appendFlatCoordinates(a,b,h,d,!1,!1);e.push(b);b=h}return b};a.prototype.drawCustom=function(a,b,c){this.beginGeometry(a,b);var d=a.getType(),e=a.getStride(),g=this.coordinates.length,h;if(d==f.default.MULTI_POLYGON){d=a.getOrientedFlatCoordinates();var m=[];for(var p=a.getEndss(),n=h=0,k=p.length;n<k;++n){var z=[];h=this.drawCustomCoordinates_(d,h,p[n],e,z);m.push(z)}this.instructions.push([w.default.CUSTOM,g,m,a,c,l.default.coordinatesss])}else d==f.default.POLYGON||d==
f.default.MULTI_LINE_STRING?(m=[],d=d==f.default.POLYGON?a.getOrientedFlatCoordinates():a.getFlatCoordinates(),this.drawCustomCoordinates_(d,0,a.getEnds(),e,m),this.instructions.push([w.default.CUSTOM,g,m,a,c,l.default.coordinatess])):d==f.default.LINE_STRING||d==f.default.MULTI_POINT?(d=a.getFlatCoordinates(),e=this.appendFlatCoordinates(d,0,d.length,e,!1,!1),this.instructions.push([w.default.CUSTOM,g,e,a,c,l.default.coordinates])):d==f.default.POINT&&(d=a.getFlatCoordinates(),this.coordinates.push(d[0],
d[1]),e=this.coordinates.length,this.instructions.push([w.default.CUSTOM,g,e,a,c]));this.endGeometry(a,b)};a.prototype.beginGeometry=function(a,b){this.beginGeometryInstruction1_=[w.default.BEGIN_GEOMETRY,b,0];this.instructions.push(this.beginGeometryInstruction1_);this.beginGeometryInstruction2_=[w.default.BEGIN_GEOMETRY,b,0];this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)};a.prototype.fill_=function(a){if(this.fillOrigin_){var b=A.default.apply(this.renderedTransform_,this.fillOrigin_.slice());
a.translate(b[0],b[1]);a.rotate(this.viewRotation_)}a.fill();this.fillOrigin_&&a.setTransform.apply(a,y.default.resetTransform_)};a.prototype.setStrokeStyle_=function(a,b){a.strokeStyle=b[1];a.lineWidth=b[2];a.lineCap=b[3];a.lineJoin=b[4];a.miterLimit=b[5];r.default.CANVAS_LINE_DASH&&(a.lineDashOffset=b[7],a.setLineDash(b[6]))};a.prototype.renderDeclutter_=function(a,b){if(a&&5<a.length){var c=a[4];if(1==c||c==a.length-5){b={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};if(!this.declutterTree.collides(b)){this.declutterTree.insert(b);
b=y.default.drawImage;c=5;for(var d=a.length;c<d;++c){var e=a[c];e&&(11<e.length&&this.replayTextBackground_(e[0],e[13],e[14],e[15],e[16],e[11],e[12]),b.apply(void 0,e))}}a.length=5;n.default.createOrUpdateEmpty(a)}}};a.prototype.replay_=function(a,d,e,f,g,h){if(this.pixelCoordinates_&&b.default.equals(d,this.renderedTransform_))var l=this.pixelCoordinates_;else this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=p.default.transform2D(this.coordinates,0,this.coordinates.length,2,d,this.pixelCoordinates_),
A.default.setFromArray(this.renderedTransform_,d);d=!t.default.isEmpty(e);for(var k=0,z=f.length,C,r,u,x,S,B,I,F,N,O=0,K=0,U=null,Z=null,ba=this.coordinateCache_,X=this.viewRotation_,V={context:a,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:X},Y=this.instructions!=f||this.overlaps?0:200;k<z;)switch(F=f[k],F[0]){case w.default.BEGIN_GEOMETRY:var L=F[1];d&&e[c.default.getUid(L).toString()]||!L.getGeometry()?k=F[2]:void 0===h||n.default.intersects(h,L.getGeometry().getExtent())?++k:
k=F[2]+1;break;case w.default.BEGIN_PATH:O>Y&&(this.fill_(a),O=0);K>Y&&(a.stroke(),K=0);O||K||(a.beginPath(),S=B=NaN);++k;break;case w.default.CIRCLE:C=F[1];I=l[C];F=l[C+1];u=l[C+2]-I;x=l[C+3]-F;u=Math.sqrt(u*u+x*x);a.moveTo(I+u,F);a.arc(I,F,u,0,2*Math.PI,!0);++k;break;case w.default.CLOSE_PATH:a.closePath();++k;break;case w.default.CUSTOM:C=F[1];r=F[2];I=F[4];u=6==F.length?F[5]:void 0;V.geometry=F[3];V.feature=L;k in ba||(ba[k]=[]);F=ba[k];u?u(l,C,r,2,F):(F[0]=l[C],F[1]=l[C+1],F.length=2);I(F,V);
++k;break;case w.default.DRAW_IMAGE:C=F[1];r=F[2];N=F[3];u=F[4];x=F[5];I=g?null:F[6];var P=F[7],ea=F[8],W=F[9],ca=F[10],fa=F[11],E=F[12],ha=F[13],ia=F[14],ma=F[15];if(16<F.length){var ka=F[16];var ja=F[17];F=F[18]}else ka=y.default.defaultPadding,ja=F=!1;for(fa&&(E+=X);C<r;C+=2)this.replayImage_(a,l[C],l[C+1],N,u,x,I,P,ea,W,ca,E,ha,ia,ma,ka,ja?U:null,F?Z:null);this.renderDeclutter_(I,L);++k;break;case w.default.DRAW_CHARS:u=F[1];x=F[2];C=F[3];I=g?null:F[4];ca=F[5];r=F[6];fa=F[7];E=F[8];N=F[9];P=F[10];
ea=F[11];ha=F[12];W=F[13];F=F[14];ia=q.default.lineString(l,u,x,2);ma=E(ha);if(ca||ma<=ia)if(ca=m.default.lineString(l,u,x,2,ha,E,(ia-ma)*v.default.TEXT_ALIGN[this.textStates[W].textAlign],fa)){if(P)for(fa=0,E=ca.length;fa<E;++fa)ha=ca[fa],u=ha[4],ia=this.getImage(u,W,"",P),u=ha[2]+ea,x=C*ia.height+2*(.5-C)*ea-N,this.replayImage_(a,ha[0],ha[1],ia,u,x,I,ia.height,1,0,0,ha[3],F,!1,ia.width,y.default.defaultPadding,null,null);if(r)for(fa=0,E=ca.length;fa<E;++fa)ha=ca[fa],u=ha[4],ia=this.getImage(u,W,
r,""),u=ha[2],x=C*ia.height-N,this.replayImage_(a,ha[0],ha[1],ia,u,x,I,ia.height,1,0,0,ha[3],F,!1,ia.width,y.default.defaultPadding,null,null)}this.renderDeclutter_(I,L);++k;break;case w.default.END_GEOMETRY:if(void 0!==g&&(L=F[1],I=g(L)))return I;++k;break;case w.default.FILL:Y?O++:this.fill_(a);++k;break;case w.default.MOVE_TO_LINE_TO:C=F[1];r=F[2];u=l[C];x=l[C+1];I=u+.5|0;F=x+.5|0;if(I!==S||F!==B)a.moveTo(u,x),S=I,B=F;for(C+=2;C<r;C+=2)if(u=l[C],x=l[C+1],I=u+.5|0,F=x+.5|0,C==r-2||I!==S||F!==B)a.lineTo(u,
x),S=I,B=F;++k;break;case w.default.SET_FILL_STYLE:U=F;this.fillOrigin_=F[2];O&&(this.fill_(a),O=0,K&&(a.stroke(),K=0));a.fillStyle=F[1];++k;break;case w.default.SET_STROKE_STYLE:Z=F;K&&(a.stroke(),K=0);this.setStrokeStyle_(a,F);++k;break;case w.default.STROKE:Y?K++:a.stroke();++k;break;default:++k}O&&this.fill_(a);K&&a.stroke()};a.prototype.replay=function(a,b,c,d){this.viewRotation_=c;this.replay_(a,b,d,this.instructions,void 0,void 0)};a.prototype.replayHitDetection=function(a,b,c,d,e,f){this.viewRotation_=
c;return this.replay_(a,b,d,this.hitDetectionInstructions,e,f)};a.prototype.reverseHitDetectionInstructions=function(){var a=this.hitDetectionInstructions;a.reverse();var c,d=a.length,e=-1;for(c=0;c<d;++c){var f=a[c];var g=f[0];g==w.default.END_GEOMETRY?e=c:g==w.default.BEGIN_GEOMETRY&&(f[2]=c,b.default.reverseSubArray(this.hitDetectionInstructions,e,c),e=-1)}};a.prototype.setFillStrokeStyle=function(a,b){var c=this.state;a?(a=a.getColor(),c.fillStyle=h.default.asColorLike(a?a:y.default.defaultFillStyle)):
c.fillStyle=void 0;b?(a=b.getColor(),c.strokeStyle=h.default.asColorLike(a?a:y.default.defaultStrokeStyle),a=b.getLineCap(),c.lineCap=void 0!==a?a:y.default.defaultLineCap,a=b.getLineDash(),c.lineDash=a?a.slice():y.default.defaultLineDash,a=b.getLineDashOffset(),c.lineDashOffset=a?a:y.default.defaultLineDashOffset,a=b.getLineJoin(),c.lineJoin=void 0!==a?a:y.default.defaultLineJoin,a=b.getWidth(),c.lineWidth=void 0!==a?a:y.default.defaultLineWidth,b=b.getMiterLimit(),c.miterLimit=void 0!==b?b:y.default.defaultMiterLimit,
c.lineWidth>this.maxLineWidth&&(this.maxLineWidth=c.lineWidth,this.bufferedMaxExtent_=null)):(c.strokeStyle=void 0,c.lineCap=void 0,c.lineDash=null,c.lineDashOffset=void 0,c.lineJoin=void 0,c.lineWidth=void 0,c.miterLimit=void 0)};a.prototype.applyFill=function(a,b){var c=a.fillStyle;a=[w.default.SET_FILL_STYLE,c];"string"!==typeof c&&(b=b.getExtent(),a.push([b[0],b[3]]));this.instructions.push(a)};a.prototype.applyStroke=function(a){this.instructions.push([w.default.SET_STROKE_STYLE,a.strokeStyle,
a.lineWidth*this.pixelRatio,a.lineCap,a.lineJoin,a.miterLimit,this.applyPixelRatio(a.lineDash),a.lineDashOffset*this.pixelRatio])};a.prototype.updateFillStyle=function(a,b,c){var d=a.fillStyle;if("string"!==typeof d||a.currentFillStyle!=d)b.call(this,a,c),a.currentFillStyle=d};a.prototype.updateStrokeStyle=function(a,c){var d=a.strokeStyle,e=a.lineCap,f=a.lineDash,g=a.lineDashOffset,h=a.lineJoin,l=a.lineWidth,m=a.miterLimit;if(a.currentStrokeStyle!=d||a.currentLineCap!=e||f!=a.currentLineDash&&!b.default.equals(a.currentLineDash,
f)||a.currentLineDashOffset!=g||a.currentLineJoin!=h||a.currentLineWidth!=l||a.currentMiterLimit!=m)c.call(this,a),a.currentStrokeStyle=d,a.currentLineCap=e,a.currentLineDash=f,a.currentLineDashOffset=g,a.currentLineJoin=h,a.currentLineWidth=l,a.currentMiterLimit=m};a.prototype.endGeometry=function(a,b){this.beginGeometryInstruction1_[2]=this.instructions.length;this.beginGeometryInstruction1_=null;this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length;this.beginGeometryInstruction2_=
null;a=[w.default.END_GEOMETRY,b];this.instructions.push(a);this.hitDetectionInstructions.push(a)};a.prototype.finish=c.default.nullFunction;a.prototype.getBufferedMaxExtent=function(){this.bufferedMaxExtent_||(this.bufferedMaxExtent_=n.default.clone(this.maxExtent),0<this.maxLineWidth&&n.default.buffer(this.bufferedMaxExtent_,this.resolution*(this.maxLineWidth+1)/2,this.bufferedMaxExtent_));return this.bufferedMaxExtent_};k.default=a},{"../../array.js":29,"../../colorlike.js":37,"../../extent.js":54,
"../../extent/relationship.js":56,"../../geom/flat/inflate.js":65,"../../geom/flat/length.js":68,"../../geom/flat/textpath.js":74,"../../geom/flat/transform.js":76,"../../geom/geometrytype.js":79,"../../has.js":84,"../../index.js":89,"../../obj.js":124,"../../transform.js":243,"../canvas.js":150,"../canvas/instruction.js":153,"../replay.js":161,"../vectorcontext.js":164}],157:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");
e=d(e);var c=a("../../array.js"),b=d(c);c=a("../../dom.js");var h=d(c);c=a("../../extent.js");var n=d(c);c=a("../../geom/flat/transform.js");var g=d(c);c=a("../../obj.js");var f=d(c);c=a("../replaygroup.js");var l=d(c);c=a("../replaytype.js");var q=d(c);c=a("../canvas/replay.js");c=d(c);var m=a("../canvas/imagereplay.js");m=d(m);var p=a("../canvas/linestringreplay.js");p=d(p);var r=a("../canvas/polygonreplay.js");r=d(r);var t=a("../canvas/textreplay.js");t=d(t);var u=a("../replay.js"),y=d(u);a=a("../../transform.js");
var w=d(a),v=function(a,b,c,d,e,f,g){l.default.call(this);this.declutterTree_=f;this.declutterGroup_=null;this.tolerance_=a;this.maxExtent_=b;this.overlaps_=e;this.pixelRatio_=d;this.resolution_=c;this.renderBuffer_=g;this.replaysByZIndex_={};this.hitDetectionContext_=h.default.createCanvasContext2D(1,1);this.hitDetectionTransform_=w.default.create()};e.default.inherits(v,l.default);v.circleArrayCache_={0:[[!0]]};v.fillCircleArrayRowToMiddle_=function(a,b,c){var d,e=Math.floor(a.length/2);if(b>=e)for(d=
e;d<b;d++)a[d][c]=!0;else if(b<e)for(d=b+1;d<e;d++)a[d][c]=!0};v.getCircleArray_=function(a){if(void 0!==v.circleArrayCache_[a])return v.circleArrayCache_[a];for(var b=2*a+1,c=Array(b),d=0;d<b;d++)c[d]=Array(b);b=a;for(var e=d=0;b>=d;)v.fillCircleArrayRowToMiddle_(c,a+b,a+d),v.fillCircleArrayRowToMiddle_(c,a+d,a+b),v.fillCircleArrayRowToMiddle_(c,a-d,a+b),v.fillCircleArrayRowToMiddle_(c,a-b,a+d),v.fillCircleArrayRowToMiddle_(c,a-b,a-d),v.fillCircleArrayRowToMiddle_(c,a-d,a-b),v.fillCircleArrayRowToMiddle_(c,
a+d,a-b),v.fillCircleArrayRowToMiddle_(c,a+b,a-d),d++,e+=1+2*d,0<2*(e-b)+1&&(--b,e+=1-2*b);return v.circleArrayCache_[a]=c};v.replayDeclutter=function(a,c,d){for(var e=Object.keys(a).map(Number).sort(b.default.numberSafeCompareFunction),f={},g=0,h=e.length;g<h;++g)for(var l=a[e[g].toString()],m=0,p=l.length;m<p;){var k=l[m++],n=l[m++];k.replay(c,n,d,f)}};v.prototype.addDeclutter=function(a){var b=null;this.declutterTree_&&(a?(b=this.declutterGroup_,b[4]++):(b=this.declutterGroup_=n.default.createEmpty(),
b.push(1)));return b};v.prototype.clip=function(a,b){b=this.getClipCoords(b);a.beginPath();a.moveTo(b[0],b[1]);a.lineTo(b[2],b[3]);a.lineTo(b[4],b[5]);a.lineTo(b[6],b[7]);a.clip()};v.prototype.hasReplays=function(a){for(var b in this.replaysByZIndex_)for(var c=this.replaysByZIndex_[b],d=0,e=a.length;d<e;++d)if(a[d]in c)return!0;return!1};v.prototype.finish=function(){for(var a in this.replaysByZIndex_){var b=this.replaysByZIndex_[a],c;for(c in b)b[c].finish()}};v.prototype.forEachFeatureAtCoordinate=
function(a,b,c,d,e,f,g){d=Math.round(d);var h=2*d+1,l=w.default.compose(this.hitDetectionTransform_,d+.5,d+.5,1/b,-1/b,-c,-a[0],-a[1]),m=this.hitDetectionContext_;m.canvas.width!==h||m.canvas.height!==h?(m.canvas.width=h,m.canvas.height=h):m.clearRect(0,0,h,h);if(void 0!==this.renderBuffer_){var p=n.default.createEmpty();n.default.extendCoordinate(p,a);n.default.buffer(p,b*(this.renderBuffer_+d),p)}var k=v.getCircleArray_(d),u;this.declutterTree_&&(u=this.declutterTree_.all().map(function(a){return a.value}));
return this.replayHitDetection_(m,l,c,e,function(a){for(var b=m.getImageData(0,0,h,h).data,c=0;c<h;c++)for(var d=0;d<h;d++)if(k[c][d]&&0<b[4*(d*h+c)+3]){var e;u&&-1===u.indexOf(a)||(e=f(a));if(e)return e;m.clearRect(0,0,h,h);return}},p,g)};v.prototype.getClipCoords=function(a){var b=this.maxExtent_,c=b[0],d=b[1],e=b[2];b=b[3];c=[c,d,c,b,e,b,e,d];g.default.transform2D(c,0,8,2,a,c);return c};v.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0";a=this.replaysByZIndex_[c];void 0===a&&
(a={},this.replaysByZIndex_[c]=a);c=a[b];void 0===c&&(c=new v.BATCH_CONSTRUCTORS_[b](this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),a[b]=c);return c};v.prototype.getReplays=function(){return this.replaysByZIndex_};v.prototype.isEmpty=function(){return f.default.isEmpty(this.replaysByZIndex_)};v.prototype.replay=function(a,c,d,e,f,g){var h=Object.keys(this.replaysByZIndex_).map(Number);h.sort(b.default.numberSafeCompareFunction);a.save();this.clip(a,
c);f=f?f:y.default.ORDER;var l,m;var p=0;for(l=h.length;p<l;++p){var k=h[p].toString();var n=this.replaysByZIndex_[k];var u=0;for(m=f.length;u<m;++u){var r=f[u];var C=n[r];void 0!==C&&(!g||r!=q.default.IMAGE&&r!=q.default.TEXT?C.replay(a,c,d,e):(r=g[k])?r.push(C,c.slice(0)):g[k]=[C,c.slice(0)])}}a.restore()};v.prototype.replayHitDetection_=function(a,c,d,e,f,g,h){var l=Object.keys(this.replaysByZIndex_).map(Number);l.sort(b.default.numberSafeCompareFunction);var m,p;for(m=l.length-1;0<=m;--m){var k=
l[m].toString();var n=this.replaysByZIndex_[k];for(p=y.default.ORDER.length-1;0<=p;--p){var u=y.default.ORDER[p];var r=n[u];if(void 0!==r)if(!h||u!=q.default.IMAGE&&u!=q.default.TEXT){if(r=r.replayHitDetection(a,c,d,e,f,g))return r}else(u=h[k])?u.push(r,c.slice(0)):h[k]=[r,c.slice(0)]}}};v.BATCH_CONSTRUCTORS_={Circle:r.default,Default:c.default,Image:m.default,LineString:p.default,Polygon:r.default,Text:t.default};k.default=v},{"../../array.js":29,"../../dom.js":46,"../../extent.js":54,"../../geom/flat/transform.js":76,
"../../index.js":89,"../../obj.js":124,"../../transform.js":243,"../canvas/imagereplay.js":151,"../canvas/linestringreplay.js":154,"../canvas/polygonreplay.js":155,"../canvas/replay.js":156,"../canvas/textreplay.js":158,"../replay.js":161,"../replaygroup.js":162,"../replaytype.js":163}],158:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../colorlike.js");var b=d(e);e=a("../../dom.js");var h=
d(e);e=a("../../extent.js");var n=d(e);e=a("../../geom/flat/straightchunk.js");var g=d(e);e=a("../../geom/geometrytype.js");var f=d(e);e=a("../../has.js");var l=d(e);e=a("../canvas.js");var q=d(e);e=a("../canvas/instruction.js");var m=d(e);e=a("../canvas/replay.js");var p=d(e);e=a("../replay.js");var r=d(e);a=a("../../style/textplacement.js");var t=d(a),u=function(a,b,c,d,e,f){p.default.call(this,a,b,c,d,e,f);this.declutterGroup_;this.labels_=null;this.text_="";this.textOffsetY_=this.textOffsetX_=
0;this.textRotateWithView_=void 0;this.textRotation_=0;this.textFillState_=null;this.fillStates={};this.textStrokeState_=null;this.strokeStates={};this.textState_={};this.textStates={};this.strokeKey_=this.fillKey_=this.textKey_="";this.widths_={};q.default.labelCache.prune()};c.default.inherits(u,p.default);u.measureTextWidths=function(a,b,c){var d=b.length,e=0,f;for(f=0;f<d;++f){var g=q.default.measureTextWidth(a,b[f]);e=Math.max(e,g);c.push(g)}return e};u.prototype.drawText=function(a,b){var c=
this.textFillState_,d=this.textStrokeState_,e=this.textState_;if(""!==this.text_&&e&&(c||d)){c=this.coordinates.length;var h=a.getType();d=null;var l=2,m=2;if(e.placement===t.default.LINE){if(!n.default.intersects(this.getBufferedMaxExtent(),a.getExtent()))return;d=a.getFlatCoordinates();m=a.getStride();if(h==f.default.LINE_STRING)var p=[d.length];else if(h==f.default.MULTI_LINE_STRING)p=a.getEnds();else if(h==f.default.POLYGON)p=a.getEnds().slice(0,1);else if(h==f.default.MULTI_POLYGON){var k=a.getEndss();
p=[];l=0;for(h=k.length;l<h;++l)p.push(k[l][0])}this.beginGeometry(a,b);h=e.textAlign;var u=0;k=0;for(var r=p.length;k<r;++k){if(void 0==h){l=g.default.lineString(e.maxAngle,d,u,p[k],m);u=l[0];var q=l[1]}else q=p[k];for(l=u;l<q;l+=m)this.coordinates.push(d[l],d[l+1]);l=this.coordinates.length;u=p[k];this.drawChars_(c,l,this.declutterGroup_);c=l}}else{p=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_);k=p.width/this.pixelRatio;switch(h){case f.default.POINT:case f.default.MULTI_POINT:d=
a.getFlatCoordinates();l=d.length;break;case f.default.LINE_STRING:d=a.getFlatMidpoint();break;case f.default.CIRCLE:d=a.getCenter();break;case f.default.MULTI_LINE_STRING:d=a.getFlatMidpoints();l=d.length;break;case f.default.POLYGON:d=a.getFlatInteriorPoint();if(!e.overflow&&d[2]/this.resolution<k)return;m=3;break;case f.default.MULTI_POLYGON:r=a.getFlatInteriorPoints();d=[];l=0;for(h=r.length;l<h;l+=3)(e.overflow||r[l+2]/this.resolution>=k)&&d.push(r[l],r[l+1]);l=d.length;if(0==l)return}l=this.appendFlatCoordinates(d,
0,l,m,!1,!1);this.beginGeometry(a,b);if(e.backgroundFill||e.backgroundStroke)this.setFillStrokeStyle(e.backgroundFill,e.backgroundStroke),this.updateFillStyle(this.state,this.applyFill,a),this.updateStrokeStyle(this.state,this.applyStroke);this.drawTextImage_(p,c,l)}this.endGeometry(a,b)}};u.prototype.getImage=function(a,b,c,d){var e=d+b+a+c+this.pixelRatio,f=q.default.labelCache;if(!f.containsKey(e)){var g=d?this.strokeStates[d]||this.textStrokeState_:null,m=c?this.fillStates[c]||this.textFillState_:
null,p=this.textStates[b]||this.textState_,k=p.scale*this.pixelRatio,n=r.default.TEXT_ALIGN[p.textAlign||q.default.defaultTextAlign];b=d&&g.lineWidth?g.lineWidth:0;a=a.split("\n");var t=a.length,v=[],y=u.measureTextWidths(p.font,a,v),A=q.default.measureTextHeight(p.font);y=h.default.createCanvasContext2D(Math.ceil((y+b)*k),Math.ceil((A*t+b)*k));var w=y.canvas;f.set(e,w);1!=k&&y.scale(k,k);y.font=p.font;d&&(y.strokeStyle=g.strokeStyle,y.lineWidth=b*(l.default.SAFARI?k:1),y.lineCap=g.lineCap,y.lineJoin=
g.lineJoin,y.miterLimit=g.miterLimit,l.default.CANVAS_LINE_DASH&&g.lineDash.length&&(y.setLineDash(g.lineDash),y.lineDashOffset=g.lineDashOffset));c&&(y.fillStyle=m.fillStyle);y.textBaseline="middle";y.textAlign="center";g=.5-n;m=n*w.width/k+g*b;if(d)for(d=0;d<t;++d)y.strokeText(a[d],m+g*v[d],.5*(b+A)+d*A);if(c)for(d=0;d<t;++d)y.fillText(a[d],m+g*v[d],.5*(b+A)+d*A)}return f.get(e)};u.prototype.drawTextImage_=function(a,b,c){var d=this.textState_,e=this.textStrokeState_,f=this.pixelRatio,g=r.default.TEXT_ALIGN[d.textAlign||
q.default.defaultTextAlign],h=r.default.TEXT_ALIGN[d.textBaseline];e=e&&e.lineWidth?e.lineWidth:0;g=g*a.width/f+2*(.5-g)*e;h=h*a.height/f+2*(.5-h)*e;this.instructions.push([m.default.DRAW_IMAGE,b,c,a,(g-this.textOffsetX_)*f,(h-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,a.width,d.padding==q.default.defaultPadding?q.default.defaultPadding:d.padding.map(function(a){return a*f}),!!d.backgroundFill,!!d.backgroundStroke]);this.hitDetectionInstructions.push([m.default.DRAW_IMAGE,
b,c,a,(g-this.textOffsetX_)*f,(h-this.textOffsetY_)*f,this.declutterGroup_,a.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/f,!0,a.width,d.padding,!!d.backgroundFill,!!d.backgroundStroke])};u.prototype.drawChars_=function(a,b,c){var d=this.textStrokeState_,e=this.textState_,f=this.textFillState_,g=this.strokeKey_;d&&(g in this.strokeStates||(this.strokeStates[g]={strokeStyle:d.strokeStyle,lineCap:d.lineCap,lineDashOffset:d.lineDashOffset,lineWidth:d.lineWidth,lineJoin:d.lineJoin,miterLimit:d.miterLimit,
lineDash:d.lineDash}));var h=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:e.font,textAlign:e.textAlign||q.default.defaultTextAlign,scale:e.scale});var l=this.fillKey_;f&&(l in this.fillStates||(this.fillStates[l]={fillStyle:f.fillStyle}));var p=this.pixelRatio;f=r.default.TEXT_ALIGN[e.textBaseline];var k=this.textOffsetY_*p,n=this.text_,u=e.font,t=e.scale;d=d?d.lineWidth*t/2:0;var v=this.widths_[u];v||(this.widths_[u]=v={});this.instructions.push([m.default.DRAW_CHARS,
a,b,f,c,e.overflow,l,e.maxAngle,function(a){var b=v[a];b||(b=v[a]=q.default.measureTextWidth(u,a));return b*t*p},k,g,d*p,n,h,1]);this.hitDetectionInstructions.push([m.default.DRAW_CHARS,a,b,f,c,e.overflow,l,e.maxAngle,function(a){var b=v[a];b||(b=v[a]=q.default.measureTextWidth(u,a));return b*t},k,g,d,n,h,1/p])};u.prototype.setTextStyle=function(a,d){var e,f;if(a){this.declutterGroup_=d;(f=a.getFill())?(d=this.textFillState_,d||(d=this.textFillState_={}),d.fillStyle=b.default.asColorLike(f.getColor()||
q.default.defaultFillStyle)):d=this.textFillState_=null;if(e=a.getStroke()){f=this.textStrokeState_;f||(f=this.textStrokeState_={});var g=e.getLineDash(),h=e.getLineDashOffset(),l=e.getWidth(),m=e.getMiterLimit();f.lineCap=e.getLineCap()||q.default.defaultLineCap;f.lineDash=g?g.slice():q.default.defaultLineDash;f.lineDashOffset=void 0===h?q.default.defaultLineDashOffset:h;f.lineJoin=e.getLineJoin()||q.default.defaultLineJoin;f.lineWidth=void 0===l?q.default.defaultLineWidth:l;f.miterLimit=void 0===
m?q.default.defaultMiterLimit:m;f.strokeStyle=b.default.asColorLike(e.getColor()||q.default.defaultStrokeStyle)}else f=this.textStrokeState_=null;e=this.textState_;g=a.getFont()||q.default.defaultFont;q.default.checkFont(g);h=a.getScale();e.overflow=a.getOverflow();e.font=g;e.maxAngle=a.getMaxAngle();e.placement=a.getPlacement();e.textAlign=a.getTextAlign();e.textBaseline=a.getTextBaseline()||q.default.defaultTextBaseline;e.backgroundFill=a.getBackgroundFill();e.backgroundStroke=a.getBackgroundStroke();
e.padding=a.getPadding()||q.default.defaultPadding;e.scale=void 0===h?1:h;g=a.getOffsetX();h=a.getOffsetY();l=a.getRotateWithView();m=a.getRotation();this.text_=a.getText()||"";this.textOffsetX_=void 0===g?0:g;this.textOffsetY_=void 0===h?0:h;this.textRotateWithView_=void 0===l?!1:l;this.textRotation_=void 0===m?0:m;this.strokeKey_=f?("string"==typeof f.strokeStyle?f.strokeStyle:c.default.getUid(f.strokeStyle))+f.lineCap+f.lineDashOffset+"|"+f.lineWidth+f.lineJoin+f.miterLimit+"["+f.lineDash.join()+
"]":"";this.textKey_=e.font+e.scale+(e.textAlign||"?");this.fillKey_=d?"string"==typeof d.fillStyle?d.fillStyle:"|"+c.default.getUid(d.fillStyle):""}else this.text_=""};k.default=u},{"../../colorlike.js":37,"../../dom.js":46,"../../extent.js":54,"../../geom/flat/straightchunk.js":73,"../../geom/geometrytype.js":79,"../../has.js":84,"../../index.js":89,"../../style/textplacement.js":236,"../canvas.js":150,"../canvas/instruction.js":153,"../canvas/replay.js":156,"../replay.js":161}],159:[function(a,
e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../events/event.js"))&&a.__esModule?a:{default:a};a=function(a,b,e,k,g){d.default.call(this,a);this.vectorContext=b;this.frameState=e;this.context=k;this.glContext=g};e.default.inherits(a,d.default);k.default=a},{"../events/event.js":50,"../index.js":89}],160:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",
RENDER:"render"}},{}],161:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=(a=a("../render/replaytype.js"))&&a.__esModule?a:{default:a};e={};e.ORDER=[a.default.POLYGON,a.default.CIRCLE,a.default.LINE_STRING,a.default.IMAGE,a.default.TEXT,a.default.DEFAULT];e.TEXT_ALIGN={};e.TEXT_ALIGN.left=0;e.TEXT_ALIGN.end=0;e.TEXT_ALIGN.center=.5;e.TEXT_ALIGN.right=1;e.TEXT_ALIGN.start=1;e.TEXT_ALIGN.top=0;e.TEXT_ALIGN.middle=.5;e.TEXT_ALIGN.hanging=.2;e.TEXT_ALIGN.alphabetic=.8;e.TEXT_ALIGN.ideographic=
.8;e.TEXT_ALIGN.bottom=1;k.default=e},{"../render/replaytype.js":163}],162:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(){};a.prototype.getReplay=function(a,c){};a.prototype.isEmpty=function(){};k.default=a},{}],163:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"}},{}],164:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});
a=function(){};a.prototype.drawCustom=function(a,c,b){};a.prototype.drawGeometry=function(a){};a.prototype.setStyle=function(a){};a.prototype.drawCircle=function(a,c){};a.prototype.drawFeature=function(a,c){};a.prototype.drawGeometryCollection=function(a,c){};a.prototype.drawLineString=function(a,c){};a.prototype.drawMultiLineString=function(a,c){};a.prototype.drawMultiPoint=function(a,c){};a.prototype.drawMultiPolygon=function(a,c){};a.prototype.drawPoint=function(a,c){};a.prototype.drawPolygon=
function(a,c){};a.prototype.drawText=function(a,c){};a.prototype.setFillStrokeStyle=function(a,c){};a.prototype.setImageStyle=function(a,c){};a.prototype.setTextStyle=function(a,c){};k.default=a},{}],165:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={defaultFont:"10px sans-serif",defaultFillStyle:[0,0,0,1],defaultLineCap:"round",defaultLineDash:[],defaultLineDashOffset:0,defaultLineJoin:"round",defaultMiterLimit:10,defaultStrokeStyle:[0,0,0,1],defaultTextAlign:.5,defaultTextBaseline:.5,
defaultLineWidth:1,triangleIsCounterClockwise:function(a,b,e,k,g,f){a=(e-a)*(f-b)-(g-a)*(k-b);return a<=d.EPSILON&&a>=-d.EPSILON?void 0:0<a}};d.EPSILON=Number.EPSILON||2.220446049250313E-16;k.default=d},{}],166:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../array.js");var b=d(e);e=a("../../color.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../../obj.js");var g=d(e);e=a("../../geom/flat/transform.js");
var f=d(e);e=a("../webgl/circlereplay/defaultshader.js");var l=d(e);e=a("../webgl/circlereplay/defaultshader/locations.js");var q=d(e);e=a("../webgl/replay.js");var m=d(e);e=a("../webgl.js");var p=d(e);e=a("../../webgl.js");var r=d(e);a=a("../../webgl/buffer.js");var t=d(a);a=function(a,b){m.default.call(this,a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.radius_=0;this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};
c.default.inherits(a,m.default);a.prototype.drawCoordinates_=function(a,b,c,d){for(var e=this.vertices.length,f=this.indices.length,g=e/4;b<c;b+=d)this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=0,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=1,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+1],this.vertices[e++]=2,this.vertices[e++]=this.radius_,this.vertices[e++]=a[b],this.vertices[e++]=a[b+
1],this.vertices[e++]=3,this.vertices[e++]=this.radius_,this.indices[f++]=g,this.indices[f++]=g+1,this.indices[f++]=g+2,this.indices[f++]=g+2,this.indices[f++]=g+3,this.indices[f++]=g,g+=4};a.prototype.drawCircle=function(a,b){var c=a.getRadius(),d=a.getStride();c?(this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=c,a=a.getFlatCoordinates(),a=f.default.translate(a,0,2,
d,-this.origin[0],-this.origin[1]),this.drawCoordinates_(a,0,2,d)):this.state_.changed&&(this.styles_.pop(),this.styles_.length&&(d=this.styles_[this.styles_.length-1],this.state_.fillColor=d[0],this.state_.strokeColor=d[1],this.state_.lineWidth=d[2],this.state_.changed=!1))};a.prototype.finish=function(a){this.verticesBuffer=new t.default(this.vertices);this.indicesBuffer=new t.default(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&0<this.styles_.length&&
(this.styles_=[]);this.indices=this.vertices=null};a.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b);a.deleteBuffer(c)}};a.prototype.setUpProgram=function(a,b,c,d){var e=b.getProgram(l.default.fragment,l.default.vertex);if(this.defaultLocations_)var f=this.defaultLocations_;else this.defaultLocations_=f=new q.default(a,e);b.useProgram(e);a.enableVertexAttribArray(f.a_position);a.vertexAttribPointer(f.a_position,2,
r.default.FLOAT,!1,16,0);a.enableVertexAttribArray(f.a_instruction);a.vertexAttribPointer(f.a_instruction,1,r.default.FLOAT,!1,16,8);a.enableVertexAttribArray(f.a_radius);a.vertexAttribPointer(f.a_radius,1,r.default.FLOAT,!1,16,12);a.uniform2fv(f.u_size,c);a.uniform1f(f.u_pixelRatio,d);return f};a.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_instruction);a.disableVertexAttribArray(b.a_radius)};a.prototype.drawReplay=function(a,b,c,
d){if(g.default.isEmpty(c)){var e=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){d=this.styleIndices_[c];var f=this.styles_[c];this.setFillStyle_(a,f[0]);this.setStrokeStyle_(a,f[1],f[2]);this.drawElements(a,b,d,e);e=d}}else this.drawReplaySkipping_(a,b,c)};a.prototype.drawHitDetectionReplayOneByOne=function(a,b,d,e,f){var g,h;var l=this.startIndices.length-2;var m=this.startIndices[l+1];for(g=this.styleIndices_.length-1;0<=g;--g){var p=this.styles_[g];this.setFillStyle_(a,
p[0]);this.setStrokeStyle_(a,p[1],p[2]);for(h=this.styleIndices_[g];0<=l&&this.startIndices[l]>=h;){p=this.startIndices[l];var k=this.startIndicesFeature[l];var r=c.default.getUid(k).toString();if(void 0===d[r]&&k.getGeometry()&&(void 0===f||n.default.intersects(f,k.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,p,m),m=e(k)))return m;l--;m=p}}};a.prototype.drawReplaySkipping_=function(a,b,d){var e,f;var g=this.startIndices.length-2;var h=f=this.startIndices[g+
1];for(e=this.styleIndices_.length-1;0<=e;--e){var l=this.styles_[e];this.setFillStyle_(a,l[0]);this.setStrokeStyle_(a,l[1],l[2]);for(l=this.styleIndices_[e];0<=g&&this.startIndices[g]>=l;){var m=this.startIndices[g];var p=this.startIndicesFeature[g];p=c.default.getUid(p).toString();d[p]&&(f!==h&&this.drawElements(a,b,f,h),h=m);g--;f=m}f!==h&&this.drawElements(a,b,f,h);f=h=l}};a.prototype.setFillStyle_=function(a,b){a.uniform4fv(this.defaultLocations_.u_fillColor,b)};a.prototype.setStrokeStyle_=function(a,
b,c){a.uniform4fv(this.defaultLocations_.u_strokeColor,b);a.uniform1f(this.defaultLocations_.u_lineWidth,c)};a.prototype.setFillStrokeStyle=function(a,c){if(c){var d=c.getLineDash();this.state_.lineDash=d?d:p.default.defaultLineDash;d=c.getLineDashOffset();this.state_.lineDashOffset=d?d:p.default.defaultLineDashOffset;d=c.getColor();d=d instanceof CanvasGradient||d instanceof CanvasPattern?p.default.defaultStrokeStyle:h.default.asArray(d).map(function(a,b){return 3!=b?a/255:a})||p.default.defaultStrokeStyle;
c=c.getWidth();c=void 0!==c?c:p.default.defaultLineWidth}else d=[0,0,0,0],c=0;a=a?a.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?p.default.defaultFillStyle:h.default.asArray(a).map(function(a,b){return 3!=b?a/255:a})||p.default.defaultFillStyle;this.state_.strokeColor&&b.default.equals(this.state_.strokeColor,d)&&this.state_.fillColor&&b.default.equals(this.state_.fillColor,a)&&this.state_.lineWidth===c||(this.state_.changed=!0,this.state_.fillColor=a,this.state_.strokeColor=
d,this.state_.lineWidth=c,this.styles_.push([a,d,c]))};k.default=a},{"../../array.js":29,"../../color.js":36,"../../extent.js":54,"../../geom/flat/transform.js":76,"../../index.js":89,"../../obj.js":124,"../../webgl.js":248,"../../webgl/buffer.js":249,"../webgl.js":165,"../webgl/circlereplay/defaultshader.js":167,"../webgl/circlereplay/defaultshader/locations.js":168,"../webgl/replay.js":177}],167:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",
{value:!0});e=a("../../../index.js");e=d(e);var c=a("../../../webgl/fragment.js");c=d(c);a=a("../../../webgl/vertex.js");a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":
"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}");
b.vertex=new a.default(e.default.DEBUG_WEBGL?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":
"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");
k.default=b},{"../../../index.js":89,"../../../webgl/fragment.js":252,"../../../webgl/vertex.js":254}],168:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,
d.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_lineWidth=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_lineWidth":"k");this.u_pixelRatio=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_pixelRatio":"l");this.u_opacity=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_opacity":"m");this.u_fillColor=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_fillColor":"n");this.u_strokeColor=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_strokeColor":"o");this.u_size=a.getUniformLocation(b,d.default.DEBUG_WEBGL?
"u_size":"p");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"e");this.a_instruction=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_instruction":"f");this.a_radius=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_radius":"g")}},{"../../../../index.js":89}],169:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../webgl/texturereplay.js");var b=d(e);a=a("../../webgl/buffer.js");
var h=d(a);a=function(a,c){b.default.call(this,a,c);this.images_=[];this.hitDetectionImages_=[];this.textures_=[];this.hitDetectionTextures_=[]};c.default.inherits(a,b.default);a.prototype.drawMultiPoint=function(a,b){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);b=a.getFlatCoordinates();a=a.getStride();this.drawCoordinates(b,0,b.length,a)};a.prototype.drawPoint=function(a,b){this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);b=a.getFlatCoordinates();
a=a.getStride();this.drawCoordinates(b,0,b.length,a)};a.prototype.finish=function(a){var c=a.getGL();this.groupIndices.push(this.indices.length);this.hitDetectionGroupIndices.push(this.indices.length);this.verticesBuffer=new h.default(this.vertices);this.indicesBuffer=new h.default(this.indices);var d={};this.createTextures(this.textures_,this.images_,d,c);this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,d,c);this.hitDetectionImages_=this.images_=null;b.default.prototype.finish.call(this,
a)};a.prototype.setImageStyle=function(a){var b=a.getAnchor(),d=a.getImage(1),e=a.getImageSize(),h=a.getHitDetectionImage(1),m=a.getOpacity(),p=a.getOrigin(),k=a.getRotateWithView(),n=a.getRotation(),u=a.getSize();a=a.getScale();if(0===this.images_.length)this.images_.push(d);else{var y=this.images_[this.images_.length-1];c.default.getUid(y)!=c.default.getUid(d)&&(this.groupIndices.push(this.indices.length),this.images_.push(d))}0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(h):
(y=this.hitDetectionImages_[this.hitDetectionImages_.length-1],c.default.getUid(y)!=c.default.getUid(h)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(h)));this.anchorX=b[0];this.anchorY=b[1];this.height=u[1];this.imageHeight=e[1];this.imageWidth=e[0];this.opacity=m;this.originX=p[0];this.originY=p[1];this.rotation=n;this.rotateWithView=k;this.scale=a;this.width=u[0]};a.prototype.getTextures=function(a){return a?this.textures_.concat(this.hitDetectionTextures_):
this.textures_};a.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_};k.default=a},{"../../index.js":89,"../../webgl/buffer.js":249,"../webgl/texturereplay.js":180}],170:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../extent.js"),b=d(c);c=a("../../geom/geometrytype.js");var h=d(c);c=a("../replaytype.js");var n=d(c);c=a("../vectorcontext.js");var g=d(c);a=a("../webgl/replaygroup.js");
var f=d(a);a=function(a,b,c,d,e,f,h){g.default.call(this);this.context_=a;this.center_=b;this.extent_=f;this.pixelRatio_=h;this.size_=e;this.rotation_=d;this.resolution_=c;this.textStyle_=this.strokeStyle_=this.fillStyle_=this.imageStyle_=null};e.default.inherits(a,g.default);a.prototype.drawText_=function(a,b){var c=this.context_;a=a.getReplay(0,n.default.TEXT);a.setTextStyle(this.textStyle_);a.drawText(b,null);a.finish(c);a.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,
this.pixelRatio_,1,{},void 0,!1);a.getDeleteResourcesFunction(c)()};a.prototype.setStyle=function(a){this.setFillStrokeStyle(a.getFill(),a.getStroke());this.setImageStyle(a.getImage());this.setTextStyle(a.getText())};a.prototype.drawGeometry=function(a){switch(a.getType()){case h.default.POINT:this.drawPoint(a,null);break;case h.default.LINE_STRING:this.drawLineString(a,null);break;case h.default.POLYGON:this.drawPolygon(a,null);break;case h.default.MULTI_POINT:this.drawMultiPoint(a,null);break;case h.default.MULTI_LINE_STRING:this.drawMultiLineString(a,
null);break;case h.default.MULTI_POLYGON:this.drawMultiPolygon(a,null);break;case h.default.GEOMETRY_COLLECTION:this.drawGeometryCollection(a,null);break;case h.default.CIRCLE:this.drawCircle(a,null)}};a.prototype.drawFeature=function(a,c){(a=c.getGeometryFunction()(a))&&b.default.intersects(this.extent_,a.getExtent())&&(this.setStyle(c),this.drawGeometry(a))};a.prototype.drawGeometryCollection=function(a,b){a=a.getGeometriesArray();var c;b=0;for(c=a.length;b<c;++b)this.drawGeometry(a[b])};a.prototype.drawPoint=
function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.IMAGE);e.setImageStyle(this.imageStyle_);e.drawPoint(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.drawMultiPoint=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.IMAGE);e.setImageStyle(this.imageStyle_);
e.drawMultiPoint(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.drawLineString=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_);e.drawLineString(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,
this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.drawMultiLineString=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.LINE_STRING);e.setFillStrokeStyle(null,this.strokeStyle_);e.drawMultiLineString(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,
a)};a.prototype.drawPolygon=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawPolygon(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.drawMultiPolygon=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,
n.default.POLYGON);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawMultiPolygon(a,b);e.finish(c);e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.drawCircle=function(a,b){var c=this.context_,d=new f.default(1,this.extent_),e=d.getReplay(0,n.default.CIRCLE);e.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_);e.drawCircle(a,b);e.finish(c);
e.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1);e.getDeleteResourcesFunction(c)();this.textStyle_&&this.drawText_(d,a)};a.prototype.setImageStyle=function(a){this.imageStyle_=a};a.prototype.setFillStrokeStyle=function(a,b){this.fillStyle_=a;this.strokeStyle_=b};a.prototype.setTextStyle=function(a){this.textStyle_=a};k.default=a},{"../../extent.js":54,"../../geom/geometrytype.js":79,"../../index.js":89,"../replaytype.js":163,"../vectorcontext.js":164,
"../webgl/replaygroup.js":178}],171:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../array.js");var b=d(e);e=a("../../color.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../../geom/flat/orient.js");var g=d(e);e=a("../../geom/flat/transform.js");var f=d(e);e=a("../../geom/flat/topology.js");var l=d(e);e=a("../../obj.js");var q=d(e);e=a("../webgl.js");var m=d(e);e=a("../webgl/replay.js");
var p=d(e);e=a("../webgl/linestringreplay/defaultshader.js");var r=d(e);e=a("../webgl/linestringreplay/defaultshader/locations.js");var t=d(e);e=a("../../webgl.js");var u=d(e);a=a("../../webgl/buffer.js");var y=d(a),w=function(a,b){p.default.call(this,a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};c.default.inherits(w,p.default);w.prototype.drawCoordinates_=
function(a,c,d,e){var f,h=this.vertices.length,p=this.indices.length,k="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,n="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,t=l.default.lineStringIsClosed(a,c,d,e),r=p,u=1;for(f=c;f<d;f+=e){var q=h/7;var v=y;var y=x||[a[f],a[f+1]];if(f===c){var x=[a[f+e],a[f+e+1]];if(d-c===2*e&&b.default.equals(y,x))break;if(t){v=[a[d-2*e],a[d-2*e+1]];var A=x}else{n&&(h=this.addVertices_([0,0],y,x,u*w.Instruction_.BEGIN_LINE_CAP*n,
h),h=this.addVertices_([0,0],y,x,-u*w.Instruction_.BEGIN_LINE_CAP*n,h),this.indices[p++]=q+2,this.indices[p++]=q,this.indices[p++]=q+1,this.indices[p++]=q+1,this.indices[p++]=q+3,this.indices[p++]=q+2);h=this.addVertices_([0,0],y,x,u*w.Instruction_.BEGIN_LINE*(n||1),h);h=this.addVertices_([0,0],y,x,-u*w.Instruction_.BEGIN_LINE*(n||1),h);r=h/7-1;continue}}else if(f===d-e){t?x=A:(v=v||[0,0],h=this.addVertices_(v,y,[0,0],u*w.Instruction_.END_LINE*(n||1),h),h=this.addVertices_(v,y,[0,0],-u*w.Instruction_.END_LINE*
(n||1),h),this.indices[p++]=q,this.indices[p++]=r-1,this.indices[p++]=r,this.indices[p++]=r,this.indices[p++]=q+1,this.indices[p++]=q,n&&(h=this.addVertices_(v,y,[0,0],u*w.Instruction_.END_LINE_CAP*n,h),h=this.addVertices_(v,y,[0,0],-u*w.Instruction_.END_LINE_CAP*n,h),this.indices[p++]=q+2,this.indices[p++]=q,this.indices[p++]=q+1,this.indices[p++]=q+1,this.indices[p++]=q+3,this.indices[p++]=q+2));break}else x=[a[f+e],a[f+e+1]];var B=m.default.triangleIsCounterClockwise(v[0],v[1],y[0],y[1],x[0],x[1])?
-1:1;h=this.addVertices_(v,y,x,B*w.Instruction_.BEVEL_FIRST*(k||1),h);h=this.addVertices_(v,y,x,B*w.Instruction_.BEVEL_SECOND*(k||1),h);h=this.addVertices_(v,y,x,-B*w.Instruction_.MITER_BOTTOM*(k||1),h);f>c&&(this.indices[p++]=q,this.indices[p++]=r-1,this.indices[p++]=r,this.indices[p++]=q+2,this.indices[p++]=q,this.indices[p++]=0<u*B?r:r-1);this.indices[p++]=q;this.indices[p++]=q+2;this.indices[p++]=q+1;r=q+2;u=B;k&&(h=this.addVertices_(v,y,x,B*w.Instruction_.MITER_TOP*k,h),this.indices[p++]=q+1,
this.indices[p++]=q+3,this.indices[p++]=q)}t&&(q=q||h/7,B=g.default.linearRingIsClockwise([v[0],v[1],y[0],y[1],x[0],x[1]],0,6,2)?1:-1,h=this.addVertices_(v,y,x,B*w.Instruction_.BEVEL_FIRST*(k||1),h),this.addVertices_(v,y,x,-B*w.Instruction_.MITER_BOTTOM*(k||1),h),this.indices[p++]=q,this.indices[p++]=r-1,this.indices[p++]=r,this.indices[p++]=q+1,this.indices[p++]=q,this.indices[p++]=0<u*B?r:r-1)};w.prototype.addVertices_=function(a,b,c,d,e){this.vertices[e++]=a[0];this.vertices[e++]=a[1];this.vertices[e++]=
b[0];this.vertices[e++]=b[1];this.vertices[e++]=c[0];this.vertices[e++]=c[1];this.vertices[e++]=d;return e};w.prototype.isValid_=function(a,c,d,e){d-=c;return d<2*e?!1:d===2*e?!b.default.equals([a[c],a[c+1]],[a[c+e],a[c+e+1]]):!0};w.prototype.drawLineString=function(a,b){var c=a.getFlatCoordinates();a=a.getStride();this.isValid_(c,0,c.length,a)&&(c=f.default.translate(c,0,c.length,a,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=
!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(b),this.drawCoordinates_(c,0,c.length,a))};w.prototype.drawMultiLineString=function(a,b){var c=this.indices.length,d=a.getEnds();d.unshift(0);var e=a.getFlatCoordinates();a=a.getStride();var g;if(1<d.length){var h=1;for(g=d.length;h<g;++h)if(this.isValid_(e,d[h-1],d[h],a)){var l=f.default.translate(e,d[h-1],d[h],a,-this.origin[0],-this.origin[1]);this.drawCoordinates_(l,0,l.length,a)}}this.indices.length>c&&(this.startIndices.push(c),
this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(c),this.state_.changed=!1))};w.prototype.drawPolygonCoordinates=function(a,b,c){l.default.lineStringIsClosed(a,0,a.length,c)||(a.push(a[0]),a.push(a[1]));this.drawCoordinates_(a,0,a.length,c);if(b.length){var d;a=0;for(d=b.length;a<d;++a)l.default.lineStringIsClosed(b[a],0,b[a].length,c)||(b[a].push(b[a][0]),b[a].push(b[a][1])),this.drawCoordinates_(b[a],0,b[a].length,c)}};w.prototype.setPolygonStyle=function(a,b){b=void 0===
b?this.indices.length:b;this.startIndices.push(b);this.startIndicesFeature.push(a);this.state_.changed&&(this.styleIndices_.push(b),this.state_.changed=!1)};w.prototype.getCurrentIndex=function(){return this.indices.length};w.prototype.finish=function(a){this.verticesBuffer=new y.default(this.vertices);this.indicesBuffer=new y.default(this.indices);this.startIndices.push(this.indices.length);0===this.styleIndices_.length&&0<this.styles_.length&&(this.styles_=[]);this.indices=this.vertices=null};w.prototype.getDeleteResourcesFunction=
function(a){var b=this.verticesBuffer,c=this.indicesBuffer;return function(){a.deleteBuffer(b);a.deleteBuffer(c)}};w.prototype.setUpProgram=function(a,b,c,d){var e=b.getProgram(r.default.fragment,r.default.vertex);if(this.defaultLocations_)var f=this.defaultLocations_;else this.defaultLocations_=f=new t.default(a,e);b.useProgram(e);a.enableVertexAttribArray(f.a_lastPos);a.vertexAttribPointer(f.a_lastPos,2,u.default.FLOAT,!1,28,0);a.enableVertexAttribArray(f.a_position);a.vertexAttribPointer(f.a_position,
2,u.default.FLOAT,!1,28,8);a.enableVertexAttribArray(f.a_nextPos);a.vertexAttribPointer(f.a_nextPos,2,u.default.FLOAT,!1,28,16);a.enableVertexAttribArray(f.a_direction);a.vertexAttribPointer(f.a_direction,1,u.default.FLOAT,!1,28,24);a.uniform2fv(f.u_size,c);a.uniform1f(f.u_pixelRatio,d);return f};w.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_lastPos);a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_nextPos);a.disableVertexAttribArray(b.a_direction)};
w.prototype.drawReplay=function(a,b,c,d){var e=a.getParameter(a.DEPTH_FUNC),f=a.getParameter(a.DEPTH_WRITEMASK);d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL));if(q.default.isEmpty(c)){var g=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){var h=this.styleIndices_[c];var l=this.styles_[c];this.setStrokeStyle_(a,l[0],l[1],l[2]);this.drawElements(a,b,h,g);a.clear(a.DEPTH_BUFFER_BIT);g=h}}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),
a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(f),a.depthFunc(e))};w.prototype.drawReplaySkipping_=function(a,b,d){var e,f;var g=this.startIndices.length-2;var h=f=this.startIndices[g+1];for(e=this.styleIndices_.length-1;0<=e;--e){var l=this.styles_[e];this.setStrokeStyle_(a,l[0],l[1],l[2]);for(l=this.styleIndices_[e];0<=g&&this.startIndices[g]>=l;){var p=this.startIndices[g];var m=this.startIndicesFeature[g];m=c.default.getUid(m).toString();d[m]&&(f!==h&&(this.drawElements(a,b,f,h),a.clear(a.DEPTH_BUFFER_BIT)),
h=p);g--;f=p}f!==h&&(this.drawElements(a,b,f,h),a.clear(a.DEPTH_BUFFER_BIT));f=h=l}};w.prototype.drawHitDetectionReplayOneByOne=function(a,b,d,e,f){var g,h;var l=this.startIndices.length-2;var p=this.startIndices[l+1];for(g=this.styleIndices_.length-1;0<=g;--g){var m=this.styles_[g];this.setStrokeStyle_(a,m[0],m[1],m[2]);for(h=this.styleIndices_[g];0<=l&&this.startIndices[l]>=h;){m=this.startIndices[l];var k=this.startIndicesFeature[l];var r=c.default.getUid(k).toString();if(void 0===d[r]&&k.getGeometry()&&
(void 0===f||n.default.intersects(f,k.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,m,p),p=e(k)))return p;l--;p=m}}};w.prototype.setStrokeStyle_=function(a,b,c,d){a.uniform4fv(this.defaultLocations_.u_color,b);a.uniform1f(this.defaultLocations_.u_lineWidth,c);a.uniform1f(this.defaultLocations_.u_miterLimit,d)};w.prototype.setFillStrokeStyle=function(a,c){a=c.getLineCap();this.state_.lineCap=void 0!==a?a:m.default.defaultLineCap;a=c.getLineDash();
this.state_.lineDash=a?a:m.default.defaultLineDash;a=c.getLineDashOffset();this.state_.lineDashOffset=a?a:m.default.defaultLineDashOffset;a=c.getLineJoin();this.state_.lineJoin=void 0!==a?a:m.default.defaultLineJoin;a=c.getColor();a=a instanceof CanvasGradient||a instanceof CanvasPattern?m.default.defaultStrokeStyle:h.default.asArray(a).map(function(a,b){return 3!=b?a/255:a})||m.default.defaultStrokeStyle;var d=c.getWidth();d=void 0!==d?d:m.default.defaultLineWidth;c=c.getMiterLimit();c=void 0!==
c?c:m.default.defaultMiterLimit;this.state_.strokeColor&&b.default.equals(this.state_.strokeColor,a)&&this.state_.lineWidth===d&&this.state_.miterLimit===c||(this.state_.changed=!0,this.state_.strokeColor=a,this.state_.lineWidth=d,this.state_.miterLimit=c,this.styles_.push([a,d,c]))};w.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23};k.default=w},{"../../array.js":29,"../../color.js":36,"../../extent.js":54,
"../../geom/flat/orient.js":69,"../../geom/flat/topology.js":75,"../../geom/flat/transform.js":76,"../../index.js":89,"../../obj.js":124,"../../webgl.js":248,"../../webgl/buffer.js":249,"../webgl.js":165,"../webgl/linestringreplay/defaultshader.js":172,"../webgl/linestringreplay/defaultshader/locations.js":173,"../webgl/replay.js":177}],172:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../../index.js");e=d(e);var c=a("../../../webgl/fragment.js");
c=d(c);a=a("../../../webgl/vertex.js");a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":
"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");b.vertex=new a.default(e.default.DEBUG_WEBGL?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":
"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");
k.default=b},{"../../../index.js":89,"../../../webgl/fragment.js":252,"../../../webgl/vertex.js":254}],173:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,
d.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_lineWidth=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_lineWidth":"k");this.u_miterLimit=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_miterLimit":"l");this.u_opacity=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_opacity":"m");this.u_color=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_color":"n");this.u_size=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_size":"o");this.u_pixelRatio=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_pixelRatio":
"p");this.a_lastPos=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_lastPos":"d");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"e");this.a_nextPos=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_nextPos":"f");this.a_direction=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_direction":"g")}},{"../../../../index.js":89}],174:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=
a("../../array.js");var b=d(e);e=a("../../color.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../../obj.js");var g=d(e);e=a("../../geom/flat/contains.js");var f=d(e);e=a("../../geom/flat/orient.js");var l=d(e);e=a("../../geom/flat/transform.js");var q=d(e);e=a("../webgl/polygonreplay/defaultshader.js");var m=d(e);e=a("../webgl/polygonreplay/defaultshader/locations.js");var p=d(e);e=a("../webgl/linestringreplay.js");var r=d(e);e=a("../webgl/replay.js");var t=d(e);e=a("../webgl.js");var u=
d(e);e=a("../../style/stroke.js");var y=d(e);e=a("../../structs/linkedlist.js");var w=d(e);e=a("../../structs/rbush.js");var v=d(e);e=a("../../webgl.js");var A=d(e);a=a("../../webgl/buffer.js");var B=d(a);a=function(a,b){t.default.call(this,a,b);this.lineStringReplay=new r.default(a,b);this.defaultLocations_=null;this.styles_=[];this.styleIndices_=[];this.state_={fillColor:null,changed:!1}};c.default.inherits(a,t.default);a.prototype.drawCoordinates_=function(a,b,c){var d=new w.default,e=new v.default;
this.processFlatCoordinates_(a,c,d,e,!0);a=this.getMaxCoords_(d);if(b.length){var f,g=[];var h=0;for(f=b.length;h<f;++h){var l={list:new w.default,maxCoords:void 0,rtree:new v.default};g.push(l);this.processFlatCoordinates_(b[h],c,l.list,l.rtree,!1);this.classifyPoints_(l.list,l.rtree,!0);l.maxCoords=this.getMaxCoords_(l.list)}g.sort(function(a,b){return b.maxCoords[0]===a.maxCoords[0]?a.maxCoords[1]-b.maxCoords[1]:b.maxCoords[0]-a.maxCoords[0]});for(h=0;h<g.length;++h){b=g[h].list;f=c=b.firstItem();
do{if(this.getIntersections_(f,e).length){var p=!0;break}f=b.nextItem()}while(c!==f);!p&&this.bridgeHole_(b,g[h].maxCoords[0],d,a[0],e)&&(e.concat(g[h].rtree),this.classifyPoints_(d,e,!1))}}else this.classifyPoints_(d,e,!1);this.triangulate_(d,e)};a.prototype.processFlatCoordinates_=function(a,b,c,d,e){var f=l.default.linearRingIsClockwise(a,0,a.length,b),g,h=this.vertices.length/2,p=[],m=[];if(e===f){f=e=this.createPoint_(a[0],a[1],h++);var k=b;for(g=a.length;k<g;k+=b){var n=this.createPoint_(a[k],
a[k+1],h++);m.push(this.insertItem_(f,n,c));p.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]);f=n}}else for(k=a.length-b,f=e=this.createPoint_(a[k],a[k+1],h++),k-=b,g=0;k>=g;k-=b)n=this.createPoint_(a[k],a[k+1],h++),m.push(this.insertItem_(f,n,c)),p.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]),f=n;m.push(this.insertItem_(n,e,c));p.push([Math.min(f.x,n.x),Math.min(f.y,n.y),Math.max(f.x,n.x),Math.max(f.y,n.y)]);d.load(p,m)};a.prototype.getMaxCoords_=
function(a){var b=a.firstItem(),c=b,d=[c.p0.x,c.p0.y];do c=a.nextItem(),c.p0.x>d[0]&&(d=[c.p0.x,c.p0.y]);while(c!==b);return d};a.prototype.classifyPoints_=function(a,b,c){var d=a.firstItem(),e=d,f=a.nextItem(),g=!1;do{var h=c?u.default.triangleIsCounterClockwise(f.p1.x,f.p1.y,e.p1.x,e.p1.y,e.p0.x,e.p0.y):u.default.triangleIsCounterClockwise(e.p0.x,e.p0.y,e.p1.x,e.p1.y,f.p1.x,f.p1.y);void 0===h?(this.removeItem_(e,f,a,b),g=!0,f===d&&(d=a.getNextItem()),f=e,a.prevItem()):e.p1.reflex!==h&&(e.p1.reflex=
h,g=!0);e=f;f=a.nextItem()}while(e!==d);return g};a.prototype.bridgeHole_=function(a,b,c,d,e){for(var f=a.firstItem();f.p1.x!==b;)f=a.nextItem();b=f.p1;d={x:d,y:b.y,i:-1};var g=Infinity,h;var l=this.getIntersections_({p0:b,p1:d},e,!0);var p=0;for(h=l.length;p<h;++p){var m=l[p],k=this.calculateIntersection_(b,d,m.p0,m.p1,!0),n=Math.abs(b.x-k[0]);if(n<g&&void 0!==u.default.triangleIsCounterClockwise(b.x,b.y,m.p0.x,m.p0.y,m.p1.x,m.p1.y)){g=n;var r={x:k[0],y:k[1],i:-1};f=m}}if(Infinity===g)return!1;l=
f.p1;if(0<g&&(f=this.getPointsInTriangle_(b,r,f.p1,e),f.length))for(r=Infinity,p=0,h=f.length;p<h;++p)if(g=f[p],m=Math.atan2(b.y-g.y,d.x-g.x),m<r||m===r&&g.x<l.x)r=m,l=g;for(f=c.firstItem();f.p1.x!==l.x||f.p1.y!==l.y;)f=c.nextItem();d={x:b.x,y:b.y,i:b.i,reflex:void 0};p={x:f.p1.x,y:f.p1.y,i:f.p1.i,reflex:void 0};a.getNextItem().p0=d;this.insertItem_(b,f.p1,a,e);this.insertItem_(p,d,a,e);f.p1=p;a.setFirstItem();c.concat(a);return!0};a.prototype.triangulate_=function(a,b){for(var c=!1,d=this.isSimple_(a,
b);3<a.getLength();)if(d){if(!this.clipEars_(a,b,d,c)&&!this.classifyPoints_(a,b,c)&&!this.resolveSelfIntersections_(a,b,!0))break}else if(!this.clipEars_(a,b,d,c)&&!this.classifyPoints_(a,b,c)&&!this.resolveSelfIntersections_(a,b))if(d=this.isSimple_(a,b))c=!this.isClockwise_(a),this.classifyPoints_(a,b,c);else{this.splitPolygon_(a,b);break}3===a.getLength()&&(b=this.indices.length,this.indices[b++]=a.getPrevItem().p0.i,this.indices[b++]=a.getCurrItem().p0.i,this.indices[b++]=a.getNextItem().p0.i)};
a.prototype.clipEars_=function(a,b,c,d){var e=this.indices.length,f=a.firstItem(),g=a.getPrevItem(),h=f,p=a.nextItem(),m=a.getNextItem(),k=!1;do{var n=h.p0;var r=h.p1;var t=p.p1;if(!1===r.reflex){var u=c?0===this.getPointsInTriangle_(n,r,t,b,!0).length:d?this.diagonalIsInside_(m.p1,t,r,n,g.p0):this.diagonalIsInside_(g.p0,n,r,t,m.p1);!c&&0!==this.getIntersections_({p0:n,p1:t},b).length||!u||!c&&!1!==n.reflex&&!1!==t.reflex&&l.default.linearRingIsClockwise([g.p0.x,g.p0.y,n.x,n.y,r.x,r.y,t.x,t.y,m.p1.x,
m.p1.y],0,10,2)!==!d||(this.indices[e++]=n.i,this.indices[e++]=r.i,this.indices[e++]=t.i,this.removeItem_(h,p,a,b),p===f&&(f=m),k=!0)}g=a.getPrevItem();h=a.getCurrItem();p=a.nextItem();m=a.getNextItem()}while(h!==f&&3<a.getLength());return k};a.prototype.resolveSelfIntersections_=function(a,b,c){var d=a.firstItem();a.nextItem();var e=d,f=a.nextItem(),g=!1;do{var h=this.calculateIntersection_(e.p0,e.p1,f.p0,f.p1,c);if(h){g=this.indices.length;var l=this.vertices.length/2,p=a.prevItem();a.removeItem();
b.remove(p);var m=p===d;c?(h[0]===e.p0.x&&h[1]===e.p0.y?(a.prevItem(),h=e.p0,f.p0=h,b.remove(e),m=m||e===d):(h=f.p1,e.p1=h,b.remove(f),m=m||f===d),a.removeItem()):(h=this.createPoint_(h[0],h[1],l),e.p1=h,f.p0=h,b.update([Math.min(e.p0.x,e.p1.x),Math.min(e.p0.y,e.p1.y),Math.max(e.p0.x,e.p1.x),Math.max(e.p0.y,e.p1.y)],e),b.update([Math.min(f.p0.x,f.p1.x),Math.min(f.p0.y,f.p1.y),Math.max(f.p0.x,f.p1.x),Math.max(f.p0.y,f.p1.y)],f));this.indices[g++]=p.p0.i;this.indices[g++]=p.p1.i;this.indices[g++]=h.i;
g=!0;if(m)break}e=a.getPrevItem();f=a.nextItem()}while(e!==d);return g};a.prototype.isSimple_=function(a,b){var c=a.firstItem(),d=c;do{if(this.getIntersections_(d,b).length)return!1;d=a.nextItem()}while(d!==c);return!0};a.prototype.isClockwise_=function(a){var b=2*a.getLength(),c=Array(b),d=a.firstItem(),e=d,f=0;do c[f++]=e.p0.x,c[f++]=e.p0.y,e=a.nextItem();while(e!==d);return l.default.linearRingIsClockwise(c,0,b,2)};a.prototype.splitPolygon_=function(a,b){var c=a.firstItem(),d=c;do{var e=this.getIntersections_(d,
b);if(e.length){c=e[0];e=this.vertices.length/2;var f=this.calculateIntersection_(d.p0,d.p1,c.p0,c.p1);e=this.createPoint_(f[0],f[1],e);f=new w.default;var g=new v.default;this.insertItem_(e,d.p1,f,g);d.p1=e;b.update([Math.min(d.p0.x,e.x),Math.min(d.p0.y,e.y),Math.max(d.p0.x,e.x),Math.max(d.p0.y,e.y)],d);for(d=a.nextItem();d!==c;)this.insertItem_(d.p0,d.p1,f,g),b.remove(d),a.removeItem(),d=a.getCurrItem();this.insertItem_(c.p0,e,f,g);c.p0=e;b.update([Math.min(c.p1.x,e.x),Math.min(c.p1.y,e.y),Math.max(c.p1.x,
e.x),Math.max(c.p1.y,e.y)],c);this.classifyPoints_(a,b,!1);this.triangulate_(a,b);this.classifyPoints_(f,g,!1);this.triangulate_(f,g);break}d=a.nextItem()}while(d!==c)};a.prototype.createPoint_=function(a,b,c){var d=this.vertices.length;this.vertices[d++]=a;this.vertices[d++]=b;return{x:a,y:b,i:c,reflex:void 0}};a.prototype.insertItem_=function(a,b,c,d){var e={p0:a,p1:b};c.insertItem(e);d&&d.insert([Math.min(a.x,b.x),Math.min(a.y,b.y),Math.max(a.x,b.x),Math.max(a.y,b.y)],e);return e};a.prototype.removeItem_=
function(a,b,c,d){c.getCurrItem()===b&&(c.removeItem(),a.p1=b.p1,d.remove(b),d.update([Math.min(a.p0.x,a.p1.x),Math.min(a.p0.y,a.p1.y),Math.max(a.p0.x,a.p1.x),Math.max(a.p0.y,a.p1.y)],a))};a.prototype.getPointsInTriangle_=function(a,b,c,d,e){var g,h,l=[],m=d.getInExtent([Math.min(a.x,b.x,c.x),Math.min(a.y,b.y,c.y),Math.max(a.x,b.x,c.x),Math.max(a.y,b.y,c.y)]);d=0;for(g=m.length;d<g;++d)for(h in m[d]){var p=m[d][h];"object"!==typeof p||e&&!p.reflex||p.x===a.x&&p.y===a.y||p.x===b.x&&p.y===b.y||p.x===
c.x&&p.y===c.y||-1!==l.indexOf(p)||!f.default.linearRingContainsXY([a.x,a.y,b.x,b.y,c.x,c.y],0,6,2,p.x,p.y)||l.push(p)}return l};a.prototype.getIntersections_=function(a,b,c){var d=a.p0,e=a.p1;b=b.getInExtent([Math.min(d.x,e.x),Math.min(d.y,e.y),Math.max(d.x,e.x),Math.max(d.y,e.y)]);var f=[],g;var h=0;for(g=b.length;h<g;++h){var l=b[h];a!==l&&(c||l.p0!==e||l.p1!==d)&&this.calculateIntersection_(d,e,l.p0,l.p1,c)&&f.push(l)}return f};a.prototype.calculateIntersection_=function(a,b,c,d,e){var f=(d.y-
c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!==f&&(d=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/f,c=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/f,!e&&d>u.default.EPSILON&&d<1-u.default.EPSILON&&c>u.default.EPSILON&&c<1-u.default.EPSILON||e&&0<=d&&1>=d&&0<=c&&1>=c))return[a.x+d*(b.x-a.x),a.y+d*(b.y-a.y)]};a.prototype.diagonalIsInside_=function(a,b,c,d,e){if(void 0===b.reflex||void 0===d.reflex)return!1;var f=(c.x-d.x)*(b.y-d.y)>(c.y-d.y)*(b.x-d.x);e=(e.x-d.x)*(b.y-d.y)<(e.y-d.y)*(b.x-d.x);a=(a.x-b.x)*(d.y-
b.y)>(a.y-b.y)*(d.x-b.x);c=(c.x-b.x)*(d.y-b.y)<(c.y-b.y)*(d.x-b.x);b=b.reflex?c||a:c&&a;return(d.reflex?e||f:e&&f)&&b};a.prototype.drawMultiPolygon=function(a,b){var c=a.getEndss(),d=a.getStride(),e=this.indices.length,f=this.lineStringReplay.getCurrentIndex();a=a.getFlatCoordinates();var g,h,l;var p=h=0;for(g=c.length;p<g;++p){var m=c[p];if(0<m.length){var k=q.default.translate(a,h,m[0],d,-this.origin[0],-this.origin[1]);if(k.length){var n=[];h=1;for(l=m.length;h<l;++h)if(m[h]!==m[h-1]){var r=q.default.translate(a,
m[h-1],m[h],d,-this.origin[0],-this.origin[1]);n.push(r)}this.lineStringReplay.drawPolygonCoordinates(k,n,d);this.drawCoordinates_(k,n,d)}}h=m[m.length-1]}this.indices.length>e&&(this.startIndices.push(e),this.startIndicesFeature.push(b),this.state_.changed&&(this.styleIndices_.push(e),this.state_.changed=!1));this.lineStringReplay.getCurrentIndex()>f&&this.lineStringReplay.setPolygonStyle(b,f)};a.prototype.drawPolygon=function(a,b){var c=a.getEnds(),d=a.getStride();if(0<c.length){a=a.getFlatCoordinates().map(Number);
var e=q.default.translate(a,0,c[0],d,-this.origin[0],-this.origin[1]);if(e.length){var f=[],g;var h=1;for(g=c.length;h<g;++h)if(c[h]!==c[h-1]){var l=q.default.translate(a,c[h-1],c[h],d,-this.origin[0],-this.origin[1]);f.push(l)}this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1);this.lineStringReplay.setPolygonStyle(b);this.lineStringReplay.drawPolygonCoordinates(e,f,d);this.drawCoordinates_(e,
f,d)}}};a.prototype.finish=function(a){this.verticesBuffer=new B.default(this.vertices);this.indicesBuffer=new B.default(this.indices);this.startIndices.push(this.indices.length);this.lineStringReplay.finish(a);0===this.styleIndices_.length&&0<this.styles_.length&&(this.styles_=[]);this.indices=this.vertices=null};a.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.lineStringReplay.getDeleteResourcesFunction(a);return function(){a.deleteBuffer(b);
a.deleteBuffer(c);d()}};a.prototype.setUpProgram=function(a,b,c,d){c=b.getProgram(m.default.fragment,m.default.vertex);this.defaultLocations_?d=this.defaultLocations_:this.defaultLocations_=d=new p.default(a,c);b.useProgram(c);a.enableVertexAttribArray(d.a_position);a.vertexAttribPointer(d.a_position,2,A.default.FLOAT,!1,8,0);return d};a.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position)};a.prototype.drawReplay=function(a,b,c,d){var e=a.getParameter(a.DEPTH_FUNC),f=a.getParameter(a.DEPTH_WRITEMASK);
d||(a.enable(a.DEPTH_TEST),a.depthMask(!0),a.depthFunc(a.NOTEQUAL));if(g.default.isEmpty(c)){var h=this.startIndices[this.startIndices.length-1];for(c=this.styleIndices_.length-1;0<=c;--c){var l=this.styleIndices_[c];var p=this.styles_[c];this.setFillStyle_(a,p);this.drawElements(a,b,l,h);h=l}}else this.drawReplaySkipping_(a,b,c);d||(a.disable(a.DEPTH_TEST),a.clear(a.DEPTH_BUFFER_BIT),a.depthMask(f),a.depthFunc(e))};a.prototype.drawHitDetectionReplayOneByOne=function(a,b,d,e,f){var g,h;var l=this.startIndices.length-
2;var p=this.startIndices[l+1];for(g=this.styleIndices_.length-1;0<=g;--g){var m=this.styles_[g];this.setFillStyle_(a,m);for(h=this.styleIndices_[g];0<=l&&this.startIndices[l]>=h;){m=this.startIndices[l];var k=this.startIndicesFeature[l];var r=c.default.getUid(k).toString();if(void 0===d[r]&&k.getGeometry()&&(void 0===f||n.default.intersects(f,k.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,b,m,p),p=e(k)))return p;l--;p=m}}};a.prototype.drawReplaySkipping_=
function(a,b,d){var e,f;var g=this.startIndices.length-2;var h=f=this.startIndices[g+1];for(e=this.styleIndices_.length-1;0<=e;--e){var l=this.styles_[e];this.setFillStyle_(a,l);for(l=this.styleIndices_[e];0<=g&&this.startIndices[g]>=l;){var p=this.startIndices[g];var m=this.startIndicesFeature[g];m=c.default.getUid(m).toString();d[m]&&(f!==h&&(this.drawElements(a,b,f,h),a.clear(a.DEPTH_BUFFER_BIT)),h=p);g--;f=p}f!==h&&(this.drawElements(a,b,f,h),a.clear(a.DEPTH_BUFFER_BIT));f=h=l}};a.prototype.setFillStyle_=
function(a,b){a.uniform4fv(this.defaultLocations_.u_color,b)};a.prototype.setFillStrokeStyle=function(a,c){a=a?a.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?u.default.defaultFillStyle:h.default.asArray(a).map(function(a,b){return 3!=b?a/255:a})||u.default.defaultFillStyle;this.state_.fillColor&&b.default.equals(a,this.state_.fillColor)||(this.state_.fillColor=a,this.state_.changed=!0,this.styles_.push(a));c?this.lineStringReplay.setFillStrokeStyle(null,c):(c=new y.default({color:[0,
0,0,0],lineWidth:0}),this.lineStringReplay.setFillStrokeStyle(null,c))};k.default=a},{"../../array.js":29,"../../color.js":36,"../../extent.js":54,"../../geom/flat/contains.js":63,"../../geom/flat/orient.js":69,"../../geom/flat/transform.js":76,"../../index.js":89,"../../obj.js":124,"../../structs/linkedlist.js":217,"../../structs/rbush.js":220,"../../style/stroke.js":233,"../../webgl.js":248,"../../webgl/buffer.js":249,"../webgl.js":165,"../webgl/linestringreplay.js":171,"../webgl/polygonreplay/defaultshader.js":175,
"../webgl/polygonreplay/defaultshader/locations.js":176,"../webgl/replay.js":177}],175:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../../index.js");e=d(e);var c=a("../../../webgl/fragment.js");c=d(c);a=a("../../../webgl/vertex.js");a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":
"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");b.vertex=new a.default(e.default.DEBUG_WEBGL?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");
k.default=b},{"../../../index.js":89,"../../../webgl/fragment.js":252,"../../../webgl/vertex.js":254}],176:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_projectionMatrix":"b");this.u_offsetScaleMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"c");this.u_offsetRotateMatrix=a.getUniformLocation(b,
d.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"d");this.u_color=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_color":"e");this.u_opacity=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_opacity":"f");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"a")}},{"../../../../index.js":89}],177:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../extent.js"),b=d(c);c=a("../vectorcontext.js");
var h=d(c);c=a("../../transform.js");var n=d(c);c=a("../../vec/mat4.js");var g=d(c);a=a("../../webgl.js");var f=d(a);a=function(a,c){h.default.call(this);this.tolerance=a;this.maxExtent=c;this.origin=b.default.getCenter(c);this.projectionMatrix_=n.default.create();this.offsetRotateMatrix_=n.default.create();this.offsetScaleMatrix_=n.default.create();this.tmpMat4_=g.default.create();this.indices=[];this.indicesBuffer=null;this.startIndices=[];this.startIndicesFeature=[];this.vertices=[];this.verticesBuffer=
null;this.lineStringReplay=void 0};e.default.inherits(a,h.default);a.prototype.getDeleteResourcesFunction=function(a){};a.prototype.finish=function(a){};a.prototype.setUpProgram=function(a,b,c,d){};a.prototype.shutDownProgram=function(a,b){};a.prototype.drawReplay=function(a,b,c,d){};a.prototype.drawHitDetectionReplayOneByOne=function(a,b,c,d,e){};a.prototype.drawHitDetectionReplay=function(a,b,c,d,e,f){return e?this.drawHitDetectionReplayOneByOne(a,b,c,d,f):this.drawHitDetectionReplayAll(a,b,c,d)};
a.prototype.drawHitDetectionReplayAll=function(a,b,c,d){a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);this.drawReplay(a,b,c,!0);if(a=d(null))return a};a.prototype.replay=function(a,b,c,d,e,h,k,y,w,v,A){var l=a.getGL();if(this.lineStringReplay){var p=l.isEnabled(l.STENCIL_TEST);var m=l.getParameter(l.STENCIL_FUNC);var r=l.getParameter(l.STENCIL_VALUE_MASK);var t=l.getParameter(l.STENCIL_REF);var u=l.getParameter(l.STENCIL_WRITEMASK);var q=l.getParameter(l.STENCIL_FAIL);var H=l.getParameter(l.STENCIL_PASS_DEPTH_PASS);
var J=l.getParameter(l.STENCIL_PASS_DEPTH_FAIL);l.enable(l.STENCIL_TEST);l.clear(l.STENCIL_BUFFER_BIT);l.stencilMask(255);l.stencilFunc(l.ALWAYS,1,255);l.stencilOp(l.KEEP,l.KEEP,l.REPLACE);this.lineStringReplay.replay(a,b,c,d,e,h,k,y,w,v,A);l.stencilMask(0);l.stencilFunc(l.NOTEQUAL,1,255)}a.bindBuffer(f.default.ARRAY_BUFFER,this.verticesBuffer);a.bindBuffer(f.default.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);h=this.setUpProgram(l,a,e,h);var D=n.default.reset(this.projectionMatrix_);n.default.scale(D,
2/(c*e[0]),2/(c*e[1]));n.default.rotate(D,-d);n.default.translate(D,-(b[0]-this.origin[0]),-(b[1]-this.origin[1]));b=n.default.reset(this.offsetScaleMatrix_);n.default.scale(b,2/e[0],2/e[1]);e=n.default.reset(this.offsetRotateMatrix_);0!==d&&n.default.rotate(e,-d);l.uniformMatrix4fv(h.u_projectionMatrix,!1,g.default.fromTransform(this.tmpMat4_,D));l.uniformMatrix4fv(h.u_offsetScaleMatrix,!1,g.default.fromTransform(this.tmpMat4_,b));l.uniformMatrix4fv(h.u_offsetRotateMatrix,!1,g.default.fromTransform(this.tmpMat4_,
e));l.uniform1f(h.u_opacity,k);var T;void 0===w?this.drawReplay(l,a,y,!1):T=this.drawHitDetectionReplay(l,a,y,w,v,A);this.shutDownProgram(l,h);this.lineStringReplay&&(p||l.disable(l.STENCIL_TEST),l.clear(l.STENCIL_BUFFER_BIT),l.stencilFunc(m,t,r),l.stencilMask(u),l.stencilOp(q,J,H));return T};a.prototype.drawElements=function(a,b,c,d){a.drawElements(f.default.TRIANGLES,d-c,b.hasOESElementIndexUint?f.default.UNSIGNED_INT:f.default.UNSIGNED_SHORT,c*(b.hasOESElementIndexUint?4:2))};k.default=a},{"../../extent.js":54,
"../../index.js":89,"../../transform.js":243,"../../vec/mat4.js":244,"../../webgl.js":248,"../vectorcontext.js":164}],178:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../array.js"),b=d(c);c=a("../../extent.js");var h=d(c);c=a("../../obj.js");var n=d(c);c=a("../replay.js");var g=d(c);c=a("../replaygroup.js");var f=d(c);c=a("../webgl/circlereplay.js");c=d(c);var l=a("../webgl/imagereplay.js");
l=d(l);var q=a("../webgl/linestringreplay.js");q=d(q);var m=a("../webgl/polygonreplay.js");m=d(m);a=a("../webgl/textreplay.js");a=d(a);var p=function(a,b,c){f.default.call(this);this.maxExtent_=b;this.tolerance_=a;this.renderBuffer_=c;this.replaysByZIndex_={}};e.default.inherits(p,f.default);p.prototype.addDeclutter=function(a,b){};p.prototype.getDeleteResourcesFunction=function(a){var b=[],c;for(c in this.replaysByZIndex_){var d=this.replaysByZIndex_[c],e;for(e in d)b.push(d[e].getDeleteResourcesFunction(a))}return function(){for(var a=
b.length,c,d=0;d<a;d++)c=b[d].apply(this,arguments);return c}};p.prototype.finish=function(a){for(var b in this.replaysByZIndex_){var c=this.replaysByZIndex_[b],d;for(d in c)c[d].finish(a)}};p.prototype.getReplay=function(a,b){var c=void 0!==a?a.toString():"0";a=this.replaysByZIndex_[c];void 0===a&&(a={},this.replaysByZIndex_[c]=a);c=a[b];void 0===c&&(c=new p.BATCH_CONSTRUCTORS_[b](this.tolerance_,this.maxExtent_),a[b]=c);return c};p.prototype.isEmpty=function(){return n.default.isEmpty(this.replaysByZIndex_)};
p.prototype.replay=function(a,c,d,e,f,h,l,p){var m=Object.keys(this.replaysByZIndex_).map(Number);m.sort(b.default.numberSafeCompareFunction);var k,n;var r=0;for(k=m.length;r<k;++r){var t=this.replaysByZIndex_[m[r].toString()];var u=0;for(n=g.default.ORDER.length;u<n;++u){var q=t[g.default.ORDER[u]];void 0!==q&&q.replay(a,c,d,e,f,h,l,p,void 0,!1)}}};p.prototype.replayHitDetection_=function(a,b,c,d,e,f,h,l,p,m,k){var n=Object.keys(this.replaysByZIndex_).map(Number);n.sort(function(a,b){return b-a});
var r,t;var u=0;for(r=n.length;u<r;++u){var q=this.replaysByZIndex_[n[u].toString()];for(t=g.default.ORDER.length-1;0<=t;--t){var y=q[g.default.ORDER[t]];if(void 0!==y&&(y=y.replay(a,b,c,d,e,f,h,l,p,m,k)))return y}}};p.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g,l,m,k){var n=b.getGL();n.bindFramebuffer(n.FRAMEBUFFER,b.getHitDetectionFramebuffer());var r;void 0!==this.renderBuffer_&&(r=h.default.buffer(h.default.createOrUpdateFromCoordinate(a),d*this.renderBuffer_));return this.replayHitDetection_(b,
a,d,e,p.HIT_DETECTION_SIZE_,g,l,m,function(a){var b=new Uint8Array(4);n.readPixels(0,0,1,1,n.RGBA,n.UNSIGNED_BYTE,b);if(0<b[3]&&(a=k(a)))return a},!0,r)};p.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e,f,g,h,l){var m=b.getGL();m.bindFramebuffer(m.FRAMEBUFFER,b.getHitDetectionFramebuffer());return void 0!==this.replayHitDetection_(b,a,d,e,p.HIT_DETECTION_SIZE_,g,h,l,function(a){a=new Uint8Array(4);m.readPixels(0,0,1,1,m.RGBA,m.UNSIGNED_BYTE,a);return 0<a[3]},!1)};p.HIT_DETECTION_SIZE_=[1,1];
p.BATCH_CONSTRUCTORS_={Circle:c.default,Image:l.default,LineString:q.default,Polygon:m.default,Text:a.default};k.default=p},{"../../array.js":29,"../../extent.js":54,"../../index.js":89,"../../obj.js":124,"../replay.js":161,"../replaygroup.js":162,"../webgl/circlereplay.js":166,"../webgl/imagereplay.js":169,"../webgl/linestringreplay.js":171,"../webgl/polygonreplay.js":174,"../webgl/textreplay.js":179}],179:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,
"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../colorlike.js");var b=d(e);e=a("../../dom.js");var h=d(e);e=a("../../geom/geometrytype.js");var n=d(e);e=a("../../has.js");var g=d(e);e=a("../replay.js");var f=d(e);e=a("../webgl.js");var l=d(e);e=a("../webgl/texturereplay.js");var q=d(e);e=a("../../style/atlasmanager.js");var m=d(e);a=a("../../webgl/buffer.js");var p=d(a);a=function(a,b){q.default.call(this,a,b);this.images_=[];this.textures_=[];this.measureCanvas_=h.default.createCanvasContext2D(0,
0).canvas;this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0};this.text_="";this.offsetY_=this.offsetX_=this.textBaseline_=this.textAlign_=void 0;this.atlases_={};this.currAtlas_=void 0;this.opacity=this.scale=1};c.default.inherits(a,q.default);a.prototype.drawText=function(a,b){if(this.text_){var d=null,e=2,f=2;switch(a.getType()){case n.default.POINT:case n.default.MULTI_POINT:d=a.getFlatCoordinates();
e=d.length;f=a.getStride();break;case n.default.CIRCLE:d=a.getCenter();break;case n.default.LINE_STRING:d=a.getFlatMidpoint();break;case n.default.MULTI_LINE_STRING:d=a.getFlatMidpoints();e=d.length;break;case n.default.POLYGON:d=a.getFlatInteriorPoint();break;case n.default.MULTI_POLYGON:d=a.getFlatInteriorPoints(),e=d.length}this.startIndices.push(this.indices.length);this.startIndicesFeature.push(b);a=this.currAtlas_;b=this.text_.split("\n");var g=this.getTextSize_(b),h,l,m,p=Math.round(g[0]*this.textAlign_-
this.offsetX_),k=Math.round(g[1]*this.textBaseline_-this.offsetY_),r=this.state_.lineWidth/2*this.state_.scale;g=0;for(h=b.length;g<h;++g){var t=0;var q=a.height*g;var H=b[g].split("");var J=0;for(l=H.length;J<l;++J){if(m=a.atlas.getInfo(H[J])){var D=m.image;this.anchorX=p-t;this.anchorY=k-q;this.originX=0===J?m.offsetX-r:m.offsetX;this.originY=m.offsetY;this.height=a.height;this.width=0===J||J===H.length-1?a.width[H[J]]+r:a.width[H[J]];this.imageHeight=D.height;this.imageWidth=D.width;0===this.images_.length?
this.images_.push(D):(m=this.images_[this.images_.length-1],c.default.getUid(m)!=c.default.getUid(D)&&(this.groupIndices.push(this.indices.length),this.images_.push(D)));this.drawText_(d,0,e,f)}t+=this.width}}}};a.prototype.getTextSize_=function(a){var b=this,c=this.currAtlas_,d=a.length*c.height;return[a.map(function(a){var d=0,e;var f=0;for(e=a.length;f<e;++f){var g=a[f];c.width[g]||b.addCharToAtlas_(g);d+=c.width[g]?c.width[g]:0}return d}).reduce(function(a,b){return Math.max(a,b)}),d]};a.prototype.drawText_=
function(a,b,c,d){var e;for(e=b;e<c;e+=d)this.drawCoordinates(a,b,c,d)};a.prototype.addCharToAtlas_=function(a){if(1===a.length){var b=this.currAtlas_,c=this.state_,d=this.measureCanvas_.getContext("2d");d.font=c.font;d=Math.ceil(d.measureText(a).width*c.scale);b.atlas.add(a,d,b.height,function(b,d,e){b.font=c.font;b.fillStyle=c.fillColor;b.strokeStyle=c.strokeColor;b.lineWidth=c.lineWidth;b.lineCap=c.lineCap;b.lineJoin=c.lineJoin;b.miterLimit=c.miterLimit;b.textAlign="left";b.textBaseline="top";
g.default.CANVAS_LINE_DASH&&c.lineDash&&(b.setLineDash(c.lineDash),b.lineDashOffset=c.lineDashOffset);1!==c.scale&&b.setTransform(c.scale,0,0,c.scale,0,0);c.strokeColor&&b.strokeText(a,d,e);c.fillColor&&b.fillText(a,d,e)})&&(b.width[a]=d)}};a.prototype.finish=function(a){var b=a.getGL();this.groupIndices.push(this.indices.length);this.hitDetectionGroupIndices=this.groupIndices;this.verticesBuffer=new p.default(this.vertices);this.indicesBuffer=new p.default(this.indices);this.createTextures(this.textures_,
this.images_,{},b);this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0};this.text_="";this.offsetY_=this.offsetX_=this.textBaseline_=this.textAlign_=void 0;this.images_=null;this.atlases_={};this.currAtlas_=void 0;q.default.prototype.finish.call(this,a)};a.prototype.setTextStyle=function(a){var c=this.state_,d=a.getFill(),e=a.getStroke();a&&a.getText()&&(d||e)?(d?(d=d.getColor(),c.fillColor=
b.default.asColorLike(d?d:l.default.defaultFillStyle)):c.fillColor=null,e?(d=e.getColor(),c.strokeColor=b.default.asColorLike(d?d:l.default.defaultStrokeStyle),c.lineWidth=e.getWidth()||l.default.defaultLineWidth,c.lineCap=e.getLineCap()||l.default.defaultLineCap,c.lineDashOffset=e.getLineDashOffset()||l.default.defaultLineDashOffset,c.lineJoin=e.getLineJoin()||l.default.defaultLineJoin,c.miterLimit=e.getMiterLimit()||l.default.defaultMiterLimit,e=e.getLineDash(),c.lineDash=e?e.slice():l.default.defaultLineDash):
(c.strokeColor=null,c.lineWidth=0),c.font=a.getFont()||l.default.defaultFont,c.scale=a.getScale()||1,this.text_=a.getText(),e=f.default.TEXT_ALIGN[a.getTextAlign()],d=f.default.TEXT_ALIGN[a.getTextBaseline()],this.textAlign_=void 0===e?l.default.defaultTextAlign:e,this.textBaseline_=void 0===d?l.default.defaultTextBaseline:d,this.offsetX_=a.getOffsetX()||0,this.offsetY_=a.getOffsetY()||0,this.rotateWithView=!!a.getRotateWithView(),this.rotation=a.getRotation()||0,this.currAtlas_=this.getAtlas_(c)):
this.text_=""};a.prototype.getAtlas_=function(a){var b=[];for(c in a)if(a[c]||0===a[c])Array.isArray(a[c])?b=b.concat(a[c]):b.push(a[c]);b=this.calculateHash_(b);if(!this.atlases_[b]){var c=this.measureCanvas_.getContext("2d");c.font=a.font;c=Math.ceil((1.5*c.measureText("M").width+a.lineWidth/2)*a.scale);this.atlases_[b]={atlas:new m.default({space:a.lineWidth+1}),width:{},height:c}}return this.atlases_[b]};a.prototype.calculateHash_=function(a){var b,c="";var d=0;for(b=a.length;d<b;++d)c+=a[d];
return c};a.prototype.getTextures=function(a){return this.textures_};a.prototype.getHitDetectionTextures=function(){return this.textures_};k.default=a},{"../../colorlike.js":37,"../../dom.js":46,"../../geom/geometrytype.js":79,"../../has.js":84,"../../index.js":89,"../../style/atlasmanager.js":223,"../../webgl/buffer.js":249,"../replay.js":161,"../webgl.js":165,"../webgl/texturereplay.js":180}],180:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",
{value:!0});e=a("../../index.js");var c=d(e);e=a("../../extent.js");var b=d(e);e=a("../../obj.js");var h=d(e);e=a("../webgl/texturereplay/defaultshader.js");var n=d(e);e=a("../webgl/texturereplay/defaultshader/locations.js");var g=d(e);e=a("../webgl/replay.js");var f=d(e);e=a("../../webgl.js");var l=d(e);a=a("../../webgl/context.js");var q=d(a);a=function(a,b){f.default.call(this,a,b);this.anchorY=this.anchorX=void 0;this.groupIndices=[];this.hitDetectionGroupIndices=[];this.imageWidth=this.imageHeight=
this.height=void 0;this.defaultLocations=null;this.width=this.scale=this.rotation=this.rotateWithView=this.originY=this.originX=this.opacity=void 0};c.default.inherits(a,f.default);a.prototype.getDeleteResourcesFunction=function(a){var b=this.verticesBuffer,c=this.indicesBuffer,d=this.getTextures(!0),e=a.getGL();return function(){if(!e.isContextLost()){var f;var g=0;for(f=d.length;g<f;++g)e.deleteTexture(d[g])}a.deleteBuffer(b);a.deleteBuffer(c)}};a.prototype.drawCoordinates=function(a,b,c,d){var e=
this.anchorX,f=this.anchorY,g=this.height,h=this.imageHeight,l=this.imageWidth,m=this.opacity,p=this.originX,k=this.originY,n=this.rotateWithView?1:0,t=-this.rotation,r=this.scale,q=this.width,H=Math.cos(t);t=Math.sin(t);for(var J=this.indices.length,D=this.vertices.length,T,R,G,Q,da;b<c;b+=d)Q=a[b]-this.origin[0],da=a[b+1]-this.origin[1],T=D/8,R=-r*e,G=-r*(g-f),this.vertices[D++]=Q,this.vertices[D++]=da,this.vertices[D++]=R*H-G*t,this.vertices[D++]=R*t+G*H,this.vertices[D++]=p/l,this.vertices[D++]=
(k+g)/h,this.vertices[D++]=m,this.vertices[D++]=n,R=r*(q-e),G=-r*(g-f),this.vertices[D++]=Q,this.vertices[D++]=da,this.vertices[D++]=R*H-G*t,this.vertices[D++]=R*t+G*H,this.vertices[D++]=(p+q)/l,this.vertices[D++]=(k+g)/h,this.vertices[D++]=m,this.vertices[D++]=n,R=r*(q-e),G=r*f,this.vertices[D++]=Q,this.vertices[D++]=da,this.vertices[D++]=R*H-G*t,this.vertices[D++]=R*t+G*H,this.vertices[D++]=(p+q)/l,this.vertices[D++]=k/h,this.vertices[D++]=m,this.vertices[D++]=n,R=-r*e,G=r*f,this.vertices[D++]=
Q,this.vertices[D++]=da,this.vertices[D++]=R*H-G*t,this.vertices[D++]=R*t+G*H,this.vertices[D++]=p/l,this.vertices[D++]=k/h,this.vertices[D++]=m,this.vertices[D++]=n,this.indices[J++]=T,this.indices[J++]=T+1,this.indices[J++]=T+2,this.indices[J++]=T,this.indices[J++]=T+2,this.indices[J++]=T+3;return D};a.prototype.createTextures=function(a,b,d,e){var f,g=b.length;for(f=0;f<g;++f){var h=b[f];var m=c.default.getUid(h).toString();m in d?h=d[m]:(h=q.default.createTexture(e,h,l.default.CLAMP_TO_EDGE,l.default.CLAMP_TO_EDGE),
d[m]=h);a[f]=h}};a.prototype.setUpProgram=function(a,b,c,d){c=b.getProgram(n.default.fragment,n.default.vertex);this.defaultLocations?d=this.defaultLocations:this.defaultLocations=d=new g.default(a,c);b.useProgram(c);a.enableVertexAttribArray(d.a_position);a.vertexAttribPointer(d.a_position,2,l.default.FLOAT,!1,32,0);a.enableVertexAttribArray(d.a_offsets);a.vertexAttribPointer(d.a_offsets,2,l.default.FLOAT,!1,32,8);a.enableVertexAttribArray(d.a_texCoord);a.vertexAttribPointer(d.a_texCoord,2,l.default.FLOAT,
!1,32,16);a.enableVertexAttribArray(d.a_opacity);a.vertexAttribPointer(d.a_opacity,1,l.default.FLOAT,!1,32,24);a.enableVertexAttribArray(d.a_rotateWithView);a.vertexAttribPointer(d.a_rotateWithView,1,l.default.FLOAT,!1,32,28);return d};a.prototype.shutDownProgram=function(a,b){a.disableVertexAttribArray(b.a_position);a.disableVertexAttribArray(b.a_offsets);a.disableVertexAttribArray(b.a_texCoord);a.disableVertexAttribArray(b.a_opacity);a.disableVertexAttribArray(b.a_rotateWithView)};a.prototype.drawReplay=
function(a,b,c,d){var e=d?this.getHitDetectionTextures():this.getTextures();d=d?this.hitDetectionGroupIndices:this.groupIndices;if(h.default.isEmpty(c)){var f;c=0;var g=e.length;for(f=0;c<g;++c){a.bindTexture(l.default.TEXTURE_2D,e[c]);var m=d[c];this.drawElements(a,b,f,m);f=m}}else this.drawReplaySkipping(a,b,c,e,d)};a.prototype.drawReplaySkipping=function(a,b,d,e,f){var g=0,h;var m=0;for(h=e.length;m<h;++m){a.bindTexture(l.default.TEXTURE_2D,e[m]);for(var p=0<m?f[m-1]:0,k=f[m],n=p;g<this.startIndices.length&&
this.startIndices[g]<=k;){var t=c.default.getUid(this.startIndicesFeature[g]).toString();void 0!==d[t]?(n!==p&&this.drawElements(a,b,n,p),p=n=g===this.startIndices.length-1?k:this.startIndices[g+1]):p=g===this.startIndices.length-1?k:this.startIndices[g+1];g++}n!==p&&this.drawElements(a,b,n,p)}};a.prototype.drawHitDetectionReplayOneByOne=function(a,d,e,f,g){var h,p,m=this.startIndices.length-1,k=this.getHitDetectionTextures();for(h=k.length-1;0<=h;--h){a.bindTexture(l.default.TEXTURE_2D,k[h]);var n=
0<h?this.hitDetectionGroupIndices[h-1]:0;for(p=this.hitDetectionGroupIndices[h];0<=m&&this.startIndices[m]>=n;){var t=this.startIndices[m];var r=this.startIndicesFeature[m];var q=c.default.getUid(r).toString();if(void 0===e[q]&&r.getGeometry()&&(void 0===g||b.default.intersects(g,r.getGeometry().getExtent()))&&(a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.drawElements(a,d,t,p),p=f(r)))return p;p=t;m--}}};a.prototype.finish=function(a){this.imageWidth=this.imageHeight=this.height=this.anchorY=
this.anchorX=void 0;this.indices=null;this.scale=this.rotation=this.rotateWithView=this.originY=this.originX=this.opacity=void 0;this.vertices=null;this.width=void 0};a.prototype.getTextures=function(a){};a.prototype.getHitDetectionTextures=function(){};k.default=a},{"../../extent.js":54,"../../index.js":89,"../../obj.js":124,"../../webgl.js":248,"../../webgl/context.js":250,"../webgl/replay.js":177,"../webgl/texturereplay/defaultshader.js":181,"../webgl/texturereplay/defaultshader/locations.js":182}],
181:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../../index.js");e=d(e);var c=a("../../../webgl/fragment.js");c=d(c);a=a("../../../webgl/vertex.js");a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":
"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}");b.vertex=new a.default(e.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":
"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");k.default=b},{"../../../index.js":89,"../../../webgl/fragment.js":252,"../../../webgl/vertex.js":254}],182:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=
a("../../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_projectionMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_projectionMatrix":"h");this.u_offsetScaleMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_offsetScaleMatrix":"i");this.u_offsetRotateMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_offsetRotateMatrix":"j");this.u_opacity=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_opacity":"k");this.u_image=a.getUniformLocation(b,d.default.DEBUG_WEBGL?
"u_image":"l");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"c");this.a_texCoord=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_texCoord":"d");this.a_offsets=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_offsets":"e");this.a_opacity=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_opacity":"f");this.a_rotateWithView=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_rotateWithView":"g")}},{"../../../../index.js":89}],183:[function(a,e,k){function d(a){return a&&a.__esModule?
a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../imagecanvas.js");var b=d(e);e=a("../../layertype.js");var h=d(e);e=a("../../viewhint.js");var n=d(e);e=a("../../array.js");var g=d(e);e=a("../../extent.js");var f=d(e);e=a("../../layer/vectorrendertype.js");var l=d(e);e=a("../../obj.js");var q=d(e);e=a("../../plugins.js");var m=d(e);e=a("../type.js");var p=d(e);e=a("../canvas/intermediatecanvas.js");var r=d(e);a=a("../../transform.js");var t=
d(a),u=function(a){r.default.call(this,a);this.image_=null;this.imageTransform_=t.default.create();this.skippedFeatures_=[];this.vectorRenderer_=null};c.default.inherits(u,r.default);u.handles=function(a,b){return a===p.default.CANVAS&&(b.getType()===h.default.IMAGE||b.getType()===h.default.VECTOR&&b.getRenderMode()===l.default.IMAGE)};u.create=function(a,b){var c=new u(b);if(b.getType()===h.default.VECTOR)for(var d=m.default.getLayerRendererPlugins(),e=0,f=d.length;e<f;++e){var g=d[e];g!==u&&g.handles(p.default.CANVAS,
b)&&c.setVectorRenderer(g.create(a,b))}return c};u.prototype.getImage=function(){return this.image_?this.image_.getImage():null};u.prototype.getImageTransform=function(){return this.imageTransform_};u.prototype.prepareFrame=function(a,d){var e=a.pixelRatio,h=a.size,l=a.viewState,p=l.center,m=l.resolution,k=this.getLayer().getSource(),r=a.viewHints,u=a.extent;void 0!==d.extent&&(u=f.default.getIntersection(u,d.extent));if(!r[n.default.ANIMATING]&&!r[n.default.INTERACTING]&&!f.default.isEmpty(u))if(r=
l.projection,c.default.ENABLE_RASTER_REPROJECTION||(l=k.getProjection())&&(r=l),l=this.vectorRenderer_){r=l.context;var y=q.default.assign({},a,{size:[f.default.getWidth(u)/m,f.default.getHeight(u)/m],viewState:q.default.assign({},a.viewState,{rotation:0})}),w=Object.keys(y.skippedFeatureUids).sort();!l.prepareFrame(y,d)||!l.replayGroupChanged&&g.default.equals(w,this.skippedFeatures_)||(r.canvas.width=y.size[0]*e,r.canvas.height=y.size[1]*e,l.composeFrame(y,d,r),this.image_=new b.default(u,m,e,r.canvas),
this.skippedFeatures_=w)}else(l=k.getImage(u,m,e,r))&&this.loadImage(l)&&(this.image_=l);this.image_&&(l=this.image_,u=l.getExtent(),d=l.getResolution(),l=l.getPixelRatio(),r=e*d/(m*l),u=t.default.compose(this.imageTransform_,e*h[0]/2,e*h[1]/2,r,r,0,l*(u[0]-p[0])/d,l*(p[1]-u[3])/d),t.default.compose(this.coordinateToCanvasPixelTransform,e*h[0]/2-u[4],e*h[1]/2-u[5],e/m,-e/m,0,-p[0],-p[1]),this.updateLogos(a,k),this.renderedResolution=d*e/l);return!!this.image_};u.prototype.forEachFeatureAtCoordinate=
function(a,b,c,d,e){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(a,b,c,d,e):r.default.prototype.forEachFeatureAtCoordinate.call(this,a,b,c,d,e)};u.prototype.setVectorRenderer=function(a){this.vectorRenderer_=a};k.default=u},{"../../array.js":29,"../../extent.js":54,"../../imagecanvas.js":87,"../../index.js":89,"../../layer/vectorrendertype.js":111,"../../layertype.js":113,"../../obj.js":124,"../../plugins.js":131,"../../transform.js":243,"../../viewhint.js":246,"../canvas/intermediatecanvas.js":184,
"../type.js":192}],184:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../coordinate.js");var b=d(e);e=a("../../dom.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../canvas/layer.js");var g=d(e);a=a("../../transform.js");var f=d(a);a=function(a){g.default.call(this,a);this.coordinateToCanvasPixelTransform=f.default.create();this.hitCanvasContext_=null};c.default.inherits(a,g.default);
a.prototype.composeFrame=function(a,b,c){this.preCompose(c,a);var d=this.getImage();if(d){var e=b.extent,f=void 0!==e&&!n.default.containsExtent(e,a.extent)&&n.default.intersects(e,a.extent);f&&this.clip(c,a,e);e=this.getImageTransform();var g=c.globalAlpha;c.globalAlpha=b.opacity;c.drawImage(d,0,0,+d.width,+d.height,Math.round(e[4]),Math.round(e[5]),Math.round(d.width*e[0]),Math.round(d.height*e[3]));c.globalAlpha=g;f&&c.restore()}this.postCompose(c,a,b)};a.prototype.getImage=function(){};a.prototype.getImageTransform=
function(){};a.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer();return f.getSource().forEachFeatureAtCoordinate(a,b.viewState.resolution,b.viewState.rotation,c,b.skippedFeatureUids,function(a){return d.call(e,a,f)})};a.prototype.forEachLayerAtCoordinate=function(a,d,e,p){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==c.default.nullFunction)return g.default.prototype.forEachLayerAtCoordinate.apply(this,arguments);var l=f.default.apply(this.coordinateToCanvasPixelTransform,
a.slice());b.default.scale(l,d.viewState.resolution/this.renderedResolution);this.hitCanvasContext_||(this.hitCanvasContext_=h.default.createCanvasContext2D(1,1));this.hitCanvasContext_.clearRect(0,0,1,1);this.hitCanvasContext_.drawImage(this.getImage(),l[0],l[1],1,1,0,0,1,1);l=this.hitCanvasContext_.getImageData(0,0,1,1).data;if(0<l[3])return e.call(p,this.getLayer(),l)}};k.default=a},{"../../coordinate.js":43,"../../dom.js":46,"../../extent.js":54,"../../index.js":89,"../../transform.js":243,"../canvas/layer.js":185}],
185:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../extent.js"),b=d(c);c=a("../../functions.js");var h=d(c);c=a("../../render/event.js");var n=d(c);c=a("../../render/eventtype.js");var g=d(c);c=a("../../render/canvas.js");var f=d(c);c=a("../../render/canvas/immediate.js");var l=d(c);c=a("../layer.js");var q=d(c);a=a("../../transform.js");var m=d(a);a=function(a){q.default.call(this,a);
this.renderedResolution;this.transform_=m.default.create()};e.default.inherits(a,q.default);a.prototype.clip=function(a,c,d){var e=c.pixelRatio,g=c.size[0]*e,h=c.size[1]*e,l=c.viewState.rotation,p=b.default.getTopLeft(d),k=b.default.getTopRight(d),n=b.default.getBottomRight(d);d=b.default.getBottomLeft(d);m.default.apply(c.coordinateToPixelTransform,p);m.default.apply(c.coordinateToPixelTransform,k);m.default.apply(c.coordinateToPixelTransform,n);m.default.apply(c.coordinateToPixelTransform,d);a.save();
f.default.rotateAtOffset(a,-l,g/2,h/2);a.beginPath();a.moveTo(p[0]*e,p[1]*e);a.lineTo(k[0]*e,k[1]*e);a.lineTo(n[0]*e,n[1]*e);a.lineTo(d[0]*e,d[1]*e);a.clip();f.default.rotateAtOffset(a,l,g/2,h/2)};a.prototype.dispatchComposeEvent_=function(a,b,c,d){var e=this.getLayer();if(e.hasListener(a)){var g=c.size[0]*c.pixelRatio,h=c.size[1]*c.pixelRatio,m=c.viewState.rotation;f.default.rotateAtOffset(b,-m,g/2,h/2);d=void 0!==d?d:this.getTransform(c,0);d=new l.default(b,c.pixelRatio,c.extent,d,c.viewState.rotation);
a=new n.default(a,d,c,b,null);e.dispatchEvent(a);f.default.rotateAtOffset(b,m,g/2,h/2)}};a.prototype.forEachLayerAtCoordinate=function(a,b,c,d){if(this.forEachFeatureAtCoordinate(a,b,0,h.default.TRUE,this))return c.call(d,this.getLayer(),null)};a.prototype.postCompose=function(a,b,c,d){this.dispatchComposeEvent_(g.default.POSTCOMPOSE,a,b,d)};a.prototype.preCompose=function(a,b,c){this.dispatchComposeEvent_(g.default.PRECOMPOSE,a,b,c)};a.prototype.dispatchRenderEvent=function(a,b,c){this.dispatchComposeEvent_(g.default.RENDER,
a,b,c)};a.prototype.getTransform=function(a,b){var c=a.viewState,d=a.pixelRatio,e=d/c.resolution;return m.default.compose(this.transform_,d*a.size[0]/2,d*a.size[1]/2,e,-e,-c.rotation,-c.center[0]+b,-c.center[1])};a.prototype.composeFrame=function(a,b,c){};a.prototype.prepareFrame=function(a,b){};k.default=a},{"../../extent.js":54,"../../functions.js":60,"../../index.js":89,"../../render/canvas.js":150,"../../render/canvas/immediate.js":152,"../../render/event.js":159,"../../render/eventtype.js":160,
"../../transform.js":243,"../layer.js":190}],186:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../transform.js");var c=d(e);e=a("../../index.js");e=d(e);var b=a("../../array.js"),h=d(b);b=a("../../css.js");var n=d(b);b=a("../../dom.js");var g=d(b);b=a("../../layer/layer.js");var f=d(b);b=a("../../render/event.js");var l=d(b);b=a("../../render/eventtype.js");var q=d(b);b=a("../../render/canvas.js");var m=d(b);b=a("../../render/canvas/immediate.js");
var p=d(b);b=a("../map.js");var r=d(b);b=a("../type.js");var t=d(b);a=a("../../source/state.js");var u=d(a),y=function(a,b){r.default.call(this,a,b);this.context_=g.default.createCanvasContext2D();this.canvas_=this.context_.canvas;this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=n.default.CLASS_UNSELECTABLE;a.insertBefore(this.canvas_,a.childNodes[0]||null);this.renderedVisible_=!0;this.transform_=c.default.create()};e.default.inherits(y,
r.default);y.handles=function(a){return a===t.default.CANVAS};y.create=function(a,b){return new y(a,b)};y.prototype.dispatchComposeEvent_=function(a,b){var c=this.getMap(),d=this.context_;if(c.hasListener(a)){var e=b.extent,f=b.pixelRatio,g=b.viewState.rotation,h=this.getTransform(b);e=new p.default(d,f,e,h,g);a=new l.default(a,e,b,d,null);c.dispatchEvent(a)}};y.prototype.getTransform=function(a){var b=a.viewState;a=a.pixelRatio/b.resolution;return c.default.compose(this.transform_,this.canvas_.width/
2,this.canvas_.height/2,a,-a,-b.rotation,-b.center[0],-b.center[1])};y.prototype.getType=function(){return t.default.CANVAS};y.prototype.renderFrame=function(a){if(a){var b=this.context_,c=a.pixelRatio,d=Math.round(a.size[0]*c),e=Math.round(a.size[1]*c);this.canvas_.width!=d||this.canvas_.height!=e?(this.canvas_.width=d,this.canvas_.height=e):b.clearRect(0,0,d,e);c=a.viewState.rotation;this.calculateMatrices2D(a);this.dispatchComposeEvent_(q.default.PRECOMPOSE,a);var g=a.layerStatesArray;h.default.stableSort(g,
r.default.sortByZIndex);c&&(b.save(),m.default.rotateAtOffset(b,c,d/2,e/2));d=a.viewState.resolution;var l;e=0;for(l=g.length;e<l;++e){var p=g[e];var k=p.layer;k=this.getLayerRenderer(k);f.default.visibleAtResolution(p,d)&&p.sourceState==u.default.READY&&k.prepareFrame(a,p)&&k.composeFrame(a,p,b)}c&&b.restore();this.dispatchComposeEvent_(q.default.POSTCOMPOSE,a);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0);this.scheduleRemoveUnusedLayerRenderers(a);this.scheduleExpireIconCache(a)}else this.renderedVisible_&&
(this.canvas_.style.display="none",this.renderedVisible_=!1)};y.prototype.forEachLayerAtPixel=function(a,b,d,e,g,h){var l=b.viewState.resolution,m=b.layerStatesArray,p=m.length;a=c.default.apply(b.pixelToCoordinateTransform,a.slice());for(--p;0<=p;--p){var k=m[p];var n=k.layer;if(f.default.visibleAtResolution(k,l)&&g.call(h,n)&&(k=this.getLayerRenderer(n).forEachLayerAtCoordinate(a,b,d,e)))return k}};k.default=y},{"../../array.js":29,"../../css.js":44,"../../dom.js":46,"../../index.js":89,"../../layer/layer.js":108,
"../../render/canvas.js":150,"../../render/canvas/immediate.js":152,"../../render/event.js":159,"../../render/eventtype.js":160,"../../source/state.js":212,"../../transform.js":243,"../map.js":191,"../type.js":192}],187:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../layertype.js");var b=d(e);e=a("../../tilerange.js");var h=d(e);e=a("../../tilestate.js");var n=d(e);e=a("../../viewhint.js");
var g=d(e);e=a("../../dom.js");var f=d(e);e=a("../../extent.js");var l=d(e);e=a("../type.js");var q=d(e);e=a("../canvas/intermediatecanvas.js");var m=d(e);a=a("../../transform.js");var p=d(a),r=function(a){m.default.call(this,a);this.context=null===this.context?null:f.default.createCanvasContext2D();this.oversampling_;this.renderedExtent_=null;this.renderedRevision;this.renderedTiles=[];this.tmpExtent=l.default.createEmpty();this.tmpTileRange_=new h.default(0,0,0,0);this.imageTransform_=p.default.create();
this.zDirection=0};c.default.inherits(r,m.default);r.handles=function(a,c){return a===q.default.CANVAS&&c.getType()===b.default.TILE};r.create=function(a,b){return new r(b)};r.prototype.isDrawableTile_=function(a){a=a.getState();var b=this.getLayer().getUseInterimTilesOnError();return a==n.default.LOADED||a==n.default.EMPTY||a==n.default.ERROR&&!b};r.prototype.prepareFrame=function(a,b){var d=a.pixelRatio,e=a.size,f=a.viewState,h=f.projection,m=f.resolution;f=f.center;var k=this.getLayer(),r=k.getSource(),
q=r.getRevision(),t=r.getTileGridForProjection(h),u=t.getZForResolution(m,this.zDirection),M=t.getResolution(u),H=Math.round(m/M)||1,J=a.extent;void 0!==b.extent&&(J=l.default.getIntersection(J,b.extent));if(l.default.isEmpty(J))return!1;var D=t.getTileRangeForExtentAndZ(J,u),T=t.getTileRangeExtent(u,D),R=r.getTilePixelRatio(d),G={};G[u]={};var Q=this.createLoadedTileFinder(r,h,G),da=this.tmpExtent,aa=this.tmpTileRange_,F=!1,N,O;for(N=D.minX;N<=D.maxX;++N)for(O=D.minY;O<=D.maxY;++O){var K=r.getTile(u,
N,O,d,h);K.getState()==n.default.ERROR&&(k.getUseInterimTilesOnError()?0<k.getPreload()&&(F=!0):K.setState(n.default.LOADED));this.isDrawableTile_(K)||(K=K.getInterimTile());if(this.isDrawableTile_(K)){var U=c.default.getUid(this);if(K.getState()==n.default.LOADED){G[u][K.tileCoord.toString()]=K;var Z=K.inTransition(U);F||!Z&&-1!==this.renderedTiles.indexOf(K)||(F=!0)}if(1===K.getAlpha(U,a.time))continue}U=t.getTileCoordChildTileRange(K.tileCoord,aa,da);Z=!1;U&&(Z=Q(u+1,U));Z||t.forEachTileCoordParentTileRange(K.tileCoord,
Q,null,aa,da)}K=M*d/R*H;N=a.viewHints;N=N[g.default.ANIMATING]||N[g.default.INTERACTING];if(!(this.renderedResolution&&16<Date.now()-a.time&&N||!F&&this.renderedExtent_&&l.default.containsExtent(this.renderedExtent_,J)&&this.renderedRevision==q&&H==this.oversampling_&&(N||K==this.renderedResolution))){if(K=this.context)O=r.getTilePixelSize(u,d,h),N=Math.round(D.getWidth()*O[0]/H),O=Math.round(D.getHeight()*O[1]/H),F=K.canvas,F.width!=N||F.height!=O?(this.oversampling_=H,F.width=N,F.height=O):(this.renderedExtent_&&
!l.default.equals(T,this.renderedExtent_)&&K.clearRect(0,0,N,O),H=this.oversampling_);this.renderedTiles.length=0;F=Object.keys(G).map(Number);F.sort(function(a,b){return a===u?1:b===u?-1:a>b?1:a<b?-1:0});U=0;for(Z=F.length;U<Z;++U){aa=F[U];Q=r.getTilePixelSize(aa,d,h);K=t.getResolution(aa);var ba=K/M;var X=R*r.getGutter(h);var V=G[aa];for(var Y in V){K=V[Y];O=t.getTileCoordExtent(K.getTileCoord(),da);N=(O[0]-T[0])/M*R/H;O=(T[3]-O[3])/M*R/H;var L=Q[0]*ba/H;var P=Q[1]*ba/H;this.drawTileImage(K,a,b,
N,O,L,P,X,u===aa);this.renderedTiles.push(K)}}this.renderedRevision=q;this.renderedResolution=M*d/R*H;this.renderedExtent_=T}b=this.renderedResolution/m;b=p.default.compose(this.imageTransform_,d*e[0]/2,d*e[1]/2,b,b,0,(this.renderedExtent_[0]-f[0])/this.renderedResolution*d,(f[1]-this.renderedExtent_[3])/this.renderedResolution*d);p.default.compose(this.coordinateToCanvasPixelTransform,d*e[0]/2-b[4],d*e[1]/2-b[5],d/m,-d/m,0,-f[0],-f[1]);this.updateUsedTiles(a.usedTiles,r,u,D);this.manageTilePyramid(a,
r,t,d,h,J,u,k.getPreload());this.scheduleExpireCache(a,r);this.updateLogos(a,r);return 0<this.renderedTiles.length};r.prototype.drawTileImage=function(a,b,d,e,f,g,h,l,m){if(d=a.getImage(this.getLayer())){var p=c.default.getUid(this),k=m?a.getAlpha(p,b.time):1;1!==k||this.getLayer().getSource().getOpaque(b.viewState.projection)||this.context.clearRect(e,f,g,h);var n=k!==this.context.globalAlpha;n&&(this.context.save(),this.context.globalAlpha=k);this.context.drawImage(d,l,l,d.width-2*l,d.height-2*
l,e,f,g,h);n&&this.context.restore();1!==k?b.animate=!0:m&&a.endTransition(p)}};r.prototype.getImage=function(){var a=this.context;return a?a.canvas:null};r.prototype.getLayer;r.prototype.getImageTransform=function(){return this.imageTransform_};k.default=r},{"../../dom.js":46,"../../extent.js":54,"../../index.js":89,"../../layertype.js":113,"../../tilerange.js":241,"../../tilestate.js":242,"../../transform.js":243,"../../viewhint.js":246,"../canvas/intermediatecanvas.js":184,"../type.js":192}],188:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../layertype.js");var b=d(e);e=a("../../viewhint.js");var h=d(e);e=a("../../dom.js");var n=d(e);e=a("../../events.js");var g=d(e);e=a("../../events/eventtype.js");var f=d(e);e=a("rbush");var l=d(e);e=a("../../extent.js");var q=d(e);e=a("../../render/eventtype.js");var m=d(e);e=a("../../render/canvas.js");var p=d(e);e=a("../../render/canvas/replaygroup.js");
var r=d(e);e=a("../type.js");var t=d(e);e=a("../canvas/layer.js");var u=d(e);a=a("../vector.js");var y=d(a),w=function(a){u.default.call(this,a);this.declutterTree_=a.getDeclutter()?(0,l.default)(9):null;this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=NaN;this.renderedExtent_=q.default.createEmpty();this.replayGroup_=this.renderedRenderOrder_=null;this.replayGroupChanged=!0;this.context=n.default.createCanvasContext2D();g.default.listen(p.default.labelCache,f.default.CLEAR,this.handleFontsChanged_,
this)};c.default.inherits(w,u.default);w.handles=function(a,c){return a===t.default.CANVAS&&c.getType()===b.default.VECTOR};w.create=function(a,b){return new w(b)};w.prototype.disposeInternal=function(){g.default.unlisten(p.default.labelCache,f.default.CLEAR,this.handleFontsChanged_,this);u.default.prototype.disposeInternal.call(this)};w.prototype.composeFrame=function(a,b,c){var d=a.extent,e=a.pixelRatio,f=b.managed?a.skippedFeatureUids:{},g=a.viewState,h=g.projection,l=g.rotation,k=h.getExtent(),
n=this.getLayer().getSource(),r=this.getTransform(a,0);this.preCompose(c,a,r);var u=b.extent;(g=void 0!==u)&&this.clip(c,a,u);var t=this.replayGroup_;if(t&&!t.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var y=this.getLayer(),v=u=0,w=1!==b.opacity;y=y.hasListener(m.default.RENDER);if(w||y){var A=c.canvas.width;var B=c.canvas.height;if(l){var N=Math.round(Math.sqrt(A*A+B*B));u=(N-A)/2;v=(N-B)/2;A=B=N}this.context.canvas.width=A;this.context.canvas.height=B;A=this.context}else A=c;B=
A.globalAlpha;w||(A.globalAlpha=b.opacity);A!=c&&A.translate(u,v);N=a.size[0]*e;e*=a.size[1];p.default.rotateAtOffset(A,-l,N/2,e/2);t.replay(A,r,l,f);if(n.getWrapX()&&h.canWrapX()&&!q.default.containsExtent(k,d)){h=d[0];n=q.default.getWidth(k);for(var O=0;h<k[0];)--O,r=n*O,r=this.getTransform(a,r),t.replay(A,r,l,f),h+=n;O=0;for(h=d[2];h>k[2];)++O,r=n*O,r=this.getTransform(a,r),t.replay(A,r,l,f),h-=n;r=this.getTransform(a,0)}p.default.rotateAtOffset(A,l,N/2,e/2);A!=c&&(y&&this.dispatchRenderEvent(A,
a,r),w?(d=c.globalAlpha,c.globalAlpha=b.opacity,c.drawImage(A.canvas,-u,-v),c.globalAlpha=d):c.drawImage(A.canvas,-u,-v),A.translate(-u,-v));w||(A.globalAlpha=B)}g&&c.restore();this.postCompose(c,a,b,r)};w.prototype.forEachFeatureAtCoordinate=function(a,b,d,e,f){if(this.replayGroup_){var g=b.viewState.resolution;b=b.viewState.rotation;var h=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(a,g,b,d,{},function(a){var b=c.default.getUid(a).toString();if(!(b in l))return l[b]=
!0,e.call(f,a,h)},null)}};w.prototype.handleFontsChanged_=function(a){a=this.getLayer();a.getVisible()&&this.replayGroup_&&a.changed()};w.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};w.prototype.prepareFrame=function(a,b){var c=this.getLayer();b=c.getSource();this.updateLogos(a,b);var d=a.viewHints[h.default.ANIMATING],e=a.viewHints[h.default.INTERACTING],f=c.getUpdateWhileAnimating(),g=c.getUpdateWhileInteracting();if(!this.dirty_&&!f&&d||!g&&e)return!0;f=a.extent;
var l=a.viewState;g=l.projection;var m=l.resolution,p=a.pixelRatio;d=c.getRevision();var k=c.getRenderBuffer();e=c.getRenderOrder();void 0===e&&(e=y.default.defaultOrder);f=q.default.buffer(f,k*m);k=l.projection.getExtent();b.getWrapX()&&l.projection.canWrapX()&&!q.default.containsExtent(k,a.extent)&&(a=q.default.getWidth(k),a=Math.max(q.default.getWidth(f)/2,a),f[0]=k[0]-a,f[2]=k[2]+a);if(!this.dirty_&&this.renderedResolution_==m&&this.renderedRevision_==d&&this.renderedRenderOrder_==e&&q.default.containsExtent(this.renderedExtent_,
f))return this.replayGroupChanged=!1,!0;this.replayGroup_=null;this.dirty_=!1;var n=new r.default(y.default.getTolerance(m,p),f,m,p,b.getOverlaps(),this.declutterTree_,c.getRenderBuffer());b.loadFeatures(f,m,g);a=function(a){var b=a.getStyleFunction();if(b)var d=b.call(a,m);else(b=c.getStyleFunction())&&(d=b(a,m));d&&(a=this.renderFeature(a,m,p,d,n),this.dirty_=this.dirty_||a)}.bind(this);if(e){var u=[];b.forEachFeatureInExtent(f,function(a){u.push(a)},this);u.sort(e);b=0;for(g=u.length;b<g;++b)a(u[b])}else b.forEachFeatureInExtent(f,
a,this);n.finish();this.renderedResolution_=m;this.renderedRevision_=d;this.renderedRenderOrder_=e;this.renderedExtent_=f;this.replayGroup_=n;return this.replayGroupChanged=!0};w.prototype.renderFeature=function(a,b,c,d,e){if(!d)return!1;var f=!1;if(Array.isArray(d))for(var g=0,h=d.length;g<h;++g)f=y.default.renderFeature(e,a,d[g],y.default.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;else f=y.default.renderFeature(e,a,d,y.default.getSquaredTolerance(b,c),this.handleStyleImageChange_,
this);return f};k.default=w},{"../../dom.js":46,"../../events.js":48,"../../events/eventtype.js":52,"../../extent.js":54,"../../index.js":89,"../../layertype.js":113,"../../render/canvas.js":150,"../../render/canvas/replaygroup.js":157,"../../render/eventtype.js":160,"../../viewhint.js":246,"../canvas/layer.js":185,"../type.js":192,"../vector.js":193,rbush:258}],189:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");
var c=d(e);e=a("../../layertype.js");var b=d(e);e=a("../../tilestate.js");var h=d(e);e=a("../../dom.js");var n=d(e);e=a("../../events.js");var g=d(e);e=a("../../events/eventtype.js");var f=d(e);e=a("rbush");var l=d(e);e=a("../../extent.js");var q=d(e);e=a("../../layer/vectortilerendertype.js");var m=d(e);e=a("../../proj.js");var p=d(e);e=a("../../proj/units.js");var r=d(e);e=a("../../render/replaytype.js");e=d(e);var t=a("../../render/canvas.js"),u=d(t);t=a("../../render/canvas/replaygroup.js");var y=
d(t);t=a("../../render/replay.js");t=d(t);var w=a("../type.js"),v=d(w);w=a("../canvas/tilelayer.js");var A=d(w);w=a("../vector.js");var B=d(w);a=a("../../transform.js");var x=d(a),z=function(a){this.context=null;A.default.call(this,a);this.declutterTree_=a.getDeclutter()?(0,l.default)(9):null;this.dirty_=!1;this.renderedLayerRevision_;this.tmpTransform_=x.default.create();this.zDirection=a.getRenderMode()==m.default.VECTOR?1:0;g.default.listen(u.default.labelCache,f.default.CLEAR,this.handleFontsChanged_,
this)};c.default.inherits(z,A.default);z.handles=function(a,c){return a===v.default.CANVAS&&c.getType()===b.default.VECTOR_TILE};z.create=function(a,b){return new z(b)};z.IMAGE_REPLAYS={image:[e.default.POLYGON,e.default.CIRCLE,e.default.LINE_STRING,e.default.IMAGE,e.default.TEXT],hybrid:[e.default.POLYGON,e.default.LINE_STRING]};z.VECTOR_REPLAYS={image:[e.default.DEFAULT],hybrid:[e.default.IMAGE,e.default.TEXT,e.default.DEFAULT],vector:t.default.ORDER};z.prototype.disposeInternal=function(){g.default.unlisten(u.default.labelCache,
f.default.CLEAR,this.handleFontsChanged_,this);A.default.prototype.disposeInternal.call(this)};z.prototype.prepareFrame=function(a,b){var c=this.getLayer(),d=c.getRevision();this.renderedLayerRevision_!=d&&(this.renderedTiles.length=0,c=c.getRenderMode(),this.context||c==m.default.VECTOR||(this.context=n.default.createCanvasContext2D()),this.context&&c==m.default.VECTOR&&(this.context=null));this.renderedLayerRevision_=d;return A.default.prototype.prepareFrame.apply(this,arguments)};z.prototype.createReplayGroup_=
function(a,b){var c=this.getLayer(),d=b.pixelRatio;b=b.viewState.projection;var e=c.getRevision(),f=c.getRenderOrder()||null,g=a.getReplayState(c);if(g.dirty||g.renderedRevision!=e||g.renderedRenderOrder!=f){var l=c.getSource(),m=l.getTileGrid(),k=l.getTileGridForProjection(b),n=k.getResolution(a.tileCoord[0]);k=k.getTileCoordExtent(a.wrappedTileCoord);for(var u=0,t=a.tileKeys.length;u<t;++u){var C=a.getTile(a.tileKeys[u]);if(C.getState()!=h.default.ERROR){var w=m.getTileCoordExtent(C.tileCoord),
z=q.default.getIntersection(k,w),v=q.default.equals(w,z)?null:q.default.buffer(z,c.getRenderBuffer()*n),A=C.getProjection(),S=!1;p.default.equivalent(b,A)||(S=!0,C.setProjection(b));g.dirty=!1;z=new y.default(0,z,n,d,l.getOverlaps(),this.declutterTree_,c.getRenderBuffer());var x=B.default.getSquaredTolerance(n,d),X=C.getFeatures();f&&f!==g.renderedRenderOrder&&X.sort(f);for(var V,Y=0,L=X.length;Y<L;++Y)if(V=X[Y],S&&(A.getUnits()==r.default.TILE_PIXELS&&(A.setWorldExtent(w),A.setExtent(C.getExtent())),
V.getGeometry().transform(A,b)),!v||q.default.intersects(v,V.getGeometry().getExtent())){var P=void 0,ea=V.getStyleFunction();ea?P=ea.call(V,n):(ea=c.getStyleFunction())&&(P=ea(V,n));P&&(P=this.renderFeature(V,x,P,z),this.dirty_=this.dirty_||P,g.dirty=g.dirty||P)}z.finish();for(var W in z.getReplays());C.setReplayGroup(c,a.tileCoord.toString(),z)}}g.renderedRevision=e;g.renderedRenderOrder=f}};z.prototype.drawTileImage=function(a,b,c,d,e,f,g,h,l){var m=a;this.createReplayGroup_(m,b);this.context&&
(this.renderTileImage_(m,b,c),A.default.prototype.drawTileImage.apply(this,arguments))};z.prototype.forEachFeatureAtCoordinate=function(a,b,d,e,f){var g=b.viewState.resolution,l=b.viewState.rotation;d=void 0==d?0:d;var m=this.getLayer(),p={},k=this.renderedTiles;b=m.getSource().getTileGridForProjection(b.viewState.projection);var n;var r=0;for(n=k.length;r<n;++r){var u=k[r];var t=u.wrappedTileCoord;t=b.getTileCoordExtent(t,this.tmpExtent);var y=q.default.buffer(t,d*g,y);if(q.default.containsCoordinate(y,
a)){t=0;for(var C=u.tileKeys.length;t<C;++t){var w=u.getTile(u.tileKeys[t]);if(w.getState()!=h.default.ERROR){w=w.getReplayGroup(m,u.tileCoord.toString());var z=z||w.forEachFeatureAtCoordinate(a,g,l,d,{},function(a){var b=c.default.getUid(a).toString();if(!(b in p))return p[b]=!0,e.call(f,a,m)},null)}}}}return z};z.prototype.getReplayTransform_=function(a,b){var c=this.getLayer().getSource().getTileGrid(),d=a.tileCoord;a=c.getResolution(d[0]);var e=b.viewState,f=b.pixelRatio,g=e.resolution/f;d=c.getTileCoordExtent(d,
this.tmpExtent);c=e.center;d=q.default.getTopLeft(d);b=b.size;return x.default.compose(this.tmpTransform_,Math.round(f*b[0]/2),Math.round(f*b[1]/2),a/g,a/g,e.rotation,(d[0]-c[0])/a,(c[1]-d[1])/a)};z.prototype.handleFontsChanged_=function(a){a=this.getLayer();a.getVisible()&&void 0!==this.renderedLayerRevision_&&a.changed()};z.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};z.prototype.postCompose=function(a,b,c){var d=this.getLayer(),e=d.getDeclutter()?{}:null,f=d.getSource(),
g=d.getRenderMode(),l=z.VECTOR_REPLAYS[g],p=b.pixelRatio,k=b.viewState.rotation,n=b.size;if(k){var r=Math.round(p*n[0]/2);var q=Math.round(p*n[1]/2);u.default.rotateAtOffset(a,-k,r,q)}e&&this.declutterTree_.clear();p=this.renderedTiles;f=f.getTileGridForProjection(b.viewState.projection);n=[];for(var t=[],C=p.length-1;0<=C;--C){var w=p[C];if(w.getState()!=h.default.ABORT)for(var v=w.tileCoord,S=f.getTileCoordExtent(v)[0]-f.getTileCoordExtent(w.wrappedTileCoord)[0],x=void 0,I=0,B=w.tileKeys.length;I<
B;++I){var V=w.getTile(w.tileKeys[I]);if(V.getState()!=h.default.ERROR){var Y=V.getReplayGroup(d,v.toString());if(g==m.default.VECTOR||Y.hasReplays(l)){x||(x=this.getTransform(b,S));V=V.tileCoord[0];var L=Y.getClipCoords(x);a.save();a.globalAlpha=c.opacity;for(var P=0,ea=n.length;P<ea;++P){var W=n[P];V<t[P]&&(a.beginPath(),a.moveTo(L[0],L[1]),a.lineTo(L[2],L[3]),a.lineTo(L[4],L[5]),a.lineTo(L[6],L[7]),a.moveTo(W[6],W[7]),a.lineTo(W[4],W[5]),a.lineTo(W[2],W[3]),a.lineTo(W[0],W[1]),a.clip())}Y.replay(a,
x,k,{},l,e);a.restore();n.push(L);t.push(V)}}}}e&&y.default.replayDeclutter(e,a,k);k&&u.default.rotateAtOffset(a,k,r,q);A.default.prototype.postCompose.apply(this,arguments)};z.prototype.renderFeature=function(a,b,c,d){if(!c)return!1;var e=!1;if(Array.isArray(c))for(var f=0,g=c.length;f<g;++f)e=B.default.renderFeature(d,a,c[f],b,this.handleStyleImageChange_,this)||e;else e=B.default.renderFeature(d,a,c,b,this.handleStyleImageChange_,this);return e};z.prototype.renderTileImage_=function(a,b,c){c=this.getLayer();
var d=a.getReplayState(c),e=c.getRevision(),f=z.IMAGE_REPLAYS[c.getRenderMode()];if(f&&d.renderedTileRevision!==e){d.renderedTileRevision=e;var g=a.wrappedTileCoord,l=g[0];d=b.pixelRatio;var m=c.getSource(),p=m.getTileGridForProjection(b.viewState.projection);e=p.getResolution(l);var k=a.getContext(c);b=m.getTilePixelSize(l,d,b.viewState.projection);k.canvas.width=b[0];k.canvas.height=b[1];b=p.getTileCoordExtent(g);g=0;for(p=a.tileKeys.length;g<p;++g)if(l=a.getTile(a.tileKeys[g]),l.getState()!=h.default.ERROR){m=
d/e;var n=x.default.reset(this.tmpTransform_);x.default.scale(n,m,-m);x.default.translate(n,-b[0],-b[3]);l.getReplayGroup(c,a.tileCoord.toString()).replay(k,n,0,{},f)}}};k.default=z},{"../../dom.js":46,"../../events.js":48,"../../events/eventtype.js":52,"../../extent.js":54,"../../index.js":89,"../../layer/vectortilerendertype.js":112,"../../layertype.js":113,"../../proj.js":141,"../../proj/units.js":148,"../../render/canvas.js":150,"../../render/canvas/replaygroup.js":157,"../../render/replay.js":161,
"../../render/replaytype.js":163,"../../tilestate.js":242,"../../transform.js":243,"../canvas/tilelayer.js":187,"../type.js":192,"../vector.js":193,rbush:258}],190:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../imagestate.js");var b=d(e);e=a("../observable.js");var h=d(e);e=a("../tilestate.js");var n=d(e);e=a("../asserts.js");var g=d(e);e=a("../events.js");var f=d(e);e=a("../events/eventtype.js");
var l=d(e);e=a("../functions.js");e=d(e);a=a("../source/state.js");var q=d(a);a=function(a){h.default.call(this);this.layer_=a};c.default.inherits(a,h.default);a.prototype.forEachFeatureAtCoordinate=c.default.nullFunction;a.prototype.hasFeatureAtCoordinate=e.default.FALSE;a.prototype.createLoadedTileFinder=function(a,b,c){return function(d,e){return a.forEachLoadedTile(b,d,e,function(a){c[d]||(c[d]={});c[d][a.tileCoord.toString()]=a})}};a.prototype.getLayer=function(){return this.layer_};a.prototype.handleImageChange_=
function(a){a.target.getState()===b.default.LOADED&&this.renderIfReadyAndVisible()};a.prototype.loadImage=function(a){var c=a.getState();c!=b.default.LOADED&&c!=b.default.ERROR&&f.default.listen(a,l.default.CHANGE,this.handleImageChange_,this);c==b.default.IDLE&&(a.load(),c=a.getState());return c==b.default.LOADED};a.prototype.renderIfReadyAndVisible=function(){var a=this.getLayer();a.getVisible()&&a.getSourceState()==q.default.READY&&this.changed()};a.prototype.scheduleExpireCache=function(a,b){b.canExpireCache()&&
(b=function(a,b,d){b=c.default.getUid(a).toString();b in d.usedTiles&&a.expireCache(d.viewState.projection,d.usedTiles[b])}.bind(null,b),a.postRenderFunctions.push(b))};a.prototype.updateLogos=function(a,b){b=b.getLogo();void 0!==b&&("string"===typeof b?a.logos[b]="":b&&(g.default.assert("string"==typeof b.href,44),g.default.assert("string"==typeof b.src,45),a.logos[b.src]=b.href))};a.prototype.updateUsedTiles=function(a,b,d,e){b=c.default.getUid(b).toString();d=d.toString();b in a?d in a[b]?a[b][d].extend(e):
a[b][d]=e:(a[b]={},a[b][d]=e)};a.prototype.manageTilePyramid=function(a,b,d,e,f,g,h,l,k,q){var m=c.default.getUid(b).toString();m in a.wantedTiles||(a.wantedTiles[m]={});var p=a.wantedTiles[m];a=a.tileQueue;var r,u,t;for(t=d.getMinZoom();t<=h;++t){var y=d.getTileRangeForExtentAndZ(g,t,y);var w=d.getResolution(t);for(r=y.minX;r<=y.maxX;++r)for(u=y.minY;u<=y.maxY;++u)if(h-t<=l){var v=b.getTile(t,r,u,e,f);v.getState()==n.default.IDLE&&(p[v.getKey()]=!0,a.isKeyQueued(v.getKey())||a.enqueue([v,m,d.getTileCoordCenter(v.tileCoord),
w]));void 0!==k&&k.call(q,v)}else b.useTile(t,r,u,f)}};k.default=a},{"../asserts.js":31,"../events.js":48,"../events/eventtype.js":52,"../functions.js":60,"../imagestate.js":88,"../index.js":89,"../observable.js":127,"../source/state.js":212,"../tilestate.js":242}],191:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../disposable.js");var b=d(e);e=a("../events.js");var h=d(e);e=a("../events/eventtype.js");
var n=d(e);e=a("../extent.js");var g=d(e);e=a("../functions.js");var f=d(e);e=a("../layer/layer.js");var l=d(e);e=a("../plugins.js");var q=d(e);e=a("../style.js");var m=d(e);a=a("../transform.js");var p=d(a),r=function(a,c){b.default.call(this);this.map_=c;this.layerRenderers_={};this.layerRendererListeners_={}};c.default.inherits(r,b.default);r.prototype.calculateMatrices2D=function(a){var b=a.viewState,c=a.coordinateToPixelTransform,d=a.pixelToCoordinateTransform;p.default.compose(c,a.size[0]/2,
a.size[1]/2,1/b.resolution,-1/b.resolution,-b.rotation,-b.center[0],-b.center[1]);p.default.invert(p.default.setFromArray(d,c))};r.prototype.removeLayerRenderers=function(){for(var a in this.layerRenderers_)this.removeLayerRendererByKey_(a).dispose()};r.expireIconCache_=function(a,b){m.default.iconImageCache.expire()};r.prototype.forEachFeatureAtCoordinate=function(a,b,d,e,f,h,m){function k(a,d){var g=c.default.getUid(a).toString(),h=b.layerStates[c.default.getUid(d)].managed;if(!(g in b.skippedFeatureUids)||
h)return e.call(f,a,h?d:null)}var p,n=b.viewState,r=n.resolution,q=n.projection;n=a;if(q.canWrapX()){q=q.getExtent();var u=g.default.getWidth(q),t=a[0];if(t<q[0]||t>q[2])n=[t+u*Math.ceil((q[0]-t)/u),a[1]]}q=b.layerStatesArray;for(u=q.length-1;0<=u;--u){var y=q[u];t=y.layer;if(l.default.visibleAtResolution(y,r)&&h.call(m,t)&&(y=this.getLayerRenderer(t),t.getSource()&&(p=y.forEachFeatureAtCoordinate(t.getSource().getWrapX()?n:a,b,d,k,f)),p))return p}};r.prototype.forEachLayerAtPixel=function(a,b,c,
d,e,f){};r.prototype.hasFeatureAtCoordinate=function(a,b,c,d,e){return void 0!==this.forEachFeatureAtCoordinate(a,b,c,f.default.TRUE,this,d,e)};r.prototype.getLayerRenderer=function(a){var b=c.default.getUid(a).toString();if(b in this.layerRenderers_)return this.layerRenderers_[b];for(var d=q.default.getLayerRendererPlugins(),e,f=this.getType(),g=0,l=d.length;g<l;++g){var m=d[g];if(m.handles(f,a)){e=m.create(this,a);break}}if(e)this.layerRenderers_[b]=e,this.layerRendererListeners_[b]=h.default.listen(e,
n.default.CHANGE,this.handleLayerRendererChange_,this);else throw Error("Unable to create renderer for layer: "+a.getType());return e};r.prototype.getLayerRendererByKey=function(a){return this.layerRenderers_[a]};r.prototype.getLayerRenderers=function(){return this.layerRenderers_};r.prototype.getMap=function(){return this.map_};r.prototype.getType=function(){};r.prototype.handleLayerRendererChange_=function(){this.map_.render()};r.prototype.removeLayerRendererByKey_=function(a){var b=this.layerRenderers_[a];
delete this.layerRenderers_[a];h.default.unlistenByKey(this.layerRendererListeners_[a]);delete this.layerRendererListeners_[a];return b};r.prototype.renderFrame=c.default.nullFunction;r.prototype.removeUnusedLayerRenderers_=function(a,b){for(var c in this.layerRenderers_)b&&c in b.layerStates||this.removeLayerRendererByKey_(c).dispose()};r.prototype.scheduleExpireIconCache=function(a){a.postRenderFunctions.push(r.expireIconCache_)};r.prototype.scheduleRemoveUnusedLayerRenderers=function(a){for(var b in this.layerRenderers_)if(!(b in
a.layerStates)){a.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this));break}};r.sortByZIndex=function(a,b){return a.zIndex-b.zIndex};k.default=r},{"../disposable.js":45,"../events.js":48,"../events/eventtype.js":52,"../extent.js":54,"../functions.js":60,"../index.js":89,"../layer/layer.js":108,"../plugins.js":131,"../style.js":221,"../transform.js":243}],192:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={CANVAS:"canvas",WEBGL:"webgl"}},{}],193:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../imagestate.js");var b=d(e);e=a("../geom/geometrytype.js");var h=d(e);a=a("../render/replaytype.js");var n=d(a),g={defaultOrder:function(a,b){return c.default.getUid(a)-c.default.getUid(b)},getSquaredTolerance:function(a,b){a=g.getTolerance(a,b);return a*a},getTolerance:function(a,b){return c.default.SIMPLIFY_TOLERANCE*a/b},renderCircleGeometry_:function(a,
b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),n.default.CIRCLE);g.setFillStrokeStyle(e,f);g.drawCircle(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),n.default.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)},renderFeature:function(a,c,d,e,h,k){var f=!1,l;if(l=d.getImage()){var m=l.getImageState();m==b.default.LOADED||m==b.default.ERROR?l.unlistenImageChange(h,k):(m==b.default.IDLE&&l.load(),l.getImageState(),l.listenImageChange(h,k),f=!0)}g.renderFeature_(a,
c,d,e);return f},renderFeature_:function(a,b,c,d){var e=c.getGeometryFunction()(b);if(e)if(d=e.getSimplifiedGeometry(d),c.getRenderer())g.renderGeometry_(a,d,c,b);else(0,g.GEOMETRY_RENDERERS_[d.getType()])(a,d,c,b)},renderGeometry_:function(a,b,c,d){if(b.getType()==h.default.GEOMETRY_COLLECTION){b=b.getGeometries();for(var e=0,f=b.length;e<f;++e)g.renderGeometry_(a,b[e],c,d)}else a.getReplay(c.getZIndex(),n.default.DEFAULT).drawCustom(b,d,c.getRenderer())},renderGeometryCollectionGeometry_:function(a,
b,c,d){b=b.getGeometriesArray();var e;var f=0;for(e=b.length;f<e;++f)(0,g.GEOMETRY_RENDERERS_[b[f].getType()])(a,b[f],c,d)},renderLineStringGeometry_:function(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),n.default.LINE_STRING);f.setFillStrokeStyle(null,e);f.drawLineString(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),n.default.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)},renderMultiLineStringGeometry_:function(a,b,c,d){var e=c.getStroke();if(e){var f=a.getReplay(c.getZIndex(),
n.default.LINE_STRING);f.setFillStrokeStyle(null,e);f.drawMultiLineString(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),n.default.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)},renderMultiPolygonGeometry_:function(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(f||e){var g=a.getReplay(c.getZIndex(),n.default.POLYGON);g.setFillStrokeStyle(e,f);g.drawMultiPolygon(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),n.default.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)},renderPointGeometry_:function(a,
c,d,e){var f=d.getImage();if(f){if(f.getImageState()!=b.default.LOADED)return;var g=a.getReplay(d.getZIndex(),n.default.IMAGE);g.setImageStyle(f,a.addDeclutter(!1));g.drawPoint(c,e)}if(g=d.getText())d=a.getReplay(d.getZIndex(),n.default.TEXT),d.setTextStyle(g,a.addDeclutter(!!f)),d.drawText(c,e)},renderMultiPointGeometry_:function(a,c,d,e){var f=d.getImage();if(f){if(f.getImageState()!=b.default.LOADED)return;var g=a.getReplay(d.getZIndex(),n.default.IMAGE);g.setImageStyle(f,a.addDeclutter(!1));g.drawMultiPoint(c,
e)}if(g=d.getText())d=a.getReplay(d.getZIndex(),n.default.TEXT),d.setTextStyle(g,a.addDeclutter(!!f)),d.drawText(c,e)},renderPolygonGeometry_:function(a,b,c,d){var e=c.getFill(),f=c.getStroke();if(e||f){var g=a.getReplay(c.getZIndex(),n.default.POLYGON);g.setFillStrokeStyle(e,f);g.drawPolygon(b,d)}if(e=c.getText())c=a.getReplay(c.getZIndex(),n.default.TEXT),c.setTextStyle(e,a.addDeclutter(!1)),c.drawText(b,d)}};g.GEOMETRY_RENDERERS_={Point:g.renderPointGeometry_,LineString:g.renderLineStringGeometry_,
Polygon:g.renderPolygonGeometry_,MultiPoint:g.renderMultiPointGeometry_,MultiLineString:g.renderMultiLineStringGeometry_,MultiPolygon:g.renderMultiPolygonGeometry_,GeometryCollection:g.renderGeometryCollectionGeometry_,Circle:g.renderCircleGeometry_};k.default=g},{"../geom/geometrytype.js":79,"../imagestate.js":88,"../index.js":89,"../render/replaytype.js":163}],194:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");
e=d(e);var c=a("../../webgl/fragment.js");c=d(c);a=a("../../webgl/vertex.js");a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}");
b.vertex=new a.default(e.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");
k.default=b},{"../../index.js":89,"../../webgl/fragment.js":252,"../../webgl/vertex.js":254}],195:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_texCoordMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_texCoordMatrix":"d");this.u_projectionMatrix=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_projectionMatrix":"e");this.u_opacity=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_opacity":
"f");this.u_texture=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_texture":"g");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_texCoord":"c")}},{"../../../index.js":89}],196:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../layertype.js");var b=d(e);e=a("../../viewhint.js");var h=d(e);e=a("../../dom.js");
var n=d(e);e=a("../../extent.js");var g=d(e);e=a("../../functions.js");var f=d(e);e=a("../type.js");var l=d(e);e=a("../webgl/layer.js");var q=d(e);e=a("../../transform.js");var m=d(e);e=a("../../webgl.js");var p=d(e);a=a("../../webgl/context.js");var r=d(a),t=function(a,b){q.default.call(this,a,b);this.hitTransformationMatrix_=this.hitCanvasContext_=this.image_=null};c.default.inherits(t,q.default);t.handles=function(a,c){return a===l.default.WEBGL&&c.getType()===b.default.IMAGE};t.create=function(a,
b){return new t(a,b)};t.prototype.createTexture_=function(a){a=a.getImage();var b=this.mapRenderer.getGL();return r.default.createTexture(b,a,p.default.CLAMP_TO_EDGE,p.default.CLAMP_TO_EDGE)};t.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e){var f=this.getLayer();return f.getSource().forEachFeatureAtCoordinate(a,b.viewState.resolution,b.viewState.rotation,c,b.skippedFeatureUids,function(a){return d.call(e,a,f)})};t.prototype.prepareFrame=function(a,b,d){var e=this.mapRenderer.getGL(),f=a.pixelRatio,
l=a.viewState,k=l.center,p=l.resolution,n=l.rotation;d=this.image_;var r=this.texture,q=this.getLayer().getSource(),u=a.viewHints,t=a.extent;void 0!==b.extent&&(t=g.default.getIntersection(t,b.extent));u[h.default.ANIMATING]||u[h.default.INTERACTING]||g.default.isEmpty(t)||(b=l.projection,c.default.ENABLE_RASTER_REPROJECTION||(l=q.getProjection())&&(b=l),(t=q.getImage(t,p,f,b))&&this.loadImage(t)&&(d=t,r=this.createTexture_(t),this.texture&&(e=function(a,b){a.isContextLost()||a.deleteTexture(b)}.bind(null,
e,this.texture),a.postRenderFunctions.push(e))));d&&(e=this.mapRenderer.getContext().getCanvas(),this.updateProjectionMatrix_(e.width,e.height,f,k,p,n,d.getExtent()),this.hitTransformationMatrix_=null,f=this.texCoordMatrix,m.default.reset(f),m.default.scale(f,1,-1),m.default.translate(f,0,-1),this.image_=d,this.texture=r,this.updateLogos(a,q));return!!d};t.prototype.updateProjectionMatrix_=function(a,b,c,d,e,f,g){a*=e;b*=e;e=this.projectionMatrix;m.default.reset(e);m.default.scale(e,2*c/a,2*c/b);
m.default.rotate(e,-f);m.default.translate(e,g[0]-d[0],g[1]-d[1]);m.default.scale(e,(g[2]-g[0])/2,(g[3]-g[1])/2);m.default.translate(e,1,1)};t.prototype.hasFeatureAtCoordinate=function(a,b){return void 0!==this.forEachFeatureAtCoordinate(a,b,0,f.default.TRUE,this)};t.prototype.forEachLayerAtPixel=function(a,b,d,e){if(this.image_&&this.image_.getImage())if(this.getLayer().getSource().forEachFeatureAtCoordinate!==c.default.nullFunction){var g=m.default.apply(b.pixelToCoordinateTransform,a.slice());
if(this.forEachFeatureAtCoordinate(g,b,0,f.default.TRUE,this))return d.call(e,this.getLayer(),null)}else if(g=[this.image_.getImage().width,this.image_.getImage().height],this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(b.size,g)),b=m.default.apply(this.hitTransformationMatrix_,a.slice()),!(0>b[0]||b[0]>g[0]||0>b[1]||b[1]>g[1])&&(this.hitCanvasContext_||(this.hitCanvasContext_=n.default.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,
1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),b[0],b[1],1,1,0,0,1,1),b=this.hitCanvasContext_.getImageData(0,0,1,1).data,0<b[3]))return d.call(e,this.getLayer(),b)};t.prototype.getHitTransformationMatrix_=function(a,b){var c=m.default.create();m.default.translate(c,-1,-1);m.default.scale(c,2/a[0],2/a[1]);m.default.translate(c,0,a[1]);m.default.scale(c,1,-1);a=m.default.invert(this.projectionMatrix.slice());var d=m.default.create();m.default.translate(d,0,b[1]);m.default.scale(d,1,-1);
m.default.scale(d,b[0]/2,b[1]/2);m.default.translate(d,1,1);m.default.multiply(d,a);m.default.multiply(d,c);return d};k.default=t},{"../../dom.js":46,"../../extent.js":54,"../../functions.js":60,"../../index.js":89,"../../layertype.js":113,"../../transform.js":243,"../../viewhint.js":246,"../../webgl.js":248,"../../webgl/context.js":250,"../type.js":192,"../webgl/layer.js":197}],197:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});
e=a("../../index.js");e=d(e);var c=a("../../render/event.js"),b=d(c);c=a("../../render/eventtype.js");var h=d(c);c=a("../../render/webgl/immediate.js");var n=d(c);c=a("../layer.js");var g=d(c);c=a("../webgl/defaultmapshader.js");var f=d(c);c=a("../webgl/defaultmapshader/locations.js");var l=d(c);c=a("../../transform.js");var q=d(c);c=a("../../vec/mat4.js");var m=d(c);c=a("../../webgl.js");var p=d(c);c=a("../../webgl/buffer.js");var r=d(c);a=a("../../webgl/context.js");var t=d(a);a=function(a,b){g.default.call(this,
b);this.mapRenderer=a;this.arrayBuffer_=new r.default([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);this.framebuffer=this.texture=null;this.framebufferDimension=void 0;this.texCoordMatrix=q.default.create();this.projectionMatrix=q.default.create();this.tmpMat4_=m.default.create();this.defaultLocations_=null};e.default.inherits(a,g.default);a.prototype.bindFramebuffer=function(a,b){var c=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=b){var d=function(a,b,c){a.isContextLost()||
(a.deleteFramebuffer(b),a.deleteTexture(c))}.bind(null,c,this.framebuffer,this.texture);a.postRenderFunctions.push(d);a=t.default.createEmptyTexture(c,b,b);d=c.createFramebuffer();c.bindFramebuffer(p.default.FRAMEBUFFER,d);c.framebufferTexture2D(p.default.FRAMEBUFFER,p.default.COLOR_ATTACHMENT0,p.default.TEXTURE_2D,a,0);this.texture=a;this.framebuffer=d;this.framebufferDimension=b}else c.bindFramebuffer(p.default.FRAMEBUFFER,this.framebuffer)};a.prototype.composeFrame=function(a,b,c){this.dispatchComposeEvent_(h.default.PRECOMPOSE,
c,a);c.bindBuffer(p.default.ARRAY_BUFFER,this.arrayBuffer_);var d=c.getGL(),e=c.getProgram(f.default.fragment,f.default.vertex);if(this.defaultLocations_)var g=this.defaultLocations_;else this.defaultLocations_=g=new l.default(d,e);c.useProgram(e)&&(d.enableVertexAttribArray(g.a_position),d.vertexAttribPointer(g.a_position,2,p.default.FLOAT,!1,16,0),d.enableVertexAttribArray(g.a_texCoord),d.vertexAttribPointer(g.a_texCoord,2,p.default.FLOAT,!1,16,8),d.uniform1i(g.u_texture,0));d.uniformMatrix4fv(g.u_texCoordMatrix,
!1,m.default.fromTransform(this.tmpMat4_,this.getTexCoordMatrix()));d.uniformMatrix4fv(g.u_projectionMatrix,!1,m.default.fromTransform(this.tmpMat4_,this.getProjectionMatrix()));d.uniform1f(g.u_opacity,b.opacity);d.bindTexture(p.default.TEXTURE_2D,this.getTexture());d.drawArrays(p.default.TRIANGLE_STRIP,0,4);this.dispatchComposeEvent_(h.default.POSTCOMPOSE,c,a)};a.prototype.dispatchComposeEvent_=function(a,c,d){var e=this.getLayer();if(e.hasListener(a)){var f=d.viewState;f=new n.default(c,f.center,
f.resolution,f.rotation,d.size,d.extent,d.pixelRatio);a=new b.default(a,f,d,null,c);e.dispatchEvent(a)}};a.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix};a.prototype.getTexture=function(){return this.texture};a.prototype.getProjectionMatrix=function(){return this.projectionMatrix};a.prototype.handleWebGLContextLost=function(){this.framebuffer=this.texture=null;this.framebufferDimension=void 0};a.prototype.prepareFrame=function(a,b,c){};a.prototype.forEachLayerAtPixel=function(a,
b,c,d){};k.default=a},{"../../index.js":89,"../../render/event.js":159,"../../render/eventtype.js":160,"../../render/webgl/immediate.js":170,"../../transform.js":243,"../../vec/mat4.js":244,"../../webgl.js":248,"../../webgl/buffer.js":249,"../../webgl/context.js":250,"../layer.js":190,"../webgl/defaultmapshader.js":194,"../webgl/defaultmapshader/locations.js":195}],198:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");
var c=d(e);e=a("../../array.js");var b=d(e);e=a("../../css.js");var h=d(e);e=a("../../dom.js");var n=d(e);e=a("../../events.js");var g=d(e);e=a("../../has.js");var f=d(e);e=a("../../layer/layer.js");var l=d(e);e=a("../../render/event.js");var q=d(e);e=a("../../render/eventtype.js");var m=d(e);e=a("../../render/webgl/immediate.js");var p=d(e);e=a("../map.js");var r=d(e);e=a("../type.js");var t=d(e);e=a("../../source/state.js");var u=d(e);e=a("../../structs/lrucache.js");var y=d(e);e=a("../../structs/priorityqueue.js");
var w=d(e);e=a("../../webgl.js");var v=d(e);e=a("../../webgl/context.js");var A=d(e);a=a("../../webgl/contexteventtype.js");var B=d(a),x=function(a,b){r.default.call(this,a,b);this.canvas_=document.createElement("CANVAS");this.canvas_.style.width="100%";this.canvas_.style.height="100%";this.canvas_.style.display="block";this.canvas_.className=h.default.CLASS_UNSELECTABLE;a.insertBefore(this.canvas_,a.childNodes[0]||null);this.clipTileCanvasHeight_=this.clipTileCanvasWidth_=0;this.clipTileContext_=
n.default.createCanvasContext2D();this.renderedVisible_=!0;this.gl_=v.default.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0});this.context_=new A.default(this.canvas_,this.gl_);g.default.listen(this.canvas_,B.default.LOST,this.handleWebGLContextLost,this);g.default.listen(this.canvas_,B.default.RESTORED,this.handleWebGLContextRestored,this);this.textureCache_=new y.default;this.focus_=null;this.tileTextureQueue_=new w.default(function(a){var b=
a[1];a=a[2];var c=b[0]-this.focus_[0];b=b[1]-this.focus_[1];return 65536*Math.log(a)+Math.sqrt(c*c+b*b)/a}.bind(this),function(a){return a[0].getKey()});this.loadNextTileTexture_=function(a,b){this.tileTextureQueue_.isEmpty()||(this.tileTextureQueue_.reprioritize(),a=this.tileTextureQueue_.dequeue(),this.bindTileTexture(a[0],a[3],a[4],v.default.LINEAR,v.default.LINEAR));return!1}.bind(this);this.textureCacheFrameMarkerCount_=0;this.initializeGL_()};c.default.inherits(x,r.default);x.handles=function(a){return f.default.WEBGL&&
a===t.default.WEBGL};x.create=function(a,b){return new x(a,b)};x.prototype.bindTileTexture=function(a,b,c,d,e){var f=this.getGL(),g=a.getKey();if(this.textureCache_.containsKey(g))a=this.textureCache_.get(g),f.bindTexture(v.default.TEXTURE_2D,a.texture),a.magFilter!=d&&(f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_MAG_FILTER,d),a.magFilter=d),a.minFilter!=e&&(f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_MIN_FILTER,e),a.minFilter=e);else{var h=f.createTexture();f.bindTexture(v.default.TEXTURE_2D,
h);if(0<c){var l=this.clipTileContext_.canvas,k=this.clipTileContext_;this.clipTileCanvasWidth_!==b[0]||this.clipTileCanvasHeight_!==b[1]?(l.width=b[0],l.height=b[1],this.clipTileCanvasWidth_=b[0],this.clipTileCanvasHeight_=b[1]):k.clearRect(0,0,b[0],b[1]);k.drawImage(a.getImage(),c,c,b[0],b[1],0,0,b[0],b[1]);f.texImage2D(v.default.TEXTURE_2D,0,v.default.RGBA,v.default.RGBA,v.default.UNSIGNED_BYTE,l)}else f.texImage2D(v.default.TEXTURE_2D,0,v.default.RGBA,v.default.RGBA,v.default.UNSIGNED_BYTE,a.getImage());
f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_MAG_FILTER,d);f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_MIN_FILTER,e);f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_WRAP_S,v.default.CLAMP_TO_EDGE);f.texParameteri(v.default.TEXTURE_2D,v.default.TEXTURE_WRAP_T,v.default.CLAMP_TO_EDGE);this.textureCache_.set(g,{texture:h,magFilter:d,minFilter:e})}};x.prototype.dispatchComposeEvent_=function(a,b){var c=this.getMap();if(c.hasListener(a)){var d=this.context_,e=b.viewState;e=
new p.default(d,e.center,e.resolution,e.rotation,b.size,b.extent,b.pixelRatio);a=new q.default(a,e,b,null,d);c.dispatchEvent(a)}};x.prototype.disposeInternal=function(){var a=this.getGL();a.isContextLost()||this.textureCache_.forEach(function(b){b&&a.deleteTexture(b.texture)});this.context_.dispose();r.default.prototype.disposeInternal.call(this)};x.prototype.expireCache_=function(a,b){a=this.getGL();for(var d;this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>c.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){if(d=
this.textureCache_.peekLast())a.deleteTexture(d.texture);else if(+this.textureCache_.peekLastKey()==b.index)break;else--this.textureCacheFrameMarkerCount_;this.textureCache_.pop()}};x.prototype.getContext=function(){return this.context_};x.prototype.getGL=function(){return this.gl_};x.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_};x.prototype.getType=function(){return t.default.WEBGL};x.prototype.handleWebGLContextLost=function(a){a.preventDefault();this.textureCache_.clear();
this.textureCacheFrameMarkerCount_=0;a=this.getLayerRenderers();for(var b in a)a[b].handleWebGLContextLost()};x.prototype.handleWebGLContextRestored=function(){this.initializeGL_();this.getMap().render()};x.prototype.initializeGL_=function(){var a=this.gl_;a.activeTexture(v.default.TEXTURE0);a.blendFuncSeparate(v.default.SRC_ALPHA,v.default.ONE_MINUS_SRC_ALPHA,v.default.ONE,v.default.ONE_MINUS_SRC_ALPHA);a.disable(v.default.CULL_FACE);a.disable(v.default.DEPTH_TEST);a.disable(v.default.SCISSOR_TEST);
a.disable(v.default.STENCIL_TEST)};x.prototype.isTileTextureLoaded=function(a){return this.textureCache_.containsKey(a.getKey())};x.prototype.renderFrame=function(a){var d=this.getContext(),e=this.getGL();if(e.isContextLost())return!1;if(!a)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=a.focus;this.textureCache_.set((-a.index).toString(),null);++this.textureCacheFrameMarkerCount_;this.dispatchComposeEvent_(m.default.PRECOMPOSE,a);var f=[],
g=a.layerStatesArray;b.default.stableSort(g,r.default.sortByZIndex);var h=a.viewState.resolution,k;var p=0;for(k=g.length;p<k;++p){var n=g[p];if(l.default.visibleAtResolution(n,h)&&n.sourceState==u.default.READY){var t=this.getLayerRenderer(n.layer);t.prepareFrame(a,n,d)&&f.push(n)}}g=a.size[0]*a.pixelRatio;h=a.size[1]*a.pixelRatio;if(this.canvas_.width!=g||this.canvas_.height!=h)this.canvas_.width=g,this.canvas_.height=h;e.bindFramebuffer(v.default.FRAMEBUFFER,null);e.clearColor(0,0,0,0);e.clear(v.default.COLOR_BUFFER_BIT);
e.enable(v.default.BLEND);e.viewport(0,0,this.canvas_.width,this.canvas_.height);p=0;for(k=f.length;p<k;++p)n=f[p],t=this.getLayerRenderer(n.layer),t.composeFrame(a,n,d);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0);this.calculateMatrices2D(a);this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>c.default.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&a.postRenderFunctions.push(this.expireCache_.bind(this));this.tileTextureQueue_.isEmpty()||(a.postRenderFunctions.push(this.loadNextTileTexture_),
a.animate=!0);this.dispatchComposeEvent_(m.default.POSTCOMPOSE,a);this.scheduleRemoveUnusedLayerRenderers(a);this.scheduleExpireIconCache(a)};x.prototype.forEachFeatureAtCoordinate=function(a,b,c,d,e,f,g){if(this.getGL().isContextLost())return!1;var h=b.viewState,k=b.layerStatesArray,m;for(m=k.length-1;0<=m;--m){var p=k[m];var n=p.layer;if(l.default.visibleAtResolution(p,h.resolution)&&f.call(g,n)&&(p=this.getLayerRenderer(n).forEachFeatureAtCoordinate(a,b,c,d,e)))return p}};x.prototype.hasFeatureAtCoordinate=
function(a,b,c,d,e){c=!1;if(this.getGL().isContextLost())return!1;var f=b.viewState,g=b.layerStatesArray,h;for(h=g.length-1;0<=h;--h){var k=g[h],m=k.layer;if(l.default.visibleAtResolution(k,f.resolution)&&d.call(e,m)&&(c=this.getLayerRenderer(m).hasFeatureAtCoordinate(a,b)))return!0}return c};x.prototype.forEachLayerAtPixel=function(a,b,c,d,e,f){if(this.getGL().isContextLost())return!1;f=b.viewState;var g=b.layerStatesArray,h;for(h=g.length-1;0<=h;--h){var k=g[h];var m=k.layer;if(l.default.visibleAtResolution(k,
f.resolution)&&e.call(d,m)&&(k=this.getLayerRenderer(m).forEachLayerAtPixel(a,b,c,d)))return k}};k.default=x},{"../../array.js":29,"../../css.js":44,"../../dom.js":46,"../../events.js":48,"../../has.js":84,"../../index.js":89,"../../layer/layer.js":108,"../../render/event.js":159,"../../render/eventtype.js":160,"../../render/webgl/immediate.js":170,"../../source/state.js":212,"../../structs/lrucache.js":218,"../../structs/priorityqueue.js":219,"../../webgl.js":248,"../../webgl/context.js":250,"../../webgl/contexteventtype.js":251,
"../map.js":191,"../type.js":192}],199:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../layertype.js"),b=d(c);c=a("../../tilerange.js");var h=d(c);c=a("../../tilestate.js");var n=d(c);c=a("../../array.js");var g=d(c);c=a("../../extent.js");var f=d(c);c=a("../../math.js");var l=d(c);c=a("../type.js");var q=d(c);c=a("../webgl/layer.js");var m=d(c);c=a("../webgl/tilelayershader.js");var p=
d(c);c=a("../webgl/tilelayershader/locations.js");var r=d(c);c=a("../../size.js");var t=d(c);c=a("../../transform.js");var u=d(c);c=a("../../webgl.js");var y=d(c);a=a("../../webgl/buffer.js");var w=d(a),v=function(a,b){m.default.call(this,a,b);this.fragmentShader_=p.default.fragment;this.vertexShader_=p.default.vertex;this.locations_=null;this.renderArrayBuffer_=new w.default([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]);this.renderedFramebufferExtent_=this.renderedTileRange_=null;this.renderedRevision_=-1;
this.tmpSize_=[0,0]};e.default.inherits(v,m.default);v.handles=function(a,c){return a===q.default.WEBGL&&c.getType()===b.default.TILE};v.create=function(a,b){return new v(a,b)};v.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_);m.default.prototype.disposeInternal.call(this)};v.prototype.createLoadedTileFinder=function(a,b,c){var d=this.mapRenderer;return function(e,f){return a.forEachLoadedTile(b,e,f,function(a){var b=d.isTileTextureLoaded(a);
b&&(c[e]||(c[e]={}),c[e][a.tileCoord.toString()]=a);return b})}};v.prototype.handleWebGLContextLost=function(){m.default.prototype.handleWebGLContextLost.call(this);this.locations_=null};v.prototype.prepareFrame=function(a,b,c){var d=this.mapRenderer,e=c.getGL(),k=a.viewState,m=k.projection,p=this.getLayer(),q=p.getSource(),w=q.getTileGridForProjection(m),v=w.getZForResolution(k.resolution),A=w.getResolution(v),x=q.getTilePixelSize(v,a.pixelRatio,m),B=x[0]/t.default.toSize(w.getTileSize(v),this.tmpSize_)[0],
Q=A/B,da=q.getTilePixelRatio(B)*q.getGutter(m),aa=k.center,F=a.extent,N=w.getTileRangeForExtentAndZ(F,v);if(this.renderedTileRange_&&this.renderedTileRange_.equals(N)&&this.renderedRevision_==q.getRevision())Q=this.renderedFramebufferExtent_;else{var O=N.getSize(),K=l.default.roundUpToPowerOfTwo(Math.max(O[0]*x[0],O[1]*x[1]));O=Q*K;var U=w.getOrigin(v),Z=U[0]+N.minX*x[0]*Q;Q=U[1]+N.minY*x[1]*Q;Q=[Z,Q,Z+O,Q+O];this.bindFramebuffer(a,K);e.viewport(0,0,K,K);e.clearColor(0,0,0,0);e.clear(y.default.COLOR_BUFFER_BIT);
e.disable(y.default.BLEND);K=c.getProgram(this.fragmentShader_,this.vertexShader_);c.useProgram(K);this.locations_||(this.locations_=new r.default(e,K));c.bindBuffer(y.default.ARRAY_BUFFER,this.renderArrayBuffer_);e.enableVertexAttribArray(this.locations_.a_position);e.vertexAttribPointer(this.locations_.a_position,2,y.default.FLOAT,!1,16,0);e.enableVertexAttribArray(this.locations_.a_texCoord);e.vertexAttribPointer(this.locations_.a_texCoord,2,y.default.FLOAT,!1,16,8);e.uniform1i(this.locations_.u_texture,
0);c={};c[v]={};var ba=this.createLoadedTileFinder(q,m,c),X=p.getUseInterimTilesOnError();K=!0;Z=f.default.createEmpty();var V=new h.default(0,0,0,0),Y,L;for(Y=N.minX;Y<=N.maxX;++Y)for(L=N.minY;L<=N.maxY;++L){U=q.getTile(v,Y,L,B,m);if(void 0!==b.extent){var P=w.getTileCoordExtent(U.tileCoord,Z);if(!f.default.intersects(P,b.extent))continue}P=U.getState();(P=P==n.default.LOADED||P==n.default.EMPTY||P==n.default.ERROR&&!X)||(U=U.getInterimTile());P=U.getState();if(P==n.default.LOADED){if(d.isTileTextureLoaded(U)){c[v][U.tileCoord.toString()]=
U;continue}}else if(P==n.default.EMPTY||P==n.default.ERROR&&!X)continue;K=!1;P=w.forEachTileCoordParentTileRange(U.tileCoord,ba,null,V,Z);P||(U=w.getTileCoordChildTileRange(U.tileCoord,V,Z))&&ba(v+1,U)}b=Object.keys(c).map(Number);b.sort(g.default.numberSafeCompareFunction);ba=new Float32Array(4);var ea;X=0;for(V=b.length;X<V;++X)for(ea in Y=c[b[X]],Y)U=Y[ea],P=w.getTileCoordExtent(U.tileCoord,Z),ba[0]=2*(P[2]-P[0])/O,ba[1]=2*(P[3]-P[1])/O,ba[2]=2*(P[0]-Q[0])/O-1,ba[3]=2*(P[1]-Q[1])/O-1,e.uniform4fv(this.locations_.u_tileOffset,
ba),d.bindTileTexture(U,x,da*B,y.default.LINEAR,y.default.LINEAR),e.drawArrays(y.default.TRIANGLE_STRIP,0,4);K?(this.renderedTileRange_=N,this.renderedFramebufferExtent_=Q,this.renderedRevision_=q.getRevision()):(this.renderedFramebufferExtent_=this.renderedTileRange_=null,this.renderedRevision_=-1,a.animate=!0)}this.updateUsedTiles(a.usedTiles,q,v,N);var W=d.getTileTextureQueue();this.manageTilePyramid(a,q,w,B,m,F,v,p.getPreload(),function(a){a.getState()!=n.default.LOADED||d.isTileTextureLoaded(a)||
W.isKeyQueued(a.getKey())||W.enqueue([a,w.getTileCoordCenter(a.tileCoord),w.getResolution(a.tileCoord[0]),x,da*B])},this);this.scheduleExpireCache(a,q);this.updateLogos(a,q);e=this.texCoordMatrix;u.default.reset(e);u.default.translate(e,(Math.round(aa[0]/A)*A-Q[0])/(Q[2]-Q[0]),(Math.round(aa[1]/A)*A-Q[1])/(Q[3]-Q[1]));0!==k.rotation&&u.default.rotate(e,k.rotation);u.default.scale(e,a.size[0]*k.resolution/(Q[2]-Q[0]),a.size[1]*k.resolution/(Q[3]-Q[1]));u.default.translate(e,-.5,-.5);return!0};v.prototype.forEachLayerAtPixel=
function(a,b,c,d){if(this.framebuffer){a=u.default.apply(this.texCoordMatrix,[a[0]/b.size[0],(b.size[1]-a[1])/b.size[1]].slice());a=[a[0]*this.framebufferDimension,a[1]*this.framebufferDimension];b=this.mapRenderer.getContext().getGL();b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffer);var e=new Uint8Array(4);b.readPixels(a[0],a[1],1,1,b.RGBA,b.UNSIGNED_BYTE,e);if(0<e[3])return c.call(d,this.getLayer(),e)}};k.default=v},{"../../array.js":29,"../../extent.js":54,"../../index.js":89,"../../layertype.js":113,
"../../math.js":123,"../../size.js":208,"../../tilerange.js":241,"../../tilestate.js":242,"../../transform.js":243,"../../webgl.js":248,"../../webgl/buffer.js":249,"../type.js":192,"../webgl/layer.js":197,"../webgl/tilelayershader.js":200,"../webgl/tilelayershader/locations.js":201}],200:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");e=d(e);var c=a("../../webgl/fragment.js");c=d(c);a=a("../../webgl/vertex.js");
a=d(a);var b={};b.fragment=new c.default(e.default.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}");b.vertex=new a.default(e.default.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":
"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");k.default=b},{"../../index.js":89,"../../webgl/fragment.js":252,"../../webgl/vertex.js":254}],201:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../../../index.js"))&&a.__esModule?a:{default:a};k.default=function(a,b){this.u_tileOffset=a.getUniformLocation(b,d.default.DEBUG_WEBGL?"u_tileOffset":"d");this.u_texture=a.getUniformLocation(b,d.default.DEBUG_WEBGL?
"u_texture":"e");this.a_position=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_position":"b");this.a_texCoord=a.getAttribLocation(b,d.default.DEBUG_WEBGL?"a_texCoord":"c")}},{"../../../index.js":89}],202:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../../index.js");var c=d(e);e=a("../../layertype.js");var b=d(e);e=a("../../viewhint.js");var h=d(e);e=a("../../extent.js");var n=d(e);e=a("../../render/webgl/replaygroup.js");
var g=d(e);e=a("../type.js");var f=d(e);e=a("../vector.js");var l=d(e);e=a("../webgl/layer.js");var q=d(e);a=a("../../transform.js");var m=d(a),p=function(a,b){q.default.call(this,a,b);this.dirty_=!1;this.renderedRevision_=-1;this.renderedResolution_=NaN;this.renderedExtent_=n.default.createEmpty();this.layerState_=this.replayGroup_=this.renderedRenderOrder_=null};c.default.inherits(p,q.default);p.handles=function(a,c){return a===f.default.WEBGL&&c.getType()===b.default.VECTOR};p.create=function(a,
b){return new p(a,b)};p.prototype.composeFrame=function(a,b,c){this.layerState_=b;var d=a.viewState,e=this.replayGroup_,f=a.size,g=a.pixelRatio,h=this.mapRenderer.getGL();e&&!e.isEmpty()&&(h.enable(h.SCISSOR_TEST),h.scissor(0,0,f[0]*g,f[1]*g),e.replay(c,d.center,d.resolution,d.rotation,f,g,b.opacity,b.managed?a.skippedFeatureUids:{}),h.disable(h.SCISSOR_TEST))};p.prototype.disposeInternal=function(){var a=this.replayGroup_;if(a){var b=this.mapRenderer.getContext();a.getDeleteResourcesFunction(b)();
this.replayGroup_=null}q.default.prototype.disposeInternal.call(this)};p.prototype.forEachFeatureAtCoordinate=function(a,b,d,e,f){if(this.replayGroup_&&this.layerState_){d=this.mapRenderer.getContext();var g=b.viewState,h=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(a,d,g.center,g.resolution,g.rotation,b.size,b.pixelRatio,this.layerState_.opacity,{},function(a){var b=c.default.getUid(a).toString();if(!(b in l))return l[b]=!0,e.call(f,a,h)})}};p.prototype.hasFeatureAtCoordinate=
function(a,b){if(this.replayGroup_&&this.layerState_){var c=this.mapRenderer.getContext(),d=b.viewState;return this.replayGroup_.hasFeatureAtCoordinate(a,c,d.center,d.resolution,d.rotation,b.size,b.pixelRatio,this.layerState_.opacity,b.skippedFeatureUids)}return!1};p.prototype.forEachLayerAtPixel=function(a,b,c,d){a=m.default.apply(b.pixelToCoordinateTransform,a.slice());if(this.hasFeatureAtCoordinate(a,b))return c.call(d,this.getLayer(),null)};p.prototype.handleStyleImageChange_=function(a){this.renderIfReadyAndVisible()};
p.prototype.prepareFrame=function(a,b,c){var d=this.getLayer();b=d.getSource();this.updateLogos(a,b);var e=a.viewHints[h.default.ANIMATING],f=a.viewHints[h.default.INTERACTING],k=d.getUpdateWhileAnimating(),m=d.getUpdateWhileInteracting();if(!this.dirty_&&!k&&e||!m&&f)return!0;m=a.extent;f=a.viewState;e=f.projection;var p=f.resolution,q=a.pixelRatio;f=d.getRevision();var r=d.getRenderBuffer();k=d.getRenderOrder();void 0===k&&(k=l.default.defaultOrder);m=n.default.buffer(m,r*p);if(!this.dirty_&&this.renderedResolution_==
p&&this.renderedRevision_==f&&this.renderedRenderOrder_==k&&n.default.containsExtent(this.renderedExtent_,m))return!0;this.replayGroup_&&a.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(c));this.dirty_=!1;var t=new g.default(l.default.getTolerance(p,q),m,d.getRenderBuffer());b.loadFeatures(m,p,e);a=function(a){var b=a.getStyleFunction();if(b)var c=b.call(a,p);else(b=d.getStyleFunction())&&(c=b(a,p));c&&(a=this.renderFeature(a,p,q,c,t),this.dirty_=this.dirty_||a)};if(k){var u=
[];b.forEachFeatureInExtent(m,function(a){u.push(a)},this);u.sort(k);u.forEach(a,this)}else b.forEachFeatureInExtent(m,a,this);t.finish(c);this.renderedResolution_=p;this.renderedRevision_=f;this.renderedRenderOrder_=k;this.renderedExtent_=m;this.replayGroup_=t;return!0};p.prototype.renderFeature=function(a,b,c,d,e){if(!d)return!1;var f=!1;if(Array.isArray(d))for(var g=d.length-1;0<=g;--g)f=l.default.renderFeature(e,a,d[g],l.default.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;else f=
l.default.renderFeature(e,a,d,l.default.getSquaredTolerance(b,c),this.handleStyleImageChange_,this)||f;return f};k.default=p},{"../../extent.js":54,"../../index.js":89,"../../layertype.js":113,"../../render/webgl/replaygroup.js":178,"../../transform.js":243,"../../viewhint.js":246,"../type.js":192,"../vector.js":193,"../webgl/layer.js":197}],203:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./dom.js");var c=d(e);e=a("./extent.js");
var b=d(e);e=a("./math.js");var h=d(e);a=a("./proj.js");var n=d(a),g={calculateSourceResolution:function(a,c,d,e){var f=n.default.transform(d,c,a);d=n.default.getPointResolution(c,e,d);c=c.getMetersPerUnit();void 0!==c&&(d*=c);c=a.getMetersPerUnit();void 0!==c&&(d/=c);c=a.getExtent();if(!c||b.default.containsCoordinate(c,f))a=n.default.getPointResolution(a,d,f)/d,isFinite(a)&&0<a&&(d/=a);return d},enlargeClipPoint_:function(a,b,c,d){a=c-a;b=d-b;var e=Math.sqrt(a*a+b*b);return[Math.round(c+a/e),Math.round(d+
b/e)]},render:function(a,d,e,k,p,n,t,u,y,w,v){var f=c.default.createCanvasContext2D(Math.round(e*a),Math.round(e*d));if(0===y.length)return f.canvas;f.scale(e,e);var l=b.default.createEmpty();y.forEach(function(a,c,d){b.default.extend(l,a.extent)});a=b.default.getWidth(l);d=b.default.getHeight(l);var m=c.default.createCanvasContext2D(Math.round(e*a/k),Math.round(e*d/k)),r=e/k;y.forEach(function(a,c,d){c=a.extent[0]-l[0];d=-(a.extent[3]-l[3]);var e=b.default.getWidth(a.extent),f=b.default.getHeight(a.extent);
m.drawImage(a.image,w,w,a.image.width-2*w,a.image.height-2*w,c*r,d*r,e*r,f*r)});var q=b.default.getTopLeft(t);u.getTriangles().forEach(function(a,b,c){var d=a.source,p=a.target,r=d[1][0],t=d[1][1],u=d[2][0],y=d[2][1];a=(p[0][0]-q[0])/n;b=-(p[0][1]-q[1])/n;var w=(p[1][0]-q[0])/n,C=-(p[1][1]-q[1])/n;c=(p[2][0]-q[0])/n;var v=-(p[2][1]-q[1])/n;p=d[0][0];d=d[0][1];r-=p;t-=d;u-=p;y-=d;if(r=h.default.solveLinearSystem([[r,t,0,0,w-a],[u,y,0,0,c-a],[0,0,r,t,C-b],[0,0,u,y,v-b]]))f.save(),f.beginPath(),u=(a+
w+c)/3,y=(b+C+v)/3,t=g.enlargeClipPoint_(u,y,a,b),w=g.enlargeClipPoint_(u,y,w,C),c=g.enlargeClipPoint_(u,y,c,v),f.moveTo(w[0],w[1]),f.lineTo(t[0],t[1]),f.lineTo(c[0],c[1]),f.clip(),f.transform(r[0],r[2],r[1],r[3],a,b),f.translate(l[0]-p,l[3]-d),f.scale(k/e,-k/e),f.drawImage(m.canvas,0,0),f.restore()});v&&(f.save(),f.strokeStyle="black",f.lineWidth=1,u.getTriangles().forEach(function(a,b,c){var d=a.target;a=(d[0][0]-q[0])/n;b=-(d[0][1]-q[1])/n;c=(d[1][0]-q[0])/n;var e=-(d[1][1]-q[1])/n,g=(d[2][0]-
q[0])/n;d=-(d[2][1]-q[1])/n;f.beginPath();f.moveTo(c,e);f.lineTo(a,b);f.lineTo(g,d);f.closePath();f.stroke()}),f.restore());return f.canvas}};k.default=g},{"./dom.js":46,"./extent.js":54,"./math.js":123,"./proj.js":141}],204:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../imagebase.js");var b=d(e);e=a("../imagestate.js");var h=d(e);e=a("../events.js");var n=d(e);e=a("../events/eventtype.js");
var g=d(e);e=a("../extent.js");var f=d(e);e=a("../reproj.js");var l=d(e);a=a("../reproj/triangulation.js");var q=d(a);a=function(a,d,e,g,k,n){this.targetProj_=d;this.maxSourceExtent_=a.getExtent();var m=d.getExtent();m=m?f.default.getIntersection(e,m):e;var p=f.default.getCenter(m);p=l.default.calculateSourceResolution(a,d,p,g);this.triangulation_=new q.default(a,d,m,this.maxSourceExtent_,p*c.default.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD);this.targetResolution_=g;this.targetExtent_=e;a=this.triangulation_.calculateSourceExtent();
this.sourcePixelRatio_=(this.sourceImage_=n(a,p,k))?this.sourceImage_.getPixelRatio():1;this.sourceListenerKey_=this.canvas_=null;k=h.default.LOADED;this.sourceImage_&&(k=h.default.IDLE);b.default.call(this,e,g,this.sourcePixelRatio_,k)};c.default.inherits(a,b.default);a.prototype.disposeInternal=function(){this.state==h.default.LOADING&&this.unlistenSource_();b.default.prototype.disposeInternal.call(this)};a.prototype.getImage=function(){return this.canvas_};a.prototype.getProjection=function(){return this.targetProj_};
a.prototype.reproject_=function(){var a=this.sourceImage_.getState();if(a==h.default.LOADED){var b=f.default.getWidth(this.targetExtent_)/this.targetResolution_,c=f.default.getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=l.default.render(b,c,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=a;this.changed()};
a.prototype.load=function(){if(this.state==h.default.IDLE){this.state=h.default.LOADING;this.changed();var a=this.sourceImage_.getState();a==h.default.LOADED||a==h.default.ERROR?this.reproject_():(this.sourceListenerKey_=n.default.listen(this.sourceImage_,g.default.CHANGE,function(a){a=this.sourceImage_.getState();if(a==h.default.LOADED||a==h.default.ERROR)this.unlistenSource_(),this.reproject_()},this),this.sourceImage_.load())}};a.prototype.unlistenSource_=function(){n.default.unlistenByKey(this.sourceListenerKey_);
this.sourceListenerKey_=null};k.default=a},{"../events.js":48,"../events/eventtype.js":52,"../extent.js":54,"../imagebase.js":86,"../imagestate.js":88,"../index.js":89,"../reproj.js":203,"../reproj/triangulation.js":205}],205:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../extent.js");var b=d(e);e=a("../math.js");var h=d(e);a=a("../proj.js");var n=d(a);a=function(a,d,e,h,k){this.sourceProj_=
a;this.targetProj_=d;var f={},g=n.default.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(a){var b=a[0]+"/"+a[1];f[b]||(f[b]=g(a));return f[b]};this.maxSourceExtent_=h;this.errorThresholdSquared_=k*k;this.triangles_=[];this.wrapsXInSource_=!1;this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!h&&!!this.sourceProj_.getExtent()&&b.default.getWidth(h)==b.default.getWidth(this.sourceProj_.getExtent());this.sourceWorldWidth_=this.sourceProj_.getExtent()?b.default.getWidth(this.sourceProj_.getExtent()):
null;this.targetWorldWidth_=this.targetProj_.getExtent()?b.default.getWidth(this.targetProj_.getExtent()):null;a=b.default.getTopLeft(e);d=b.default.getTopRight(e);h=b.default.getBottomRight(e);e=b.default.getBottomLeft(e);k=this.transformInv_(a);var l=this.transformInv_(d),m=this.transformInv_(h),q=this.transformInv_(e);this.addQuad_(a,d,h,e,k,l,m,q,c.default.RASTER_REPROJECTION_MAX_SUBDIVISION);if(this.wrapsXInSource_){var w=Infinity;this.triangles_.forEach(function(a,b,c){w=Math.min(w,a.source[0][0],
a.source[1][0],a.source[2][0])});this.triangles_.forEach(function(a){if(Math.max(a.source[0][0],a.source[1][0],a.source[2][0])-w>this.sourceWorldWidth_/2){var b=[[a.source[0][0],a.source[0][1]],[a.source[1][0],a.source[1][1]],[a.source[2][0],a.source[2][1]]];b[0][0]-w>this.sourceWorldWidth_/2&&(b[0][0]-=this.sourceWorldWidth_);b[1][0]-w>this.sourceWorldWidth_/2&&(b[1][0]-=this.sourceWorldWidth_);b[2][0]-w>this.sourceWorldWidth_/2&&(b[2][0]-=this.sourceWorldWidth_);Math.max(b[0][0],b[1][0],b[2][0])-
Math.min(b[0][0],b[1][0],b[2][0])<this.sourceWorldWidth_/2&&(a.source=b)}},this)}f={}};a.prototype.addTriangle_=function(a,b,c,d,e,h){this.triangles_.push({source:[d,e,h],target:[a,b,c]})};a.prototype.addQuad_=function(a,d,e,k,m,p,n,t,u){var f=b.default.boundingExtent([m,p,n,t]),g=this.sourceWorldWidth_?b.default.getWidth(f)/this.sourceWorldWidth_:null,l=this.sourceWorldWidth_,r=this.sourceProj_.canWrapX()&&.5<g&&1>g,q=!1;if(0<u){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var x=b.default.boundingExtent([a,
d,e,k]);x=b.default.getWidth(x)/this.targetWorldWidth_;q|=x>c.default.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH}!r&&this.sourceProj_.isGlobal()&&g&&(q|=g>c.default.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH)}if(q||!this.maxSourceExtent_||b.default.intersects(f,this.maxSourceExtent_)){if(!(q||isFinite(m[0])&&isFinite(m[1])&&isFinite(p[0])&&isFinite(p[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(t[0])&&isFinite(t[1])))if(0<u)q=!0;else return;if(0<u&&(q||(f=this.transformInv_([(a[0]+e[0])/2,(a[1]+e[1])/2]),
l=r?(h.default.modulo(m[0],l)+h.default.modulo(n[0],l))/2-h.default.modulo(f[0],l):(m[0]+n[0])/2-f[0],f=(m[1]+n[1])/2-f[1],q=l*l+f*f>this.errorThresholdSquared_),q)){Math.abs(a[0]-e[0])<=Math.abs(a[1]-e[1])?(r=[(d[0]+e[0])/2,(d[1]+e[1])/2],l=this.transformInv_(r),f=[(k[0]+a[0])/2,(k[1]+a[1])/2],g=this.transformInv_(f),this.addQuad_(a,d,r,f,m,p,l,g,u-1),this.addQuad_(f,r,e,k,g,l,n,t,u-1)):(r=[(a[0]+d[0])/2,(a[1]+d[1])/2],l=this.transformInv_(r),f=[(e[0]+k[0])/2,(e[1]+k[1])/2],g=this.transformInv_(f),
this.addQuad_(a,r,f,k,m,l,g,t,u-1),this.addQuad_(r,d,e,f,l,p,n,g,u-1));return}if(r){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(a,e,k,m,n,t);this.addTriangle_(a,d,e,m,p,n)}};a.prototype.calculateSourceExtent=function(){var a=b.default.createEmpty();this.triangles_.forEach(function(c,d,e){c=c.source;b.default.extendCoordinate(a,c[0]);b.default.extendCoordinate(a,c[1]);b.default.extendCoordinate(a,c[2])});return a};a.prototype.getTriangles=function(){return this.triangles_};
k.default=a},{"../extent.js":54,"../index.js":89,"../math.js":123,"../proj.js":141}],206:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("./array.js"))&&e.__esModule?e:{default:e},c=(a=a("./math.js"))&&a.__esModule?a:{default:a};k.default={createSnapToResolutions:function(a){return function(b,e,g){if(void 0!==b)return b=d.default.linearFindNearest(a,b,g),b=c.default.clamp(b+e,0,a.length-1),e=Math.floor(b),b!=e&&e<a.length-1?a[e]/Math.pow(a[e]/a[e+1],b-e):a[e]}},createSnapToPower:function(a,
c,d){return function(b,e,h){if(void 0!==b)return b=Math.max(Math.floor(Math.log(c/b)/Math.log(a)+(-h/2+.5))+e,0),void 0!==d&&(b=Math.min(b,d)),c/Math.pow(a,b)}}}},{"./array.js":29,"./math.js":123}],207:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./math.js"))&&a.__esModule?a:{default:a};k.default={disable:function(a,b){if(void 0!==a)return 0},none:function(a,b){if(void 0!==a)return a+b},createSnapToN:function(a){var b=2*Math.PI/a;return function(a,c){if(void 0!==a)return a=
Math.floor((a+c)/b+.5)*b}},createSnapToZero:function(a){var b=a||d.default.toRadians(5);return function(a,c){if(void 0!==a)return Math.abs(a+c)<=b?0:a+c}}}},{"./math.js":123}],208:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={buffer:function(a,c,b){void 0===b&&(b=[0,0]);b[0]=a[0]+2*c;b[1]=a[1]+2*c;return b},hasArea:function(a){return 0<a[0]&&0<a[1]},scale:function(a,c,b){void 0===b&&(b=[0,0]);b[0]=a[0]*c+.5|0;b[1]=a[1]*c+.5|0;return b},toSize:function(a,c){if(Array.isArray(a))return a;
void 0===c?c=[a,a]:c[0]=c[1]=a;return c}}},{}],209:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../imagestate.js");var b=d(e);e=a("../array.js");var h=d(e);e=a("../events/event.js");var n=d(e);e=a("../extent.js");var g=d(e);e=a("../proj.js");var f=d(e);e=a("../reproj/image.js");var l=d(e);a=a("../source/source.js");var q=d(a),m=function(a){q.default.call(this,{attributions:a.attributions,extent:a.extent,
logo:a.logo,projection:a.projection,state:a.state});this.resolutions_=void 0!==a.resolutions?a.resolutions:null;this.reprojectedImage_=null;this.reprojectedRevision_=0};c.default.inherits(m,q.default);m.prototype.getResolutions=function(){return this.resolutions_};m.prototype.findNearestResolution=function(a){this.resolutions_&&(a=h.default.linearFindNearest(this.resolutions_,a,0),a=this.resolutions_[a]);return a};m.prototype.getImage=function(a,b,d,e){var h=this.getProjection();if(c.default.ENABLE_RASTER_REPROJECTION&&
h&&e&&!f.default.equivalent(h,e)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&f.default.equivalent(this.reprojectedImage_.getProjection(),e)&&this.reprojectedImage_.getResolution()==b&&g.default.equals(this.reprojectedImage_.getExtent(),a))return this.reprojectedImage_;this.reprojectedImage_.dispose();this.reprojectedImage_=null}this.reprojectedImage_=new l.default(h,e,a,b,d,function(a,b,c){return this.getImageInternal(a,b,c,h)}.bind(this));this.reprojectedRevision_=
this.getRevision();return this.reprojectedImage_}h&&(e=h);return this.getImageInternal(a,b,d,e)};m.prototype.getImageInternal=function(a,b,c,d){};m.prototype.handleImageChange=function(a){a=a.target;switch(a.getState()){case b.default.LOADING:this.dispatchEvent(new m.Event(m.EventType_.IMAGELOADSTART,a));break;case b.default.LOADED:this.dispatchEvent(new m.Event(m.EventType_.IMAGELOADEND,a));break;case b.default.ERROR:this.dispatchEvent(new m.Event(m.EventType_.IMAGELOADERROR,a))}};m.defaultImageLoadFunction=
function(a,b){a.getImage().src=b};m.Event=function(a,b){n.default.call(this,a);this.image=b};c.default.inherits(m.Event,n.default);m.EventType_={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};k.default=m},{"../array.js":29,"../events/event.js":50,"../extent.js":54,"../imagestate.js":88,"../index.js":89,"../proj.js":141,"../reproj/image.js":204,"../source/source.js":211}],210:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,
"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../image.js"),b=d(c);c=a("../imagestate.js");var h=d(c);c=a("../dom.js");var n=d(c);c=a("../events.js");var g=d(c);c=a("../events/eventtype.js");var f=d(c);c=a("../extent.js");var l=d(c);c=a("../proj.js");var q=d(c);a=a("../source/image.js");var m=d(a);a=function(a){var c=a.imageExtent,d=void 0!==a.crossOrigin?a.crossOrigin:null,e=void 0!==a.imageLoadFunction?a.imageLoadFunction:m.default.defaultImageLoadFunction;m.default.call(this,{attributions:a.attributions,
logo:a.logo,projection:q.default.get(a.projection)});this.image_=new b.default(c,void 0,1,a.url,d,e);this.imageSize_=a.imageSize?a.imageSize:null;g.default.listen(this.image_,f.default.CHANGE,this.handleImageChange,this)};e.default.inherits(a,m.default);a.prototype.getImageInternal=function(a,b,c,d){return l.default.intersects(a,this.image_.getExtent())?this.image_:null};a.prototype.handleImageChange=function(a){if(this.image_.getState()==h.default.LOADED){var b=this.image_.getExtent(),c=this.image_.getImage();
if(this.imageSize_){var d=this.imageSize_[0];var e=this.imageSize_[1]}else d=c.width,e=c.height;var f=l.default.getHeight(b)/e;b=Math.ceil(l.default.getWidth(b)/f);b!=d&&(b=n.default.createCanvasContext2D(b,e),f=b.canvas,b.drawImage(c,0,0,d,e,0,0,f.width,f.height),this.image_.setImage(f))}m.default.prototype.handleImageChange.call(this,a)};k.default=a},{"../dom.js":46,"../events.js":48,"../events/eventtype.js":52,"../extent.js":54,"../image.js":85,"../imagestate.js":88,"../index.js":89,"../proj.js":141,
"../source/image.js":209}],211:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../attribution.js"),b=d(c);c=a("../object.js");var h=d(c);c=a("../proj.js");var n=d(c);a=a("../source/state.js");var g=d(a);a=function(a){h.default.call(this);this.projection_=n.default.get(a.projection);this.attributions_=null;this.attributions2_=this.adaptAttributions_(a.attributions);this.logo_=a.logo;this.state_=
void 0!==a.state?a.state:g.default.READY;this.wrapX_=void 0!==a.wrapX?a.wrapX:!1};e.default.inherits(a,h.default);a.prototype.adaptAttributions_=function(a){if(!a)return null;if(a instanceof b.default)return this.attributions_=[a],function(b){return[a.getHTML()]};if(Array.isArray(a)){if(a[0]instanceof b.default){this.attributions_=a;var c=a.map(function(a){return a.getHTML()});return function(a){return c}}this.attributions_=a.map(function(a){return new b.default({html:a})});return function(b){return a}}if("function"===
typeof a)return a;this.attributions_=[new b.default({html:a})];return function(b){return[a]}};a.prototype.forEachFeatureAtCoordinate=e.default.nullFunction;a.prototype.getAttributions=function(){return this.attributions_};a.prototype.getAttributions2=function(){return this.attributions2_};a.prototype.getLogo=function(){return this.logo_};a.prototype.getProjection=function(){return this.projection_};a.prototype.getResolutions=function(){};a.prototype.getState=function(){return this.state_};a.prototype.getWrapX=
function(){return this.wrapX_};a.prototype.refresh=function(){this.changed()};a.prototype.setAttributions=function(a){this.attributions2_=this.adaptAttributions_(a);this.changed()};a.prototype.setLogo=function(a){this.logo_=a};a.prototype.setState=function(a){this.state_=a;this.changed()};k.default=a},{"../attribution.js":32,"../index.js":89,"../object.js":125,"../proj.js":141,"../source/state.js":212}],212:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={UNDEFINED:"undefined",
LOADING:"loading",READY:"ready",ERROR:"error"}},{}],213:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../collection.js");var b=d(e);e=a("../collectioneventtype.js");var h=d(e);e=a("../objecteventtype.js");var n=d(e);e=a("../array.js");var g=d(e);e=a("../asserts.js");var f=d(e);e=a("../events.js");var l=d(e);e=a("../events/event.js");var q=d(e);e=a("../events/eventtype.js");var m=d(e);e=a("../extent.js");
var p=d(e);e=a("../featureloader.js");var r=d(e);e=a("../functions.js");var t=d(e);e=a("../loadingstrategy.js");var u=d(e);e=a("../obj.js");var y=d(e);e=a("../source/source.js");var w=d(e);e=a("../source/state.js");var v=d(e);e=a("../source/vectoreventtype.js");var A=d(e);a=a("../structs/rbush.js");var B=d(a),x=function(a){a=a||{};w.default.call(this,{attributions:a.attributions,logo:a.logo,projection:void 0,state:v.default.READY,wrapX:void 0!==a.wrapX?a.wrapX:!0});this.loader_=c.default.nullFunction;
this.format_=a.format;this.overlaps_=void 0==a.overlaps?!0:a.overlaps;this.url_=a.url;void 0!==a.loader?this.loader_=a.loader:void 0!==this.url_&&(f.default.assert(this.format_,7),this.loader_=r.default.xhr(this.url_,this.format_));this.strategy_=void 0!==a.strategy?a.strategy:u.default.all;var d=void 0!==a.useSpatialIndex?a.useSpatialIndex:!0;this.featuresRtree_=d?new B.default:null;this.loadedExtentsRtree_=new B.default;this.nullGeometryFeatures_={};this.idIndex_={};this.undefIdIndex_={};this.featureChangeKeys_=
{};this.featuresCollection_=null;if(a.features instanceof b.default){var e=a.features;var g=e.getArray()}else Array.isArray(a.features)&&(g=a.features);d||void 0!==e||(e=new b.default(g));void 0!==g&&this.addFeaturesInternal(g);void 0!==e&&this.bindFeaturesCollection_(e)};c.default.inherits(x,w.default);x.prototype.addFeature=function(a){this.addFeatureInternal(a);this.changed()};x.prototype.addFeatureInternal=function(a){var b=c.default.getUid(a).toString();if(this.addToIndex_(b,a)){this.setupChangeEvents_(b,
a);var d=a.getGeometry();d?(b=d.getExtent(),this.featuresRtree_&&this.featuresRtree_.insert(b,a)):this.nullGeometryFeatures_[b]=a;this.dispatchEvent(new x.Event(A.default.ADDFEATURE,a))}};x.prototype.setupChangeEvents_=function(a,b){this.featureChangeKeys_[a]=[l.default.listen(b,m.default.CHANGE,this.handleFeatureChange_,this),l.default.listen(b,n.default.PROPERTYCHANGE,this.handleFeatureChange_,this)]};x.prototype.addToIndex_=function(a,b){var c=!0,d=b.getId();void 0!==d?d.toString()in this.idIndex_?
c=!1:this.idIndex_[d.toString()]=b:(f.default.assert(!(a in this.undefIdIndex_),30),this.undefIdIndex_[a]=b);return c};x.prototype.addFeatures=function(a){this.addFeaturesInternal(a);this.changed()};x.prototype.addFeaturesInternal=function(a){var b,d=[],e=[],f=[];var g=0;for(b=a.length;g<b;g++){var h=a[g];var l=c.default.getUid(h).toString();this.addToIndex_(l,h)&&e.push(h)}g=0;for(b=e.length;g<b;g++)h=e[g],l=c.default.getUid(h).toString(),this.setupChangeEvents_(l,h),(a=h.getGeometry())?(l=a.getExtent(),
d.push(l),f.push(h)):this.nullGeometryFeatures_[l]=h;this.featuresRtree_&&this.featuresRtree_.load(d,f);g=0;for(b=e.length;g<b;g++)this.dispatchEvent(new x.Event(A.default.ADDFEATURE,e[g]))};x.prototype.bindFeaturesCollection_=function(a){var b=!1;l.default.listen(this,A.default.ADDFEATURE,function(c){b||(b=!0,a.push(c.feature),b=!1)});l.default.listen(this,A.default.REMOVEFEATURE,function(c){b||(b=!0,a.remove(c.feature),b=!1)});l.default.listen(a,h.default.ADD,function(a){b||(b=!0,this.addFeature(a.element),
b=!1)},this);l.default.listen(a,h.default.REMOVE,function(a){b||(b=!0,this.removeFeature(a.element),b=!1)},this);this.featuresCollection_=a};x.prototype.clear=function(a){if(a){for(var b in this.featureChangeKeys_)this.featureChangeKeys_[b].forEach(l.default.unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var c in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[c])}this.featuresCollection_&&
this.featuresCollection_.clear();this.featuresRtree_&&this.featuresRtree_.clear();this.loadedExtentsRtree_.clear();this.nullGeometryFeatures_={};a=new x.Event(A.default.CLEAR);this.dispatchEvent(a);this.changed()};x.prototype.forEachFeature=function(a,b){if(this.featuresRtree_)return this.featuresRtree_.forEach(a,b);if(this.featuresCollection_)return this.featuresCollection_.forEach(a,b)};x.prototype.forEachFeatureAtCoordinateDirect=function(a,b,c){return this.forEachFeatureInExtent([a[0],a[1],a[0],
a[1]],function(d){if(d.getGeometry().intersectsCoordinate(a))return b.call(c,d)})};x.prototype.forEachFeatureInExtent=function(a,b,c){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(a,b,c);if(this.featuresCollection_)return this.featuresCollection_.forEach(b,c)};x.prototype.forEachFeatureIntersectingExtent=function(a,b,c){return this.forEachFeatureInExtent(a,function(d){if(d.getGeometry().intersectsExtent(a)&&(d=b.call(c,d)))return d})};x.prototype.getFeaturesCollection=function(){return this.featuresCollection_};
x.prototype.getFeatures=function(){if(this.featuresCollection_)var a=this.featuresCollection_.getArray();else this.featuresRtree_&&(a=this.featuresRtree_.getAll(),y.default.isEmpty(this.nullGeometryFeatures_)||g.default.extend(a,y.default.getValues(this.nullGeometryFeatures_)));return a};x.prototype.getFeaturesAtCoordinate=function(a){var b=[];this.forEachFeatureAtCoordinateDirect(a,function(a){b.push(a)});return b};x.prototype.getFeaturesInExtent=function(a){return this.featuresRtree_.getInExtent(a)};
x.prototype.getClosestFeatureToCoordinate=function(a,b){var c=a[0],d=a[1],e=null,f=[NaN,NaN],g=Infinity,h=[-Infinity,-Infinity,Infinity,Infinity],l=b?b:t.default.TRUE;this.featuresRtree_.forEachInExtent(h,function(a){if(l(a)){var b=a.getGeometry(),k=g;g=b.closestPointXY(c,d,f,g);g<k&&(e=a,a=Math.sqrt(g),h[0]=c-a,h[1]=d-a,h[2]=c+a,h[3]=d+a)}});return e};x.prototype.getExtent=function(a){return this.featuresRtree_.getExtent(a)};x.prototype.getFeatureById=function(a){a=this.idIndex_[a.toString()];return void 0!==
a?a:null};x.prototype.getFormat=function(){return this.format_};x.prototype.getOverlaps=function(){return this.overlaps_};x.prototype.getResolutions=function(){};x.prototype.getUrl=function(){return this.url_};x.prototype.handleFeatureChange_=function(a){a=a.target;var b=c.default.getUid(a).toString(),d=a.getGeometry();d?(d=d.getExtent(),b in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[b],this.featuresRtree_&&this.featuresRtree_.insert(d,a)):this.featuresRtree_&&this.featuresRtree_.update(d,
a)):b in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(a),this.nullGeometryFeatures_[b]=a);d=a.getId();void 0!==d?(d=d.toString(),b in this.undefIdIndex_?(delete this.undefIdIndex_[b],this.idIndex_[d]=a):this.idIndex_[d]!==a&&(this.removeFromIdIndex_(a),this.idIndex_[d]=a)):b in this.undefIdIndex_||(this.removeFromIdIndex_(a),this.undefIdIndex_[b]=a);this.changed();this.dispatchEvent(new x.Event(A.default.CHANGEFEATURE,a))};x.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&
y.default.isEmpty(this.nullGeometryFeatures_)};x.prototype.loadFeatures=function(a,b,c){var d=this.loadedExtentsRtree_;a=this.strategy_(a,b);var e;var f=0;for(e=a.length;f<e;++f){var g=a[f];d.forEachInExtent(g,function(a){return p.default.containsExtent(a.extent,g)})||(this.loader_.call(this,g,b,c),d.insert(g,{extent:g.slice()}))}};x.prototype.removeLoadedExtent=function(a){var b=this.loadedExtentsRtree_,c;b.forEachInExtent(a,function(b){if(p.default.equals(b.extent,a))return c=b,!0});c&&b.remove(c)};
x.prototype.removeFeature=function(a){var b=c.default.getUid(a).toString();b in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[b]:this.featuresRtree_&&this.featuresRtree_.remove(a);this.removeFeatureInternal(a);this.changed()};x.prototype.removeFeatureInternal=function(a){var b=c.default.getUid(a).toString();this.featureChangeKeys_[b].forEach(l.default.unlistenByKey);delete this.featureChangeKeys_[b];var d=a.getId();void 0!==d?delete this.idIndex_[d.toString()]:delete this.undefIdIndex_[b];
this.dispatchEvent(new x.Event(A.default.REMOVEFEATURE,a))};x.prototype.removeFromIdIndex_=function(a){var b=!1,c;for(c in this.idIndex_)if(this.idIndex_[c]===a){delete this.idIndex_[c];b=!0;break}return b};x.prototype.setLoader=function(a){this.loader_=a};x.Event=function(a,b){q.default.call(this,a);this.feature=b};c.default.inherits(x.Event,q.default);k.default=x},{"../array.js":29,"../asserts.js":31,"../collection.js":34,"../collectioneventtype.js":35,"../events.js":48,"../events/event.js":50,
"../events/eventtype.js":52,"../extent.js":54,"../featureloader.js":58,"../functions.js":60,"../index.js":89,"../loadingstrategy.js":114,"../obj.js":124,"../objecteventtype.js":126,"../source/source.js":211,"../source/state.js":212,"../source/vectoreventtype.js":214,"../structs/rbush.js":220}],214:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"}},{}],215:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});var d=(e=a("./math.js"))&&e.__esModule?e:{default:e},c=(a=a("./geom/geometrytype.js"))&&a.__esModule?a:{default:a},b=function(a){this.radius=a};b.prototype.geodesicArea=function(a){return b.getArea_(a,this.radius)};b.prototype.haversineDistance=function(a,c){return b.getDistance_(a,c,this.radius)};b.prototype.offset=function(a,b,c){var e=d.default.toRadians(a[1]);a=d.default.toRadians(a[0]);b/=this.radius;var g=Math.asin(Math.sin(e)*Math.cos(b)+Math.cos(e)*Math.sin(b)*Math.cos(c));
return[d.default.toDegrees(a+Math.atan2(Math.sin(c)*Math.sin(b)*Math.cos(e),Math.cos(b)-Math.sin(e)*Math.sin(g))),d.default.toDegrees(g)]};b.DEFAULT_RADIUS=6371008.8;b.getLength=function(a,d){var e=d||{},f=e.radius||b.DEFAULT_RADIUS;e=e.projection||"EPSG:3857";a=a.clone().transform(e,"EPSG:4326");var h=a.getType();e=0;var k;switch(h){case c.default.POINT:case c.default.MULTI_POINT:break;case c.default.LINE_STRING:case c.default.LINEAR_RING:d=a.getCoordinates();e=b.getLength_(d,f);break;case c.default.MULTI_LINE_STRING:case c.default.POLYGON:d=
a.getCoordinates();a=0;for(h=d.length;a<h;++a)e+=b.getLength_(d[a],f);break;case c.default.MULTI_POLYGON:d=a.getCoordinates();a=0;for(h=d.length;a<h;++a){var m=d[a];var n=0;for(k=m.length;n<k;++n)e+=b.getLength_(m[n],f)}break;case c.default.GEOMETRY_COLLECTION:f=a.getGeometries();a=0;for(h=f.length;a<h;++a)e+=b.getLength(f[a],d);break;default:throw Error("Unsupported geometry type: "+h);}return e};b.getLength_=function(a,c){for(var d=0,e=0,h=a.length;e<h-1;++e)d+=b.getDistance_(a[e],a[e+1],c);return d};
b.getDistance_=function(a,b,c){var e=d.default.toRadians(a[1]),g=d.default.toRadians(b[1]),h=(g-e)/2;a=d.default.toRadians(b[0]-a[0])/2;e=Math.sin(h)*Math.sin(h)+Math.sin(a)*Math.sin(a)*Math.cos(e)*Math.cos(g);return 2*c*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))};b.getArea=function(a,d){var e=d||{},f=e.radius||b.DEFAULT_RADIUS;e=e.projection||"EPSG:3857";a=a.clone().transform(e,"EPSG:4326");var h=a.getType();e=0;var k;switch(h){case c.default.POINT:case c.default.MULTI_POINT:case c.default.LINE_STRING:case c.default.MULTI_LINE_STRING:case c.default.LINEAR_RING:break;
case c.default.POLYGON:d=a.getCoordinates();e=Math.abs(b.getArea_(d[0],f));a=1;for(h=d.length;a<h;++a)e-=Math.abs(b.getArea_(d[a],f));break;case c.default.MULTI_POLYGON:d=a.getCoordinates();a=0;for(h=d.length;a<h;++a){var m=d[a];e+=Math.abs(b.getArea_(m[0],f));var n=1;for(k=m.length;n<k;++n)e-=Math.abs(b.getArea_(m[n],f))}break;case c.default.GEOMETRY_COLLECTION:f=a.getGeometries();a=0;for(h=f.length;a<h;++a)e+=b.getArea(f[a],d);break;default:throw Error("Unsupported geometry type: "+h);}return e};
b.getArea_=function(a,b){for(var c=0,e=a.length,h=a[e-1][0],k=a[e-1][1],m=0;m<e;m++){var n=a[m][0],r=a[m][1];c+=d.default.toRadians(n-h)*(2+Math.sin(d.default.toRadians(k))+Math.sin(d.default.toRadians(r)));h=n;k=r}return c*b*b/2};k.default=b},{"./geom/geometrytype.js":79,"./math.js":123}],216:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={padNumber:function(a,c,b){a=void 0!==b?a.toFixed(b):""+a;b=a.indexOf(".");b=-1===b?a.length:b;return b>c?a:Array(1+c-b).join("0")+
a},compareVersions:function(a,c){a=(""+a).split(".");c=(""+c).split(".");for(var b=0;b<Math.max(a.length,c.length);b++){var d=parseInt(a[b]||"0",10),e=parseInt(c[b]||"0",10);if(d>e)return 1;if(e>d)return-1}return 0}}},{}],217:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(a){this.head_=this.last_=this.first_=void 0;this.circular_=void 0===a?!0:a;this.length_=0};a.prototype.insertItem=function(a){a={prev:void 0,next:void 0,data:a};var c=this.head_;if(c){var b=c.next;a.prev=
c;a.next=b;c.next=a;b&&(b.prev=a);c===this.last_&&(this.last_=a)}else this.last_=this.first_=a,this.circular_&&(a.next=a,a.prev=a);this.head_=a;this.length_++};a.prototype.removeItem=function(){var a=this.head_;if(a){var c=a.next,b=a.prev;c&&(c.prev=b);b&&(b.next=c);this.head_=c||b;this.first_===this.last_?this.last_=this.first_=this.head_=void 0:this.first_===a?this.first_=this.head_:this.last_===a&&(this.last_=b?this.head_.prev:this.head_);this.length_--}};a.prototype.firstItem=function(){if(this.head_=
this.first_)return this.head_.data};a.prototype.lastItem=function(){if(this.head_=this.last_)return this.head_.data};a.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data};a.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data};a.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data};a.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data};
a.prototype.getCurrItem=function(){if(this.head_)return this.head_.data};a.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)};a.prototype.concat=function(a){if(a.head_){if(this.head_){var c=this.head_.next;this.head_.next=a.first_;a.first_.prev=this.head_;c.prev=a.last_;a.last_.next=c;this.length_+=a.length_}else this.head_=a.head_,this.first_=a.first_,this.last_=a.last_,this.length_=a.length_;a.head_=void 0;a.first_=void 0;a.last_=void 0;
a.length_=0}};a.prototype.getLength=function(){return this.length_};k.default=a},{}],218:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../asserts.js"),b=d(c);c=a("../events/eventtarget.js");var h=d(c);a=a("../events/eventtype.js");var n=d(a);a=function(a){h.default.call(this);this.highWaterMark=void 0!==a?a:2048;this.count_=0;this.entries_={};this.newest_=this.oldest_=null};e.default.inherits(a,
h.default);a.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark};a.prototype.clear=function(){this.count_=0;this.entries_={};this.newest_=this.oldest_=null;this.dispatchEvent(n.default.CLEAR)};a.prototype.containsKey=function(a){return this.entries_.hasOwnProperty(a)};a.prototype.forEach=function(a,b){for(var c=this.oldest_;c;)a.call(b,c.value_,c.key_,this),c=c.newer};a.prototype.get=function(a){a=this.entries_[a];b.default.assert(void 0!==a,15);if(a===this.newest_)return a.value_;
a===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(a.newer.older=a.older,a.older.newer=a.newer);a.newer=null;a.older=this.newest_;this.newest_=this.newest_.newer=a;return a.value_};a.prototype.remove=function(a){var c=this.entries_[a];b.default.assert(void 0!==c,15);if(c===this.newest_){if(this.newest_=c.older)this.newest_.newer=null}else if(c===this.oldest_){if(this.oldest_=c.newer)this.oldest_.older=null}else c.newer.older=c.older,c.older.newer=c.newer;delete this.entries_[a];
--this.count_;return c.value_};a.prototype.getCount=function(){return this.count_};a.prototype.getKeys=function(){var a=Array(this.count_),b=0,c;for(c=this.newest_;c;c=c.older)a[b++]=c.key_;return a};a.prototype.getValues=function(){var a=Array(this.count_),b=0,c;for(c=this.newest_;c;c=c.older)a[b++]=c.value_;return a};a.prototype.peekLast=function(){return this.oldest_.value_};a.prototype.peekLastKey=function(){return this.oldest_.key_};a.prototype.peekFirstKey=function(){return this.newest_.key_};
a.prototype.pop=function(){var a=this.oldest_;delete this.entries_[a.key_];a.newer&&(a.newer.older=null);this.oldest_=a.newer;this.oldest_||(this.newest_=null);--this.count_;return a.value_};a.prototype.replace=function(a,b){this.get(a);this.entries_[a].value_=b};a.prototype.set=function(a,c){b.default.assert(!(a in this.entries_),16);c={key_:a,newer:null,older:this.newest_,value_:c};this.newest_?this.newest_.newer=c:this.oldest_=c;this.newest_=c;this.entries_[a]=c;++this.count_};a.prototype.prune=
function(){for(;this.canExpireCache();)this.pop()};k.default=a},{"../asserts.js":31,"../events/eventtarget.js":51,"../events/eventtype.js":52,"../index.js":89}],219:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("../asserts.js"))&&e.__esModule?e:{default:e},c=(a=a("../obj.js"))&&a.__esModule?a:{default:a},b=function(a,b){this.priorityFunction_=a;this.keyFunction_=b;this.elements_=[];this.priorities_=[];this.queuedElements_={}};b.DROP=Infinity;b.prototype.clear=function(){this.elements_.length=
0;this.priorities_.length=0;c.default.clear(this.queuedElements_)};b.prototype.dequeue=function(){var a=this.elements_,b=this.priorities_,c=a[0];1==a.length?(a.length=0,b.length=0):(a[0]=a.pop(),b[0]=b.pop(),this.siftUp_(0));a=this.keyFunction_(c);delete this.queuedElements_[a];return c};b.prototype.enqueue=function(a){d.default.assert(!(this.keyFunction_(a)in this.queuedElements_),31);var c=this.priorityFunction_(a);return c!=b.DROP?(this.elements_.push(a),this.priorities_.push(c),this.queuedElements_[this.keyFunction_(a)]=
!0,this.siftDown_(0,this.elements_.length-1),!0):!1};b.prototype.getCount=function(){return this.elements_.length};b.prototype.getLeftChildIndex_=function(a){return 2*a+1};b.prototype.getRightChildIndex_=function(a){return 2*a+2};b.prototype.getParentIndex_=function(a){return a-1>>1};b.prototype.heapify_=function(){var a;for(a=(this.elements_.length>>1)-1;0<=a;a--)this.siftUp_(a)};b.prototype.isEmpty=function(){return 0===this.elements_.length};b.prototype.isKeyQueued=function(a){return a in this.queuedElements_};
b.prototype.isQueued=function(a){return this.isKeyQueued(this.keyFunction_(a))};b.prototype.siftUp_=function(a){for(var b=this.elements_,c=this.priorities_,d=b.length,e=b[a],h=c[a],k=a;a<d>>1;){var p=this.getLeftChildIndex_(a),r=this.getRightChildIndex_(a);p=r<d&&c[r]<c[p]?r:p;b[a]=b[p];c[a]=c[p];a=p}b[a]=e;c[a]=h;this.siftDown_(k,a)};b.prototype.siftDown_=function(a,b){for(var c=this.elements_,d=this.priorities_,e=c[b],h=d[b];b>a;){var k=this.getParentIndex_(b);if(d[k]>h)c[b]=c[k],d[b]=d[k],b=k;
else break}c[b]=e;d[b]=h};b.prototype.reprioritize=function(){var a=this.priorityFunction_,c=this.elements_,d=this.priorities_,e=0,l=c.length,k;for(k=0;k<l;++k){var m=c[k];var p=a(m);p==b.DROP?delete this.queuedElements_[this.keyFunction_(m)]:(d[e]=p,c[e++]=m)}c.length=e;d.length=e;this.heapify_()};k.default=b},{"../asserts.js":31,"../obj.js":124}],220:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);
e=a("rbush");var b=d(e);e=a("../extent.js");var h=d(e);a=a("../obj.js");var n=d(a);a=function(a){this.rbush_=(0,b.default)(a);this.items_={}};a.prototype.insert=function(a,b){a={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],value:b};this.rbush_.insert(a);this.items_[c.default.getUid(b)]=a};a.prototype.load=function(a,b){for(var d=Array(b.length),e=0,f=b.length;e<f;e++){var g=a[e],h=b[e];g={minX:g[0],minY:g[1],maxX:g[2],maxY:g[3],value:h};d[e]=g;this.items_[c.default.getUid(h)]=g}this.rbush_.load(d)};a.prototype.remove=
function(a){a=c.default.getUid(a);var b=this.items_[a];delete this.items_[a];return null!==this.rbush_.remove(b)};a.prototype.update=function(a,b){var d=this.items_[c.default.getUid(b)];h.default.equals([d.minX,d.minY,d.maxX,d.maxY],a)||(this.remove(b),this.insert(a,b))};a.prototype.getAll=function(){return this.rbush_.all().map(function(a){return a.value})};a.prototype.getInExtent=function(a){return this.rbush_.search({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}).map(function(a){return a.value})};a.prototype.forEach=
function(a,b){return this.forEach_(this.getAll(),a,b)};a.prototype.forEachInExtent=function(a,b,c){return this.forEach_(this.getInExtent(a),b,c)};a.prototype.forEach_=function(a,b,c){for(var d,e=0,f=a.length;e<f&&!(d=b.call(c,a[e]));e++);return d};a.prototype.isEmpty=function(){return n.default.isEmpty(this.items_)};a.prototype.clear=function(){this.rbush_.clear();this.items_={}};a.prototype.getExtent=function(a){var b=this.rbush_.data;return h.default.createOrUpdate(b.minX,b.minY,b.maxX,b.maxY,a)};
a.prototype.concat=function(a){this.rbush_.load(a.rbush_.all());for(var b in a.items_)this.items_[b|0]=a.items_[b|0]};k.default=a},{"../extent.js":54,"../index.js":89,"../obj.js":124,rbush:258}],221:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=a("./style/iconimagecache.js");e={};e.iconImageCache=new (a&&a.__esModule?a:{default:a}).default;k.default=e},{"./style/iconimagecache.js":229}],222:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../dom.js"))&&
a.__esModule?a:{default:a};a=function(a,b){this.space_=b;this.emptyBlocks_=[{x:0,y:0,width:a,height:a}];this.entries_={};this.context_=d.default.createCanvasContext2D(a,a);this.canvas_=this.context_.canvas};a.prototype.get=function(a){return this.entries_[a]||null};a.prototype.add=function(a,b,d,e,g){var c;var h=0;for(c=this.emptyBlocks_.length;h<c;++h){var k=this.emptyBlocks_[h];if(k.width>=b+this.space_&&k.height>=d+this.space_)return c={offsetX:k.x+this.space_,offsetY:k.y+this.space_,image:this.canvas_},
this.entries_[a]=c,e.call(g,this.context_,k.x+this.space_,k.y+this.space_),this.split_(h,k,b+this.space_,d+this.space_),c}return null};a.prototype.split_=function(a,b,d,e){if(b.width-d>b.height-e){var c={x:b.x+d,y:b.y,width:b.width-d,height:b.height};b={x:b.x,y:b.y+e,width:d,height:b.height-e}}else c={x:b.x+d,y:b.y,width:b.width-d,height:e},b={x:b.x,y:b.y+e,width:b.width,height:b.height-e};this.updateBlocks_(a,c,b)};a.prototype.updateBlocks_=function(a,b,d){a=[a,1];0<b.width&&0<b.height&&a.push(b);
0<d.width&&0<d.height&&a.push(d);this.emptyBlocks_.splice.apply(this.emptyBlocks_,a)};k.default=a},{"../dom.js":46}],223:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("../index.js"))&&e.__esModule?e:{default:e},c=(a=a("../style/atlas.js"))&&a.__esModule?a:{default:a};a=function(a){a=a||{};this.currentSize_=void 0!==a.initialSize?a.initialSize:d.default.INITIAL_ATLAS_SIZE;this.maxSize_=void 0!==a.maxSize?a.maxSize:-1!=d.default.MAX_ATLAS_SIZE?d.default.MAX_ATLAS_SIZE:
void 0!==d.default.WEBGL_MAX_TEXTURE_SIZE?d.default.WEBGL_MAX_TEXTURE_SIZE:2048;this.space_=void 0!==a.space?a.space:1;this.atlases_=[new c.default(this.currentSize_,this.space_)];this.currentHitSize_=this.currentSize_;this.hitAtlases_=[new c.default(this.currentHitSize_,this.space_)]};a.prototype.getInfo=function(a){var b=this.getInfo_(this.atlases_,a);if(!b)return null;a=this.getInfo_(this.hitAtlases_,a);return this.mergeInfos_(b,a)};a.prototype.getInfo_=function(a,c){var b;var d=0;for(b=a.length;d<
b;++d){var e=a[d];if(e=e.get(c))return e}return null};a.prototype.mergeInfos_=function(a,c){return{offsetX:a.offsetX,offsetY:a.offsetY,image:a.image,hitImage:c.image}};a.prototype.add=function(a,c,e,g,f,k){if(c+this.space_>this.maxSize_||e+this.space_>this.maxSize_)return null;g=this.add_(!1,a,c,e,g,k);if(!g)return null;a=this.add_(!0,a,c,e,void 0!==f?f:d.default.nullFunction,k);return this.mergeInfos_(g,a)};a.prototype.add_=function(a,d,e,g,f,k){var b=a?this.hitAtlases_:this.atlases_,h;var l=0;for(h=
b.length;l<h;++l){var n=b[l];if(n=n.add(d,e,g,f,k))return n;n||l!==h-1||(a?this.currentHitSize_=n=Math.min(2*this.currentHitSize_,this.maxSize_):this.currentSize_=n=Math.min(2*this.currentSize_,this.maxSize_),n=new c.default(n,this.space_),b.push(n),++h)}return null};k.default=a},{"../index.js":89,"../style/atlas.js":222}],224:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});e=(e=a("../index.js"))&&e.__esModule?e:{default:e};var d=(a=a("../style/regularshape.js"))&&a.__esModule?a:
{default:a},c=function(a){a=a||{};d.default.call(this,{points:Infinity,fill:a.fill,radius:a.radius,snapToPixel:a.snapToPixel,stroke:a.stroke,atlasManager:a.atlasManager})};e.default.inherits(c,d.default);c.prototype.clone=function(){var a=new c({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});a.setOpacity(this.getOpacity());a.setScale(this.getScale());
return a};c.prototype.setRadius=function(a){this.radius_=a;this.render_(this.atlasManager_)};k.default=c},{"../index.js":89,"../style/regularshape.js":232}],225:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("../index.js"))&&e.__esModule?e:{default:e},c=(a=a("../color.js"))&&a.__esModule?a:{default:a},b=function(a){a=a||{};this.color_=void 0!==a.color?a.color:null;this.checksum_=void 0};b.prototype.clone=function(){var a=this.getColor();return new b({color:a&&a.slice?
a.slice():a||void 0})};b.prototype.getColor=function(){return this.color_};b.prototype.setColor=function(a){this.color_=a;this.checksum_=void 0};b.prototype.getChecksum=function(){void 0===this.checksum_&&(this.checksum_=this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?d.default.getUid(this.color_).toString():"f"+(this.color_?c.default.asString(this.color_):"-"));return this.checksum_};k.default=b},{"../color.js":36,"../index.js":89}],226:[function(a,e,k){function d(a){return a&&
a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../imagestate.js");var b=d(e);e=a("../asserts.js");var h=d(e);e=a("../color.js");var n=d(e);e=a("../events.js");var g=d(e);e=a("../events/eventtype.js");var f=d(e);e=a("../style/iconanchorunits.js");var l=d(e);e=a("../style/iconimage.js");var q=d(e);e=a("../style/iconorigin.js");var m=d(e);a=a("../style/image.js");var p=d(a),r=function(a){a=a||{};this.anchor_=void 0!==a.anchor?a.anchor:[.5,
.5];this.normalizedAnchor_=null;this.anchorOrigin_=void 0!==a.anchorOrigin?a.anchorOrigin:m.default.TOP_LEFT;this.anchorXUnits_=void 0!==a.anchorXUnits?a.anchorXUnits:l.default.FRACTION;this.anchorYUnits_=void 0!==a.anchorYUnits?a.anchorYUnits:l.default.FRACTION;this.crossOrigin_=void 0!==a.crossOrigin?a.crossOrigin:null;var d=void 0!==a.img?a.img:null,e=void 0!==a.imgSize?a.imgSize:null,f=a.src;h.default.assert(!(void 0!==f&&d),4);h.default.assert(!d||d&&e,5);void 0!==f&&0!==f.length||!d||(f=d.src||
c.default.getUid(d).toString());h.default.assert(void 0!==f&&0<f.length,6);var g=void 0!==a.src?b.default.IDLE:b.default.LOADED;this.color_=void 0!==a.color?n.default.asArray(a.color):null;this.iconImage_=q.default.get(d,f,e,this.crossOrigin_,g,this.color_);this.offset_=void 0!==a.offset?a.offset:[0,0];this.offsetOrigin_=void 0!==a.offsetOrigin?a.offsetOrigin:m.default.TOP_LEFT;this.origin_=null;this.size_=void 0!==a.size?a.size:null;p.default.call(this,{opacity:void 0!==a.opacity?a.opacity:1,rotation:void 0!==
a.rotation?a.rotation:0,scale:void 0!==a.scale?a.scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0,rotateWithView:void 0!==a.rotateWithView?a.rotateWithView:!1})};c.default.inherits(r,p.default);r.prototype.clone=function(){return new r({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),
offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})};r.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var a=this.anchor_,b=this.getSize();if(this.anchorXUnits_==l.default.FRACTION||this.anchorYUnits_==l.default.FRACTION){if(!b)return null;a=this.anchor_.slice();this.anchorXUnits_==
l.default.FRACTION&&(a[0]*=b[0]);this.anchorYUnits_==l.default.FRACTION&&(a[1]*=b[1])}if(this.anchorOrigin_!=m.default.TOP_LEFT){if(!b)return null;a===this.anchor_&&(a=this.anchor_.slice());if(this.anchorOrigin_==m.default.TOP_RIGHT||this.anchorOrigin_==m.default.BOTTOM_RIGHT)a[0]=-a[0]+b[0];if(this.anchorOrigin_==m.default.BOTTOM_LEFT||this.anchorOrigin_==m.default.BOTTOM_RIGHT)a[1]=-a[1]+b[1]}return this.normalizedAnchor_=a};r.prototype.getColor=function(){return this.color_};r.prototype.getImage=
function(a){return this.iconImage_.getImage(a)};r.prototype.getImageSize=function(){return this.iconImage_.getSize()};r.prototype.getHitDetectionImageSize=function(){return this.getImageSize()};r.prototype.getImageState=function(){return this.iconImage_.getImageState()};r.prototype.getHitDetectionImage=function(a){return this.iconImage_.getHitDetectionImage(a)};r.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var a=this.offset_;if(this.offsetOrigin_!=m.default.TOP_LEFT){var b=
this.getSize(),c=this.iconImage_.getSize();if(!b||!c)return null;a=a.slice();if(this.offsetOrigin_==m.default.TOP_RIGHT||this.offsetOrigin_==m.default.BOTTOM_RIGHT)a[0]=c[0]-b[0]-a[0];if(this.offsetOrigin_==m.default.BOTTOM_LEFT||this.offsetOrigin_==m.default.BOTTOM_RIGHT)a[1]=c[1]-b[1]-a[1]}return this.origin_=a};r.prototype.getSrc=function(){return this.iconImage_.getSrc()};r.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()};r.prototype.listenImageChange=function(a,
b){return g.default.listen(this.iconImage_,f.default.CHANGE,a,b)};r.prototype.load=function(){this.iconImage_.load()};r.prototype.unlistenImageChange=function(a,b){g.default.unlisten(this.iconImage_,f.default.CHANGE,a,b)};k.default=r},{"../asserts.js":31,"../color.js":36,"../events.js":48,"../events/eventtype.js":52,"../imagestate.js":88,"../index.js":89,"../style/iconanchorunits.js":227,"../style/iconimage.js":228,"../style/iconorigin.js":230,"../style/image.js":231}],227:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});k.default={FRACTION:"fraction",PIXELS:"pixels"}},{}],228:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../dom.js"),b=d(c);c=a("../events.js");var h=d(c);c=a("../events/eventtarget.js");var n=d(c);c=a("../events/eventtype.js");var g=d(c);c=a("../imagestate.js");var f=d(c);a=a("../style.js");var l=d(a),q=function(a,b,c,d,e,g){n.default.call(this);this.hitDetectionImage_=
null;this.image_=a?a:new Image;null!==d&&(this.image_.crossOrigin=d);this.canvas_=g?document.createElement("CANVAS"):null;this.color_=g;this.imageListenerKeys_=null;this.imageState_=e;this.size_=c;this.src_=b;this.tainting_=!1;this.imageState_==f.default.LOADED&&this.determineTainting_()};e.default.inherits(q,n.default);q.get=function(a,b,c,d,e,f){var g=l.default.iconImageCache,h=g.get(b,d,f);h||(h=new q(a,b,c,d,e,f),g.set(b,d,f,h));return h};q.prototype.determineTainting_=function(){var a=b.default.createCanvasContext2D(1,
1);try{a.drawImage(this.image_,0,0),a.getImageData(0,0,1,1)}catch(p){this.tainting_=!0}};q.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(g.default.CHANGE)};q.prototype.handleImageError_=function(){this.imageState_=f.default.ERROR;this.unlistenImage_();this.dispatchChangeEvent_()};q.prototype.handleImageLoad_=function(){this.imageState_=f.default.LOADED;this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]);this.size_=[this.image_.width,this.image_.height];this.unlistenImage_();
this.determineTainting_();this.replaceColor_();this.dispatchChangeEvent_()};q.prototype.getImage=function(a){return this.canvas_?this.canvas_:this.image_};q.prototype.getImageState=function(){return this.imageState_};q.prototype.getHitDetectionImage=function(a){if(!this.hitDetectionImage_)if(this.tainting_){a=this.size_[0];var c=this.size_[1],d=b.default.createCanvasContext2D(a,c);d.fillRect(0,0,a,c);this.hitDetectionImage_=d.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_};
q.prototype.getSize=function(){return this.size_};q.prototype.getSrc=function(){return this.src_};q.prototype.load=function(){if(this.imageState_==f.default.IDLE){this.imageState_=f.default.LOADING;this.imageListenerKeys_=[h.default.listenOnce(this.image_,g.default.ERROR,this.handleImageError_,this),h.default.listenOnce(this.image_,g.default.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(m){this.handleImageError_()}}};q.prototype.replaceColor_=function(){if(!this.tainting_&&
null!==this.color_){this.canvas_.width=this.image_.width;this.canvas_.height=this.image_.height;var a=this.canvas_.getContext("2d");a.drawImage(this.image_,0,0);for(var b=a.getImageData(0,0,this.image_.width,this.image_.height),c=b.data,d=this.color_[0]/255,e=this.color_[1]/255,f=this.color_[2]/255,g=0,h=c.length;g<h;g+=4)c[g]*=d,c[g+1]*=e,c[g+2]*=f;a.putImageData(b,0,0)}};q.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(h.default.unlistenByKey);this.imageListenerKeys_=null};
k.default=q},{"../dom.js":46,"../events.js":48,"../events/eventtarget.js":51,"../events/eventtype.js":52,"../imagestate.js":88,"../index.js":89,"../style.js":221}],229:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../color.js"))&&a.__esModule?a:{default:a},c=function(){this.cache_={};this.cacheSize_=0;this.maxCacheSize_=32};c.getKey=function(a,c,e){e=e?d.default.asString(e):"null";return c+":"+a+":"+e};c.prototype.clear=function(){this.cache_={};this.cacheSize_=0};
c.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var a=0,c;for(c in this.cache_){var d=this.cache_[c];0!==(a++&3)||d.hasListener()||(delete this.cache_[c],--this.cacheSize_)}}};c.prototype.get=function(a,d,e){a=c.getKey(a,d,e);return a in this.cache_?this.cache_[a]:null};c.prototype.set=function(a,d,e,g){a=c.getKey(a,d,e);this.cache_[a]=g;++this.cacheSize_};c.prototype.setSize=function(a){this.maxCacheSize_=a;this.expire()};k.default=c},{"../color.js":36}],230:[function(a,e,k){Object.defineProperty(k,
"__esModule",{value:!0});k.default={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"}},{}],231:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=function(a){this.opacity_=a.opacity;this.rotateWithView_=a.rotateWithView;this.rotation_=a.rotation;this.scale_=a.scale;this.snapToPixel_=a.snapToPixel};a.prototype.getOpacity=function(){return this.opacity_};a.prototype.getRotateWithView=function(){return this.rotateWithView_};a.prototype.getRotation=
function(){return this.rotation_};a.prototype.getScale=function(){return this.scale_};a.prototype.getSnapToPixel=function(){return this.snapToPixel_};a.prototype.getAnchor=function(){};a.prototype.getImage=function(a){};a.prototype.getHitDetectionImage=function(a){};a.prototype.getImageState=function(){};a.prototype.getImageSize=function(){};a.prototype.getHitDetectionImageSize=function(){};a.prototype.getOrigin=function(){};a.prototype.getSize=function(){};a.prototype.setOpacity=function(a){this.opacity_=
a};a.prototype.setRotateWithView=function(a){this.rotateWithView_=a};a.prototype.setRotation=function(a){this.rotation_=a};a.prototype.setScale=function(a){this.scale_=a};a.prototype.setSnapToPixel=function(a){this.snapToPixel_=a};a.prototype.listenImageChange=function(a,c){};a.prototype.load=function(){};a.prototype.unlistenImageChange=function(a,c){};k.default=a},{}],232:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");
e=d(e);var c=a("../colorlike.js"),b=d(c);c=a("../dom.js");var h=d(c);c=a("../has.js");var n=d(c);c=a("../imagestate.js");var g=d(c);c=a("../render/canvas.js");var f=d(c);a=a("../style/image.js");var l=d(a),q=function(a){this.hitDetectionCanvas_=this.canvas_=this.checksums_=null;this.fill_=void 0!==a.fill?a.fill:null;this.origin_=[0,0];this.points_=a.points;this.radius_=void 0!==a.radius?a.radius:a.radius1;this.radius2_=a.radius2;this.angle_=void 0!==a.angle?a.angle:0;this.stroke_=void 0!==a.stroke?
a.stroke:null;this.hitDetectionImageSize_=this.imageSize_=this.size_=this.anchor_=null;this.atlasManager_=a.atlasManager;this.render_(this.atlasManager_);l.default.call(this,{opacity:1,rotateWithView:void 0!==a.rotateWithView?a.rotateWithView:!1,rotation:void 0!==a.rotation?a.rotation:0,scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0})};e.default.inherits(q,l.default);q.prototype.clone=function(){var a=new q({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),
radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});a.setOpacity(this.getOpacity());a.setScale(this.getScale());return a};q.prototype.getAnchor=function(){return this.anchor_};q.prototype.getAngle=function(){return this.angle_};q.prototype.getFill=function(){return this.fill_};q.prototype.getHitDetectionImage=function(a){return this.hitDetectionCanvas_};
q.prototype.getImage=function(a){return this.canvas_};q.prototype.getImageSize=function(){return this.imageSize_};q.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_};q.prototype.getImageState=function(){return g.default.LOADED};q.prototype.getOrigin=function(){return this.origin_};q.prototype.getPoints=function(){return this.points_};q.prototype.getRadius=function(){return this.radius_};q.prototype.getRadius2=function(){return this.radius2_};q.prototype.getSize=function(){return this.size_};
q.prototype.getStroke=function(){return this.stroke_};q.prototype.listenImageChange=function(a,b){};q.prototype.load=function(){};q.prototype.unlistenImageChange=function(a,b){};q.prototype.render_=function(a){var c="",d="",e=0,g=null,k=0,l=0;if(this.stroke_){var m=this.stroke_.getColor();null===m&&(m=f.default.defaultStrokeStyle);m=b.default.asColorLike(m);l=this.stroke_.getWidth();void 0===l&&(l=f.default.defaultLineWidth);g=this.stroke_.getLineDash();k=this.stroke_.getLineDashOffset();n.default.CANVAS_LINE_DASH||
(g=null,k=0);d=this.stroke_.getLineJoin();void 0===d&&(d=f.default.defaultLineJoin);c=this.stroke_.getLineCap();void 0===c&&(c=f.default.defaultLineCap);e=this.stroke_.getMiterLimit();void 0===e&&(e=f.default.defaultMiterLimit)}var q=2*(this.radius_+l)+1;c={strokeStyle:m,strokeWidth:l,size:q,lineCap:c,lineDash:g,lineDashOffset:k,lineJoin:d,miterLimit:e};if(void 0===a){var B=h.default.createCanvasContext2D(q,q);this.canvas_=B.canvas;a=q=this.canvas_.width;this.draw_(c,B,0,0);this.createHitDetectionCanvas_(c)}else q=
Math.round(q),(d=!this.fill_)&&(B=this.drawHitDetectionCanvas_.bind(this,c)),e=this.getChecksum(),B=a.add(e,q,q,this.draw_.bind(this,c),B),this.canvas_=B.image,this.origin_=[B.offsetX,B.offsetY],a=B.image.width,d?(this.hitDetectionCanvas_=B.hitImage,this.hitDetectionImageSize_=[B.hitImage.width,B.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[a,a]);this.anchor_=[q/2,q/2];this.size_=[q,q];this.imageSize_=[a,a]};q.prototype.draw_=function(a,c,d,e){c.setTransform(1,
0,0,1,0,0);c.translate(d,e);c.beginPath();var g=this.points_;if(Infinity===g)c.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{var h=void 0!==this.radius2_?this.radius2_:this.radius_;h!==this.radius_&&(g*=2);for(d=0;d<=g;d++){e=2*d*Math.PI/g-Math.PI/2+this.angle_;var k=0===d%2?this.radius_:h;c.lineTo(a.size/2+k*Math.cos(e),a.size/2+k*Math.sin(e))}}this.fill_&&(d=this.fill_.getColor(),null===d&&(d=f.default.defaultFillStyle),c.fillStyle=b.default.asColorLike(d),c.fill());this.stroke_&&(c.strokeStyle=
a.strokeStyle,c.lineWidth=a.strokeWidth,a.lineDash&&(c.setLineDash(a.lineDash),c.lineDashOffset=a.lineDashOffset),c.lineCap=a.lineCap,c.lineJoin=a.lineJoin,c.miterLimit=a.miterLimit,c.stroke());c.closePath()};q.prototype.createHitDetectionCanvas_=function(a){this.hitDetectionImageSize_=[a.size,a.size];if(this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var b=h.default.createCanvasContext2D(a.size,a.size);this.hitDetectionCanvas_=b.canvas;this.drawHitDetectionCanvas_(a,b,0,0)}};q.prototype.drawHitDetectionCanvas_=
function(a,b,c,d){b.setTransform(1,0,0,1,0,0);b.translate(c,d);b.beginPath();c=this.points_;if(Infinity===c)b.arc(a.size/2,a.size/2,this.radius_,0,2*Math.PI,!0);else{d=void 0!==this.radius2_?this.radius2_:this.radius_;d!==this.radius_&&(c*=2);var e;for(e=0;e<=c;e++){var g=2*e*Math.PI/c-Math.PI/2+this.angle_;var h=0===e%2?this.radius_:d;b.lineTo(a.size/2+h*Math.cos(g),a.size/2+h*Math.sin(g))}}b.fillStyle=f.default.defaultFillStyle;b.fill();this.stroke_&&(b.strokeStyle=a.strokeStyle,b.lineWidth=a.strokeWidth,
a.lineDash&&(b.setLineDash(a.lineDash),b.lineDashOffset=a.lineDashOffset),b.stroke());b.closePath()};q.prototype.getChecksum=function(){var a=this.stroke_?this.stroke_.getChecksum():"-",b=this.fill_?this.fill_.getChecksum():"-";this.checksums_&&a==this.checksums_[1]&&b==this.checksums_[2]&&this.radius_==this.checksums_[3]&&this.radius2_==this.checksums_[4]&&this.angle_==this.checksums_[5]&&this.points_==this.checksums_[6]||(this.checksums_=["r"+a+b+(void 0!==this.radius_?this.radius_.toString():"-")+
(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-"),a,b,this.radius_,this.radius2_,this.angle_,this.points_]);return this.checksums_[0]};k.default=q},{"../colorlike.js":37,"../dom.js":46,"../has.js":84,"../imagestate.js":88,"../index.js":89,"../render/canvas.js":150,"../style/image.js":231}],233:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("../index.js"))&&a.__esModule?
a:{default:a},c=function(a){a=a||{};this.color_=void 0!==a.color?a.color:null;this.lineCap_=a.lineCap;this.lineDash_=void 0!==a.lineDash?a.lineDash:null;this.lineDashOffset_=a.lineDashOffset;this.lineJoin_=a.lineJoin;this.miterLimit_=a.miterLimit;this.width_=a.width;this.checksum_=void 0};c.prototype.clone=function(){var a=this.getColor();return new c({color:a&&a.slice?a.slice():a||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),
lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})};c.prototype.getColor=function(){return this.color_};c.prototype.getLineCap=function(){return this.lineCap_};c.prototype.getLineDash=function(){return this.lineDash_};c.prototype.getLineDashOffset=function(){return this.lineDashOffset_};c.prototype.getLineJoin=function(){return this.lineJoin_};c.prototype.getMiterLimit=function(){return this.miterLimit_};c.prototype.getWidth=function(){return this.width_};c.prototype.setColor=
function(a){this.color_=a;this.checksum_=void 0};c.prototype.setLineCap=function(a){this.lineCap_=a;this.checksum_=void 0};c.prototype.setLineDash=function(a){this.lineDash_=a;this.checksum_=void 0};c.prototype.setLineDashOffset=function(a){this.lineDashOffset_=a;this.checksum_=void 0};c.prototype.setLineJoin=function(a){this.lineJoin_=a;this.checksum_=void 0};c.prototype.setMiterLimit=function(a){this.miterLimit_=a;this.checksum_=void 0};c.prototype.setWidth=function(a){this.width_=a;this.checksum_=
void 0};c.prototype.getChecksum=function(){void 0===this.checksum_&&(this.checksum_="s",this.checksum_=this.color_?"string"===typeof this.color_?this.checksum_+this.color_:this.checksum_+d.default.getUid(this.color_).toString():this.checksum_+"-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?
this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-"));return this.checksum_};k.default=c},{"../index.js":89}],234:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../asserts.js");var c=d(e);e=a("../geom/geometrytype.js");var b=d(e);e=a("../style/circle.js");var h=d(e);e=a("../style/fill.js");var n=d(e);a=a("../style/stroke.js");var g=d(a),f=function(a){a=a||{};this.geometry_=null;this.geometryFunction_=
f.defaultGeometryFunction;void 0!==a.geometry&&this.setGeometry(a.geometry);this.fill_=void 0!==a.fill?a.fill:null;this.image_=void 0!==a.image?a.image:null;this.renderer_=void 0!==a.renderer?a.renderer:null;this.stroke_=void 0!==a.stroke?a.stroke:null;this.text_=void 0!==a.text?a.text:null;this.zIndex_=a.zIndex};f.prototype.clone=function(){var a=this.getGeometry();a&&a.clone&&(a=a.clone());return new f({geometry:a,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():
void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})};f.prototype.getRenderer=function(){return this.renderer_};f.prototype.setRenderer=function(a){this.renderer_=a};f.prototype.getGeometry=function(){return this.geometry_};f.prototype.getGeometryFunction=function(){return this.geometryFunction_};f.prototype.getFill=function(){return this.fill_};f.prototype.setFill=function(a){this.fill_=a};f.prototype.getImage=
function(){return this.image_};f.prototype.setImage=function(a){this.image_=a};f.prototype.getStroke=function(){return this.stroke_};f.prototype.setStroke=function(a){this.stroke_=a};f.prototype.getText=function(){return this.text_};f.prototype.setText=function(a){this.text_=a};f.prototype.getZIndex=function(){return this.zIndex_};f.prototype.setGeometry=function(a){"function"===typeof a?this.geometryFunction_=a:"string"===typeof a?this.geometryFunction_=function(b){return b.get(a)}:a?void 0!==a&&
(this.geometryFunction_=function(){return a}):this.geometryFunction_=f.defaultGeometryFunction;this.geometry_=a};f.prototype.setZIndex=function(a){this.zIndex_=a};f.createFunction=function(a){if("function"!==typeof a){if(Array.isArray(a))var b=a;else c.default.assert(a instanceof f,41),b=[a];a=function(){return b}}return a};f.default_=null;f.defaultFunction=function(a,b){f.default_||(a=new n.default({color:"rgba(255,255,255,0.4)"}),b=new g.default({color:"#3399CC",width:1.25}),f.default_=[new f({image:new h.default({fill:a,
stroke:b,radius:5}),fill:a,stroke:b})]);return f.default_};f.createDefaultEditing=function(){var a={},c=[255,255,255,1],d=[0,153,255,1];a[b.default.POLYGON]=[new f({fill:new n.default({color:[255,255,255,.5]})})];a[b.default.MULTI_POLYGON]=a[b.default.POLYGON];a[b.default.LINE_STRING]=[new f({stroke:new g.default({color:c,width:5})}),new f({stroke:new g.default({color:d,width:3})})];a[b.default.MULTI_LINE_STRING]=a[b.default.LINE_STRING];a[b.default.CIRCLE]=a[b.default.POLYGON].concat(a[b.default.LINE_STRING]);
a[b.default.POINT]=[new f({image:new h.default({radius:6,fill:new n.default({color:d}),stroke:new g.default({color:c,width:1.5})}),zIndex:Infinity})];a[b.default.MULTI_POINT]=a[b.default.POINT];a[b.default.GEOMETRY_COLLECTION]=a[b.default.POLYGON].concat(a[b.default.LINE_STRING],a[b.default.POINT]);return a};f.defaultGeometryFunction=function(a){return a.getGeometry()};k.default=f},{"../asserts.js":31,"../geom/geometrytype.js":79,"../style/circle.js":224,"../style/fill.js":225,"../style/stroke.js":233}],
235:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(e=a("../style/fill.js"))&&e.__esModule?e:{default:e},c=(a=a("../style/textplacement.js"))&&a.__esModule?a:{default:a},b=function(a){a=a||{};this.font_=a.font;this.rotation_=a.rotation;this.rotateWithView_=a.rotateWithView;this.scale_=a.scale;this.text_=a.text;this.textAlign_=a.textAlign;this.textBaseline_=a.textBaseline;this.fill_=void 0!==a.fill?a.fill:new d.default({color:b.DEFAULT_FILL_COLOR_});this.maxAngle_=void 0!==
a.maxAngle?a.maxAngle:Math.PI/4;this.placement_=void 0!==a.placement?a.placement:c.default.POINT;var e=void 0===a.overflow?a.exceedLength:a.overflow;this.overflow_=void 0!==e?e:!1;this.stroke_=void 0!==a.stroke?a.stroke:null;this.offsetX_=void 0!==a.offsetX?a.offsetX:0;this.offsetY_=void 0!==a.offsetY?a.offsetY:0;this.backgroundFill_=a.backgroundFill?a.backgroundFill:null;this.backgroundStroke_=a.backgroundStroke?a.backgroundStroke:null;this.padding_=void 0===a.padding?null:a.padding};b.DEFAULT_FILL_COLOR_=
"#333";b.prototype.clone=function(){return new b({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY()})};b.prototype.getOverflow=
function(){return this.overflow_};b.prototype.getFont=function(){return this.font_};b.prototype.getMaxAngle=function(){return this.maxAngle_};b.prototype.getPlacement=function(){return this.placement_};b.prototype.getOffsetX=function(){return this.offsetX_};b.prototype.getOffsetY=function(){return this.offsetY_};b.prototype.getFill=function(){return this.fill_};b.prototype.getRotateWithView=function(){return this.rotateWithView_};b.prototype.getRotation=function(){return this.rotation_};b.prototype.getScale=
function(){return this.scale_};b.prototype.getStroke=function(){return this.stroke_};b.prototype.getText=function(){return this.text_};b.prototype.getTextAlign=function(){return this.textAlign_};b.prototype.getTextBaseline=function(){return this.textBaseline_};b.prototype.getBackgroundFill=function(){return this.backgroundFill_};b.prototype.getBackgroundStroke=function(){return this.backgroundStroke_};b.prototype.getPadding=function(){return this.padding_};b.prototype.setOverflow=function(a){this.overflow_=
a};b.prototype.setFont=function(a){this.font_=a};b.prototype.setMaxAngle=function(a){this.maxAngle_=a};b.prototype.setOffsetX=function(a){this.offsetX_=a};b.prototype.setOffsetY=function(a){this.offsetY_=a};b.prototype.setPlacement=function(a){this.placement_=a};b.prototype.setFill=function(a){this.fill_=a};b.prototype.setRotation=function(a){this.rotation_=a};b.prototype.setScale=function(a){this.scale_=a};b.prototype.setStroke=function(a){this.stroke_=a};b.prototype.setText=function(a){this.text_=
a};b.prototype.setTextAlign=function(a){this.textAlign_=a};b.prototype.setTextBaseline=function(a){this.textBaseline_=a};b.prototype.setBackgroundFill=function(a){this.backgroundFill_=a};b.prototype.setBackgroundStroke=function(a){this.backgroundStroke_=a};b.prototype.setPadding=function(a){this.padding_=a};k.default=b},{"../style/fill.js":225,"../style/textplacement.js":236}],236:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={POINT:"point",LINE:"line"}},{}],237:[function(a,
e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={createOrUpdate:function(a,b,d,e){return void 0!==e?(e[0]=a,e[1]=b,e[2]=d,e):[a,b,d]},getKeyZXY:function(a,b,d){return a+"/"+b+"/"+d},getKey:function(a){return d.getKeyZXY(a[0],a[1],a[2])},fromKey:function(a){return a.split("/").map(Number)},hash:function(a){return(a[1]<<a[0])+a[2]},quadKey:function(a){var b=a[0],c=Array(b),d=1<<b-1,e;for(e=0;e<b;++e){var f=48;a[1]&d&&(f+=1);a[2]&d&&(f+=2);c[e]=String.fromCharCode(f);d>>=1}return c.join("")},
withinExtentAndZ:function(a,b){var c=a[0],d=a[1];a=a[2];if(b.getMinZoom()>c||c>b.getMaxZoom())return!1;var e=b.getExtent();return(b=e?b.getTileRangeForExtentAndZ(e,c):b.getFullTileRange(c))?b.containsXY(d,a):!0}};k.default=d},{}],238:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./size.js");var b=d(e);e=a("./extent.js");var h=d(e);e=a("./extent/corner.js");var n=d(e);e=a("./obj.js");var g=d(e);
e=a("./proj.js");var f=d(e);e=a("./proj/units.js");var l=d(e);a=a("./tilegrid/tilegrid.js");var q=d(a),m={getForProjection:function(a){var b=a.getDefaultTileGrid();b||(b=m.createForProjection(a),a.setDefaultTileGrid(b));return b},wrapX:function(a,b,c){var d=b[0],e=a.getTileCoordCenter(b);c=m.extentFromProjection(c);if(h.default.containsCoordinate(c,e))return b;b=h.default.getWidth(c);e[0]+=b*Math.ceil((c[0]-e[0])/b);return a.getTileCoordForCoordAndZ(e,d)},createForExtent:function(a,b,c,d){d=void 0!==
d?d:n.default.TOP_LEFT;b=m.resolutionsFromExtent(a,b,c);return new q.default({extent:a,origin:h.default.getCorner(a,d),resolutions:b,tileSize:c})},createXYZ:function(a){var b={};g.default.assign(b,void 0!==a?a:{});void 0===b.extent&&(b.extent=f.default.get("EPSG:3857").getExtent());b.resolutions=m.resolutionsFromExtent(b.extent,b.maxZoom,b.tileSize);delete b.maxZoom;return new q.default(b)},resolutionsFromExtent:function(a,d,e){d=void 0!==d?d:c.default.DEFAULT_MAX_ZOOM;var f=h.default.getHeight(a);
a=h.default.getWidth(a);e=b.default.toSize(void 0!==e?e:c.default.DEFAULT_TILE_SIZE);e=Math.max(a/e[0],f/e[1]);d+=1;f=Array(d);for(a=0;a<d;++a)f[a]=e/Math.pow(2,a);return f},createForProjection:function(a,b,c,d){a=m.extentFromProjection(a);return m.createForExtent(a,b,c,d)},extentFromProjection:function(a){a=f.default.get(a);var b=a.getExtent();b||(a=180*f.default.METERS_PER_UNIT[l.default.DEGREES]/a.getMetersPerUnit(),b=h.default.createOrUpdate(-a,-a,a,a));return b}};k.default=m},{"./extent.js":54,
"./extent/corner.js":55,"./index.js":89,"./obj.js":124,"./proj.js":141,"./proj/units.js":148,"./size.js":208,"./tilegrid/tilegrid.js":239}],239:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../asserts.js");var b=d(e);e=a("../tilerange.js");var h=d(e);e=a("../array.js");var n=d(e);e=a("../extent.js");var g=d(e);e=a("../math.js");var f=d(e);e=a("../size.js");var l=d(e);a=a("../tilecoord.js");var q=
d(a),m=function(a){this.minZoom=void 0!==a.minZoom?a.minZoom:0;this.resolutions_=a.resolutions;b.default.assert(n.default.isSorted(this.resolutions_,function(a,b){return b-a},!0),17);if(!a.origins)for(var d=0,e=this.resolutions_.length-1;d<e;++d)if(!f)var f=this.resolutions_[d]/this.resolutions_[d+1];else if(this.resolutions_[d]/this.resolutions_[d+1]!==f){f=void 0;break}this.zoomFactor_=f;this.maxZoom=this.resolutions_.length-1;this.origin_=void 0!==a.origin?a.origin:null;this.origins_=null;void 0!==
a.origins&&(this.origins_=a.origins,b.default.assert(this.origins_.length==this.resolutions_.length,20));f=a.extent;void 0===f||this.origin_||this.origins_||(this.origin_=g.default.getTopLeft(f));b.default.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18);this.tileSizes_=null;void 0!==a.tileSizes&&(this.tileSizes_=a.tileSizes,b.default.assert(this.tileSizes_.length==this.resolutions_.length,19));this.tileSize_=void 0!==a.tileSize?a.tileSize:this.tileSizes_?null:c.default.DEFAULT_TILE_SIZE;
b.default.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22);this.extent_=void 0!==f?f:null;this.fullTileRanges_=null;this.tmpSize_=[0,0];void 0!==a.sizes?this.fullTileRanges_=a.sizes.map(function(a,b){return new h.default(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1))},this):f&&this.calculateTileRanges_(f)};m.tmpTileCoord_=[0,0,0];m.prototype.forEachTileCoord=function(a,b,c){a=this.getTileRangeForExtentAndZ(a,b);for(var d=a.minX,e=a.maxX;d<=
e;++d)for(var f=a.minY,g=a.maxY;f<=g;++f)c([b,d,f])};m.prototype.forEachTileCoordParentTileRange=function(a,b,c,d,e){var f=null,g=a[0]-1;if(2===this.zoomFactor_){var k=a[1];var l=a[2]}else f=this.getTileCoordExtent(a,e);for(;g>=this.minZoom;){2===this.zoomFactor_?(k=Math.floor(k/2),l=Math.floor(l/2),a=h.default.createOrUpdate(k,k,l,l,d)):a=this.getTileRangeForExtentAndZ(f,g,d);if(b.call(c,g,a))return!0;--g}return!1};m.prototype.getExtent=function(){return this.extent_};m.prototype.getMaxZoom=function(){return this.maxZoom};
m.prototype.getMinZoom=function(){return this.minZoom};m.prototype.getOrigin=function(a){return this.origin_?this.origin_:this.origins_[a]};m.prototype.getResolution=function(a){return this.resolutions_[a]};m.prototype.getResolutions=function(){return this.resolutions_};m.prototype.getTileCoordChildTileRange=function(a,b,c){if(a[0]<this.maxZoom){if(2===this.zoomFactor_)return c=2*a[1],a=2*a[2],h.default.createOrUpdate(c,c+1,a,a+1,b);c=this.getTileCoordExtent(a,c);return this.getTileRangeForExtentAndZ(c,
a[0]+1,b)}return null};m.prototype.getTileRangeExtent=function(a,b,c){var d=this.getOrigin(a),e=this.getResolution(a);a=l.default.toSize(this.getTileSize(a),this.tmpSize_);return g.default.createOrUpdate(d[0]+b.minX*a[0]*e,d[1]+b.minY*a[1]*e,d[0]+(b.maxX+1)*a[0]*e,d[1]+(b.maxY+1)*a[1]*e,c)};m.prototype.getTileRangeForExtentAndZ=function(a,b,c){var d=m.tmpTileCoord_;this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,d);var e=d[1],f=d[2];this.getTileCoordForXYAndZ_(a[2],a[3],b,!0,d);return h.default.createOrUpdate(e,
d[1],f,d[2],c)};m.prototype.getTileCoordCenter=function(a){var b=this.getOrigin(a[0]),c=this.getResolution(a[0]),d=l.default.toSize(this.getTileSize(a[0]),this.tmpSize_);return[b[0]+(a[1]+.5)*d[0]*c,b[1]+(a[2]+.5)*d[1]*c]};m.prototype.getTileCoordExtent=function(a,b){var c=this.getOrigin(a[0]),d=this.getResolution(a[0]),e=l.default.toSize(this.getTileSize(a[0]),this.tmpSize_),f=c[0]+a[1]*e[0]*d;a=c[1]+a[2]*e[1]*d;return g.default.createOrUpdate(f,a,f+e[0]*d,a+e[1]*d,b)};m.prototype.getTileCoordForCoordAndResolution=
function(a,b,c){return this.getTileCoordForXYAndResolution_(a[0],a[1],b,!1,c)};m.prototype.getTileCoordForXYAndResolution_=function(a,b,c,d,e){var f=this.getZForResolution(c),g=c/this.getResolution(f),h=this.getOrigin(f),k=l.default.toSize(this.getTileSize(f),this.tmpSize_);a=g*Math.floor((a-h[0])/c+(d?.5:0))/k[0];b=g*Math.floor((b-h[1])/c+(d?0:.5))/k[1];d?(a=Math.ceil(a)-1,b=Math.ceil(b)-1):(a=Math.floor(a),b=Math.floor(b));return q.default.createOrUpdate(f,a,b,e)};m.prototype.getTileCoordForXYAndZ_=
function(a,b,c,d,e){var f=this.getOrigin(c),g=this.getResolution(c),h=l.default.toSize(this.getTileSize(c),this.tmpSize_);a=Math.floor((a-f[0])/g+(d?.5:0))/h[0];b=Math.floor((b-f[1])/g+(d?0:.5))/h[1];d?(a=Math.ceil(a)-1,b=Math.ceil(b)-1):(a=Math.floor(a),b=Math.floor(b));return q.default.createOrUpdate(c,a,b,e)};m.prototype.getTileCoordForCoordAndZ=function(a,b,c){return this.getTileCoordForXYAndZ_(a[0],a[1],b,!1,c)};m.prototype.getTileCoordResolution=function(a){return this.resolutions_[a[0]]};m.prototype.getTileSize=
function(a){return this.tileSize_?this.tileSize_:this.tileSizes_[a]};m.prototype.getFullTileRange=function(a){return this.fullTileRanges_?this.fullTileRanges_[a]:null};m.prototype.getZForResolution=function(a,b){a=n.default.linearFindNearest(this.resolutions_,a,b||0);return f.default.clamp(a,this.minZoom,this.maxZoom)};m.prototype.calculateTileRanges_=function(a){for(var b=this.resolutions_.length,c=Array(b),d=this.minZoom;d<b;++d)c[d]=this.getTileRangeForExtentAndZ(a,d);this.fullTileRanges_=c};k.default=
m},{"../array.js":29,"../asserts.js":31,"../extent.js":54,"../index.js":89,"../math.js":123,"../size.js":208,"../tilecoord.js":237,"../tilerange.js":241}],240:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");e=d(e);var c=a("./tilestate.js"),b=d(c);c=a("./events.js");var h=d(c);c=a("./events/eventtype.js");var n=d(c);a=a("./structs/priorityqueue.js");var g=d(a);a=function(a,b){g.default.call(this,function(b){return a.apply(null,
b)},function(a){return a[0].getKey()});this.tileChangeCallback_=b;this.tilesLoading_=0;this.tilesLoadingKeys_={}};e.default.inherits(a,g.default);a.prototype.enqueue=function(a){var b=g.default.prototype.enqueue.call(this,a);b&&h.default.listen(a[0],n.default.CHANGE,this.handleTileChange,this);return b};a.prototype.getTilesLoading=function(){return this.tilesLoading_};a.prototype.handleTileChange=function(a){a=a.target;var c=a.getState();if(c===b.default.LOADED||c===b.default.ERROR||c===b.default.EMPTY||
c===b.default.ABORT)h.default.unlisten(a,n.default.CHANGE,this.handleTileChange,this),a=a.getKey(),a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()};a.prototype.loadMoreTiles=function(a,c){for(var d=0,e=!1,f,g,h;this.tilesLoading_<a&&d<c&&0<this.getCount();)g=this.dequeue()[0],h=g.getKey(),f=g.getState(),f===b.default.ABORT?e=!0:f!==b.default.IDLE||h in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[h]=!0,++this.tilesLoading_,++d,g.load());
0===d&&e&&this.tileChangeCallback_()};k.default=a},{"./events.js":48,"./events/eventtype.js":52,"./index.js":89,"./structs/priorityqueue.js":219,"./tilestate.js":242}],241:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=function(a,b,d,e){this.minX=a;this.maxX=b;this.minY=d;this.maxY=e};d.createOrUpdate=function(a,b,e,k,g){return void 0!==g?(g.minX=a,g.maxX=b,g.minY=e,g.maxY=k,g):new d(a,b,e,k)};d.prototype.contains=function(a){return this.containsXY(a[1],a[2])};d.prototype.containsTileRange=
function(a){return this.minX<=a.minX&&a.maxX<=this.maxX&&this.minY<=a.minY&&a.maxY<=this.maxY};d.prototype.containsXY=function(a,b){return this.minX<=a&&a<=this.maxX&&this.minY<=b&&b<=this.maxY};d.prototype.equals=function(a){return this.minX==a.minX&&this.minY==a.minY&&this.maxX==a.maxX&&this.maxY==a.maxY};d.prototype.extend=function(a){a.minX<this.minX&&(this.minX=a.minX);a.maxX>this.maxX&&(this.maxX=a.maxX);a.minY<this.minY&&(this.minY=a.minY);a.maxY>this.maxY&&(this.maxY=a.maxY)};d.prototype.getHeight=
function(){return this.maxY-this.minY+1};d.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]};d.prototype.getWidth=function(){return this.maxX-this.minX+1};d.prototype.intersects=function(a){return this.minX<=a.maxX&&this.maxX>=a.minX&&this.minY<=a.maxY&&this.maxY>=a.minY};k.default=d},{}],242:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5}},{}],243:[function(a,e,k){Object.defineProperty(k,"__esModule",
{value:!0});var d=(a=a("./asserts.js"))&&a.__esModule?a:{default:a},c={};c.tmp_=Array(6);c.create=function(){return[1,0,0,1,0,0]};c.reset=function(a){return c.set(a,1,0,0,1,0,0)};c.multiply=function(a,c){var b=a[0],d=a[1],e=a[2],h=a[3],k=a[4],m=a[5],p=c[0],r=c[1],t=c[2],u=c[3],y=c[4];c=c[5];a[0]=b*p+e*r;a[1]=d*p+h*r;a[2]=b*t+e*u;a[3]=d*t+h*u;a[4]=b*y+e*c+k;a[5]=d*y+h*c+m;return a};c.set=function(a,c,d,e,f,k,q){a[0]=c;a[1]=d;a[2]=e;a[3]=f;a[4]=k;a[5]=q;return a};c.setFromArray=function(a,c){a[0]=c[0];
a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];return a};c.apply=function(a,c){var b=c[0],d=c[1];c[0]=a[0]*b+a[2]*d+a[4];c[1]=a[1]*b+a[3]*d+a[5];return c};c.rotate=function(a,d){var b=Math.cos(d);d=Math.sin(d);return c.multiply(a,c.set(c.tmp_,b,d,-d,b,0,0))};c.scale=function(a,d,e){return c.multiply(a,c.set(c.tmp_,d,0,0,e,0,0))};c.translate=function(a,d,e){return c.multiply(a,c.set(c.tmp_,1,0,0,1,d,e))};c.compose=function(a,c,d,e,f,k,q,m){var b=Math.sin(k);k=Math.cos(k);a[0]=e*k;a[1]=f*b;a[2]=
-e*b;a[3]=f*k;a[4]=q*e*k-m*e*b+c;a[5]=q*f*b+m*f*k+d;return a};c.invert=function(a){var b=c.determinant(a);d.default.assert(0!==b,32);var e=a[0],g=a[1],f=a[2],k=a[3],q=a[4],m=a[5];a[0]=k/b;a[1]=-g/b;a[2]=-f/b;a[3]=e/b;a[4]=(f*m-k*q)/b;a[5]=-(e*m-g*q)/b;return a};c.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};k.default=c},{"./asserts.js":31}],244:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={create:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},fromTransform:function(a,
c){a[0]=c[0];a[1]=c[1];a[4]=c[2];a[5]=c[3];a[12]=c[4];a[13]=c[5];return a}}},{}],245:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("./index.js");var c=d(e);e=a("./centerconstraint.js");var b=d(e);e=a("./object.js");var h=d(e);e=a("./resolutionconstraint.js");var n=d(e);e=a("./rotationconstraint.js");var g=d(e);e=a("./viewhint.js");var f=d(e);e=a("./viewproperty.js");var l=d(e);e=a("./array.js");var q=d(e);e=a("./asserts.js");
var m=d(e);e=a("./coordinate.js");var p=d(e);e=a("./easing.js");var r=d(e);e=a("./extent.js");var t=d(e);e=a("./geom/geometrytype.js");var u=d(e);e=a("./geom/polygon.js");var y=d(e);e=a("./geom/simplegeometry.js");var w=d(e);e=a("./math.js");var v=d(e);e=a("./obj.js");var A=d(e);e=a("./proj.js");var B=d(e);a=a("./proj/units.js");var x=d(a),z=function(a){h.default.call(this);a=A.default.assign({},a);this.hints_=[0,0];this.animations_=[];this.updateAnimationKey_;this.updateAnimations_=this.updateAnimations_.bind(this);
this.projection_=B.default.createProjection(a.projection,"EPSG:3857");this.applyOptions_(a)};c.default.inherits(z,h.default);z.prototype.applyOptions_=function(a){var b={};b[l.default.CENTER]=void 0!==a.center?a.center:null;var c=z.createResolutionConstraint_(a);this.maxResolution_=c.maxResolution;this.minResolution_=c.minResolution;this.zoomFactor_=c.zoomFactor;this.resolutions_=a.resolutions;this.minZoom_=c.minZoom;var d=z.createCenterConstraint_(a);c=c.constraint;var e=z.createRotationConstraint_(a);
this.constraints_={center:d,resolution:c,rotation:e};void 0!==a.resolution?b[l.default.RESOLUTION]=a.resolution:void 0!==a.zoom&&(b[l.default.RESOLUTION]=this.constrainResolution(this.maxResolution_,a.zoom-this.minZoom_),this.resolutions_&&(b[l.default.RESOLUTION]=v.default.clamp(Number(this.getResolution()||b[l.default.RESOLUTION]),this.minResolution_,this.maxResolution_)));b[l.default.ROTATION]=void 0!==a.rotation?a.rotation:0;this.setProperties(b);this.options_=a};z.prototype.getUpdatedOptions_=
function(a){var b=A.default.assign({},this.options_);void 0!==b.resolution?b.resolution=this.getResolution():b.zoom=this.getZoom();b.center=this.getCenter();b.rotation=this.getRotation();return A.default.assign({},b,a)};z.prototype.animate=function(a){var b=arguments.length;if(1<b&&"function"===typeof arguments[b-1]){var c=arguments[b-1];--b}if(this.isDef()){for(var d=Date.now(),e=this.getCenter().slice(),g=this.getResolution(),h=this.getRotation(),k=[],l=0;l<b;++l){var m=arguments[l],n={start:d,
complete:!1,anchor:m.anchor,duration:void 0!==m.duration?m.duration:1E3,easing:m.easing||r.default.inAndOut};m.center&&(n.sourceCenter=e,n.targetCenter=m.center,e=n.targetCenter);void 0!==m.zoom?(n.sourceResolution=g,n.targetResolution=this.constrainResolution(this.maxResolution_,m.zoom-this.minZoom_,0),g=n.targetResolution):m.resolution&&(n.sourceResolution=g,n.targetResolution=m.resolution,g=n.targetResolution);void 0!==m.rotation&&(n.sourceRotation=h,m=v.default.modulo(m.rotation-h+Math.PI,2*Math.PI)-
Math.PI,n.targetRotation=h+m,h=n.targetRotation);n.callback=c;z.isNoopAnimation(n)?n.complete=!0:d+=n.duration;k.push(n)}this.animations_.push(k);this.setHint(f.default.ANIMATING,1);this.updateAnimations_()}else b=arguments[b-1],b.center&&this.setCenter(b.center),void 0!==b.zoom&&this.setZoom(b.zoom),void 0!==b.rotation&&this.setRotation(b.rotation),c&&c(!0)};z.prototype.getAnimating=function(){return 0<this.hints_[f.default.ANIMATING]};z.prototype.getInteracting=function(){return 0<this.hints_[f.default.INTERACTING]};
z.prototype.cancelAnimations=function(){this.setHint(f.default.ANIMATING,-this.hints_[f.default.ANIMATING]);for(var a=0,b=this.animations_.length;a<b;++a){var c=this.animations_[a];c[0].callback&&c[0].callback(!1)}this.animations_.length=0};z.prototype.updateAnimations_=function(){void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0);if(this.getAnimating()){for(var a=Date.now(),b=!1,c=this.animations_.length-1;0<=c;--c){for(var d=this.animations_[c],
e=!0,g=0,h=d.length;g<h;++g){var k=d[g];if(!k.complete){b=a-k.start;b=0<k.duration?b/k.duration:1;1<=b?(k.complete=!0,b=1):e=!1;b=k.easing(b);if(k.sourceCenter){var m=k.sourceCenter[0],n=k.sourceCenter[1];this.set(l.default.CENTER,[m+b*(k.targetCenter[0]-m),n+b*(k.targetCenter[1]-n)])}k.sourceResolution&&k.targetResolution&&(m=1===b?k.targetResolution:k.sourceResolution+b*(k.targetResolution-k.sourceResolution),k.anchor&&this.set(l.default.CENTER,this.calculateCenterZoom(m,k.anchor)),this.set(l.default.RESOLUTION,
m));void 0!==k.sourceRotation&&void 0!==k.targetRotation&&(b=1===b?v.default.modulo(k.targetRotation+Math.PI,2*Math.PI)-Math.PI:k.sourceRotation+b*(k.targetRotation-k.sourceRotation),k.anchor&&this.set(l.default.CENTER,this.calculateCenterRotate(b,k.anchor)),this.set(l.default.ROTATION,b));b=!0;if(!k.complete)break}}e&&(this.animations_[c]=null,this.setHint(f.default.ANIMATING,-1),(d=d[0].callback)&&d(!0))}this.animations_=this.animations_.filter(Boolean);b&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=
requestAnimationFrame(this.updateAnimations_))}};z.prototype.calculateCenterRotate=function(a,b){var c=this.getCenter();if(void 0!==c){var d=[c[0]-b[0],c[1]-b[1]];p.default.rotate(d,a-this.getRotation());p.default.add(d,b)}return d};z.prototype.calculateCenterZoom=function(a,b){var c,d=this.getCenter(),e=this.getResolution();void 0!==d&&void 0!==e&&(c=[b[0]-a*(b[0]-d[0])/e,b[1]-a*(b[1]-d[1])/e]);return c};z.prototype.getSizeFromViewport_=function(){var a=[100,100],b='.ol-viewport[data-view="'+c.default.getUid(this)+
'"]';if(b=document.querySelector(b))b=getComputedStyle(b),a[0]=parseInt(b.width,10),a[1]=parseInt(b.height,10);return a};z.prototype.constrainCenter=function(a){return this.constraints_.center(a)};z.prototype.constrainResolution=function(a,b,c){return this.constraints_.resolution(a,b||0,c||0)};z.prototype.constrainRotation=function(a,b){return this.constraints_.rotation(a,b||0)};z.prototype.getCenter=function(){return this.get(l.default.CENTER)};z.prototype.getConstraints=function(){return this.constraints_};
z.prototype.getHints=function(a){return void 0!==a?(a[0]=this.hints_[0],a[1]=this.hints_[1],a):this.hints_.slice()};z.prototype.calculateExtent=function(a){a=a||this.getSizeFromViewport_();var b=this.getCenter();m.default.assert(b,1);var c=this.getResolution();m.default.assert(void 0!==c,2);var d=this.getRotation();m.default.assert(void 0!==d,3);return t.default.getForViewAndSize(b,c,d,a)};z.prototype.getMaxResolution=function(){return this.maxResolution_};z.prototype.getMinResolution=function(){return this.minResolution_};
z.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)};z.prototype.setMaxZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({maxZoom:a}))};z.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)};z.prototype.setMinZoom=function(a){this.applyOptions_(this.getUpdatedOptions_({minZoom:a}))};z.prototype.getProjection=function(){return this.projection_};z.prototype.getResolution=function(){return this.get(l.default.RESOLUTION)};
z.prototype.getResolutions=function(){return this.resolutions_};z.prototype.getResolutionForExtent=function(a,b){var c=b||this.getSizeFromViewport_();b=t.default.getWidth(a)/c[0];a=t.default.getHeight(a)/c[1];return Math.max(b,a)};z.prototype.getResolutionForValueFunction=function(a){var b=a||2,c=this.maxResolution_,d=Math.log(c/this.minResolution_)/Math.log(b);return function(a){return c/Math.pow(b,a*d)}};z.prototype.getRotation=function(){return this.get(l.default.ROTATION)};z.prototype.getValueForResolutionFunction=
function(a){var b=a||2,c=this.maxResolution_,d=Math.log(c/this.minResolution_)/Math.log(b);return function(a){return Math.log(c/a)/Math.log(b)/d}};z.prototype.getState=function(){var a=this.getCenter(),b=this.getProjection(),c=this.getResolution(),d=this.getRotation();return{center:a.slice(),projection:void 0!==b?b:null,resolution:c,rotation:d,zoom:this.getZoom()}};z.prototype.getZoom=function(){var a,b=this.getResolution();void 0!==b&&(a=this.getZoomForResolution(b));return a};z.prototype.getZoomForResolution=
function(a){var b=this.minZoom_||0,c;if(this.resolutions_){b=c=q.default.linearFindNearest(this.resolutions_,a,1);var d=this.resolutions_[c];c=c==this.resolutions_.length-1?2:d/this.resolutions_[c+1]}else d=this.maxResolution_,c=this.zoomFactor_;return b+Math.log(d/a)/Math.log(c)};z.prototype.getResolutionForZoom=function(a){return this.constrainResolution(this.maxResolution_,a-this.minZoom_,0)};z.prototype.fit=function(a,b){b=b||{};var d=b.size;d||(d=this.getSizeFromViewport_());if(a instanceof w.default)if(a.getType()===
u.default.CIRCLE){a=a.getExtent();var e=y.default.fromExtent(a);e.rotate(this.getRotation(),t.default.getCenter(a))}else e=a;else m.default.assert(Array.isArray(a),24),m.default.assert(!t.default.isEmpty(a),25),e=y.default.fromExtent(a);var f=void 0!==b.padding?b.padding:[0,0,0,0],g=void 0!==b.constrainResolution?b.constrainResolution:!0,h=void 0!==b.nearest?b.nearest:!1;var k=void 0!==b.minResolution?b.minResolution:void 0!==b.maxZoom?this.constrainResolution(this.maxResolution_,b.maxZoom-this.minZoom_,
0):0;var l=e.getFlatCoordinates(),n=this.getRotation();a=Math.cos(-n);n=Math.sin(-n);var p=Infinity,q=Infinity,r=-Infinity,v=-Infinity;e=e.getStride();for(var x=0,A=l.length;x<A;x+=e){var C=l[x]*a-l[x+1]*n,z=l[x]*n+l[x+1]*a;p=Math.min(p,C);q=Math.min(q,z);r=Math.max(r,C);v=Math.max(v,z)}d=this.getResolutionForExtent([p,q,r,v],[d[0]-f[1]-f[3],d[1]-f[0]-f[2]]);d=isNaN(d)?k:Math.max(d,k);g&&(g=this.constrainResolution(d,0,0),!h&&g<d&&(g=this.constrainResolution(g,-1,0)),d=g);n=-n;h=(p+r)/2+(f[1]-f[3])/
2*d;f=(q+v)/2+(f[0]-f[2])/2*d;a=[h*a-f*n,f*a+h*n];f=b.callback?b.callback:c.default.nullFunction;void 0!==b.duration?this.animate({resolution:d,center:a,duration:b.duration,easing:b.easing},f):(this.setResolution(d),this.setCenter(a),setTimeout(f.bind(void 0,!0),0))};z.prototype.centerOn=function(a,b,c){var d=this.getRotation(),e=Math.cos(-d);d=Math.sin(-d);var f=a[0]*e-a[1]*d;a=a[1]*e+a[0]*d;var g=this.getResolution();f+=(b[0]/2-c[0])*g;a+=(c[1]-b[1]/2)*g;d=-d;this.setCenter([f*e-a*d,a*e+f*d])};
z.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()};z.prototype.rotate=function(a,b){void 0!==b&&(b=this.calculateCenterRotate(a,b),this.setCenter(b));this.setRotation(a)};z.prototype.setCenter=function(a){this.set(l.default.CENTER,a);this.getAnimating()&&this.cancelAnimations()};z.prototype.setHint=function(a,b){this.hints_[a]+=b;this.changed();return this.hints_[a]};z.prototype.setResolution=function(a){this.set(l.default.RESOLUTION,a);this.getAnimating()&&this.cancelAnimations()};
z.prototype.setRotation=function(a){this.set(l.default.ROTATION,a);this.getAnimating()&&this.cancelAnimations()};z.prototype.setZoom=function(a){this.setResolution(this.getResolutionForZoom(a))};z.createCenterConstraint_=function(a){return void 0!==a.extent?b.default.createExtent(a.extent):b.default.none};z.createResolutionConstraint_=function(a){var b=void 0!==a.minZoom?a.minZoom:c.default.DEFAULT_MIN_ZOOM;var d=void 0!==a.maxZoom?a.maxZoom:28;var e=void 0!==a.zoomFactor?a.zoomFactor:2;if(void 0!==
a.resolutions){a=a.resolutions;var f=a[b];var g=void 0!==a[d]?a[d]:a[a.length-1];d=n.default.createSnapToResolutions(a)}else{f=B.default.createProjection(a.projection,"EPSG:3857");g=f.getExtent();var h=(g?Math.max(t.default.getWidth(g),t.default.getHeight(g)):360*B.default.METERS_PER_UNIT[x.default.DEGREES]/f.getMetersPerUnit())/c.default.DEFAULT_TILE_SIZE/Math.pow(2,c.default.DEFAULT_MIN_ZOOM),k=h/Math.pow(2,28-c.default.DEFAULT_MIN_ZOOM);f=a.maxResolution;void 0!==f?b=0:f=h/Math.pow(e,b);g=a.minResolution;
void 0===g&&(g=void 0!==a.maxZoom?void 0!==a.maxResolution?f/Math.pow(e,d):h/Math.pow(e,d):k);d=b+Math.floor(Math.log(f/g)/Math.log(e));g=f/Math.pow(e,d-b);d=n.default.createSnapToPower(e,f,d-b)}return{constraint:d,maxResolution:f,minResolution:g,minZoom:b,zoomFactor:e}};z.createRotationConstraint_=function(a){return(void 0!==a.enableRotation?a.enableRotation:1)?(a=a.constrainRotation,void 0===a||!0===a?g.default.createSnapToZero():!1===a?g.default.none:"number"===typeof a?g.default.createSnapToN(a):
g.default.none):g.default.disable};z.isNoopAnimation=function(a){return a.sourceCenter&&a.targetCenter&&!p.default.equals(a.sourceCenter,a.targetCenter)||a.sourceResolution!==a.targetResolution||a.sourceRotation!==a.targetRotation?!1:!0};k.default=z},{"./array.js":29,"./asserts.js":31,"./centerconstraint.js":33,"./coordinate.js":43,"./easing.js":47,"./extent.js":54,"./geom/geometrytype.js":79,"./geom/polygon.js":82,"./geom/simplegeometry.js":83,"./index.js":89,"./math.js":123,"./obj.js":124,"./object.js":125,
"./proj.js":141,"./proj/units.js":148,"./resolutionconstraint.js":206,"./rotationconstraint.js":207,"./viewhint.js":246,"./viewproperty.js":247}],246:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={ANIMATING:0,INTERACTING:1}},{}],247:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"}},{}],248:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d={ONE:1,SRC_ALPHA:770,
COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,TRIANGLES:4,TRIANGLE_STRIP:5,ONE_MINUS_SRC_ALPHA:771,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,CULL_FACE:2884,BLEND:3042,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126,RGBA:6408,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,LINK_STATUS:35714,LINEAR:9729,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,
TEXTURE_2D:3553,TEXTURE0:33984,CLAMP_TO_EDGE:33071,COMPILE_STATUS:35713,FRAMEBUFFER:36160,CONTEXT_IDS_:["experimental-webgl","webgl","webkit-3d","moz-webgl"],getContext:function(a,b){var c,e,g=d.CONTEXT_IDS_.length;for(e=0;e<g;++e)try{if(c=a.getContext(d.CONTEXT_IDS_[e],b))return c}catch(f){}return null}};k.default=d},{}],249:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=(a=a("../webgl.js"))&&a.__esModule?a:{default:a};var d=function(a,b){this.arr_=void 0!==a?a:[];this.usage_=
void 0!==b?b:d.Usage_.STATIC_DRAW};d.prototype.getArray=function(){return this.arr_};d.prototype.getUsage=function(){return this.usage_};d.Usage_={STATIC_DRAW:a.default.STATIC_DRAW,STREAM_DRAW:a.default.STREAM_DRAW,DYNAMIC_DRAW:a.default.DYNAMIC_DRAW};k.default=d},{"../webgl.js":248}],250:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");var c=d(e);e=a("../disposable.js");e=d(e);var b=a("../array.js"),h=d(b);b=a("../events.js");
var n=d(b);b=a("../obj.js");var g=d(b);b=a("../webgl.js");var f=d(b);a=a("../webgl/contexteventtype.js");var l=d(a),q=function(a,b){this.canvas_=a;this.gl_=b;this.bufferCache_={};this.shaderCache_={};this.programCache_={};this.hitDetectionRenderbuffer_=this.hitDetectionTexture_=this.hitDetectionFramebuffer_=this.currentProgram_=null;(this.hasOESElementIndexUint=h.default.includes(c.default.WEBGL_EXTENSIONS,"OES_element_index_uint"))&&b.getExtension("OES_element_index_uint");n.default.listen(this.canvas_,
l.default.LOST,this.handleWebGLContextLost,this);n.default.listen(this.canvas_,l.default.RESTORED,this.handleWebGLContextRestored,this)};c.default.inherits(q,e.default);q.prototype.bindBuffer=function(a,b){var d=this.getGL(),e=b.getArray(),g=String(c.default.getUid(b));if(g in this.bufferCache_)d.bindBuffer(a,this.bufferCache_[g].buffer);else{var h=d.createBuffer();d.bindBuffer(a,h);var k;a==f.default.ARRAY_BUFFER?k=new Float32Array(e):a==f.default.ELEMENT_ARRAY_BUFFER&&(k=this.hasOESElementIndexUint?
new Uint32Array(e):new Uint16Array(e));d.bufferData(a,k,b.getUsage());this.bufferCache_[g]={buf:b,buffer:h}}};q.prototype.deleteBuffer=function(a){var b=this.getGL();a=String(c.default.getUid(a));var d=this.bufferCache_[a];b.isContextLost()||b.deleteBuffer(d.buffer);delete this.bufferCache_[a]};q.prototype.disposeInternal=function(){n.default.unlistenAll(this.canvas_);var a=this.getGL();if(!a.isContextLost()){for(var b in this.bufferCache_)a.deleteBuffer(this.bufferCache_[b].buffer);for(b in this.programCache_)a.deleteProgram(this.programCache_[b]);
for(b in this.shaderCache_)a.deleteShader(this.shaderCache_[b]);a.deleteFramebuffer(this.hitDetectionFramebuffer_);a.deleteRenderbuffer(this.hitDetectionRenderbuffer_);a.deleteTexture(this.hitDetectionTexture_)}};q.prototype.getCanvas=function(){return this.canvas_};q.prototype.getGL=function(){return this.gl_};q.prototype.getHitDetectionFramebuffer=function(){this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_();return this.hitDetectionFramebuffer_};q.prototype.getShader=function(a){var b=
String(c.default.getUid(a));if(b in this.shaderCache_)return this.shaderCache_[b];var d=this.getGL(),e=d.createShader(a.getType());d.shaderSource(e,a.getSource());d.compileShader(e);return this.shaderCache_[b]=e};q.prototype.getProgram=function(a,b){var d=c.default.getUid(a)+"/"+c.default.getUid(b);if(d in this.programCache_)return this.programCache_[d];var e=this.getGL(),f=e.createProgram();e.attachShader(f,this.getShader(a));e.attachShader(f,this.getShader(b));e.linkProgram(f);return this.programCache_[d]=
f};q.prototype.handleWebGLContextLost=function(){g.default.clear(this.bufferCache_);g.default.clear(this.shaderCache_);g.default.clear(this.programCache_);this.hitDetectionRenderbuffer_=this.hitDetectionTexture_=this.hitDetectionFramebuffer_=this.currentProgram_=null};q.prototype.handleWebGLContextRestored=function(){};q.prototype.initHitDetectionFramebuffer_=function(){var a=this.gl_,b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);var c=q.createEmptyTexture(a,1,1),d=a.createRenderbuffer();
a.bindRenderbuffer(a.RENDERBUFFER,d);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,1,1);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,d);a.bindTexture(a.TEXTURE_2D,null);a.bindRenderbuffer(a.RENDERBUFFER,null);a.bindFramebuffer(a.FRAMEBUFFER,null);this.hitDetectionFramebuffer_=b;this.hitDetectionTexture_=c;this.hitDetectionRenderbuffer_=d};q.prototype.useProgram=function(a){if(a==this.currentProgram_)return!1;
this.getGL().useProgram(a);this.currentProgram_=a;return!0};q.createTexture_=function(a,b,c){var d=a.createTexture();a.bindTexture(a.TEXTURE_2D,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);void 0!==b&&a.texParameteri(f.default.TEXTURE_2D,f.default.TEXTURE_WRAP_S,b);void 0!==c&&a.texParameteri(f.default.TEXTURE_2D,f.default.TEXTURE_WRAP_T,c);return d};q.createEmptyTexture=function(a,b,c,d,e){d=q.createTexture_(a,d,e);a.texImage2D(a.TEXTURE_2D,
0,a.RGBA,b,c,0,a.RGBA,a.UNSIGNED_BYTE,null);return d};q.createTexture=function(a,b,c,d){c=q.createTexture_(a,c,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);return c};k.default=q},{"../array.js":29,"../disposable.js":45,"../events.js":48,"../index.js":89,"../obj.js":124,"../webgl.js":248,"../webgl/contexteventtype.js":251}],251:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});k.default={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"}},{}],252:[function(a,
e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../webgl.js"),b=d(c);a=a("../webgl/shader.js");var h=d(a);a=function(a){h.default.call(this,a)};e.default.inherits(a,h.default);a.prototype.getType=function(){return b.default.FRAGMENT_SHADER};k.default=a},{"../index.js":89,"../webgl.js":248,"../webgl/shader.js":253}],253:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});a=(a=a("../functions.js"))&&
a.__esModule?a:{default:a};e=function(a){this.source_=a};e.prototype.getType=function(){};e.prototype.getSource=function(){return this.source_};e.prototype.isAnimated=a.default.FALSE;k.default=e},{"../functions.js":60}],254:[function(a,e,k){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(k,"__esModule",{value:!0});e=a("../index.js");e=d(e);var c=a("../webgl.js"),b=d(c);a=a("../webgl/shader.js");var h=d(a);a=function(a){h.default.call(this,a)};e.default.inherits(a,h.default);
a.prototype.getType=function(){return b.default.VERTEX_SHADER};k.default=a},{"../index.js":89,"../webgl.js":248,"../webgl/shader.js":253}],255:[function(a,e,k){Object.defineProperty(k,"__esModule",{value:!0});var d=(a=a("./array.js"))&&a.__esModule?a:{default:a},c={};c.DOCUMENT=document.implementation.createDocument("","",null);c.createElementNS=function(a,d){return c.DOCUMENT.createElementNS(a,d)};c.getAllTextContent=function(a,d){return c.getAllTextContent_(a,d,[]).join("")};c.getAllTextContent_=
function(a,d,e){if(a.nodeType==Node.CDATA_SECTION_NODE||a.nodeType==Node.TEXT_NODE)d?e.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):e.push(a.nodeValue);else for(a=a.firstChild;a;a=a.nextSibling)c.getAllTextContent_(a,d,e);return e};c.isDocument=function(a){return a instanceof Document};c.isNode=function(a){return a instanceof Node};c.getAttributeNS=function(a,c,d){return a.getAttributeNS(c,d)||""};c.setAttributeNS=function(a,c,d,e){a.setAttributeNS(c,d,e)};c.parse=function(a){return(new DOMParser).parseFromString(a,
"application/xml")};c.makeArrayExtender=function(a,c){return function(b,e){b=a.call(c,b,e);void 0!==b&&d.default.extend(e[e.length-1],b)}};c.makeArrayPusher=function(a,c){return function(b,d){b=a.call(void 0!==c?c:this,b,d);void 0!==b&&d[d.length-1].push(b)}};c.makeReplacer=function(a,c){return function(b,d){b=a.call(void 0!==c?c:this,b,d);void 0!==b&&(d[d.length-1]=b)}};c.makeObjectPropertyPusher=function(a,c,d){return function(b,e){var f=a.call(void 0!==d?d:this,b,e);void 0!==f&&(e=e[e.length-1],
b=void 0!==c?c:b.localName,(b in e?e[b]:e[b]=[]).push(f))}};c.makeObjectPropertySetter=function(a,c,d){return function(b,e){var f=a.call(void 0!==d?d:this,b,e);void 0!==f&&(e[e.length-1][void 0!==c?c:b.localName]=f)}};c.makeChildAppender=function(a,c){return function(b,d,e){a.call(void 0!==c?c:this,b,d,e);e[e.length-1].node.appendChild(b)}};c.makeArraySerializer=function(a,d){var b,e;return function(d,g,h){if(void 0===b){b={};var f={};f[d.localName]=a;b[d.namespaceURI]=f;e=c.makeSimpleNodeFactory(d.localName)}c.serialize(b,
e,g,h)}};c.makeSimpleNodeFactory=function(a,d){return function(b,e,f){b=e[e.length-1].node;e=a;void 0===e&&(e=f);f=d;void 0===d&&(f=b.namespaceURI);return c.createElementNS(f,e)}};c.OBJECT_PROPERTY_NODE_FACTORY=c.makeSimpleNodeFactory();c.makeSequence=function(a,c){for(var b=c.length,d=Array(b),e=0;e<b;++e)d[e]=a[c[e]];return d};c.makeStructureNS=function(a,c,d){d=void 0!==d?d:{};var b;var e=0;for(b=a.length;e<b;++e)d[a[e]]=c;return d};c.parseNode=function(a,c,d,e){for(c=c.firstElementChild;c;c=c.nextElementSibling){var b=
a[c.namespaceURI];void 0!==b&&(b=b[c.localName],void 0!==b&&b.call(e,c,d))}};c.pushParseAndPop=function(a,d,e,g,f){g.push(a);c.parseNode(d,e,g,f);return g.pop()};c.serialize=function(a,c,d,e,f,k){for(var b=(void 0!==f?f:d).length,g,h,l=0;l<b;++l)g=d[l],void 0!==g&&(h=c.call(k,g,e,void 0!==f?f[l]:void 0),void 0!==h&&a[h.namespaceURI][h.localName].call(k,h,g,e))};c.pushSerializeAndPop=function(a,d,e,g,f,k,q){f.push(a);c.serialize(d,e,g,f,k,q);return f.pop()};k.default=c},{"./array.js":29}],256:[function(a,
e,k){function d(){throw Error("setTimeout has not been defined");}function c(){throw Error("clearTimeout has not been defined");}function b(a){if(q===setTimeout)return setTimeout(a,0);if((q===d||!q)&&setTimeout)return q=setTimeout,setTimeout(a,0);try{return q(a,0)}catch(w){try{return q.call(null,a,0)}catch(v){return q.call(this,a,0)}}}function h(a){if(m===clearTimeout)return clearTimeout(a);if((m===c||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(w){try{return m.call(null,
a)}catch(v){return m.call(this,a)}}}function n(){r&&t&&(r=!1,t.length?p=t.concat(p):u=-1,p.length&&g())}function g(){if(!r){var a=b(n);r=!0;for(var c=p.length;c;){t=p;for(p=[];++u<c;)t&&t[u].run();u=-1;c=p.length}t=null;r=!1;h(a)}}function f(a,b){this.fun=a;this.array=b}function l(){}a=e.exports={};try{var q="function"===typeof setTimeout?setTimeout:d}catch(y){q=d}try{var m="function"===typeof clearTimeout?clearTimeout:c}catch(y){m=c}var p=[],r=!1,t,u=-1;a.nextTick=function(a){var c=Array(arguments.length-
1);if(1<arguments.length)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];p.push(new f(a,c));1!==p.length||r||b(g)};f.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=l;a.addListener=l;a.once=l;a.off=l;a.removeListener=l;a.removeAllListeners=l;a.emit=l;a.prependListener=l;a.prependOnceListener=l;a.listeners=function(a){return[]};a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=
function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],257:[function(a,e,k){(function(a,c){"object"===typeof k&&"undefined"!==typeof e?e.exports=c():"function"===typeof define&&define.amd?define(c):a.quickselect=c()})(this,function(){function a(b,d,e,f,k){for(;f>e;){if(600<f-e){var g=f-e+1,h=d-e+1,l=Math.log(g),n=.5*Math.exp(2*l/3);l=.5*Math.sqrt(l*n*(g-n)/g)*(0>h-g/2?-1:1);a(b,d,Math.max(e,Math.floor(d-h*n/g+l)),Math.min(f,Math.floor(d+
(g-h)*n/g+l)),k)}g=b[d];h=e;n=f;c(b,e,d);for(0<k(b[f],g)&&c(b,e,f);h<n;){c(b,h,n);h++;for(n--;0>k(b[h],g);)h++;for(;0<k(b[n],g);)n--}0===k(b[e],g)?c(b,e,n):(n++,c(b,n,f));n<=d&&(e=n+1);d<=n&&(f=n-1)}}function c(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function b(a,b){return a<b?-1:a>b?1:0}return function(c,d,e,f,k){a(c,d,e||0,f||c.length-1,k||b)}})},{}],258:[function(a,e,k){function d(a,b){if(!(this instanceof d))return new d(a,b);this._maxEntries=Math.max(4,a||9);this._minEntries=Math.max(2,Math.ceil(.4*
this._maxEntries));b&&this._initFormat(b);this.clear()}function c(a,c){b(a,0,a.children.length,c,a)}function b(a,b,c,d,e){e||(e=p(null));e.minX=Infinity;e.minY=Infinity;e.maxX=-Infinity;e.maxY=-Infinity;for(var f;b<c;b++)f=a.children[b],h(e,a.leaf?d(f):f);return e}function h(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function n(a,b){return a.minX-b.minX}function g(a,b){return a.minY-b.minY}function f(a){return(a.maxX-
a.minX)*(a.maxY-a.minY)}function l(a){return a.maxX-a.minX+(a.maxY-a.minY)}function q(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function m(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function p(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function r(a,b,c,d,e){for(var f=[b,c],g;f.length;)c=f.pop(),b=f.pop(),c-b<=d||(g=b+Math.ceil((c-b)/d/2)*d,t(a,g,b,c,e),f.push(b,g,g,c))}e.exports=
d;var t=a("quickselect");d.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!m(a,b))return c;for(var e=[],f,g,h,k;b;){f=0;for(g=b.children.length;f<g;f++)h=b.children[f],k=b.leaf?d(h):h,m(a,k)&&(b.leaf?c.push(h):q(a,k)?this._all(h,c):e.push(h));b=e.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!m(a,b))return!1;for(var d=[],e,f,g,h;b;){e=0;for(f=b.children.length;e<f;e++)if(g=b.children[e],h=b.leaf?c(g):g,m(a,
h)){if(b.leaf||q(a,h))return!0;d.push(g)}b=d.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-
1);return this},clear:function(){this.data=p([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,d=this.toBBox(a),e=[],f=[],g,h,k,l;c||e.length;){c||(c=e.pop(),h=e[e.length-1],g=f.pop(),l=!0);if(c.leaf){a:{k=a;var m=c.children,n=b;if(n){for(var p=0;p<m.length;p++)if(n(k,m[p])){k=p;break a}k=-1}else k=m.indexOf(k)}if(-1!==k){c.children.splice(k,1);e.push(c);this._condense(e);break}}l||c.leaf||!q(c,d)?h?(g++,c=h.children[g],l=!1):c=null:(e.push(c),f.push(g),g=0,h=c,c=c.children[0])}return this},
toBBox:function(a){return a},compareMinX:n,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,d,e){var f=d-b+1,g=this._maxEntries;if(f<=g){var h=p(a.slice(b,d+1));c(h,this.toBBox);return h}e||(e=Math.ceil(Math.log(f)/Math.log(g)),g=Math.ceil(f/Math.pow(g,e-1)));h=p([]);h.leaf=!1;h.height=e;f=Math.ceil(f/g);g=f*Math.ceil(Math.sqrt(g));
var k;for(r(a,b,d,g,this.compareMinX);b<=d;b+=g){var l=Math.min(b+g-1,d);r(a,b,l,f,this.compareMinY);for(k=b;k<=l;k+=f){var m=Math.min(k+f-1,l);h.children.push(this._build(a,k,m,e-1))}}c(h,this.toBBox);return h},_chooseSubtree:function(a,b,c,d){for(var e,g,h,k,l,m,n,p;;){d.push(b);if(b.leaf||d.length-1===c)break;n=p=Infinity;e=0;for(g=b.children.length;e<g;e++)h=b.children[e],l=f(h),m=(Math.max(h.maxX,a.maxX)-Math.min(h.minX,a.minX))*(Math.max(h.maxY,a.maxY)-Math.min(h.minY,a.minY))-l,m<p?(p=m,n=
l<n?l:n,k=h):m===p&&l<n&&(n=l,k=h);b=k||b.children[0]}return b},_insert:function(a,b,c){var d=this.toBBox;c=c?a:d(a);d=[];var e=this._chooseSubtree(c,this.data,b,d);e.children.push(a);for(h(e,c);0<=b;)if(d[b].children.length>this._maxEntries)this._split(d,b),b--;else break;this._adjustParentBBoxes(c,d,b)},_split:function(a,b){var d=a[b],e=d.children.length,f=this._minEntries;this._chooseSplitAxis(d,f,e);e=this._chooseSplitIndex(d,f,e);e=p(d.children.splice(e,d.children.length-e));e.height=d.height;
e.leaf=d.leaf;c(d,this.toBBox);c(e,this.toBBox);b?a[b-1].children.push(e):this._splitRoot(d,e)},_splitRoot:function(a,b){this.data=p([a,b]);this.data.height=a.height+1;this.data.leaf=!1;c(this.data,this.toBBox)},_chooseSplitIndex:function(a,c,d){var e,g;var h=g=Infinity;for(e=c;e<=d-c;e++){var k=b(a,0,e,this.toBBox);var l=b(a,e,d,this.toBBox);var m=Math.max(0,Math.min(k.maxX,l.maxX)-Math.max(k.minX,l.minX))*Math.max(0,Math.min(k.maxY,l.maxY)-Math.max(k.minY,l.minY));k=f(k)+f(l);if(m<h){h=m;var n=
e;g=k<g?k:g}else m===h&&k<g&&(g=k,n=e)}return n},_chooseSplitAxis:function(a,b,c){var d=a.leaf?this.compareMinX:n,e=a.leaf?this.compareMinY:g,f=this._allDistMargin(a,b,c,d);b=this._allDistMargin(a,b,c,e);f<b&&a.children.sort(d)},_allDistMargin:function(a,c,d,e){a.children.sort(e);e=this.toBBox;var f=b(a,0,c,e),g=b(a,d-c,d,e),k=l(f)+l(g),m;for(m=c;m<d-c;m++){var n=a.children[m];h(f,a.leaf?e(n):n);k+=l(f)}for(m=d-c-1;m>=c;m--)n=a.children[m],h(g,a.leaf?e(n):n),k+=l(g);return k},_adjustParentBBoxes:function(a,
b,c){for(;0<=c;c--)h(b[c],a)},_condense:function(a){for(var b=a.length-1,d;0<=b;b--)0===a[b].children.length?0<b?(d=a[b-1].children,d.splice(d.indexOf(a[b]),1)):this.clear():c(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}}},{quickselect:257}]},{},[1]);
